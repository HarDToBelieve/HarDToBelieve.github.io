<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ssl_session.cc source code [webkit/Source/ThirdParty/libwebrtc/Source/third_party/boringssl/src/ssl/ssl_session.cc] - Woboq Code Browser</title>
<meta name="woboq:interestingDefinitions" content="timeout_param_st "/>
<link rel="stylesheet" href="../../../../../../../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../../../../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../../../../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../../../../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'webkit/Source/ThirdParty/libwebrtc/Source/third_party/boringssl/src/ssl/ssl_session.cc'; var root_path = '../../../../../../../../..'; var data_path = '../../../../../../../../../../data'; var ecma_script_api_version = 2;</script>
<script src='../../../../../../../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../../../../../..'>webkit</a>/<a href='../../../../../../..'>Source</a>/<a href='../../../../../..'>ThirdParty</a>/<a href='../../../../..'>libwebrtc</a>/<a href='../../../..'>Source</a>/<a href='../../..'>third_party</a>/<a href='../..'>boringssl</a>/<a href='..'>src</a>/<a href='./'>ssl</a>/<a href='ssl_session.cc.html'>ssl_session.cc</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/* Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)</i></td></tr>
<tr><th id="2">2</th><td><i> * All rights reserved.</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> * This package is an SSL implementation written</i></td></tr>
<tr><th id="5">5</th><td><i> * by Eric Young (eay@cryptsoft.com).</i></td></tr>
<tr><th id="6">6</th><td><i> * The implementation was written so as to conform with Netscapes SSL.</i></td></tr>
<tr><th id="7">7</th><td><i> *</i></td></tr>
<tr><th id="8">8</th><td><i> * This library is free for commercial and non-commercial use as long as</i></td></tr>
<tr><th id="9">9</th><td><i> * the following conditions are aheared to.  The following conditions</i></td></tr>
<tr><th id="10">10</th><td><i> * apply to all code found in this distribution, be it the RC4, RSA,</i></td></tr>
<tr><th id="11">11</th><td><i> * lhash, DES, etc., code; not just the SSL code.  The SSL documentation</i></td></tr>
<tr><th id="12">12</th><td><i> * included with this distribution is covered by the same copyright terms</i></td></tr>
<tr><th id="13">13</th><td><i> * except that the holder is Tim Hudson (tjh@cryptsoft.com).</i></td></tr>
<tr><th id="14">14</th><td><i> *</i></td></tr>
<tr><th id="15">15</th><td><i> * Copyright remains Eric Young's, and as such any Copyright notices in</i></td></tr>
<tr><th id="16">16</th><td><i> * the code are not to be removed.</i></td></tr>
<tr><th id="17">17</th><td><i> * If this package is used in a product, Eric Young should be given attribution</i></td></tr>
<tr><th id="18">18</th><td><i> * as the author of the parts of the library used.</i></td></tr>
<tr><th id="19">19</th><td><i> * This can be in the form of a textual message at program startup or</i></td></tr>
<tr><th id="20">20</th><td><i> * in documentation (online or textual) provided with the package.</i></td></tr>
<tr><th id="21">21</th><td><i> *</i></td></tr>
<tr><th id="22">22</th><td><i> * Redistribution and use in source and binary forms, with or without</i></td></tr>
<tr><th id="23">23</th><td><i> * modification, are permitted provided that the following conditions</i></td></tr>
<tr><th id="24">24</th><td><i> * are met:</i></td></tr>
<tr><th id="25">25</th><td><i> * 1. Redistributions of source code must retain the copyright</i></td></tr>
<tr><th id="26">26</th><td><i> *    notice, this list of conditions and the following disclaimer.</i></td></tr>
<tr><th id="27">27</th><td><i> * 2. Redistributions in binary form must reproduce the above copyright</i></td></tr>
<tr><th id="28">28</th><td><i> *    notice, this list of conditions and the following disclaimer in the</i></td></tr>
<tr><th id="29">29</th><td><i> *    documentation and/or other materials provided with the distribution.</i></td></tr>
<tr><th id="30">30</th><td><i> * 3. All advertising materials mentioning features or use of this software</i></td></tr>
<tr><th id="31">31</th><td><i> *    must display the following acknowledgement:</i></td></tr>
<tr><th id="32">32</th><td><i> *    "This product includes cryptographic software written by</i></td></tr>
<tr><th id="33">33</th><td><i> *     Eric Young (eay@cryptsoft.com)"</i></td></tr>
<tr><th id="34">34</th><td><i> *    The word 'cryptographic' can be left out if the rouines from the library</i></td></tr>
<tr><th id="35">35</th><td><i> *    being used are not cryptographic related :-).</i></td></tr>
<tr><th id="36">36</th><td><i> * 4. If you include any Windows specific code (or a derivative thereof) from</i></td></tr>
<tr><th id="37">37</th><td><i> *    the apps directory (application code) you must include an acknowledgement:</i></td></tr>
<tr><th id="38">38</th><td><i> *    "This product includes software written by Tim Hudson (tjh@cryptsoft.com)"</i></td></tr>
<tr><th id="39">39</th><td><i> *</i></td></tr>
<tr><th id="40">40</th><td><i> * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND</i></td></tr>
<tr><th id="41">41</th><td><i> * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</i></td></tr>
<tr><th id="42">42</th><td><i> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</i></td></tr>
<tr><th id="43">43</th><td><i> * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE</i></td></tr>
<tr><th id="44">44</th><td><i> * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</i></td></tr>
<tr><th id="45">45</th><td><i> * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS</i></td></tr>
<tr><th id="46">46</th><td><i> * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</i></td></tr>
<tr><th id="47">47</th><td><i> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</i></td></tr>
<tr><th id="48">48</th><td><i> * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</i></td></tr>
<tr><th id="49">49</th><td><i> * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF</i></td></tr>
<tr><th id="50">50</th><td><i> * SUCH DAMAGE.</i></td></tr>
<tr><th id="51">51</th><td><i> *</i></td></tr>
<tr><th id="52">52</th><td><i> * The licence and distribution terms for any publically available version or</i></td></tr>
<tr><th id="53">53</th><td><i> * derivative of this code cannot be changed.  i.e. this code cannot simply be</i></td></tr>
<tr><th id="54">54</th><td><i> * copied and put under another distribution licence</i></td></tr>
<tr><th id="55">55</th><td><i> * [including the GNU Public Licence.]</i></td></tr>
<tr><th id="56">56</th><td><i> */</i></td></tr>
<tr><th id="57">57</th><td><i>/* ====================================================================</i></td></tr>
<tr><th id="58">58</th><td><i> * Copyright (c) 1998-2006 The OpenSSL Project.  All rights reserved.</i></td></tr>
<tr><th id="59">59</th><td><i> *</i></td></tr>
<tr><th id="60">60</th><td><i> * Redistribution and use in source and binary forms, with or without</i></td></tr>
<tr><th id="61">61</th><td><i> * modification, are permitted provided that the following conditions</i></td></tr>
<tr><th id="62">62</th><td><i> * are met:</i></td></tr>
<tr><th id="63">63</th><td><i> *</i></td></tr>
<tr><th id="64">64</th><td><i> * 1. Redistributions of source code must retain the above copyright</i></td></tr>
<tr><th id="65">65</th><td><i> *    notice, this list of conditions and the following disclaimer.</i></td></tr>
<tr><th id="66">66</th><td><i> *</i></td></tr>
<tr><th id="67">67</th><td><i> * 2. Redistributions in binary form must reproduce the above copyright</i></td></tr>
<tr><th id="68">68</th><td><i> *    notice, this list of conditions and the following disclaimer in</i></td></tr>
<tr><th id="69">69</th><td><i> *    the documentation and/or other materials provided with the</i></td></tr>
<tr><th id="70">70</th><td><i> *    distribution.</i></td></tr>
<tr><th id="71">71</th><td><i> *</i></td></tr>
<tr><th id="72">72</th><td><i> * 3. All advertising materials mentioning features or use of this</i></td></tr>
<tr><th id="73">73</th><td><i> *    software must display the following acknowledgment:</i></td></tr>
<tr><th id="74">74</th><td><i> *    "This product includes software developed by the OpenSSL Project</i></td></tr>
<tr><th id="75">75</th><td><i> *    for use in the OpenSSL Toolkit. (<a href="http://www.openssl.org/">http://www.openssl.org/</a>)"</i></td></tr>
<tr><th id="76">76</th><td><i> *</i></td></tr>
<tr><th id="77">77</th><td><i> * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to</i></td></tr>
<tr><th id="78">78</th><td><i> *    endorse or promote products derived from this software without</i></td></tr>
<tr><th id="79">79</th><td><i> *    prior written permission. For written permission, please contact</i></td></tr>
<tr><th id="80">80</th><td><i> *    openssl-core@openssl.org.</i></td></tr>
<tr><th id="81">81</th><td><i> *</i></td></tr>
<tr><th id="82">82</th><td><i> * 5. Products derived from this software may not be called "OpenSSL"</i></td></tr>
<tr><th id="83">83</th><td><i> *    nor may "OpenSSL" appear in their names without prior written</i></td></tr>
<tr><th id="84">84</th><td><i> *    permission of the OpenSSL Project.</i></td></tr>
<tr><th id="85">85</th><td><i> *</i></td></tr>
<tr><th id="86">86</th><td><i> * 6. Redistributions of any form whatsoever must retain the following</i></td></tr>
<tr><th id="87">87</th><td><i> *    acknowledgment:</i></td></tr>
<tr><th id="88">88</th><td><i> *    "This product includes software developed by the OpenSSL Project</i></td></tr>
<tr><th id="89">89</th><td><i> *    for use in the OpenSSL Toolkit (<a href="http://www.openssl.org/">http://www.openssl.org/</a>)"</i></td></tr>
<tr><th id="90">90</th><td><i> *</i></td></tr>
<tr><th id="91">91</th><td><i> * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY</i></td></tr>
<tr><th id="92">92</th><td><i> * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</i></td></tr>
<tr><th id="93">93</th><td><i> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR</i></td></tr>
<tr><th id="94">94</th><td><i> * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR</i></td></tr>
<tr><th id="95">95</th><td><i> * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</i></td></tr>
<tr><th id="96">96</th><td><i> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT</i></td></tr>
<tr><th id="97">97</th><td><i> * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</i></td></tr>
<tr><th id="98">98</th><td><i> * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</i></td></tr>
<tr><th id="99">99</th><td><i> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</i></td></tr>
<tr><th id="100">100</th><td><i> * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</i></td></tr>
<tr><th id="101">101</th><td><i> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED</i></td></tr>
<tr><th id="102">102</th><td><i> * OF THE POSSIBILITY OF SUCH DAMAGE.</i></td></tr>
<tr><th id="103">103</th><td><i> * ====================================================================</i></td></tr>
<tr><th id="104">104</th><td><i> *</i></td></tr>
<tr><th id="105">105</th><td><i> * This product includes cryptographic software written by Eric Young</i></td></tr>
<tr><th id="106">106</th><td><i> * (eay@cryptsoft.com).  This product includes software written by Tim</i></td></tr>
<tr><th id="107">107</th><td><i> * Hudson (tjh@cryptsoft.com).</i></td></tr>
<tr><th id="108">108</th><td><i> *</i></td></tr>
<tr><th id="109">109</th><td><i> */</i></td></tr>
<tr><th id="110">110</th><td><i>/* ====================================================================</i></td></tr>
<tr><th id="111">111</th><td><i> * Copyright 2005 Nokia. All rights reserved.</i></td></tr>
<tr><th id="112">112</th><td><i> *</i></td></tr>
<tr><th id="113">113</th><td><i> * The portions of the attached software ("Contribution") is developed by</i></td></tr>
<tr><th id="114">114</th><td><i> * Nokia Corporation and is licensed pursuant to the OpenSSL open source</i></td></tr>
<tr><th id="115">115</th><td><i> * license.</i></td></tr>
<tr><th id="116">116</th><td><i> *</i></td></tr>
<tr><th id="117">117</th><td><i> * The Contribution, originally written by Mika Kousa and Pasi Eronen of</i></td></tr>
<tr><th id="118">118</th><td><i> * Nokia Corporation, consists of the "PSK" (Pre-Shared Key) ciphersuites</i></td></tr>
<tr><th id="119">119</th><td><i> * support (see RFC 4279) to OpenSSL.</i></td></tr>
<tr><th id="120">120</th><td><i> *</i></td></tr>
<tr><th id="121">121</th><td><i> * No patent licenses or other rights except those expressly stated in</i></td></tr>
<tr><th id="122">122</th><td><i> * the OpenSSL open source license shall be deemed granted or received</i></td></tr>
<tr><th id="123">123</th><td><i> * expressly, by implication, estoppel, or otherwise.</i></td></tr>
<tr><th id="124">124</th><td><i> *</i></td></tr>
<tr><th id="125">125</th><td><i> * No assurances are provided by Nokia that the Contribution does not</i></td></tr>
<tr><th id="126">126</th><td><i> * infringe the patent or other intellectual property rights of any third</i></td></tr>
<tr><th id="127">127</th><td><i> * party or that the license provides you with all the necessary rights</i></td></tr>
<tr><th id="128">128</th><td><i> * to make use of the Contribution.</i></td></tr>
<tr><th id="129">129</th><td><i> *</i></td></tr>
<tr><th id="130">130</th><td><i> * THE SOFTWARE IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND. IN</i></td></tr>
<tr><th id="131">131</th><td><i> * ADDITION TO THE DISCLAIMERS INCLUDED IN THE LICENSE, NOKIA</i></td></tr>
<tr><th id="132">132</th><td><i> * SPECIFICALLY DISCLAIMS ANY LIABILITY FOR CLAIMS BROUGHT BY YOU OR ANY</i></td></tr>
<tr><th id="133">133</th><td><i> * OTHER ENTITY BASED ON INFRINGEMENT OF INTELLECTUAL PROPERTY RIGHTS OR</i></td></tr>
<tr><th id="134">134</th><td><i> * OTHERWISE. */</i></td></tr>
<tr><th id="135">135</th><td></td></tr>
<tr><th id="136">136</th><td><u>#include <a href="../include/openssl/ssl.h.html">&lt;openssl/ssl.h&gt;</a></u></td></tr>
<tr><th id="137">137</th><td></td></tr>
<tr><th id="138">138</th><td><u>#include &lt;assert.h&gt;</u></td></tr>
<tr><th id="139">139</th><td><u>#include &lt;stdlib.h&gt;</u></td></tr>
<tr><th id="140">140</th><td><u>#include &lt;string.h&gt;</u></td></tr>
<tr><th id="141">141</th><td></td></tr>
<tr><th id="142">142</th><td><u>#include &lt;utility&gt;</u></td></tr>
<tr><th id="143">143</th><td></td></tr>
<tr><th id="144">144</th><td><u>#include <a href="../include/openssl/err.h.html">&lt;openssl/err.h&gt;</a></u></td></tr>
<tr><th id="145">145</th><td><u>#include <a href="../include/openssl/hmac.h.html">&lt;openssl/hmac.h&gt;</a></u></td></tr>
<tr><th id="146">146</th><td><u>#include <a href="../include/openssl/lhash.h.html">&lt;openssl/lhash.h&gt;</a></u></td></tr>
<tr><th id="147">147</th><td><u>#include <a href="../include/openssl/mem.h.html">&lt;openssl/mem.h&gt;</a></u></td></tr>
<tr><th id="148">148</th><td><u>#include <a href="../include/openssl/rand.h.html">&lt;openssl/rand.h&gt;</a></u></td></tr>
<tr><th id="149">149</th><td></td></tr>
<tr><th id="150">150</th><td><u>#include <a href="internal.h.html">"internal.h"</a></u></td></tr>
<tr><th id="151">151</th><td><u>#include <a href="../crypto/internal.h.html">"../crypto/internal.h"</a></u></td></tr>
<tr><th id="152">152</th><td></td></tr>
<tr><th id="153">153</th><td></td></tr>
<tr><th id="154">154</th><td><a class="macro" href="../include/openssl/base.h.html#476" title="namespace bssl {" data-ref="_M/BSSL_NAMESPACE_BEGIN">BSSL_NAMESPACE_BEGIN</a></td></tr>
<tr><th id="155">155</th><td></td></tr>
<tr><th id="156">156</th><td><i  data-doc="bssl::g_pending_session_magic">// The address of this is a magic value, a pointer to which is returned by</i></td></tr>
<tr><th id="157">157</th><td><i  data-doc="bssl::g_pending_session_magic">// SSL_magic_pending_session_ptr(). It allows a session callback to indicate</i></td></tr>
<tr><th id="158">158</th><td><i  data-doc="bssl::g_pending_session_magic">// that it needs to asynchronously fetch session information.</i></td></tr>
<tr><th id="159">159</th><td><em>static</em> <em>const</em> <em>char</em> <dfn class="tu decl def" id="bssl::g_pending_session_magic" title='bssl::g_pending_session_magic' data-type='const char' data-ref="bssl::g_pending_session_magic" data-ref-filename="bssl..g_pending_session_magic">g_pending_session_magic</dfn> = <var>0</var>;</td></tr>
<tr><th id="160">160</th><td></td></tr>
<tr><th id="161">161</th><td><em>static</em> <a class="typedef" href="../crypto/internal.h.html#CRYPTO_EX_DATA_CLASS" title='CRYPTO_EX_DATA_CLASS' data-type='struct CRYPTO_EX_DATA_CLASS' data-ref="CRYPTO_EX_DATA_CLASS" data-ref-filename="CRYPTO_EX_DATA_CLASS">CRYPTO_EX_DATA_CLASS</a> <dfn class="tu decl def" id="bssl::g_ex_data_class" title='bssl::g_ex_data_class' data-type='CRYPTO_EX_DATA_CLASS' data-ref="bssl::g_ex_data_class" data-ref-filename="bssl..g_ex_data_class">g_ex_data_class</dfn> =</td></tr>
<tr><th id="162">162</th><td>    <a class="macro" href="../crypto/internal.h.html#667" title="{{ {0x2DA8B3B4, {0}} }, __null, 1}" data-ref="_M/CRYPTO_EX_DATA_CLASS_INIT_WITH_APP_DATA">CRYPTO_EX_DATA_CLASS_INIT_WITH_APP_DATA</a>;</td></tr>
<tr><th id="163">163</th><td></td></tr>
<tr><th id="164">164</th><td><em>static</em> <em>void</em> <a class="tu decl fn" href="#_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st" title='bssl::SSL_SESSION_list_remove' data-type='void bssl::SSL_SESSION_list_remove(SSL_CTX * ctx, SSL_SESSION * session)' data-ref="_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st" data-ref-filename="_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st">SSL_SESSION_list_remove</a>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col1 decl" id="1ctx" title='ctx' data-type='SSL_CTX *' data-ref="1ctx" data-ref-filename="1ctx">ctx</dfn>, <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col2 decl" id="2session" title='session' data-type='SSL_SESSION *' data-ref="2session" data-ref-filename="2session">session</dfn>);</td></tr>
<tr><th id="165">165</th><td><em>static</em> <em>void</em> <a class="tu decl fn" href="#_ZN4bsslL20SSL_SESSION_list_addEP10ssl_ctx_stP14ssl_session_st" title='bssl::SSL_SESSION_list_add' data-type='void bssl::SSL_SESSION_list_add(SSL_CTX * ctx, SSL_SESSION * session)' data-ref="_ZN4bsslL20SSL_SESSION_list_addEP10ssl_ctx_stP14ssl_session_st" data-ref-filename="_ZN4bsslL20SSL_SESSION_list_addEP10ssl_ctx_stP14ssl_session_st">SSL_SESSION_list_add</a>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col3 decl" id="3ctx" title='ctx' data-type='SSL_CTX *' data-ref="3ctx" data-ref-filename="3ctx">ctx</dfn>, <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col4 decl" id="4session" title='session' data-type='SSL_SESSION *' data-ref="4session" data-ref-filename="4session">session</dfn>);</td></tr>
<tr><th id="166">166</th><td><em>static</em> <em>int</em> <a class="tu decl fn" href="#_ZN4bsslL19remove_session_lockEP10ssl_ctx_stP14ssl_session_sti" title='bssl::remove_session_lock' data-type='int bssl::remove_session_lock(SSL_CTX * ctx, SSL_SESSION * session, int lock)' data-ref="_ZN4bsslL19remove_session_lockEP10ssl_ctx_stP14ssl_session_sti" data-ref-filename="_ZN4bsslL19remove_session_lockEP10ssl_ctx_stP14ssl_session_sti">remove_session_lock</a>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col5 decl" id="5ctx" title='ctx' data-type='SSL_CTX *' data-ref="5ctx" data-ref-filename="5ctx">ctx</dfn>, <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col6 decl" id="6session" title='session' data-type='SSL_SESSION *' data-ref="6session" data-ref-filename="6session">session</dfn>, <em>int</em> <dfn class="local col7 decl" id="7lock" title='lock' data-type='int' data-ref="7lock" data-ref-filename="7lock">lock</dfn>);</td></tr>
<tr><th id="167">167</th><td></td></tr>
<tr><th id="168">168</th><td><a class="type" href="../include/openssl/base.h.html#bssl::UniquePtr" title='bssl::UniquePtr' data-ref="bssl::UniquePtr" data-ref-filename="bssl..UniquePtr">UniquePtr</a>&lt;<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a>&gt; <dfn class="decl def fn" id="_ZN4bssl15ssl_session_newEPKNS_15SSL_X509_METHODE" title='bssl::ssl_session_new' data-ref="_ZN4bssl15ssl_session_newEPKNS_15SSL_X509_METHODE" data-ref-filename="_ZN4bssl15ssl_session_newEPKNS_15SSL_X509_METHODE">ssl_session_new</dfn>(<em>const</em> <a class="type" href="internal.h.html#bssl::SSL_X509_METHOD" title='bssl::SSL_X509_METHOD' data-ref="bssl::SSL_X509_METHOD" data-ref-filename="bssl..SSL_X509_METHOD">SSL_X509_METHOD</a> *<dfn class="local col8 decl" id="8x509_method" title='x509_method' data-type='const bssl::SSL_X509_METHOD *' data-ref="8x509_method" data-ref-filename="8x509_method">x509_method</dfn>) {</td></tr>
<tr><th id="169">169</th><td>  <b>return</b> <a class="ref fn" href="internal.h.html#_ZN4bssl10MakeUniqueEDpOT0_" title='bssl::MakeUnique' data-ref="_ZN4bssl10MakeUniqueEDpOT0_" data-ref-filename="_ZN4bssl10MakeUniqueEDpOT0_">MakeUnique</a>&lt;<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a>&gt;(<span class='refarg'><a class="local col8 ref" href="#8x509_method" title='x509_method' data-ref="8x509_method" data-ref-filename="8x509_method">x509_method</a></span>);</td></tr>
<tr><th id="170">170</th><td>}</td></tr>
<tr><th id="171">171</th><td></td></tr>
<tr><th id="172">172</th><td><span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span> <dfn class="decl def fn" id="_ZN4bssl19ssl_hash_session_idENS_4SpanIKhEE" title='bssl::ssl_hash_session_id' data-ref="_ZN4bssl19ssl_hash_session_idENS_4SpanIKhEE" data-ref-filename="_ZN4bssl19ssl_hash_session_idENS_4SpanIKhEE">ssl_hash_session_id</dfn>(<a class="type" href="../include/openssl/span.h.html#bssl::Span" title='bssl::Span' data-ref="bssl::Span" data-ref-filename="bssl..Span">Span</a>&lt;<em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span>&gt; <dfn class="local col9 decl" id="9session_id" title='session_id' data-type='Span&lt;const uint8_t&gt;' data-ref="9session_id" data-ref-filename="9session_id">session_id</dfn>) {</td></tr>
<tr><th id="173">173</th><td>  <i>// Take the first four bytes of |session_id|. Session IDs are generated by the</i></td></tr>
<tr><th id="174">174</th><td><i>  // server randomly, so we can assume even using the first four bytes results</i></td></tr>
<tr><th id="175">175</th><td><i>  // in a good distribution.</i></td></tr>
<tr><th id="176">176</th><td>  <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> <dfn class="local col0 decl" id="10tmp_storage" title='tmp_storage' data-type='uint8_t [4]' data-ref="10tmp_storage" data-ref-filename="10tmp_storage">tmp_storage</dfn>[<b>sizeof</b>(<span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span>)];</td></tr>
<tr><th id="177">177</th><td>  <b>if</b> (<a class="local col9 ref" href="#9session_id" title='session_id' data-ref="9session_id" data-ref-filename="9session_id">session_id</a>.<a class="ref fn" href="../include/openssl/span.h.html#_ZNK4bssl4Span4sizeEv" title='bssl::Span::size' data-ref="_ZNK4bssl4Span4sizeEv" data-ref-filename="_ZNK4bssl4Span4sizeEv">size</a>() &lt; <b>sizeof</b>(<a class="local col0 ref" href="#10tmp_storage" title='tmp_storage' data-ref="10tmp_storage" data-ref-filename="10tmp_storage">tmp_storage</a>)) {</td></tr>
<tr><th id="178">178</th><td>    <a class="ref fn" href="../crypto/internal.h.html#_ZL14OPENSSL_memsetPvim" title='OPENSSL_memset' data-ref="_ZL14OPENSSL_memsetPvim" data-ref-filename="_ZL14OPENSSL_memsetPvim">OPENSSL_memset</a>(<a class="local col0 ref" href="#10tmp_storage" title='tmp_storage' data-ref="10tmp_storage" data-ref-filename="10tmp_storage">tmp_storage</a>, <var>0</var>, <b>sizeof</b>(<a class="local col0 ref" href="#10tmp_storage" title='tmp_storage' data-ref="10tmp_storage" data-ref-filename="10tmp_storage">tmp_storage</a>));</td></tr>
<tr><th id="179">179</th><td>    <a class="ref fn" href="../crypto/internal.h.html#_ZL14OPENSSL_memcpyPvPKvm" title='OPENSSL_memcpy' data-ref="_ZL14OPENSSL_memcpyPvPKvm" data-ref-filename="_ZL14OPENSSL_memcpyPvPKvm">OPENSSL_memcpy</a>(<a class="local col0 ref" href="#10tmp_storage" title='tmp_storage' data-ref="10tmp_storage" data-ref-filename="10tmp_storage">tmp_storage</a>, <a class="local col9 ref" href="#9session_id" title='session_id' data-ref="9session_id" data-ref-filename="9session_id">session_id</a>.<a class="ref fn" href="../include/openssl/span.h.html#_ZNK4bssl4Span4dataEv" title='bssl::Span::data' data-ref="_ZNK4bssl4Span4dataEv" data-ref-filename="_ZNK4bssl4Span4dataEv">data</a>(), <a class="local col9 ref" href="#9session_id" title='session_id' data-ref="9session_id" data-ref-filename="9session_id">session_id</a>.<a class="ref fn" href="../include/openssl/span.h.html#_ZNK4bssl4Span4sizeEv" title='bssl::Span::size' data-ref="_ZNK4bssl4Span4sizeEv" data-ref-filename="_ZNK4bssl4Span4sizeEv">size</a>());</td></tr>
<tr><th id="180">180</th><td>    <a class="local col9 ref" href="#9session_id" title='session_id' data-ref="9session_id" data-ref-filename="9session_id">session_id</a> <a class="ref fn" href="../include/openssl/span.h.html#95" title='bssl::Span&lt;const unsigned char&gt;::operator=' data-ref="_ZN4bssl4SpanIKhEaSEOS2_" data-ref-filename="_ZN4bssl4SpanIKhEaSEOS2_">=</a> <a class="ref fn fake" href="../include/openssl/span.h.html#_ZN4bssl4SpanC1ERATL0___T_" title='bssl::Span::Span&lt;T&gt;' data-ref="_ZN4bssl4SpanC1ERATL0___T_" data-ref-filename="_ZN4bssl4SpanC1ERATL0___T_"></a><a class="local col0 ref" href="#10tmp_storage" title='tmp_storage' data-ref="10tmp_storage" data-ref-filename="10tmp_storage">tmp_storage</a>;</td></tr>
<tr><th id="181">181</th><td>  }</td></tr>
<tr><th id="182">182</th><td></td></tr>
<tr><th id="183">183</th><td>  <span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span> <dfn class="local col1 decl" id="11hash" title='hash' data-type='uint32_t' data-ref="11hash" data-ref-filename="11hash">hash</dfn> =</td></tr>
<tr><th id="184">184</th><td>      ((<span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span>)<a class="local col9 ref" href="#9session_id" title='session_id' data-ref="9session_id" data-ref-filename="9session_id">session_id</a><a class="ref fn" href="../include/openssl/span.h.html#_ZNK4bssl4SpanixEm" title='bssl::Span::operator[]' data-ref="_ZNK4bssl4SpanixEm" data-ref-filename="_ZNK4bssl4SpanixEm">[<var>0</var>]</a>) |</td></tr>
<tr><th id="185">185</th><td>      ((<span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span>)<a class="local col9 ref" href="#9session_id" title='session_id' data-ref="9session_id" data-ref-filename="9session_id">session_id</a><a class="ref fn" href="../include/openssl/span.h.html#_ZNK4bssl4SpanixEm" title='bssl::Span::operator[]' data-ref="_ZNK4bssl4SpanixEm" data-ref-filename="_ZNK4bssl4SpanixEm">[<var>1</var>]</a> &lt;&lt; <var>8</var>) |</td></tr>
<tr><th id="186">186</th><td>      ((<span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span>)<a class="local col9 ref" href="#9session_id" title='session_id' data-ref="9session_id" data-ref-filename="9session_id">session_id</a><a class="ref fn" href="../include/openssl/span.h.html#_ZNK4bssl4SpanixEm" title='bssl::Span::operator[]' data-ref="_ZNK4bssl4SpanixEm" data-ref-filename="_ZNK4bssl4SpanixEm">[<var>2</var>]</a> &lt;&lt; <var>16</var>) |</td></tr>
<tr><th id="187">187</th><td>      ((<span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span>)<a class="local col9 ref" href="#9session_id" title='session_id' data-ref="9session_id" data-ref-filename="9session_id">session_id</a><a class="ref fn" href="../include/openssl/span.h.html#_ZNK4bssl4SpanixEm" title='bssl::Span::operator[]' data-ref="_ZNK4bssl4SpanixEm" data-ref-filename="_ZNK4bssl4SpanixEm">[<var>3</var>]</a> &lt;&lt; <var>24</var>);</td></tr>
<tr><th id="188">188</th><td></td></tr>
<tr><th id="189">189</th><td>  <b>return</b> <a class="local col1 ref" href="#11hash" title='hash' data-ref="11hash" data-ref-filename="11hash">hash</a>;</td></tr>
<tr><th id="190">190</th><td>}</td></tr>
<tr><th id="191">191</th><td></td></tr>
<tr><th id="192">192</th><td><a class="type" href="../include/openssl/base.h.html#bssl::UniquePtr" title='bssl::UniquePtr' data-ref="bssl::UniquePtr" data-ref-filename="bssl..UniquePtr">UniquePtr</a>&lt;<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a>&gt; <dfn class="decl def fn" id="_ZN4bssl15SSL_SESSION_dupEP14ssl_session_sti" title='bssl::SSL_SESSION_dup' data-ref="_ZN4bssl15SSL_SESSION_dupEP14ssl_session_sti" data-ref-filename="_ZN4bssl15SSL_SESSION_dupEP14ssl_session_sti">SSL_SESSION_dup</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col2 decl" id="12session" title='session' data-type='SSL_SESSION *' data-ref="12session" data-ref-filename="12session">session</dfn>, <em>int</em> <dfn class="local col3 decl" id="13dup_flags" title='dup_flags' data-type='int' data-ref="13dup_flags" data-ref-filename="13dup_flags">dup_flags</dfn>) {</td></tr>
<tr><th id="193">193</th><td>  <a class="type" href="../include/openssl/base.h.html#bssl::UniquePtr" title='bssl::UniquePtr' data-ref="bssl::UniquePtr" data-ref-filename="bssl..UniquePtr">UniquePtr</a>&lt;<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a>&gt; <dfn class="local col4 decl" id="14new_session" title='new_session' data-type='UniquePtr&lt;SSL_SESSION&gt;' data-ref="14new_session" data-ref-filename="14new_session">new_session</dfn> = <a class="ref fn" href="#_ZN4bssl15ssl_session_newEPKNS_15SSL_X509_METHODE" title='bssl::ssl_session_new' data-ref="_ZN4bssl15ssl_session_newEPKNS_15SSL_X509_METHODE" data-ref-filename="_ZN4bssl15ssl_session_newEPKNS_15SSL_X509_METHODE">ssl_session_new</a>(<a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::x509_method" title='ssl_session_st::x509_method' data-ref="ssl_session_st::x509_method" data-ref-filename="ssl_session_st..x509_method">x509_method</a>);</td></tr>
<tr><th id="194">194</th><td>  <b>if</b> (!<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a>) {</td></tr>
<tr><th id="195">195</th><td>    <b>return</b> <span class='ref fn fake' title='std::__1::unique_ptr::unique_ptr&lt;_Tp, _Dp&gt;' data-ref="_ZNSt3__110unique_ptrC1EDn" data-ref-filename="_ZNSt3__110unique_ptrC1EDn"></span><b>nullptr</b>;</td></tr>
<tr><th id="196">196</th><td>  }</td></tr>
<tr><th id="197">197</th><td></td></tr>
<tr><th id="198">198</th><td>  <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::is_server" title='ssl_session_st::is_server' data-ref="ssl_session_st::is_server" data-ref-filename="ssl_session_st..is_server">is_server</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::is_server" title='ssl_session_st::is_server' data-ref="ssl_session_st::is_server" data-ref-filename="ssl_session_st..is_server">is_server</a>;</td></tr>
<tr><th id="199">199</th><td>  <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::ssl_version" title='ssl_session_st::ssl_version' data-ref="ssl_session_st::ssl_version" data-ref-filename="ssl_session_st..ssl_version">ssl_version</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ssl_version" title='ssl_session_st::ssl_version' data-ref="ssl_session_st::ssl_version" data-ref-filename="ssl_session_st..ssl_version">ssl_version</a>;</td></tr>
<tr><th id="200">200</th><td>  <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::is_quic" title='ssl_session_st::is_quic' data-ref="ssl_session_st::is_quic" data-ref-filename="ssl_session_st..is_quic">is_quic</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::is_quic" title='ssl_session_st::is_quic' data-ref="ssl_session_st::is_quic" data-ref-filename="ssl_session_st..is_quic">is_quic</a>;</td></tr>
<tr><th id="201">201</th><td>  <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx_length" title='ssl_session_st::sid_ctx_length' data-ref="ssl_session_st::sid_ctx_length" data-ref-filename="ssl_session_st..sid_ctx_length">sid_ctx_length</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx_length" title='ssl_session_st::sid_ctx_length' data-ref="ssl_session_st::sid_ctx_length" data-ref-filename="ssl_session_st..sid_ctx_length">sid_ctx_length</a>;</td></tr>
<tr><th id="202">202</th><td>  <a class="ref fn" href="../crypto/internal.h.html#_ZL14OPENSSL_memcpyPvPKvm" title='OPENSSL_memcpy' data-ref="_ZL14OPENSSL_memcpyPvPKvm" data-ref-filename="_ZL14OPENSSL_memcpyPvPKvm">OPENSSL_memcpy</a>(<a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx" title='ssl_session_st::sid_ctx' data-ref="ssl_session_st::sid_ctx" data-ref-filename="ssl_session_st..sid_ctx">sid_ctx</a>, <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx" title='ssl_session_st::sid_ctx' data-ref="ssl_session_st::sid_ctx" data-ref-filename="ssl_session_st..sid_ctx">sid_ctx</a>, <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx_length" title='ssl_session_st::sid_ctx_length' data-ref="ssl_session_st::sid_ctx_length" data-ref-filename="ssl_session_st..sid_ctx_length">sid_ctx_length</a>);</td></tr>
<tr><th id="203">203</th><td></td></tr>
<tr><th id="204">204</th><td>  <i>// Copy the key material.</i></td></tr>
<tr><th id="205">205</th><td>  <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::secret_length" title='ssl_session_st::secret_length' data-ref="ssl_session_st::secret_length" data-ref-filename="ssl_session_st..secret_length">secret_length</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::secret_length" title='ssl_session_st::secret_length' data-ref="ssl_session_st::secret_length" data-ref-filename="ssl_session_st..secret_length">secret_length</a>;</td></tr>
<tr><th id="206">206</th><td>  <a class="ref fn" href="../crypto/internal.h.html#_ZL14OPENSSL_memcpyPvPKvm" title='OPENSSL_memcpy' data-ref="_ZL14OPENSSL_memcpyPvPKvm" data-ref-filename="_ZL14OPENSSL_memcpyPvPKvm">OPENSSL_memcpy</a>(<a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::secret" title='ssl_session_st::secret' data-ref="ssl_session_st::secret" data-ref-filename="ssl_session_st..secret">secret</a>, <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::secret" title='ssl_session_st::secret' data-ref="ssl_session_st::secret" data-ref-filename="ssl_session_st..secret">secret</a>, <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::secret_length" title='ssl_session_st::secret_length' data-ref="ssl_session_st::secret_length" data-ref-filename="ssl_session_st..secret_length">secret_length</a>);</td></tr>
<tr><th id="207">207</th><td>  <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::cipher" title='ssl_session_st::cipher' data-ref="ssl_session_st::cipher" data-ref-filename="ssl_session_st..cipher">cipher</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::cipher" title='ssl_session_st::cipher' data-ref="ssl_session_st::cipher" data-ref-filename="ssl_session_st..cipher">cipher</a>;</td></tr>
<tr><th id="208">208</th><td></td></tr>
<tr><th id="209">209</th><td>  <i>// Copy authentication state.</i></td></tr>
<tr><th id="210">210</th><td>  <b>if</b> (<a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::psk_identity" title='ssl_session_st::psk_identity' data-ref="ssl_session_st::psk_identity" data-ref-filename="ssl_session_st..psk_identity">psk_identity</a> <span class='ref fn' title='std::__1::operator!=' data-ref="_ZNSt3__1neERKNS_10unique_ptrIT_T0_EEDn" data-ref-filename="_ZNSt3__1neERKNS_10unique_ptrIT_T0_EEDn">!=</span> <b>nullptr</b>) {</td></tr>
<tr><th id="211">211</th><td>    <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::psk_identity" title='ssl_session_st::psk_identity' data-ref="ssl_session_st::psk_identity" data-ref-filename="ssl_session_st..psk_identity">psk_identity</a>.<span class='ref fn' title='std::__1::unique_ptr::reset' data-ref="_ZNSt3__110unique_ptr5resetENS_14__pointer_typeIT_T0_E4typeE" data-ref-filename="_ZNSt3__110unique_ptr5resetENS_14__pointer_typeIT_T0_E4typeE">reset</span>(</td></tr>
<tr><th id="212">212</th><td>        <a class="ref fn" href="../include/openssl/mem.h.html#OPENSSL_strdup" title='OPENSSL_strdup' data-ref="OPENSSL_strdup" data-ref-filename="OPENSSL_strdup">OPENSSL_strdup</a>(<a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::psk_identity" title='ssl_session_st::psk_identity' data-ref="ssl_session_st::psk_identity" data-ref-filename="ssl_session_st..psk_identity">psk_identity</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>()));</td></tr>
<tr><th id="213">213</th><td>    <b>if</b> (<a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::psk_identity" title='ssl_session_st::psk_identity' data-ref="ssl_session_st::psk_identity" data-ref-filename="ssl_session_st..psk_identity">psk_identity</a> <span class='ref fn' title='std::__1::operator==' data-ref="_ZNSt3__1eqERKNS_10unique_ptrIT_T0_EEDn" data-ref-filename="_ZNSt3__1eqERKNS_10unique_ptrIT_T0_EEDn">==</span> <b>nullptr</b>) {</td></tr>
<tr><th id="214">214</th><td>      <b>return</b> <span class='ref fn fake' title='std::__1::unique_ptr::unique_ptr&lt;_Tp, _Dp&gt;' data-ref="_ZNSt3__110unique_ptrC1EDn" data-ref-filename="_ZNSt3__110unique_ptrC1EDn"></span><b>nullptr</b>;</td></tr>
<tr><th id="215">215</th><td>    }</td></tr>
<tr><th id="216">216</th><td>  }</td></tr>
<tr><th id="217">217</th><td>  <b>if</b> (<a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::certs" title='ssl_session_st::certs' data-ref="ssl_session_st::certs" data-ref-filename="ssl_session_st..certs">certs</a> <span class='ref fn' title='std::__1::operator!=' data-ref="_ZNSt3__1neERKNS_10unique_ptrIT_T0_EEDn" data-ref-filename="_ZNSt3__1neERKNS_10unique_ptrIT_T0_EEDn">!=</span> <b>nullptr</b>) {</td></tr>
<tr><th id="218">218</th><td>    <em>auto</em> <dfn class="local col5 decl" id="15buf_up_ref" title='buf_up_ref' data-type='(lambda at /Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/third_party/boringssl/src/ssl/ssl_session.cc:218:23)' data-ref="15buf_up_ref" data-ref-filename="15buf_up_ref">buf_up_ref</dfn> = [](<a class="typedef" href="../include/openssl/base.h.html#CRYPTO_BUFFER" title='CRYPTO_BUFFER' data-type='struct crypto_buffer_st' data-ref="CRYPTO_BUFFER" data-ref-filename="CRYPTO_BUFFER">CRYPTO_BUFFER</a> *<dfn class="local col6 decl" id="16buf" title='buf' data-type='CRYPTO_BUFFER *' data-ref="16buf" data-ref-filename="16buf">buf</dfn>) {</td></tr>
<tr><th id="219">219</th><td>      <a class="ref fn" href="../include/openssl/pool.h.html#CRYPTO_BUFFER_up_ref" title='CRYPTO_BUFFER_up_ref' data-ref="CRYPTO_BUFFER_up_ref" data-ref-filename="CRYPTO_BUFFER_up_ref">CRYPTO_BUFFER_up_ref</a>(<a class="local col6 ref" href="#16buf" title='buf' data-ref="16buf" data-ref-filename="16buf">buf</a>);</td></tr>
<tr><th id="220">220</th><td>      <b>return</b> <a class="local col6 ref" href="#16buf" title='buf' data-ref="16buf" data-ref-filename="16buf">buf</a>;</td></tr>
<tr><th id="221">221</th><td>    };</td></tr>
<tr><th id="222">222</th><td>    <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::certs" title='ssl_session_st::certs' data-ref="ssl_session_st::certs" data-ref-filename="ssl_session_st..certs">certs</a>.<span class='ref fn' title='std::__1::unique_ptr::reset' data-ref="_ZNSt3__110unique_ptr5resetENS_14__pointer_typeIT_T0_E4typeE" data-ref-filename="_ZNSt3__110unique_ptr5resetENS_14__pointer_typeIT_T0_E4typeE">reset</span>(<a class="ref fn" href="../include/openssl/pool.h.html#34" title='sk_CRYPTO_BUFFER_deep_copy' data-ref="sk_CRYPTO_BUFFER_deep_copy" data-ref-filename="sk_CRYPTO_BUFFER_deep_copy">sk_CRYPTO_BUFFER_deep_copy</a>(</td></tr>
<tr><th id="223">223</th><td>        <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::certs" title='ssl_session_st::certs' data-ref="ssl_session_st::certs" data-ref-filename="ssl_session_st..certs">certs</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>(), <a class="tu ref fn fake" href="#218" title='bssl::SSL_SESSION_dup(SSL_SESSION *, int)::(anonymous class)::operator crypto_buffer_st *(*)(crypto_buffer_st *)' data-use='c' data-ref="_ZZN4bssl15SSL_SESSION_dupEP14ssl_session_stiENK3$_0cvPFP16crypto_buffer_stS4_EEv" data-ref-filename="_ZZN4bssl15SSL_SESSION_dupEP14ssl_session_stiENK3$_0cvPFP16crypto_buffer_stS4_EEv"></a><a class="local col5 ref" href="#15buf_up_ref" title='buf_up_ref' data-ref="15buf_up_ref" data-ref-filename="15buf_up_ref">buf_up_ref</a>, <a class="ref fn" href="../include/openssl/pool.h.html#CRYPTO_BUFFER_free" title='CRYPTO_BUFFER_free' data-ref="CRYPTO_BUFFER_free" data-ref-filename="CRYPTO_BUFFER_free">CRYPTO_BUFFER_free</a>));</td></tr>
<tr><th id="224">224</th><td>    <b>if</b> (<a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::certs" title='ssl_session_st::certs' data-ref="ssl_session_st::certs" data-ref-filename="ssl_session_st..certs">certs</a> <span class='ref fn' title='std::__1::operator==' data-ref="_ZNSt3__1eqERKNS_10unique_ptrIT_T0_EEDn" data-ref-filename="_ZNSt3__1eqERKNS_10unique_ptrIT_T0_EEDn">==</span> <b>nullptr</b>) {</td></tr>
<tr><th id="225">225</th><td>      <b>return</b> <span class='ref fn fake' title='std::__1::unique_ptr::unique_ptr&lt;_Tp, _Dp&gt;' data-ref="_ZNSt3__110unique_ptrC1EDn" data-ref-filename="_ZNSt3__110unique_ptrC1EDn"></span><b>nullptr</b>;</td></tr>
<tr><th id="226">226</th><td>    }</td></tr>
<tr><th id="227">227</th><td>  }</td></tr>
<tr><th id="228">228</th><td></td></tr>
<tr><th id="229">229</th><td>  <b>if</b> (!<a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::x509_method" title='ssl_session_st::x509_method' data-ref="ssl_session_st::x509_method" data-ref-filename="ssl_session_st..x509_method">x509_method</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_X509_METHOD::session_dup" title='bssl::SSL_X509_METHOD::session_dup' data-ref="bssl::SSL_X509_METHOD::session_dup" data-ref-filename="bssl..SSL_X509_METHOD..session_dup">session_dup</a>(<a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>(), <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>)) {</td></tr>
<tr><th id="230">230</th><td>    <b>return</b> <span class='ref fn fake' title='std::__1::unique_ptr::unique_ptr&lt;_Tp, _Dp&gt;' data-ref="_ZNSt3__110unique_ptrC1EDn" data-ref-filename="_ZNSt3__110unique_ptrC1EDn"></span><b>nullptr</b>;</td></tr>
<tr><th id="231">231</th><td>  }</td></tr>
<tr><th id="232">232</th><td></td></tr>
<tr><th id="233">233</th><td>  <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::verify_result" title='ssl_session_st::verify_result' data-ref="ssl_session_st::verify_result" data-ref-filename="ssl_session_st..verify_result">verify_result</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::verify_result" title='ssl_session_st::verify_result' data-ref="ssl_session_st::verify_result" data-ref-filename="ssl_session_st..verify_result">verify_result</a>;</td></tr>
<tr><th id="234">234</th><td></td></tr>
<tr><th id="235">235</th><td>  <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::ocsp_response" title='ssl_session_st::ocsp_response' data-ref="ssl_session_st::ocsp_response" data-ref-filename="ssl_session_st..ocsp_response">ocsp_response</a> <span class='ref fn' title='std::__1::unique_ptr::operator=' data-ref="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE" data-ref-filename="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE">=</span> <a class="ref fn" href="../include/openssl/pool.h.html#94" title='bssl::UpRef' data-ref="_ZN4bssl5UpRefERKNSt3__110unique_ptrI16crypto_buffer_stNS_8internal7DeleterIS2_EEEE" data-ref-filename="_ZN4bssl5UpRefERKNSt3__110unique_ptrI16crypto_buffer_stNS_8internal7DeleterIS2_EEEE">UpRef</a>(<a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ocsp_response" title='ssl_session_st::ocsp_response' data-ref="ssl_session_st::ocsp_response" data-ref-filename="ssl_session_st..ocsp_response">ocsp_response</a>);</td></tr>
<tr><th id="236">236</th><td>  <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::signed_cert_timestamp_list" title='ssl_session_st::signed_cert_timestamp_list' data-ref="ssl_session_st::signed_cert_timestamp_list" data-ref-filename="ssl_session_st..signed_cert_timestamp_list">signed_cert_timestamp_list</a> <span class='ref fn' title='std::__1::unique_ptr::operator=' data-ref="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE" data-ref-filename="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE">=</span></td></tr>
<tr><th id="237">237</th><td>      <a class="ref fn" href="../include/openssl/pool.h.html#94" title='bssl::UpRef' data-ref="_ZN4bssl5UpRefERKNSt3__110unique_ptrI16crypto_buffer_stNS_8internal7DeleterIS2_EEEE" data-ref-filename="_ZN4bssl5UpRefERKNSt3__110unique_ptrI16crypto_buffer_stNS_8internal7DeleterIS2_EEEE">UpRef</a>(<a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::signed_cert_timestamp_list" title='ssl_session_st::signed_cert_timestamp_list' data-ref="ssl_session_st::signed_cert_timestamp_list" data-ref-filename="ssl_session_st..signed_cert_timestamp_list">signed_cert_timestamp_list</a>);</td></tr>
<tr><th id="238">238</th><td></td></tr>
<tr><th id="239">239</th><td>  <a class="ref fn" href="../crypto/internal.h.html#_ZL14OPENSSL_memcpyPvPKvm" title='OPENSSL_memcpy' data-ref="_ZL14OPENSSL_memcpyPvPKvm" data-ref-filename="_ZL14OPENSSL_memcpyPvPKvm">OPENSSL_memcpy</a>(<a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::peer_sha256" title='ssl_session_st::peer_sha256' data-ref="ssl_session_st::peer_sha256" data-ref-filename="ssl_session_st..peer_sha256">peer_sha256</a>, <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::peer_sha256" title='ssl_session_st::peer_sha256' data-ref="ssl_session_st::peer_sha256" data-ref-filename="ssl_session_st..peer_sha256">peer_sha256</a>,</td></tr>
<tr><th id="240">240</th><td>                 <a class="macro" href="../include/openssl/sha.h.html#155" title="32" data-ref="_M/SHA256_DIGEST_LENGTH">SHA256_DIGEST_LENGTH</a>);</td></tr>
<tr><th id="241">241</th><td>  <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::peer_sha256_valid" title='ssl_session_st::peer_sha256_valid' data-ref="ssl_session_st::peer_sha256_valid" data-ref-filename="ssl_session_st..peer_sha256_valid">peer_sha256_valid</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::peer_sha256_valid" title='ssl_session_st::peer_sha256_valid' data-ref="ssl_session_st::peer_sha256_valid" data-ref-filename="ssl_session_st..peer_sha256_valid">peer_sha256_valid</a>;</td></tr>
<tr><th id="242">242</th><td></td></tr>
<tr><th id="243">243</th><td>  <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::peer_signature_algorithm" title='ssl_session_st::peer_signature_algorithm' data-ref="ssl_session_st::peer_signature_algorithm" data-ref-filename="ssl_session_st..peer_signature_algorithm">peer_signature_algorithm</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::peer_signature_algorithm" title='ssl_session_st::peer_signature_algorithm' data-ref="ssl_session_st::peer_signature_algorithm" data-ref-filename="ssl_session_st..peer_signature_algorithm">peer_signature_algorithm</a>;</td></tr>
<tr><th id="244">244</th><td></td></tr>
<tr><th id="245">245</th><td>  <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a>;</td></tr>
<tr><th id="246">246</th><td>  <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::auth_timeout" title='ssl_session_st::auth_timeout' data-ref="ssl_session_st::auth_timeout" data-ref-filename="ssl_session_st..auth_timeout">auth_timeout</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::auth_timeout" title='ssl_session_st::auth_timeout' data-ref="ssl_session_st::auth_timeout" data-ref-filename="ssl_session_st..auth_timeout">auth_timeout</a>;</td></tr>
<tr><th id="247">247</th><td>  <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::time" title='ssl_session_st::time' data-ref="ssl_session_st::time" data-ref-filename="ssl_session_st..time">time</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::time" title='ssl_session_st::time' data-ref="ssl_session_st::time" data-ref-filename="ssl_session_st..time">time</a>;</td></tr>
<tr><th id="248">248</th><td></td></tr>
<tr><th id="249">249</th><td>  <i>// Copy non-authentication connection properties.</i></td></tr>
<tr><th id="250">250</th><td>  <b>if</b> (<a class="local col3 ref" href="#13dup_flags" title='dup_flags' data-ref="13dup_flags" data-ref-filename="13dup_flags">dup_flags</a> &amp; <a class="macro" href="internal.h.html#3030" title="0x2" data-ref="_M/SSL_SESSION_INCLUDE_NONAUTH">SSL_SESSION_INCLUDE_NONAUTH</a>) {</td></tr>
<tr><th id="251">251</th><td>    <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::session_id_length" title='ssl_session_st::session_id_length' data-ref="ssl_session_st::session_id_length" data-ref-filename="ssl_session_st..session_id_length">session_id_length</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::session_id_length" title='ssl_session_st::session_id_length' data-ref="ssl_session_st::session_id_length" data-ref-filename="ssl_session_st..session_id_length">session_id_length</a>;</td></tr>
<tr><th id="252">252</th><td>    <a class="ref fn" href="../crypto/internal.h.html#_ZL14OPENSSL_memcpyPvPKvm" title='OPENSSL_memcpy' data-ref="_ZL14OPENSSL_memcpyPvPKvm" data-ref-filename="_ZL14OPENSSL_memcpyPvPKvm">OPENSSL_memcpy</a>(<a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::session_id" title='ssl_session_st::session_id' data-ref="ssl_session_st::session_id" data-ref-filename="ssl_session_st..session_id">session_id</a>, <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::session_id" title='ssl_session_st::session_id' data-ref="ssl_session_st::session_id" data-ref-filename="ssl_session_st..session_id">session_id</a>,</td></tr>
<tr><th id="253">253</th><td>                   <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::session_id_length" title='ssl_session_st::session_id_length' data-ref="ssl_session_st::session_id_length" data-ref-filename="ssl_session_st..session_id_length">session_id_length</a>);</td></tr>
<tr><th id="254">254</th><td></td></tr>
<tr><th id="255">255</th><td>    <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::group_id" title='ssl_session_st::group_id' data-ref="ssl_session_st::group_id" data-ref-filename="ssl_session_st..group_id">group_id</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::group_id" title='ssl_session_st::group_id' data-ref="ssl_session_st::group_id" data-ref-filename="ssl_session_st..group_id">group_id</a>;</td></tr>
<tr><th id="256">256</th><td></td></tr>
<tr><th id="257">257</th><td>    <a class="ref fn" href="../crypto/internal.h.html#_ZL14OPENSSL_memcpyPvPKvm" title='OPENSSL_memcpy' data-ref="_ZL14OPENSSL_memcpyPvPKvm" data-ref-filename="_ZL14OPENSSL_memcpyPvPKvm">OPENSSL_memcpy</a>(<a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::original_handshake_hash" title='ssl_session_st::original_handshake_hash' data-ref="ssl_session_st::original_handshake_hash" data-ref-filename="ssl_session_st..original_handshake_hash">original_handshake_hash</a>,</td></tr>
<tr><th id="258">258</th><td>                   <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::original_handshake_hash" title='ssl_session_st::original_handshake_hash' data-ref="ssl_session_st::original_handshake_hash" data-ref-filename="ssl_session_st..original_handshake_hash">original_handshake_hash</a>,</td></tr>
<tr><th id="259">259</th><td>                   <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::original_handshake_hash_len" title='ssl_session_st::original_handshake_hash_len' data-ref="ssl_session_st::original_handshake_hash_len" data-ref-filename="ssl_session_st..original_handshake_hash_len">original_handshake_hash_len</a>);</td></tr>
<tr><th id="260">260</th><td>    <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::original_handshake_hash_len" title='ssl_session_st::original_handshake_hash_len' data-ref="ssl_session_st::original_handshake_hash_len" data-ref-filename="ssl_session_st..original_handshake_hash_len">original_handshake_hash_len</a> =</td></tr>
<tr><th id="261">261</th><td>        <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::original_handshake_hash_len" title='ssl_session_st::original_handshake_hash_len' data-ref="ssl_session_st::original_handshake_hash_len" data-ref-filename="ssl_session_st..original_handshake_hash_len">original_handshake_hash_len</a>;</td></tr>
<tr><th id="262">262</th><td>    <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::ticket_lifetime_hint" title='ssl_session_st::ticket_lifetime_hint' data-ref="ssl_session_st::ticket_lifetime_hint" data-ref-filename="ssl_session_st..ticket_lifetime_hint">ticket_lifetime_hint</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ticket_lifetime_hint" title='ssl_session_st::ticket_lifetime_hint' data-ref="ssl_session_st::ticket_lifetime_hint" data-ref-filename="ssl_session_st..ticket_lifetime_hint">ticket_lifetime_hint</a>;</td></tr>
<tr><th id="263">263</th><td>    <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::ticket_age_add" title='ssl_session_st::ticket_age_add' data-ref="ssl_session_st::ticket_age_add" data-ref-filename="ssl_session_st..ticket_age_add">ticket_age_add</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ticket_age_add" title='ssl_session_st::ticket_age_add' data-ref="ssl_session_st::ticket_age_add" data-ref-filename="ssl_session_st..ticket_age_add">ticket_age_add</a>;</td></tr>
<tr><th id="264">264</th><td>    <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::ticket_max_early_data" title='ssl_session_st::ticket_max_early_data' data-ref="ssl_session_st::ticket_max_early_data" data-ref-filename="ssl_session_st..ticket_max_early_data">ticket_max_early_data</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ticket_max_early_data" title='ssl_session_st::ticket_max_early_data' data-ref="ssl_session_st::ticket_max_early_data" data-ref-filename="ssl_session_st..ticket_max_early_data">ticket_max_early_data</a>;</td></tr>
<tr><th id="265">265</th><td>    <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::extended_master_secret" title='ssl_session_st::extended_master_secret' data-ref="ssl_session_st::extended_master_secret" data-ref-filename="ssl_session_st..extended_master_secret">extended_master_secret</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::extended_master_secret" title='ssl_session_st::extended_master_secret' data-ref="ssl_session_st::extended_master_secret" data-ref-filename="ssl_session_st..extended_master_secret">extended_master_secret</a>;</td></tr>
<tr><th id="266">266</th><td>    <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::has_application_settings" title='ssl_session_st::has_application_settings' data-ref="ssl_session_st::has_application_settings" data-ref-filename="ssl_session_st..has_application_settings">has_application_settings</a> = <a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::has_application_settings" title='ssl_session_st::has_application_settings' data-ref="ssl_session_st::has_application_settings" data-ref-filename="ssl_session_st..has_application_settings">has_application_settings</a>;</td></tr>
<tr><th id="267">267</th><td></td></tr>
<tr><th id="268">268</th><td>    <b>if</b> (!<a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::early_alpn" title='ssl_session_st::early_alpn' data-ref="ssl_session_st::early_alpn" data-ref-filename="ssl_session_st..early_alpn">early_alpn</a>.<a class="ref fn" href="internal.h.html#_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE" title='bssl::Array::CopyFrom' data-ref="_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE" data-ref-filename="_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE">CopyFrom</a>(<a class="ref fn fake" href="../include/openssl/span.h.html#_ZN4bssl4SpanC1ERKTL0__" title='bssl::Span::Span&lt;T&gt;' data-ref="_ZN4bssl4SpanC1ERKTL0__" data-ref-filename="_ZN4bssl4SpanC1ERKTL0__"></a><a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::early_alpn" title='ssl_session_st::early_alpn' data-ref="ssl_session_st::early_alpn" data-ref-filename="ssl_session_st..early_alpn">early_alpn</a>) ||</td></tr>
<tr><th id="269">269</th><td>        !<a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::quic_early_data_context" title='ssl_session_st::quic_early_data_context' data-ref="ssl_session_st::quic_early_data_context" data-ref-filename="ssl_session_st..quic_early_data_context">quic_early_data_context</a>.<a class="ref fn" href="internal.h.html#_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE" title='bssl::Array::CopyFrom' data-ref="_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE" data-ref-filename="_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE">CopyFrom</a>(</td></tr>
<tr><th id="270">270</th><td>            <a class="ref fn fake" href="../include/openssl/span.h.html#_ZN4bssl4SpanC1ERKTL0__" title='bssl::Span::Span&lt;T&gt;' data-ref="_ZN4bssl4SpanC1ERKTL0__" data-ref-filename="_ZN4bssl4SpanC1ERKTL0__"></a><a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::quic_early_data_context" title='ssl_session_st::quic_early_data_context' data-ref="ssl_session_st::quic_early_data_context" data-ref-filename="ssl_session_st..quic_early_data_context">quic_early_data_context</a>) ||</td></tr>
<tr><th id="271">271</th><td>        !<a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::local_application_settings" title='ssl_session_st::local_application_settings' data-ref="ssl_session_st::local_application_settings" data-ref-filename="ssl_session_st..local_application_settings">local_application_settings</a>.<a class="ref fn" href="internal.h.html#_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE" title='bssl::Array::CopyFrom' data-ref="_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE" data-ref-filename="_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE">CopyFrom</a>(</td></tr>
<tr><th id="272">272</th><td>            <a class="ref fn fake" href="../include/openssl/span.h.html#_ZN4bssl4SpanC1ERKTL0__" title='bssl::Span::Span&lt;T&gt;' data-ref="_ZN4bssl4SpanC1ERKTL0__" data-ref-filename="_ZN4bssl4SpanC1ERKTL0__"></a><a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::local_application_settings" title='ssl_session_st::local_application_settings' data-ref="ssl_session_st::local_application_settings" data-ref-filename="ssl_session_st..local_application_settings">local_application_settings</a>) ||</td></tr>
<tr><th id="273">273</th><td>        !<a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::peer_application_settings" title='ssl_session_st::peer_application_settings' data-ref="ssl_session_st::peer_application_settings" data-ref-filename="ssl_session_st..peer_application_settings">peer_application_settings</a>.<a class="ref fn" href="internal.h.html#_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE" title='bssl::Array::CopyFrom' data-ref="_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE" data-ref-filename="_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE">CopyFrom</a>(</td></tr>
<tr><th id="274">274</th><td>            <a class="ref fn fake" href="../include/openssl/span.h.html#_ZN4bssl4SpanC1ERKTL0__" title='bssl::Span::Span&lt;T&gt;' data-ref="_ZN4bssl4SpanC1ERKTL0__" data-ref-filename="_ZN4bssl4SpanC1ERKTL0__"></a><a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::peer_application_settings" title='ssl_session_st::peer_application_settings' data-ref="ssl_session_st::peer_application_settings" data-ref-filename="ssl_session_st..peer_application_settings">peer_application_settings</a>)) {</td></tr>
<tr><th id="275">275</th><td>      <b>return</b> <span class='ref fn fake' title='std::__1::unique_ptr::unique_ptr&lt;_Tp, _Dp&gt;' data-ref="_ZNSt3__110unique_ptrC1EDn" data-ref-filename="_ZNSt3__110unique_ptrC1EDn"></span><b>nullptr</b>;</td></tr>
<tr><th id="276">276</th><td>    }</td></tr>
<tr><th id="277">277</th><td>  }</td></tr>
<tr><th id="278">278</th><td></td></tr>
<tr><th id="279">279</th><td>  <i>// Copy the ticket.</i></td></tr>
<tr><th id="280">280</th><td>  <b>if</b> (<a class="local col3 ref" href="#13dup_flags" title='dup_flags' data-ref="13dup_flags" data-ref-filename="13dup_flags">dup_flags</a> &amp; <a class="macro" href="internal.h.html#3029" title="0x1" data-ref="_M/SSL_SESSION_INCLUDE_TICKET">SSL_SESSION_INCLUDE_TICKET</a> &amp;&amp;</td></tr>
<tr><th id="281">281</th><td>      !<a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::ticket" title='ssl_session_st::ticket' data-ref="ssl_session_st::ticket" data-ref-filename="ssl_session_st..ticket">ticket</a>.<a class="ref fn" href="internal.h.html#_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE" title='bssl::Array::CopyFrom' data-ref="_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE" data-ref-filename="_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE">CopyFrom</a>(<a class="ref fn fake" href="../include/openssl/span.h.html#_ZN4bssl4SpanC1ERKTL0__" title='bssl::Span::Span&lt;T&gt;' data-ref="_ZN4bssl4SpanC1ERKTL0__" data-ref-filename="_ZN4bssl4SpanC1ERKTL0__"></a><a class="local col2 ref" href="#12session" title='session' data-ref="12session" data-ref-filename="12session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ticket" title='ssl_session_st::ticket' data-ref="ssl_session_st::ticket" data-ref-filename="ssl_session_st..ticket">ticket</a>)) {</td></tr>
<tr><th id="282">282</th><td>    <b>return</b> <span class='ref fn fake' title='std::__1::unique_ptr::unique_ptr&lt;_Tp, _Dp&gt;' data-ref="_ZNSt3__110unique_ptrC1EDn" data-ref-filename="_ZNSt3__110unique_ptrC1EDn"></span><b>nullptr</b>;</td></tr>
<tr><th id="283">283</th><td>  }</td></tr>
<tr><th id="284">284</th><td></td></tr>
<tr><th id="285">285</th><td>  <i>// The new_session does not get a copy of the ex_data.</i></td></tr>
<tr><th id="286">286</th><td></td></tr>
<tr><th id="287">287</th><td>  <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::not_resumable" title='ssl_session_st::not_resumable' data-ref="ssl_session_st::not_resumable" data-ref-filename="ssl_session_st..not_resumable">not_resumable</a> = <b>true</b>;</td></tr>
<tr><th id="288">288</th><td>  <b>return</b> <a class="local col4 ref" href="#14new_session" title='new_session' data-ref="14new_session" data-ref-filename="14new_session">new_session</a>;</td></tr>
<tr><th id="289">289</th><td>}</td></tr>
<tr><th id="290">290</th><td></td></tr>
<tr><th id="291">291</th><td><em>void</em> <dfn class="decl def fn" id="_ZN4bssl23ssl_session_rebase_timeEP6ssl_stP14ssl_session_st" title='bssl::ssl_session_rebase_time' data-ref="_ZN4bssl23ssl_session_rebase_timeEP6ssl_stP14ssl_session_st" data-ref-filename="_ZN4bssl23ssl_session_rebase_timeEP6ssl_stP14ssl_session_st">ssl_session_rebase_time</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<dfn class="local col7 decl" id="17ssl" title='ssl' data-type='SSL *' data-ref="17ssl" data-ref-filename="17ssl">ssl</dfn>, <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col8 decl" id="18session" title='session' data-type='SSL_SESSION *' data-ref="18session" data-ref-filename="18session">session</dfn>) {</td></tr>
<tr><th id="292">292</th><td>  <b>struct</b> <a class="type" href="internal.h.html#bssl::OPENSSL_timeval" title='bssl::OPENSSL_timeval' data-ref="bssl::OPENSSL_timeval" data-ref-filename="bssl..OPENSSL_timeval">OPENSSL_timeval</a> <a class="ref fn fake" href="internal.h.html#2735" title='bssl::OPENSSL_timeval::OPENSSL_timeval' data-ref="_ZN4bssl15OPENSSL_timevalC1Ev" data-ref-filename="_ZN4bssl15OPENSSL_timevalC1Ev"></a><dfn class="local col9 decl" id="19now" title='now' data-type='struct OPENSSL_timeval' data-ref="19now" data-ref-filename="19now">now</dfn>;</td></tr>
<tr><th id="293">293</th><td>  <a class="ref fn" href="internal.h.html#_ZN4bssl20ssl_get_current_timeEPK6ssl_stPNS_15OPENSSL_timevalE" title='bssl::ssl_get_current_time' data-ref="_ZN4bssl20ssl_get_current_timeEPK6ssl_stPNS_15OPENSSL_timevalE" data-ref-filename="_ZN4bssl20ssl_get_current_timeEPK6ssl_stPNS_15OPENSSL_timevalE">ssl_get_current_time</a>(<a class="local col7 ref" href="#17ssl" title='ssl' data-ref="17ssl" data-ref-filename="17ssl">ssl</a>, &amp;<a class="local col9 ref" href="#19now" title='now' data-ref="19now" data-ref-filename="19now">now</a>);</td></tr>
<tr><th id="294">294</th><td></td></tr>
<tr><th id="295">295</th><td>  <i>// To avoid overflows and underflows, if we've gone back in time, update the</i></td></tr>
<tr><th id="296">296</th><td><i>  // time, but mark the session expired.</i></td></tr>
<tr><th id="297">297</th><td>  <b>if</b> (<a class="local col8 ref" href="#18session" title='session' data-ref="18session" data-ref-filename="18session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::time" title='ssl_session_st::time' data-ref="ssl_session_st::time" data-ref-filename="ssl_session_st..time">time</a> &gt; <a class="local col9 ref" href="#19now" title='now' data-ref="19now" data-ref-filename="19now">now</a>.<a class="ref field" href="internal.h.html#bssl::OPENSSL_timeval::tv_sec" title='bssl::OPENSSL_timeval::tv_sec' data-ref="bssl::OPENSSL_timeval::tv_sec" data-ref-filename="bssl..OPENSSL_timeval..tv_sec">tv_sec</a>) {</td></tr>
<tr><th id="298">298</th><td>    <a class="local col8 ref" href="#18session" title='session' data-ref="18session" data-ref-filename="18session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::time" title='ssl_session_st::time' data-ref="ssl_session_st::time" data-ref-filename="ssl_session_st..time">time</a> = <a class="local col9 ref" href="#19now" title='now' data-ref="19now" data-ref-filename="19now">now</a>.<a class="ref field" href="internal.h.html#bssl::OPENSSL_timeval::tv_sec" title='bssl::OPENSSL_timeval::tv_sec' data-ref="bssl::OPENSSL_timeval::tv_sec" data-ref-filename="bssl..OPENSSL_timeval..tv_sec">tv_sec</a>;</td></tr>
<tr><th id="299">299</th><td>    <a class="local col8 ref" href="#18session" title='session' data-ref="18session" data-ref-filename="18session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a> = <var>0</var>;</td></tr>
<tr><th id="300">300</th><td>    <a class="local col8 ref" href="#18session" title='session' data-ref="18session" data-ref-filename="18session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::auth_timeout" title='ssl_session_st::auth_timeout' data-ref="ssl_session_st::auth_timeout" data-ref-filename="ssl_session_st..auth_timeout">auth_timeout</a> = <var>0</var>;</td></tr>
<tr><th id="301">301</th><td>    <b>return</b>;</td></tr>
<tr><th id="302">302</th><td>  }</td></tr>
<tr><th id="303">303</th><td></td></tr>
<tr><th id="304">304</th><td>  <i>// Adjust the session time and timeouts. If the session has already expired,</i></td></tr>
<tr><th id="305">305</th><td><i>  // clamp the timeouts at zero.</i></td></tr>
<tr><th id="306">306</th><td>  <span class='typedef' title='uint64_t' data-type='unsigned long long' data-ref="uint64_t" data-ref-filename="uint64_t">uint64_t</span> <dfn class="local col0 decl" id="20delta" title='delta' data-type='uint64_t' data-ref="20delta" data-ref-filename="20delta">delta</dfn> = <a class="local col9 ref" href="#19now" title='now' data-ref="19now" data-ref-filename="19now">now</a>.<a class="ref field" href="internal.h.html#bssl::OPENSSL_timeval::tv_sec" title='bssl::OPENSSL_timeval::tv_sec' data-ref="bssl::OPENSSL_timeval::tv_sec" data-ref-filename="bssl..OPENSSL_timeval..tv_sec">tv_sec</a> - <a class="local col8 ref" href="#18session" title='session' data-ref="18session" data-ref-filename="18session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::time" title='ssl_session_st::time' data-ref="ssl_session_st::time" data-ref-filename="ssl_session_st..time">time</a>;</td></tr>
<tr><th id="307">307</th><td>  <a class="local col8 ref" href="#18session" title='session' data-ref="18session" data-ref-filename="18session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::time" title='ssl_session_st::time' data-ref="ssl_session_st::time" data-ref-filename="ssl_session_st..time">time</a> = <a class="local col9 ref" href="#19now" title='now' data-ref="19now" data-ref-filename="19now">now</a>.<a class="ref field" href="internal.h.html#bssl::OPENSSL_timeval::tv_sec" title='bssl::OPENSSL_timeval::tv_sec' data-ref="bssl::OPENSSL_timeval::tv_sec" data-ref-filename="bssl..OPENSSL_timeval..tv_sec">tv_sec</a>;</td></tr>
<tr><th id="308">308</th><td>  <b>if</b> (<a class="local col8 ref" href="#18session" title='session' data-ref="18session" data-ref-filename="18session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a> &lt; <a class="local col0 ref" href="#20delta" title='delta' data-ref="20delta" data-ref-filename="20delta">delta</a>) {</td></tr>
<tr><th id="309">309</th><td>    <a class="local col8 ref" href="#18session" title='session' data-ref="18session" data-ref-filename="18session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a> = <var>0</var>;</td></tr>
<tr><th id="310">310</th><td>  } <b>else</b> {</td></tr>
<tr><th id="311">311</th><td>    <a class="local col8 ref" href="#18session" title='session' data-ref="18session" data-ref-filename="18session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a> -= <a class="local col0 ref" href="#20delta" title='delta' data-ref="20delta" data-ref-filename="20delta">delta</a>;</td></tr>
<tr><th id="312">312</th><td>  }</td></tr>
<tr><th id="313">313</th><td>  <b>if</b> (<a class="local col8 ref" href="#18session" title='session' data-ref="18session" data-ref-filename="18session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::auth_timeout" title='ssl_session_st::auth_timeout' data-ref="ssl_session_st::auth_timeout" data-ref-filename="ssl_session_st..auth_timeout">auth_timeout</a> &lt; <a class="local col0 ref" href="#20delta" title='delta' data-ref="20delta" data-ref-filename="20delta">delta</a>) {</td></tr>
<tr><th id="314">314</th><td>    <a class="local col8 ref" href="#18session" title='session' data-ref="18session" data-ref-filename="18session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::auth_timeout" title='ssl_session_st::auth_timeout' data-ref="ssl_session_st::auth_timeout" data-ref-filename="ssl_session_st..auth_timeout">auth_timeout</a> = <var>0</var>;</td></tr>
<tr><th id="315">315</th><td>  } <b>else</b> {</td></tr>
<tr><th id="316">316</th><td>    <a class="local col8 ref" href="#18session" title='session' data-ref="18session" data-ref-filename="18session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::auth_timeout" title='ssl_session_st::auth_timeout' data-ref="ssl_session_st::auth_timeout" data-ref-filename="ssl_session_st..auth_timeout">auth_timeout</a> -= <a class="local col0 ref" href="#20delta" title='delta' data-ref="20delta" data-ref-filename="20delta">delta</a>;</td></tr>
<tr><th id="317">317</th><td>  }</td></tr>
<tr><th id="318">318</th><td>}</td></tr>
<tr><th id="319">319</th><td></td></tr>
<tr><th id="320">320</th><td><em>void</em> <dfn class="decl def fn" id="_ZN4bssl25ssl_session_renew_timeoutEP6ssl_stP14ssl_session_stj" title='bssl::ssl_session_renew_timeout' data-ref="_ZN4bssl25ssl_session_renew_timeoutEP6ssl_stP14ssl_session_stj" data-ref-filename="_ZN4bssl25ssl_session_renew_timeoutEP6ssl_stP14ssl_session_stj">ssl_session_renew_timeout</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<dfn class="local col1 decl" id="21ssl" title='ssl' data-type='SSL *' data-ref="21ssl" data-ref-filename="21ssl">ssl</dfn>, <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col2 decl" id="22session" title='session' data-type='SSL_SESSION *' data-ref="22session" data-ref-filename="22session">session</dfn>,</td></tr>
<tr><th id="321">321</th><td>                               <span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span> <dfn class="local col3 decl" id="23timeout" title='timeout' data-type='uint32_t' data-ref="23timeout" data-ref-filename="23timeout">timeout</dfn>) {</td></tr>
<tr><th id="322">322</th><td>  <i>// Rebase the timestamp relative to the current time so |timeout| is measured</i></td></tr>
<tr><th id="323">323</th><td><i>  // correctly.</i></td></tr>
<tr><th id="324">324</th><td>  <a class="ref fn" href="#_ZN4bssl23ssl_session_rebase_timeEP6ssl_stP14ssl_session_st" title='bssl::ssl_session_rebase_time' data-ref="_ZN4bssl23ssl_session_rebase_timeEP6ssl_stP14ssl_session_st" data-ref-filename="_ZN4bssl23ssl_session_rebase_timeEP6ssl_stP14ssl_session_st">ssl_session_rebase_time</a>(<a class="local col1 ref" href="#21ssl" title='ssl' data-ref="21ssl" data-ref-filename="21ssl">ssl</a>, <a class="local col2 ref" href="#22session" title='session' data-ref="22session" data-ref-filename="22session">session</a>);</td></tr>
<tr><th id="325">325</th><td></td></tr>
<tr><th id="326">326</th><td>  <b>if</b> (<a class="local col2 ref" href="#22session" title='session' data-ref="22session" data-ref-filename="22session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a> &gt; <a class="local col3 ref" href="#23timeout" title='timeout' data-ref="23timeout" data-ref-filename="23timeout">timeout</a>) {</td></tr>
<tr><th id="327">327</th><td>    <b>return</b>;</td></tr>
<tr><th id="328">328</th><td>  }</td></tr>
<tr><th id="329">329</th><td></td></tr>
<tr><th id="330">330</th><td>  <a class="local col2 ref" href="#22session" title='session' data-ref="22session" data-ref-filename="22session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a> = <a class="local col3 ref" href="#23timeout" title='timeout' data-ref="23timeout" data-ref-filename="23timeout">timeout</a>;</td></tr>
<tr><th id="331">331</th><td>  <b>if</b> (<a class="local col2 ref" href="#22session" title='session' data-ref="22session" data-ref-filename="22session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a> &gt; <a class="local col2 ref" href="#22session" title='session' data-ref="22session" data-ref-filename="22session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::auth_timeout" title='ssl_session_st::auth_timeout' data-ref="ssl_session_st::auth_timeout" data-ref-filename="ssl_session_st..auth_timeout">auth_timeout</a>) {</td></tr>
<tr><th id="332">332</th><td>    <a class="local col2 ref" href="#22session" title='session' data-ref="22session" data-ref-filename="22session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a> = <a class="local col2 ref" href="#22session" title='session' data-ref="22session" data-ref-filename="22session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::auth_timeout" title='ssl_session_st::auth_timeout' data-ref="ssl_session_st::auth_timeout" data-ref-filename="ssl_session_st..auth_timeout">auth_timeout</a>;</td></tr>
<tr><th id="333">333</th><td>  }</td></tr>
<tr><th id="334">334</th><td>}</td></tr>
<tr><th id="335">335</th><td></td></tr>
<tr><th id="336">336</th><td><span class='typedef' title='uint16_t' data-type='unsigned short' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</span> <dfn class="decl def fn" id="_ZN4bssl28ssl_session_protocol_versionEPK14ssl_session_st" title='bssl::ssl_session_protocol_version' data-ref="_ZN4bssl28ssl_session_protocol_versionEPK14ssl_session_st" data-ref-filename="_ZN4bssl28ssl_session_protocol_versionEPK14ssl_session_st">ssl_session_protocol_version</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col4 decl" id="24session" title='session' data-type='const SSL_SESSION *' data-ref="24session" data-ref-filename="24session">session</dfn>) {</td></tr>
<tr><th id="337">337</th><td>  <span class='typedef' title='uint16_t' data-type='unsigned short' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</span> <dfn class="local col5 decl" id="25ret" title='ret' data-type='uint16_t' data-ref="25ret" data-ref-filename="25ret">ret</dfn>;</td></tr>
<tr><th id="338">338</th><td>  <b>if</b> (!<a class="ref fn" href="internal.h.html#_ZN4bssl30ssl_protocol_version_from_wireEPtt" title='bssl::ssl_protocol_version_from_wire' data-ref="_ZN4bssl30ssl_protocol_version_from_wireEPtt" data-ref-filename="_ZN4bssl30ssl_protocol_version_from_wireEPtt">ssl_protocol_version_from_wire</a>(&amp;<a class="local col5 ref" href="#25ret" title='ret' data-ref="25ret" data-ref-filename="25ret">ret</a>, <a class="local col4 ref" href="#24session" title='session' data-ref="24session" data-ref-filename="24session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ssl_version" title='ssl_session_st::ssl_version' data-ref="ssl_session_st::ssl_version" data-ref-filename="ssl_session_st..ssl_version">ssl_version</a>)) {</td></tr>
<tr><th id="339">339</th><td>    <i>// An |SSL_SESSION| will never have an invalid version. This is enforced by</i></td></tr>
<tr><th id="340">340</th><td><i>    // the parser.</i></td></tr>
<tr><th id="341">341</th><td>    <span class="macro" title="(__builtin_expect(!(0), 0) ? __assert_rtn(__func__, &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/third_party/boringssl/src/ssl/ssl_session.cc&quot;, 341, &quot;0&quot;) : (void)0)" data-ref="_M/assert">assert</span>(<var>0</var>);</td></tr>
<tr><th id="342">342</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="343">343</th><td>  }</td></tr>
<tr><th id="344">344</th><td></td></tr>
<tr><th id="345">345</th><td>  <b>return</b> <a class="local col5 ref" href="#25ret" title='ret' data-ref="25ret" data-ref-filename="25ret">ret</a>;</td></tr>
<tr><th id="346">346</th><td>}</td></tr>
<tr><th id="347">347</th><td></td></tr>
<tr><th id="348">348</th><td><em>const</em> <a class="typedef" href="../include/openssl/base.h.html#EVP_MD" title='EVP_MD' data-type='struct env_md_st' data-ref="EVP_MD" data-ref-filename="EVP_MD">EVP_MD</a> *<dfn class="decl def fn" id="_ZN4bssl22ssl_session_get_digestEPK14ssl_session_st" title='bssl::ssl_session_get_digest' data-ref="_ZN4bssl22ssl_session_get_digestEPK14ssl_session_st" data-ref-filename="_ZN4bssl22ssl_session_get_digestEPK14ssl_session_st">ssl_session_get_digest</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col6 decl" id="26session" title='session' data-type='const SSL_SESSION *' data-ref="26session" data-ref-filename="26session">session</dfn>) {</td></tr>
<tr><th id="349">349</th><td>  <b>return</b> <a class="ref fn" href="internal.h.html#_ZN4bssl24ssl_get_handshake_digestEtPK13ssl_cipher_st" title='bssl::ssl_get_handshake_digest' data-ref="_ZN4bssl24ssl_get_handshake_digestEtPK13ssl_cipher_st" data-ref-filename="_ZN4bssl24ssl_get_handshake_digestEtPK13ssl_cipher_st">ssl_get_handshake_digest</a>(<a class="ref fn" href="#_ZN4bssl28ssl_session_protocol_versionEPK14ssl_session_st" title='bssl::ssl_session_protocol_version' data-ref="_ZN4bssl28ssl_session_protocol_versionEPK14ssl_session_st" data-ref-filename="_ZN4bssl28ssl_session_protocol_versionEPK14ssl_session_st">ssl_session_protocol_version</a>(<a class="local col6 ref" href="#26session" title='session' data-ref="26session" data-ref-filename="26session">session</a>),</td></tr>
<tr><th id="350">350</th><td>                                  <a class="local col6 ref" href="#26session" title='session' data-ref="26session" data-ref-filename="26session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::cipher" title='ssl_session_st::cipher' data-ref="ssl_session_st::cipher" data-ref-filename="ssl_session_st..cipher">cipher</a>);</td></tr>
<tr><th id="351">351</th><td>}</td></tr>
<tr><th id="352">352</th><td></td></tr>
<tr><th id="353">353</th><td><em>bool</em> <dfn class="decl def fn" id="_ZN4bssl19ssl_get_new_sessionEPNS_13SSL_HANDSHAKEE" title='bssl::ssl_get_new_session' data-ref="_ZN4bssl19ssl_get_new_sessionEPNS_13SSL_HANDSHAKEE" data-ref-filename="_ZN4bssl19ssl_get_new_sessionEPNS_13SSL_HANDSHAKEE">ssl_get_new_session</dfn>(<a class="type" href="internal.h.html#bssl::SSL_HANDSHAKE" title='bssl::SSL_HANDSHAKE' data-ref="bssl::SSL_HANDSHAKE" data-ref-filename="bssl..SSL_HANDSHAKE">SSL_HANDSHAKE</a> *<dfn class="local col7 decl" id="27hs" title='hs' data-type='bssl::SSL_HANDSHAKE *' data-ref="27hs" data-ref-filename="27hs">hs</dfn>) {</td></tr>
<tr><th id="354">354</th><td>  <a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<em>const</em> <dfn class="local col8 decl" id="28ssl" title='ssl' data-type='SSL *const' data-ref="28ssl" data-ref-filename="28ssl">ssl</dfn> = <a class="local col7 ref" href="#27hs" title='hs' data-ref="27hs" data-ref-filename="27hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::ssl" title='bssl::SSL_HANDSHAKE::ssl' data-ref="bssl::SSL_HANDSHAKE::ssl" data-ref-filename="bssl..SSL_HANDSHAKE..ssl">ssl</a>;</td></tr>
<tr><th id="355">355</th><td>  <b>if</b> (<a class="local col8 ref" href="#28ssl" title='ssl' data-ref="28ssl" data-ref-filename="28ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::mode" title='ssl_st::mode' data-ref="ssl_st::mode" data-ref-filename="ssl_st..mode">mode</a> &amp; <a class="macro" href="../include/openssl/ssl.h.html#779" title="0x00000200L" data-ref="_M/SSL_MODE_NO_SESSION_CREATION">SSL_MODE_NO_SESSION_CREATION</a>) {</td></tr>
<tr><th id="356">356</th><td>    <a class="macro" href="../include/openssl/err.h.html#423" title="ERR_put_error(ERR_LIB_SSL, 0, 209, &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/third_party/boringssl/src/ssl/ssl_session.cc&quot;, 356)" data-ref="_M/OPENSSL_PUT_ERROR">OPENSSL_PUT_ERROR</a>(SSL, <a class="macro" href="../include/openssl/ssl.h.html#5379" title="209" data-ref="_M/SSL_R_SESSION_MAY_NOT_BE_CREATED">SSL_R_SESSION_MAY_NOT_BE_CREATED</a>);</td></tr>
<tr><th id="357">357</th><td>    <b>return</b> <b>false</b>;</td></tr>
<tr><th id="358">358</th><td>  }</td></tr>
<tr><th id="359">359</th><td></td></tr>
<tr><th id="360">360</th><td>  <a class="type" href="../include/openssl/base.h.html#bssl::UniquePtr" title='bssl::UniquePtr' data-ref="bssl::UniquePtr" data-ref-filename="bssl..UniquePtr">UniquePtr</a>&lt;<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a>&gt; <dfn class="local col9 decl" id="29session" title='session' data-type='UniquePtr&lt;SSL_SESSION&gt;' data-ref="29session" data-ref-filename="29session">session</dfn> = <a class="ref fn" href="#_ZN4bssl15ssl_session_newEPKNS_15SSL_X509_METHODE" title='bssl::ssl_session_new' data-ref="_ZN4bssl15ssl_session_newEPKNS_15SSL_X509_METHODE" data-ref-filename="_ZN4bssl15ssl_session_newEPKNS_15SSL_X509_METHODE">ssl_session_new</a>(<a class="local col8 ref" href="#28ssl" title='ssl' data-ref="28ssl" data-ref-filename="28ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::ctx" title='ssl_st::ctx' data-ref="ssl_st::ctx" data-ref-filename="ssl_st..ctx">ctx</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_ctx_st::x509_method" title='ssl_ctx_st::x509_method' data-ref="ssl_ctx_st::x509_method" data-ref-filename="ssl_ctx_st..x509_method">x509_method</a>);</td></tr>
<tr><th id="361">361</th><td>  <b>if</b> (<a class="local col9 ref" href="#29session" title='session' data-ref="29session" data-ref-filename="29session">session</a> <span class='ref fn' title='std::__1::operator==' data-ref="_ZNSt3__1eqERKNS_10unique_ptrIT_T0_EEDn" data-ref-filename="_ZNSt3__1eqERKNS_10unique_ptrIT_T0_EEDn">==</span> <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="362">362</th><td>    <b>return</b> <b>false</b>;</td></tr>
<tr><th id="363">363</th><td>  }</td></tr>
<tr><th id="364">364</th><td></td></tr>
<tr><th id="365">365</th><td>  <a class="local col9 ref" href="#29session" title='session' data-ref="29session" data-ref-filename="29session">session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::is_server" title='ssl_session_st::is_server' data-ref="ssl_session_st::is_server" data-ref-filename="ssl_session_st..is_server">is_server</a> = <a class="local col8 ref" href="#28ssl" title='ssl' data-ref="28ssl" data-ref-filename="28ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::server" title='ssl_st::server' data-ref="ssl_st::server" data-ref-filename="ssl_st..server">server</a>;</td></tr>
<tr><th id="366">366</th><td>  <a class="local col9 ref" href="#29session" title='session' data-ref="29session" data-ref-filename="29session">session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::ssl_version" title='ssl_session_st::ssl_version' data-ref="ssl_session_st::ssl_version" data-ref-filename="ssl_session_st..ssl_version">ssl_version</a> = <a class="local col8 ref" href="#28ssl" title='ssl' data-ref="28ssl" data-ref-filename="28ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::version" title='ssl_st::version' data-ref="ssl_st::version" data-ref-filename="ssl_st..version">version</a>;</td></tr>
<tr><th id="367">367</th><td>  <a class="local col9 ref" href="#29session" title='session' data-ref="29session" data-ref-filename="29session">session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::is_quic" title='ssl_session_st::is_quic' data-ref="ssl_session_st::is_quic" data-ref-filename="ssl_session_st..is_quic">is_quic</a> = <a class="local col8 ref" href="#28ssl" title='ssl' data-ref="28ssl" data-ref-filename="28ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::quic_method" title='ssl_st::quic_method' data-ref="ssl_st::quic_method" data-ref-filename="ssl_st..quic_method">quic_method</a> != <b>nullptr</b>;</td></tr>
<tr><th id="368">368</th><td></td></tr>
<tr><th id="369">369</th><td>  <i>// Fill in the time from the |SSL_CTX|'s clock.</i></td></tr>
<tr><th id="370">370</th><td>  <b>struct</b> <a class="type" href="internal.h.html#bssl::OPENSSL_timeval" title='bssl::OPENSSL_timeval' data-ref="bssl::OPENSSL_timeval" data-ref-filename="bssl..OPENSSL_timeval">OPENSSL_timeval</a> <a class="ref fn fake" href="internal.h.html#2735" title='bssl::OPENSSL_timeval::OPENSSL_timeval' data-ref="_ZN4bssl15OPENSSL_timevalC1Ev" data-ref-filename="_ZN4bssl15OPENSSL_timevalC1Ev"></a><dfn class="local col0 decl" id="30now" title='now' data-type='struct OPENSSL_timeval' data-ref="30now" data-ref-filename="30now">now</dfn>;</td></tr>
<tr><th id="371">371</th><td>  <a class="ref fn" href="internal.h.html#_ZN4bssl20ssl_get_current_timeEPK6ssl_stPNS_15OPENSSL_timevalE" title='bssl::ssl_get_current_time' data-ref="_ZN4bssl20ssl_get_current_timeEPK6ssl_stPNS_15OPENSSL_timevalE" data-ref-filename="_ZN4bssl20ssl_get_current_timeEPK6ssl_stPNS_15OPENSSL_timevalE">ssl_get_current_time</a>(<a class="local col8 ref" href="#28ssl" title='ssl' data-ref="28ssl" data-ref-filename="28ssl">ssl</a>, &amp;<a class="local col0 ref" href="#30now" title='now' data-ref="30now" data-ref-filename="30now">now</a>);</td></tr>
<tr><th id="372">372</th><td>  <a class="local col9 ref" href="#29session" title='session' data-ref="29session" data-ref-filename="29session">session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::time" title='ssl_session_st::time' data-ref="ssl_session_st::time" data-ref-filename="ssl_session_st..time">time</a> = <a class="local col0 ref" href="#30now" title='now' data-ref="30now" data-ref-filename="30now">now</a>.<a class="ref field" href="internal.h.html#bssl::OPENSSL_timeval::tv_sec" title='bssl::OPENSSL_timeval::tv_sec' data-ref="bssl::OPENSSL_timeval::tv_sec" data-ref-filename="bssl..OPENSSL_timeval..tv_sec">tv_sec</a>;</td></tr>
<tr><th id="373">373</th><td></td></tr>
<tr><th id="374">374</th><td>  <span class='typedef' title='uint16_t' data-type='unsigned short' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</span> <dfn class="local col1 decl" id="31version" title='version' data-type='uint16_t' data-ref="31version" data-ref-filename="31version">version</dfn> = <a class="ref fn" href="internal.h.html#_ZN4bssl20ssl_protocol_versionEPK6ssl_st" title='bssl::ssl_protocol_version' data-ref="_ZN4bssl20ssl_protocol_versionEPK6ssl_st" data-ref-filename="_ZN4bssl20ssl_protocol_versionEPK6ssl_st">ssl_protocol_version</a>(<a class="local col8 ref" href="#28ssl" title='ssl' data-ref="28ssl" data-ref-filename="28ssl">ssl</a>);</td></tr>
<tr><th id="375">375</th><td>  <b>if</b> (<a class="local col1 ref" href="#31version" title='version' data-ref="31version" data-ref-filename="31version">version</a> &gt;= <a class="macro" href="../include/openssl/ssl.h.html#634" title="0x0304" data-ref="_M/TLS1_3_VERSION">TLS1_3_VERSION</a>) {</td></tr>
<tr><th id="376">376</th><td>    <i>// TLS 1.3 uses tickets as authenticators, so we are willing to use them for</i></td></tr>
<tr><th id="377">377</th><td><i>    // longer.</i></td></tr>
<tr><th id="378">378</th><td>    <a class="local col9 ref" href="#29session" title='session' data-ref="29session" data-ref-filename="29session">session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a> = <a class="local col8 ref" href="#28ssl" title='ssl' data-ref="28ssl" data-ref-filename="28ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session_ctx" title='ssl_st::session_ctx' data-ref="ssl_st::session_ctx" data-ref-filename="ssl_st..session_ctx">session_ctx</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_ctx_st::session_psk_dhe_timeout" title='ssl_ctx_st::session_psk_dhe_timeout' data-ref="ssl_ctx_st::session_psk_dhe_timeout" data-ref-filename="ssl_ctx_st..session_psk_dhe_timeout">session_psk_dhe_timeout</a>;</td></tr>
<tr><th id="379">379</th><td>    <a class="local col9 ref" href="#29session" title='session' data-ref="29session" data-ref-filename="29session">session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::auth_timeout" title='ssl_session_st::auth_timeout' data-ref="ssl_session_st::auth_timeout" data-ref-filename="ssl_session_st..auth_timeout">auth_timeout</a> = <a class="macro" href="../include/openssl/ssl.h.html#1952" title="(7 * 24 * 60 * 60)" data-ref="_M/SSL_DEFAULT_SESSION_AUTH_TIMEOUT">SSL_DEFAULT_SESSION_AUTH_TIMEOUT</a>;</td></tr>
<tr><th id="380">380</th><td>  } <b>else</b> {</td></tr>
<tr><th id="381">381</th><td>    <i>// TLS 1.2 resumption does not incorporate new key material, so we use a</i></td></tr>
<tr><th id="382">382</th><td><i>    // much shorter timeout.</i></td></tr>
<tr><th id="383">383</th><td>    <a class="local col9 ref" href="#29session" title='session' data-ref="29session" data-ref-filename="29session">session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a> = <a class="local col8 ref" href="#28ssl" title='ssl' data-ref="28ssl" data-ref-filename="28ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session_ctx" title='ssl_st::session_ctx' data-ref="ssl_st::session_ctx" data-ref-filename="ssl_st..session_ctx">session_ctx</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_ctx_st::session_timeout" title='ssl_ctx_st::session_timeout' data-ref="ssl_ctx_st::session_timeout" data-ref-filename="ssl_ctx_st..session_timeout">session_timeout</a>;</td></tr>
<tr><th id="384">384</th><td>    <a class="local col9 ref" href="#29session" title='session' data-ref="29session" data-ref-filename="29session">session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::auth_timeout" title='ssl_session_st::auth_timeout' data-ref="ssl_session_st::auth_timeout" data-ref-filename="ssl_session_st..auth_timeout">auth_timeout</a> = <a class="local col8 ref" href="#28ssl" title='ssl' data-ref="28ssl" data-ref-filename="28ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session_ctx" title='ssl_st::session_ctx' data-ref="ssl_st::session_ctx" data-ref-filename="ssl_st..session_ctx">session_ctx</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_ctx_st::session_timeout" title='ssl_ctx_st::session_timeout' data-ref="ssl_ctx_st::session_timeout" data-ref-filename="ssl_ctx_st..session_timeout">session_timeout</a>;</td></tr>
<tr><th id="385">385</th><td>  }</td></tr>
<tr><th id="386">386</th><td></td></tr>
<tr><th id="387">387</th><td>  <b>if</b> (<a class="local col7 ref" href="#27hs" title='hs' data-ref="27hs" data-ref-filename="27hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::config" title='bssl::SSL_HANDSHAKE::config' data-ref="bssl::SSL_HANDSHAKE::config" data-ref-filename="bssl..SSL_HANDSHAKE..config">config</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_CONFIG::cert" title='bssl::SSL_CONFIG::cert' data-ref="bssl::SSL_CONFIG::cert" data-ref-filename="bssl..SSL_CONFIG..cert">cert</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::CERT::sid_ctx_length" title='bssl::CERT::sid_ctx_length' data-ref="bssl::CERT::sid_ctx_length" data-ref-filename="bssl..CERT..sid_ctx_length">sid_ctx_length</a> &gt; <b>sizeof</b>(<a class="local col9 ref" href="#29session" title='session' data-ref="29session" data-ref-filename="29session">session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx" title='ssl_session_st::sid_ctx' data-ref="ssl_session_st::sid_ctx" data-ref-filename="ssl_session_st..sid_ctx">sid_ctx</a>)) {</td></tr>
<tr><th id="388">388</th><td>    <a class="macro" href="../include/openssl/err.h.html#423" title="ERR_put_error(ERR_LIB_SSL, 0, (4 | 64), &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/third_party/boringssl/src/ssl/ssl_session.cc&quot;, 388)" data-ref="_M/OPENSSL_PUT_ERROR">OPENSSL_PUT_ERROR</a>(SSL, <a class="macro" href="../include/openssl/err.h.html#374" title="(4 | 64)" data-ref="_M/ERR_R_INTERNAL_ERROR">ERR_R_INTERNAL_ERROR</a>);</td></tr>
<tr><th id="389">389</th><td>    <b>return</b> <b>false</b>;</td></tr>
<tr><th id="390">390</th><td>  }</td></tr>
<tr><th id="391">391</th><td>  <a class="ref fn" href="../crypto/internal.h.html#_ZL14OPENSSL_memcpyPvPKvm" title='OPENSSL_memcpy' data-ref="_ZL14OPENSSL_memcpyPvPKvm" data-ref-filename="_ZL14OPENSSL_memcpyPvPKvm">OPENSSL_memcpy</a>(<a class="local col9 ref" href="#29session" title='session' data-ref="29session" data-ref-filename="29session">session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx" title='ssl_session_st::sid_ctx' data-ref="ssl_session_st::sid_ctx" data-ref-filename="ssl_session_st..sid_ctx">sid_ctx</a>, <a class="local col7 ref" href="#27hs" title='hs' data-ref="27hs" data-ref-filename="27hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::config" title='bssl::SSL_HANDSHAKE::config' data-ref="bssl::SSL_HANDSHAKE::config" data-ref-filename="bssl..SSL_HANDSHAKE..config">config</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_CONFIG::cert" title='bssl::SSL_CONFIG::cert' data-ref="bssl::SSL_CONFIG::cert" data-ref-filename="bssl..SSL_CONFIG..cert">cert</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::CERT::sid_ctx" title='bssl::CERT::sid_ctx' data-ref="bssl::CERT::sid_ctx" data-ref-filename="bssl..CERT..sid_ctx">sid_ctx</a>,</td></tr>
<tr><th id="392">392</th><td>                 <a class="local col7 ref" href="#27hs" title='hs' data-ref="27hs" data-ref-filename="27hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::config" title='bssl::SSL_HANDSHAKE::config' data-ref="bssl::SSL_HANDSHAKE::config" data-ref-filename="bssl..SSL_HANDSHAKE..config">config</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_CONFIG::cert" title='bssl::SSL_CONFIG::cert' data-ref="bssl::SSL_CONFIG::cert" data-ref-filename="bssl..SSL_CONFIG..cert">cert</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::CERT::sid_ctx_length" title='bssl::CERT::sid_ctx_length' data-ref="bssl::CERT::sid_ctx_length" data-ref-filename="bssl..CERT..sid_ctx_length">sid_ctx_length</a>);</td></tr>
<tr><th id="393">393</th><td>  <a class="local col9 ref" href="#29session" title='session' data-ref="29session" data-ref-filename="29session">session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx_length" title='ssl_session_st::sid_ctx_length' data-ref="ssl_session_st::sid_ctx_length" data-ref-filename="ssl_session_st..sid_ctx_length">sid_ctx_length</a> = <a class="local col7 ref" href="#27hs" title='hs' data-ref="27hs" data-ref-filename="27hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::config" title='bssl::SSL_HANDSHAKE::config' data-ref="bssl::SSL_HANDSHAKE::config" data-ref-filename="bssl..SSL_HANDSHAKE..config">config</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_CONFIG::cert" title='bssl::SSL_CONFIG::cert' data-ref="bssl::SSL_CONFIG::cert" data-ref-filename="bssl..SSL_CONFIG..cert">cert</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::CERT::sid_ctx_length" title='bssl::CERT::sid_ctx_length' data-ref="bssl::CERT::sid_ctx_length" data-ref-filename="bssl..CERT..sid_ctx_length">sid_ctx_length</a>;</td></tr>
<tr><th id="394">394</th><td></td></tr>
<tr><th id="395">395</th><td>  <i>// The session is marked not resumable until it is completely filled in.</i></td></tr>
<tr><th id="396">396</th><td>  <a class="local col9 ref" href="#29session" title='session' data-ref="29session" data-ref-filename="29session">session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::not_resumable" title='ssl_session_st::not_resumable' data-ref="ssl_session_st::not_resumable" data-ref-filename="ssl_session_st..not_resumable">not_resumable</a> = <b>true</b>;</td></tr>
<tr><th id="397">397</th><td>  <a class="local col9 ref" href="#29session" title='session' data-ref="29session" data-ref-filename="29session">session</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::verify_result" title='ssl_session_st::verify_result' data-ref="ssl_session_st::verify_result" data-ref-filename="ssl_session_st..verify_result">verify_result</a> = <a class="macro" href="../include/openssl/x509_vfy.h.html#369" title="65" data-ref="_M/X509_V_ERR_INVALID_CALL">X509_V_ERR_INVALID_CALL</a>;</td></tr>
<tr><th id="398">398</th><td></td></tr>
<tr><th id="399">399</th><td>  <a class="local col7 ref" href="#27hs" title='hs' data-ref="27hs" data-ref-filename="27hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::new_session" title='bssl::SSL_HANDSHAKE::new_session' data-ref="bssl::SSL_HANDSHAKE::new_session" data-ref-filename="bssl..SSL_HANDSHAKE..new_session">new_session</a> <span class='ref fn' title='std::__1::unique_ptr::operator=' data-ref="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE" data-ref-filename="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE">=</span> <span class="namespace">std::</span><span class='ref fn' title='std::__1::move' data-ref="_ZNSt3__1L4moveEOT_" data-ref-filename="_ZNSt3__1L4moveEOT_">move</span>(<span class='refarg'><a class="local col9 ref" href="#29session" title='session' data-ref="29session" data-ref-filename="29session">session</a></span>);</td></tr>
<tr><th id="400">400</th><td>  <a class="ref fn" href="#_ZN4bssl15ssl_set_sessionEP6ssl_stP14ssl_session_st" title='bssl::ssl_set_session' data-ref="_ZN4bssl15ssl_set_sessionEP6ssl_stP14ssl_session_st" data-ref-filename="_ZN4bssl15ssl_set_sessionEP6ssl_stP14ssl_session_st">ssl_set_session</a>(<a class="local col8 ref" href="#28ssl" title='ssl' data-ref="28ssl" data-ref-filename="28ssl">ssl</a>, <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="401">401</th><td>  <b>return</b> <b>true</b>;</td></tr>
<tr><th id="402">402</th><td>}</td></tr>
<tr><th id="403">403</th><td></td></tr>
<tr><th id="404">404</th><td><em>int</em> <dfn class="decl def fn" id="_ZN4bssl36ssl_ctx_rotate_ticket_encryption_keyEP10ssl_ctx_st" title='bssl::ssl_ctx_rotate_ticket_encryption_key' data-ref="_ZN4bssl36ssl_ctx_rotate_ticket_encryption_keyEP10ssl_ctx_st" data-ref-filename="_ZN4bssl36ssl_ctx_rotate_ticket_encryption_keyEP10ssl_ctx_st">ssl_ctx_rotate_ticket_encryption_key</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col2 decl" id="32ctx" title='ctx' data-type='SSL_CTX *' data-ref="32ctx" data-ref-filename="32ctx">ctx</dfn>) {</td></tr>
<tr><th id="405">405</th><td>  <a class="type" href="internal.h.html#bssl::OPENSSL_timeval" title='bssl::OPENSSL_timeval' data-ref="bssl::OPENSSL_timeval" data-ref-filename="bssl..OPENSSL_timeval">OPENSSL_timeval</a> <a class="ref fn fake" href="internal.h.html#2735" title='bssl::OPENSSL_timeval::OPENSSL_timeval' data-ref="_ZN4bssl15OPENSSL_timevalC1Ev" data-ref-filename="_ZN4bssl15OPENSSL_timevalC1Ev"></a><dfn class="local col3 decl" id="33now" title='now' data-type='bssl::OPENSSL_timeval' data-ref="33now" data-ref-filename="33now">now</dfn>;</td></tr>
<tr><th id="406">406</th><td>  <a class="ref fn" href="internal.h.html#_ZN4bssl24ssl_ctx_get_current_timeEPK10ssl_ctx_stPNS_15OPENSSL_timevalE" title='bssl::ssl_ctx_get_current_time' data-ref="_ZN4bssl24ssl_ctx_get_current_timeEPK10ssl_ctx_stPNS_15OPENSSL_timevalE" data-ref-filename="_ZN4bssl24ssl_ctx_get_current_timeEPK10ssl_ctx_stPNS_15OPENSSL_timevalE">ssl_ctx_get_current_time</a>(<a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>, &amp;<a class="local col3 ref" href="#33now" title='now' data-ref="33now" data-ref-filename="33now">now</a>);</td></tr>
<tr><th id="407">407</th><td>  {</td></tr>
<tr><th id="408">408</th><td>    <i>// Avoid acquiring a write lock in the common case (i.e. a non-default key</i></td></tr>
<tr><th id="409">409</th><td><i>    // is used or the default keys have not expired yet).</i></td></tr>
<tr><th id="410">410</th><td>    <a class="typedef" href="../crypto/internal.h.html#bssl::MutexReadLock" title='bssl::MutexReadLock' data-type='internal::MutexLockBase&lt;CRYPTO_MUTEX_lock_read, CRYPTO_MUTEX_unlock_read&gt;' data-ref="bssl::MutexReadLock" data-ref-filename="bssl..MutexReadLock">MutexReadLock</a> <dfn class="local col4 decl" id="34lock" title='lock' data-type='bssl::MutexReadLock' data-ref="34lock" data-ref-filename="34lock">lock</dfn><a class="ref fn" href="../crypto/internal.h.html#_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t" title='bssl::internal::MutexLockBase::MutexLockBase&lt;LockFunc, ReleaseFunc&gt;' data-ref="_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t" data-ref-filename="_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t">(</a>&amp;<a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::lock" title='ssl_ctx_st::lock' data-ref="ssl_ctx_st::lock" data-ref-filename="ssl_ctx_st..lock">lock</a>);</td></tr>
<tr><th id="411">411</th><td>    <b>if</b> (<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_current" title='ssl_ctx_st::ticket_key_current' data-ref="ssl_ctx_st::ticket_key_current" data-ref-filename="ssl_ctx_st..ticket_key_current">ticket_key_current</a> &amp;&amp;</td></tr>
<tr><th id="412">412</th><td>        (<a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_current" title='ssl_ctx_st::ticket_key_current' data-ref="ssl_ctx_st::ticket_key_current" data-ref-filename="ssl_ctx_st..ticket_key_current">ticket_key_current</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::TicketKey::next_rotation_tv_sec" title='bssl::TicketKey::next_rotation_tv_sec' data-ref="bssl::TicketKey::next_rotation_tv_sec" data-ref-filename="bssl..TicketKey..next_rotation_tv_sec">next_rotation_tv_sec</a> == <var>0</var> ||</td></tr>
<tr><th id="413">413</th><td>         <a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_current" title='ssl_ctx_st::ticket_key_current' data-ref="ssl_ctx_st::ticket_key_current" data-ref-filename="ssl_ctx_st..ticket_key_current">ticket_key_current</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::TicketKey::next_rotation_tv_sec" title='bssl::TicketKey::next_rotation_tv_sec' data-ref="bssl::TicketKey::next_rotation_tv_sec" data-ref-filename="bssl..TicketKey..next_rotation_tv_sec">next_rotation_tv_sec</a> &gt; <a class="local col3 ref" href="#33now" title='now' data-ref="33now" data-ref-filename="33now">now</a>.<a class="ref field" href="internal.h.html#bssl::OPENSSL_timeval::tv_sec" title='bssl::OPENSSL_timeval::tv_sec' data-ref="bssl::OPENSSL_timeval::tv_sec" data-ref-filename="bssl..OPENSSL_timeval..tv_sec">tv_sec</a>) &amp;&amp;</td></tr>
<tr><th id="414">414</th><td>        (!<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_prev" title='ssl_ctx_st::ticket_key_prev' data-ref="ssl_ctx_st::ticket_key_prev" data-ref-filename="ssl_ctx_st..ticket_key_prev">ticket_key_prev</a> ||</td></tr>
<tr><th id="415">415</th><td>         <a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_prev" title='ssl_ctx_st::ticket_key_prev' data-ref="ssl_ctx_st::ticket_key_prev" data-ref-filename="ssl_ctx_st..ticket_key_prev">ticket_key_prev</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::TicketKey::next_rotation_tv_sec" title='bssl::TicketKey::next_rotation_tv_sec' data-ref="bssl::TicketKey::next_rotation_tv_sec" data-ref-filename="bssl..TicketKey..next_rotation_tv_sec">next_rotation_tv_sec</a> &gt; <a class="local col3 ref" href="#33now" title='now' data-ref="33now" data-ref-filename="33now">now</a>.<a class="ref field" href="internal.h.html#bssl::OPENSSL_timeval::tv_sec" title='bssl::OPENSSL_timeval::tv_sec' data-ref="bssl::OPENSSL_timeval::tv_sec" data-ref-filename="bssl..OPENSSL_timeval..tv_sec">tv_sec</a>)) {</td></tr>
<tr><th id="416">416</th><td>      <b>return</b> <var>1</var>;</td></tr>
<tr><th id="417">417</th><td>    }</td></tr>
<tr><th id="418">418</th><td>  }</td></tr>
<tr><th id="419">419</th><td></td></tr>
<tr><th id="420">420</th><td>  <a class="typedef" href="../crypto/internal.h.html#bssl::MutexWriteLock" title='bssl::MutexWriteLock' data-type='internal::MutexLockBase&lt;CRYPTO_MUTEX_lock_write, CRYPTO_MUTEX_unlock_write&gt;' data-ref="bssl::MutexWriteLock" data-ref-filename="bssl..MutexWriteLock">MutexWriteLock</a> <dfn class="local col5 decl" id="35lock" title='lock' data-type='bssl::MutexWriteLock' data-ref="35lock" data-ref-filename="35lock">lock</dfn><a class="ref fn" href="../crypto/internal.h.html#_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t" title='bssl::internal::MutexLockBase::MutexLockBase&lt;LockFunc, ReleaseFunc&gt;' data-ref="_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t" data-ref-filename="_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t">(</a>&amp;<a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::lock" title='ssl_ctx_st::lock' data-ref="ssl_ctx_st::lock" data-ref-filename="ssl_ctx_st..lock">lock</a>);</td></tr>
<tr><th id="421">421</th><td>  <b>if</b> (!<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_current" title='ssl_ctx_st::ticket_key_current' data-ref="ssl_ctx_st::ticket_key_current" data-ref-filename="ssl_ctx_st..ticket_key_current">ticket_key_current</a> ||</td></tr>
<tr><th id="422">422</th><td>      (<a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_current" title='ssl_ctx_st::ticket_key_current' data-ref="ssl_ctx_st::ticket_key_current" data-ref-filename="ssl_ctx_st..ticket_key_current">ticket_key_current</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::TicketKey::next_rotation_tv_sec" title='bssl::TicketKey::next_rotation_tv_sec' data-ref="bssl::TicketKey::next_rotation_tv_sec" data-ref-filename="bssl..TicketKey..next_rotation_tv_sec">next_rotation_tv_sec</a> != <var>0</var> &amp;&amp;</td></tr>
<tr><th id="423">423</th><td>       <a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_current" title='ssl_ctx_st::ticket_key_current' data-ref="ssl_ctx_st::ticket_key_current" data-ref-filename="ssl_ctx_st..ticket_key_current">ticket_key_current</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::TicketKey::next_rotation_tv_sec" title='bssl::TicketKey::next_rotation_tv_sec' data-ref="bssl::TicketKey::next_rotation_tv_sec" data-ref-filename="bssl..TicketKey..next_rotation_tv_sec">next_rotation_tv_sec</a> &lt;= <a class="local col3 ref" href="#33now" title='now' data-ref="33now" data-ref-filename="33now">now</a>.<a class="ref field" href="internal.h.html#bssl::OPENSSL_timeval::tv_sec" title='bssl::OPENSSL_timeval::tv_sec' data-ref="bssl::OPENSSL_timeval::tv_sec" data-ref-filename="bssl..OPENSSL_timeval..tv_sec">tv_sec</a>)) {</td></tr>
<tr><th id="424">424</th><td>    <i>// The current key has not been initialized or it is expired.</i></td></tr>
<tr><th id="425">425</th><td>    <em>auto</em> <dfn class="local col6 decl" id="36new_key" title='new_key' data-type='std::__1::unique_ptr&lt;bssl::TicketKey, bssl::internal::Deleter&lt;bssl::TicketKey&gt;&gt;' data-ref="36new_key" data-ref-filename="36new_key">new_key</dfn> = <span class="namespace">bssl::</span><a class="ref fn" href="internal.h.html#_ZN4bssl10MakeUniqueEDpOT0_" title='bssl::MakeUnique' data-ref="_ZN4bssl10MakeUniqueEDpOT0_" data-ref-filename="_ZN4bssl10MakeUniqueEDpOT0_">MakeUnique</a>&lt;<a class="type" href="internal.h.html#bssl::TicketKey" title='bssl::TicketKey' data-ref="bssl::TicketKey" data-ref-filename="bssl..TicketKey">TicketKey</a>&gt;();</td></tr>
<tr><th id="426">426</th><td>    <b>if</b> (!<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col6 ref" href="#36new_key" title='new_key' data-ref="36new_key" data-ref-filename="36new_key">new_key</a>) {</td></tr>
<tr><th id="427">427</th><td>      <b>return</b> <var>0</var>;</td></tr>
<tr><th id="428">428</th><td>    }</td></tr>
<tr><th id="429">429</th><td>    <a class="ref fn" href="../include/openssl/rand.h.html#RAND_bytes" title='RAND_bytes' data-ref="RAND_bytes" data-ref-filename="RAND_bytes">RAND_bytes</a>(<a class="local col6 ref" href="#36new_key" title='new_key' data-ref="36new_key" data-ref-filename="36new_key">new_key</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::TicketKey::name" title='bssl::TicketKey::name' data-ref="bssl::TicketKey::name" data-ref-filename="bssl..TicketKey..name">name</a>, <var>16</var>);</td></tr>
<tr><th id="430">430</th><td>    <a class="ref fn" href="../include/openssl/rand.h.html#RAND_bytes" title='RAND_bytes' data-ref="RAND_bytes" data-ref-filename="RAND_bytes">RAND_bytes</a>(<a class="local col6 ref" href="#36new_key" title='new_key' data-ref="36new_key" data-ref-filename="36new_key">new_key</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::TicketKey::hmac_key" title='bssl::TicketKey::hmac_key' data-ref="bssl::TicketKey::hmac_key" data-ref-filename="bssl..TicketKey..hmac_key">hmac_key</a>, <var>16</var>);</td></tr>
<tr><th id="431">431</th><td>    <a class="ref fn" href="../include/openssl/rand.h.html#RAND_bytes" title='RAND_bytes' data-ref="RAND_bytes" data-ref-filename="RAND_bytes">RAND_bytes</a>(<a class="local col6 ref" href="#36new_key" title='new_key' data-ref="36new_key" data-ref-filename="36new_key">new_key</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::TicketKey::aes_key" title='bssl::TicketKey::aes_key' data-ref="bssl::TicketKey::aes_key" data-ref-filename="bssl..TicketKey..aes_key">aes_key</a>, <var>16</var>);</td></tr>
<tr><th id="432">432</th><td>    <a class="local col6 ref" href="#36new_key" title='new_key' data-ref="36new_key" data-ref-filename="36new_key">new_key</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::TicketKey::next_rotation_tv_sec" title='bssl::TicketKey::next_rotation_tv_sec' data-ref="bssl::TicketKey::next_rotation_tv_sec" data-ref-filename="bssl..TicketKey..next_rotation_tv_sec">next_rotation_tv_sec</a> =</td></tr>
<tr><th id="433">433</th><td>        <a class="local col3 ref" href="#33now" title='now' data-ref="33now" data-ref-filename="33now">now</a>.<a class="ref field" href="internal.h.html#bssl::OPENSSL_timeval::tv_sec" title='bssl::OPENSSL_timeval::tv_sec' data-ref="bssl::OPENSSL_timeval::tv_sec" data-ref-filename="bssl..OPENSSL_timeval..tv_sec">tv_sec</a> + <a class="macro" href="../include/openssl/ssl.h.html#2133" title="(2 * 24 * 60 * 60)" data-ref="_M/SSL_DEFAULT_TICKET_KEY_ROTATION_INTERVAL">SSL_DEFAULT_TICKET_KEY_ROTATION_INTERVAL</a>;</td></tr>
<tr><th id="434">434</th><td>    <b>if</b> (<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_current" title='ssl_ctx_st::ticket_key_current' data-ref="ssl_ctx_st::ticket_key_current" data-ref-filename="ssl_ctx_st..ticket_key_current">ticket_key_current</a>) {</td></tr>
<tr><th id="435">435</th><td>      <i>// The current key expired. Rotate it to prev and bump up its rotation</i></td></tr>
<tr><th id="436">436</th><td><i>      // timestamp. Note that even with the new rotation time it may still be</i></td></tr>
<tr><th id="437">437</th><td><i>      // expired and get dropped below.</i></td></tr>
<tr><th id="438">438</th><td>      <a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_current" title='ssl_ctx_st::ticket_key_current' data-ref="ssl_ctx_st::ticket_key_current" data-ref-filename="ssl_ctx_st..ticket_key_current">ticket_key_current</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::TicketKey::next_rotation_tv_sec" title='bssl::TicketKey::next_rotation_tv_sec' data-ref="bssl::TicketKey::next_rotation_tv_sec" data-ref-filename="bssl..TicketKey..next_rotation_tv_sec">next_rotation_tv_sec</a> +=</td></tr>
<tr><th id="439">439</th><td>          <a class="macro" href="../include/openssl/ssl.h.html#2133" title="(2 * 24 * 60 * 60)" data-ref="_M/SSL_DEFAULT_TICKET_KEY_ROTATION_INTERVAL">SSL_DEFAULT_TICKET_KEY_ROTATION_INTERVAL</a>;</td></tr>
<tr><th id="440">440</th><td>      <a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_prev" title='ssl_ctx_st::ticket_key_prev' data-ref="ssl_ctx_st::ticket_key_prev" data-ref-filename="ssl_ctx_st..ticket_key_prev">ticket_key_prev</a> <span class='ref fn' title='std::__1::unique_ptr::operator=' data-ref="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE" data-ref-filename="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE">=</span> <span class="namespace">std::</span><span class='ref fn' title='std::__1::move' data-ref="_ZNSt3__1L4moveEOT_" data-ref-filename="_ZNSt3__1L4moveEOT_">move</span>(<span class='refarg'><a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_current" title='ssl_ctx_st::ticket_key_current' data-ref="ssl_ctx_st::ticket_key_current" data-ref-filename="ssl_ctx_st..ticket_key_current">ticket_key_current</a></span>);</td></tr>
<tr><th id="441">441</th><td>    }</td></tr>
<tr><th id="442">442</th><td>    <a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_current" title='ssl_ctx_st::ticket_key_current' data-ref="ssl_ctx_st::ticket_key_current" data-ref-filename="ssl_ctx_st..ticket_key_current">ticket_key_current</a> <span class='ref fn' title='std::__1::unique_ptr::operator=' data-ref="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE" data-ref-filename="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE">=</span> <span class="namespace">std::</span><span class='ref fn' title='std::__1::move' data-ref="_ZNSt3__1L4moveEOT_" data-ref-filename="_ZNSt3__1L4moveEOT_">move</span>(<span class='refarg'><a class="local col6 ref" href="#36new_key" title='new_key' data-ref="36new_key" data-ref-filename="36new_key">new_key</a></span>);</td></tr>
<tr><th id="443">443</th><td>  }</td></tr>
<tr><th id="444">444</th><td></td></tr>
<tr><th id="445">445</th><td>  <i>// Drop an expired prev key.</i></td></tr>
<tr><th id="446">446</th><td>  <b>if</b> (<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_prev" title='ssl_ctx_st::ticket_key_prev' data-ref="ssl_ctx_st::ticket_key_prev" data-ref-filename="ssl_ctx_st..ticket_key_prev">ticket_key_prev</a> &amp;&amp;</td></tr>
<tr><th id="447">447</th><td>      <a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_prev" title='ssl_ctx_st::ticket_key_prev' data-ref="ssl_ctx_st::ticket_key_prev" data-ref-filename="ssl_ctx_st..ticket_key_prev">ticket_key_prev</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::TicketKey::next_rotation_tv_sec" title='bssl::TicketKey::next_rotation_tv_sec' data-ref="bssl::TicketKey::next_rotation_tv_sec" data-ref-filename="bssl..TicketKey..next_rotation_tv_sec">next_rotation_tv_sec</a> &lt;= <a class="local col3 ref" href="#33now" title='now' data-ref="33now" data-ref-filename="33now">now</a>.<a class="ref field" href="internal.h.html#bssl::OPENSSL_timeval::tv_sec" title='bssl::OPENSSL_timeval::tv_sec' data-ref="bssl::OPENSSL_timeval::tv_sec" data-ref-filename="bssl..OPENSSL_timeval..tv_sec">tv_sec</a>) {</td></tr>
<tr><th id="448">448</th><td>    <a class="local col2 ref" href="#32ctx" title='ctx' data-ref="32ctx" data-ref-filename="32ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_prev" title='ssl_ctx_st::ticket_key_prev' data-ref="ssl_ctx_st::ticket_key_prev" data-ref-filename="ssl_ctx_st..ticket_key_prev">ticket_key_prev</a>.<span class='ref fn' title='std::__1::unique_ptr::reset' data-ref="_ZNSt3__110unique_ptr5resetENS_14__pointer_typeIT_T0_E4typeE" data-ref-filename="_ZNSt3__110unique_ptr5resetENS_14__pointer_typeIT_T0_E4typeE">reset</span>();</td></tr>
<tr><th id="449">449</th><td>  }</td></tr>
<tr><th id="450">450</th><td></td></tr>
<tr><th id="451">451</th><td>  <b>return</b> <var>1</var>;</td></tr>
<tr><th id="452">452</th><td>}</td></tr>
<tr><th id="453">453</th><td></td></tr>
<tr><th id="454">454</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="_ZN4bsslL34ssl_encrypt_ticket_with_cipher_ctxEPNS_13SSL_HANDSHAKEEP6cbb_stPKhm" title='bssl::ssl_encrypt_ticket_with_cipher_ctx' data-type='int bssl::ssl_encrypt_ticket_with_cipher_ctx(bssl::SSL_HANDSHAKE * hs, CBB * out, const uint8_t * session_buf, size_t session_len)' data-ref="_ZN4bsslL34ssl_encrypt_ticket_with_cipher_ctxEPNS_13SSL_HANDSHAKEEP6cbb_stPKhm" data-ref-filename="_ZN4bsslL34ssl_encrypt_ticket_with_cipher_ctxEPNS_13SSL_HANDSHAKEEP6cbb_stPKhm">ssl_encrypt_ticket_with_cipher_ctx</dfn>(<a class="type" href="internal.h.html#bssl::SSL_HANDSHAKE" title='bssl::SSL_HANDSHAKE' data-ref="bssl::SSL_HANDSHAKE" data-ref-filename="bssl..SSL_HANDSHAKE">SSL_HANDSHAKE</a> *<dfn class="local col7 decl" id="37hs" title='hs' data-type='bssl::SSL_HANDSHAKE *' data-ref="37hs" data-ref-filename="37hs">hs</dfn>, <a class="typedef" href="../include/openssl/base.h.html#CBB" title='CBB' data-type='struct cbb_st' data-ref="CBB" data-ref-filename="CBB">CBB</a> *<dfn class="local col8 decl" id="38out" title='out' data-type='CBB *' data-ref="38out" data-ref-filename="38out">out</dfn>,</td></tr>
<tr><th id="455">455</th><td>                                              <em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> *<dfn class="local col9 decl" id="39session_buf" title='session_buf' data-type='const uint8_t *' data-ref="39session_buf" data-ref-filename="39session_buf">session_buf</dfn>,</td></tr>
<tr><th id="456">456</th><td>                                              <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col0 decl" id="40session_len" title='session_len' data-type='size_t' data-ref="40session_len" data-ref-filename="40session_len">session_len</dfn>) {</td></tr>
<tr><th id="457">457</th><td>  <a class="typedef" href="../include/openssl/cipher.h.html#bssl::ScopedEVP_CIPHER_CTX" title='bssl::ScopedEVP_CIPHER_CTX' data-type='internal::StackAllocated&lt;EVP_CIPHER_CTX, int, EVP_CIPHER_CTX_init, EVP_CIPHER_CTX_cleanup&gt;' data-ref="bssl::ScopedEVP_CIPHER_CTX" data-ref-filename="bssl..ScopedEVP_CIPHER_CTX">ScopedEVP_CIPHER_CTX</a> <a class="ref fn fake" href="../include/openssl/base.h.html#_ZN4bssl8internal14StackAllocatedC1Ev" title='bssl::internal::StackAllocated::StackAllocated&lt;T, CleanupRet, init, cleanup&gt;' data-ref="_ZN4bssl8internal14StackAllocatedC1Ev" data-ref-filename="_ZN4bssl8internal14StackAllocatedC1Ev"></a><dfn class="local col1 decl" id="41ctx" title='ctx' data-type='bssl::ScopedEVP_CIPHER_CTX' data-ref="41ctx" data-ref-filename="41ctx">ctx</dfn>;</td></tr>
<tr><th id="458">458</th><td>  <a class="typedef" href="../include/openssl/hmac.h.html#bssl::ScopedHMAC_CTX" title='bssl::ScopedHMAC_CTX' data-type='internal::StackAllocated&lt;HMAC_CTX, void, HMAC_CTX_init, HMAC_CTX_cleanup&gt;' data-ref="bssl::ScopedHMAC_CTX" data-ref-filename="bssl..ScopedHMAC_CTX">ScopedHMAC_CTX</a> <a class="ref fn fake" href="../include/openssl/base.h.html#_ZN4bssl8internal14StackAllocatedC1Ev" title='bssl::internal::StackAllocated::StackAllocated&lt;T, CleanupRet, init, cleanup&gt;' data-ref="_ZN4bssl8internal14StackAllocatedC1Ev" data-ref-filename="_ZN4bssl8internal14StackAllocatedC1Ev"></a><dfn class="local col2 decl" id="42hctx" title='hctx' data-type='bssl::ScopedHMAC_CTX' data-ref="42hctx" data-ref-filename="42hctx">hctx</dfn>;</td></tr>
<tr><th id="459">459</th><td></td></tr>
<tr><th id="460">460</th><td>  <i>// If the session is too long, emit a dummy value rather than abort the</i></td></tr>
<tr><th id="461">461</th><td><i>  // connection.</i></td></tr>
<tr><th id="462">462</th><td>  <em>static</em> <em>const</em> <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col3 decl" id="43kMaxTicketOverhead" title='kMaxTicketOverhead' data-type='const size_t' data-ref="43kMaxTicketOverhead" data-ref-filename="43kMaxTicketOverhead">kMaxTicketOverhead</dfn> =</td></tr>
<tr><th id="463">463</th><td>      <var>16</var> + <a class="macro" href="../include/openssl/cipher.h.html#515" title="16" data-ref="_M/EVP_MAX_IV_LENGTH">EVP_MAX_IV_LENGTH</a> + <a class="macro" href="../include/openssl/cipher.h.html#516" title="32" data-ref="_M/EVP_MAX_BLOCK_LENGTH">EVP_MAX_BLOCK_LENGTH</a> + <a class="macro" href="../include/openssl/digest.h.html#152" title="64" data-ref="_M/EVP_MAX_MD_SIZE">EVP_MAX_MD_SIZE</a>;</td></tr>
<tr><th id="464">464</th><td>  <b>if</b> (<a class="local col0 ref" href="#40session_len" title='session_len' data-ref="40session_len" data-ref-filename="40session_len">session_len</a> &gt; <var>0xffff</var> - <a class="local col3 ref" href="#43kMaxTicketOverhead" title='kMaxTicketOverhead' data-ref="43kMaxTicketOverhead" data-ref-filename="43kMaxTicketOverhead">kMaxTicketOverhead</a>) {</td></tr>
<tr><th id="465">465</th><td>    <em>static</em> <em>const</em> <em>char</em> <dfn class="local col4 decl" id="44kTicketPlaceholder" title='kTicketPlaceholder' data-type='const char [17]' data-ref="44kTicketPlaceholder" data-ref-filename="44kTicketPlaceholder">kTicketPlaceholder</dfn>[] = <q>"TICKET TOO LARGE"</q>;</td></tr>
<tr><th id="466">466</th><td>    <b>return</b> <a class="ref fn" href="../include/openssl/bytestring.h.html#CBB_add_bytes" title='CBB_add_bytes' data-ref="CBB_add_bytes" data-ref-filename="CBB_add_bytes">CBB_add_bytes</a>(<a class="local col8 ref" href="#38out" title='out' data-ref="38out" data-ref-filename="38out">out</a>, (<em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> *)<a class="local col4 ref" href="#44kTicketPlaceholder" title='kTicketPlaceholder' data-ref="44kTicketPlaceholder" data-ref-filename="44kTicketPlaceholder">kTicketPlaceholder</a>,</td></tr>
<tr><th id="467">467</th><td>                         <span class='ref fn' title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</span>(<a class="local col4 ref" href="#44kTicketPlaceholder" title='kTicketPlaceholder' data-ref="44kTicketPlaceholder" data-ref-filename="44kTicketPlaceholder">kTicketPlaceholder</a>));</td></tr>
<tr><th id="468">468</th><td>  }</td></tr>
<tr><th id="469">469</th><td></td></tr>
<tr><th id="470">470</th><td>  <i>// Initialize HMAC and cipher contexts. If callback present it does all the</i></td></tr>
<tr><th id="471">471</th><td><i>  // work otherwise use generated values from parent ctx.</i></td></tr>
<tr><th id="472">472</th><td>  <a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col5 decl" id="45tctx" title='tctx' data-type='SSL_CTX *' data-ref="45tctx" data-ref-filename="45tctx">tctx</dfn> = <a class="local col7 ref" href="#37hs" title='hs' data-ref="37hs" data-ref-filename="37hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::ssl" title='bssl::SSL_HANDSHAKE::ssl' data-ref="bssl::SSL_HANDSHAKE::ssl" data-ref-filename="bssl..SSL_HANDSHAKE..ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session_ctx" title='ssl_st::session_ctx' data-ref="ssl_st::session_ctx" data-ref-filename="ssl_st..session_ctx">session_ctx</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>();</td></tr>
<tr><th id="473">473</th><td>  <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> <dfn class="local col6 decl" id="46iv" title='iv' data-type='uint8_t [16]' data-ref="46iv" data-ref-filename="46iv">iv</dfn>[<a class="macro" href="../include/openssl/cipher.h.html#515" title="16" data-ref="_M/EVP_MAX_IV_LENGTH">EVP_MAX_IV_LENGTH</a>];</td></tr>
<tr><th id="474">474</th><td>  <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> <dfn class="local col7 decl" id="47key_name" title='key_name' data-type='uint8_t [16]' data-ref="47key_name" data-ref-filename="47key_name">key_name</dfn>[<var>16</var>];</td></tr>
<tr><th id="475">475</th><td>  <b>if</b> (<a class="local col5 ref" href="#45tctx" title='tctx' data-ref="45tctx" data-ref-filename="45tctx">tctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_cb" title='ssl_ctx_st::ticket_key_cb' data-ref="ssl_ctx_st::ticket_key_cb" data-ref-filename="ssl_ctx_st..ticket_key_cb">ticket_key_cb</a> != <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="476">476</th><td>    <b>if</b> (<a class="local col5 ref" href="#45tctx" title='tctx' data-ref="45tctx" data-ref-filename="45tctx">tctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_cb" title='ssl_ctx_st::ticket_key_cb' data-ref="ssl_ctx_st::ticket_key_cb" data-ref-filename="ssl_ctx_st..ticket_key_cb">ticket_key_cb</a>(<a class="local col7 ref" href="#37hs" title='hs' data-ref="37hs" data-ref-filename="37hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::ssl" title='bssl::SSL_HANDSHAKE::ssl' data-ref="bssl::SSL_HANDSHAKE::ssl" data-ref-filename="bssl..SSL_HANDSHAKE..ssl">ssl</a>, <a class="local col7 ref" href="#47key_name" title='key_name' data-ref="47key_name" data-ref-filename="47key_name">key_name</a>, <a class="local col6 ref" href="#46iv" title='iv' data-ref="46iv" data-ref-filename="46iv">iv</a>, <a class="local col1 ref" href="#41ctx" title='ctx' data-ref="41ctx" data-ref-filename="41ctx">ctx</a>.<a class="ref fn" href="../include/openssl/base.h.html#_ZN4bssl8internal14StackAllocated3getEv" title='bssl::internal::StackAllocated::get' data-ref="_ZN4bssl8internal14StackAllocated3getEv" data-ref-filename="_ZN4bssl8internal14StackAllocated3getEv">get</a>(), <a class="local col2 ref" href="#42hctx" title='hctx' data-ref="42hctx" data-ref-filename="42hctx">hctx</a>.<a class="ref fn" href="../include/openssl/base.h.html#_ZN4bssl8internal14StackAllocated3getEv" title='bssl::internal::StackAllocated::get' data-ref="_ZN4bssl8internal14StackAllocated3getEv" data-ref-filename="_ZN4bssl8internal14StackAllocated3getEv">get</a>(),</td></tr>
<tr><th id="477">477</th><td>                            <var>1</var> <i>/* encrypt */</i>) &lt; <var>0</var>) {</td></tr>
<tr><th id="478">478</th><td>      <b>return</b> <var>0</var>;</td></tr>
<tr><th id="479">479</th><td>    }</td></tr>
<tr><th id="480">480</th><td>  } <b>else</b> {</td></tr>
<tr><th id="481">481</th><td>    <i>// Rotate ticket key if necessary.</i></td></tr>
<tr><th id="482">482</th><td>    <b>if</b> (!<a class="ref fn" href="#_ZN4bssl36ssl_ctx_rotate_ticket_encryption_keyEP10ssl_ctx_st" title='bssl::ssl_ctx_rotate_ticket_encryption_key' data-ref="_ZN4bssl36ssl_ctx_rotate_ticket_encryption_keyEP10ssl_ctx_st" data-ref-filename="_ZN4bssl36ssl_ctx_rotate_ticket_encryption_keyEP10ssl_ctx_st">ssl_ctx_rotate_ticket_encryption_key</a>(<a class="local col5 ref" href="#45tctx" title='tctx' data-ref="45tctx" data-ref-filename="45tctx">tctx</a>)) {</td></tr>
<tr><th id="483">483</th><td>      <b>return</b> <var>0</var>;</td></tr>
<tr><th id="484">484</th><td>    }</td></tr>
<tr><th id="485">485</th><td>    <a class="typedef" href="../crypto/internal.h.html#bssl::MutexReadLock" title='bssl::MutexReadLock' data-type='internal::MutexLockBase&lt;CRYPTO_MUTEX_lock_read, CRYPTO_MUTEX_unlock_read&gt;' data-ref="bssl::MutexReadLock" data-ref-filename="bssl..MutexReadLock">MutexReadLock</a> <dfn class="local col8 decl" id="48lock" title='lock' data-type='bssl::MutexReadLock' data-ref="48lock" data-ref-filename="48lock">lock</dfn><a class="ref fn" href="../crypto/internal.h.html#_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t" title='bssl::internal::MutexLockBase::MutexLockBase&lt;LockFunc, ReleaseFunc&gt;' data-ref="_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t" data-ref-filename="_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t">(</a>&amp;<a class="local col5 ref" href="#45tctx" title='tctx' data-ref="45tctx" data-ref-filename="45tctx">tctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::lock" title='ssl_ctx_st::lock' data-ref="ssl_ctx_st::lock" data-ref-filename="ssl_ctx_st..lock">lock</a>);</td></tr>
<tr><th id="486">486</th><td>    <b>if</b> (!<a class="ref fn" href="../include/openssl/rand.h.html#RAND_bytes" title='RAND_bytes' data-ref="RAND_bytes" data-ref-filename="RAND_bytes">RAND_bytes</a>(<a class="local col6 ref" href="#46iv" title='iv' data-ref="46iv" data-ref-filename="46iv">iv</a>, <var>16</var>) ||</td></tr>
<tr><th id="487">487</th><td>        !<a class="ref fn" href="../include/openssl/cipher.h.html#EVP_EncryptInit_ex" title='EVP_EncryptInit_ex' data-ref="EVP_EncryptInit_ex" data-ref-filename="EVP_EncryptInit_ex">EVP_EncryptInit_ex</a>(<a class="local col1 ref" href="#41ctx" title='ctx' data-ref="41ctx" data-ref-filename="41ctx">ctx</a>.<a class="ref fn" href="../include/openssl/base.h.html#_ZN4bssl8internal14StackAllocated3getEv" title='bssl::internal::StackAllocated::get' data-ref="_ZN4bssl8internal14StackAllocated3getEv" data-ref-filename="_ZN4bssl8internal14StackAllocated3getEv">get</a>(), <a class="ref fn" href="../include/openssl/cipher.h.html#EVP_aes_128_cbc" title='EVP_aes_128_cbc' data-ref="EVP_aes_128_cbc" data-ref-filename="EVP_aes_128_cbc">EVP_aes_128_cbc</a>(), <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>,</td></tr>
<tr><th id="488">488</th><td>                            <a class="local col5 ref" href="#45tctx" title='tctx' data-ref="45tctx" data-ref-filename="45tctx">tctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_current" title='ssl_ctx_st::ticket_key_current' data-ref="ssl_ctx_st::ticket_key_current" data-ref-filename="ssl_ctx_st..ticket_key_current">ticket_key_current</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::TicketKey::aes_key" title='bssl::TicketKey::aes_key' data-ref="bssl::TicketKey::aes_key" data-ref-filename="bssl..TicketKey..aes_key">aes_key</a>, <a class="local col6 ref" href="#46iv" title='iv' data-ref="46iv" data-ref-filename="46iv">iv</a>) ||</td></tr>
<tr><th id="489">489</th><td>        !<a class="ref fn" href="../include/openssl/hmac.h.html#HMAC_Init_ex" title='HMAC_Init_ex' data-ref="HMAC_Init_ex" data-ref-filename="HMAC_Init_ex">HMAC_Init_ex</a>(<a class="local col2 ref" href="#42hctx" title='hctx' data-ref="42hctx" data-ref-filename="42hctx">hctx</a>.<a class="ref fn" href="../include/openssl/base.h.html#_ZN4bssl8internal14StackAllocated3getEv" title='bssl::internal::StackAllocated::get' data-ref="_ZN4bssl8internal14StackAllocated3getEv" data-ref-filename="_ZN4bssl8internal14StackAllocated3getEv">get</a>(), <a class="local col5 ref" href="#45tctx" title='tctx' data-ref="45tctx" data-ref-filename="45tctx">tctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_current" title='ssl_ctx_st::ticket_key_current' data-ref="ssl_ctx_st::ticket_key_current" data-ref-filename="ssl_ctx_st..ticket_key_current">ticket_key_current</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::TicketKey::hmac_key" title='bssl::TicketKey::hmac_key' data-ref="bssl::TicketKey::hmac_key" data-ref-filename="bssl..TicketKey..hmac_key">hmac_key</a>, <var>16</var>,</td></tr>
<tr><th id="490">490</th><td>                      <a class="macro" href="internal.h.html#3175" title="EVP_sha256" data-ref="_M/tlsext_tick_md">tlsext_tick_md</a>(), <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>)) {</td></tr>
<tr><th id="491">491</th><td>      <b>return</b> <var>0</var>;</td></tr>
<tr><th id="492">492</th><td>    }</td></tr>
<tr><th id="493">493</th><td>    <a class="ref fn" href="../crypto/internal.h.html#_ZL14OPENSSL_memcpyPvPKvm" title='OPENSSL_memcpy' data-ref="_ZL14OPENSSL_memcpyPvPKvm" data-ref-filename="_ZL14OPENSSL_memcpyPvPKvm">OPENSSL_memcpy</a>(<a class="local col7 ref" href="#47key_name" title='key_name' data-ref="47key_name" data-ref-filename="47key_name">key_name</a>, <a class="local col5 ref" href="#45tctx" title='tctx' data-ref="45tctx" data-ref-filename="45tctx">tctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_key_current" title='ssl_ctx_st::ticket_key_current' data-ref="ssl_ctx_st::ticket_key_current" data-ref-filename="ssl_ctx_st..ticket_key_current">ticket_key_current</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::TicketKey::name" title='bssl::TicketKey::name' data-ref="bssl::TicketKey::name" data-ref-filename="bssl..TicketKey..name">name</a>, <var>16</var>);</td></tr>
<tr><th id="494">494</th><td>  }</td></tr>
<tr><th id="495">495</th><td></td></tr>
<tr><th id="496">496</th><td>  <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> *<dfn class="local col9 decl" id="49ptr" title='ptr' data-type='uint8_t *' data-ref="49ptr" data-ref-filename="49ptr">ptr</dfn>;</td></tr>
<tr><th id="497">497</th><td>  <b>if</b> (!<a class="ref fn" href="../include/openssl/bytestring.h.html#CBB_add_bytes" title='CBB_add_bytes' data-ref="CBB_add_bytes" data-ref-filename="CBB_add_bytes">CBB_add_bytes</a>(<a class="local col8 ref" href="#38out" title='out' data-ref="38out" data-ref-filename="38out">out</a>, <a class="local col7 ref" href="#47key_name" title='key_name' data-ref="47key_name" data-ref-filename="47key_name">key_name</a>, <var>16</var>) ||</td></tr>
<tr><th id="498">498</th><td>      !<a class="ref fn" href="../include/openssl/bytestring.h.html#CBB_add_bytes" title='CBB_add_bytes' data-ref="CBB_add_bytes" data-ref-filename="CBB_add_bytes">CBB_add_bytes</a>(<a class="local col8 ref" href="#38out" title='out' data-ref="38out" data-ref-filename="38out">out</a>, <a class="local col6 ref" href="#46iv" title='iv' data-ref="46iv" data-ref-filename="46iv">iv</a>, <a class="ref fn" href="../include/openssl/cipher.h.html#EVP_CIPHER_CTX_iv_length" title='EVP_CIPHER_CTX_iv_length' data-ref="EVP_CIPHER_CTX_iv_length" data-ref-filename="EVP_CIPHER_CTX_iv_length">EVP_CIPHER_CTX_iv_length</a>(<a class="local col1 ref" href="#41ctx" title='ctx' data-ref="41ctx" data-ref-filename="41ctx">ctx</a>.<a class="ref fn" href="../include/openssl/base.h.html#_ZN4bssl8internal14StackAllocated3getEv" title='bssl::internal::StackAllocated::get' data-ref="_ZN4bssl8internal14StackAllocated3getEv" data-ref-filename="_ZN4bssl8internal14StackAllocated3getEv">get</a>())) ||</td></tr>
<tr><th id="499">499</th><td>      !<a class="ref fn" href="../include/openssl/bytestring.h.html#CBB_reserve" title='CBB_reserve' data-ref="CBB_reserve" data-ref-filename="CBB_reserve">CBB_reserve</a>(<a class="local col8 ref" href="#38out" title='out' data-ref="38out" data-ref-filename="38out">out</a>, &amp;<a class="local col9 ref" href="#49ptr" title='ptr' data-ref="49ptr" data-ref-filename="49ptr">ptr</a>, <a class="local col0 ref" href="#40session_len" title='session_len' data-ref="40session_len" data-ref-filename="40session_len">session_len</a> + <a class="macro" href="../include/openssl/cipher.h.html#516" title="32" data-ref="_M/EVP_MAX_BLOCK_LENGTH">EVP_MAX_BLOCK_LENGTH</a>)) {</td></tr>
<tr><th id="500">500</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="501">501</th><td>  }</td></tr>
<tr><th id="502">502</th><td></td></tr>
<tr><th id="503">503</th><td>  <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col0 decl" id="50total" title='total' data-type='size_t' data-ref="50total" data-ref-filename="50total">total</dfn> = <var>0</var>;</td></tr>
<tr><th id="504">504</th><td><u>#<span data-ppcond="504">if</span> defined(<span class="macro" data-ref="_M/BORINGSSL_UNSAFE_FUZZER_MODE">BORINGSSL_UNSAFE_FUZZER_MODE</span>)</u></td></tr>
<tr><th id="505">505</th><td>  OPENSSL_memcpy(ptr, session_buf, session_len);</td></tr>
<tr><th id="506">506</th><td>  total = session_len;</td></tr>
<tr><th id="507">507</th><td><u>#<span data-ppcond="504">else</span></u></td></tr>
<tr><th id="508">508</th><td>  <em>int</em> <dfn class="local col1 decl" id="51len" title='len' data-type='int' data-ref="51len" data-ref-filename="51len">len</dfn>;</td></tr>
<tr><th id="509">509</th><td>  <b>if</b> (!<a class="ref fn" href="../include/openssl/cipher.h.html#EVP_EncryptUpdate" title='EVP_EncryptUpdate' data-ref="EVP_EncryptUpdate" data-ref-filename="EVP_EncryptUpdate">EVP_EncryptUpdate</a>(<a class="local col1 ref" href="#41ctx" title='ctx' data-ref="41ctx" data-ref-filename="41ctx">ctx</a>.<a class="ref fn" href="../include/openssl/base.h.html#_ZN4bssl8internal14StackAllocated3getEv" title='bssl::internal::StackAllocated::get' data-ref="_ZN4bssl8internal14StackAllocated3getEv" data-ref-filename="_ZN4bssl8internal14StackAllocated3getEv">get</a>(), <a class="local col9 ref" href="#49ptr" title='ptr' data-ref="49ptr" data-ref-filename="49ptr">ptr</a> + <a class="local col0 ref" href="#50total" title='total' data-ref="50total" data-ref-filename="50total">total</a>, &amp;<a class="local col1 ref" href="#51len" title='len' data-ref="51len" data-ref-filename="51len">len</a>, <a class="local col9 ref" href="#39session_buf" title='session_buf' data-ref="39session_buf" data-ref-filename="39session_buf">session_buf</a>, <a class="local col0 ref" href="#40session_len" title='session_len' data-ref="40session_len" data-ref-filename="40session_len">session_len</a>)) {</td></tr>
<tr><th id="510">510</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="511">511</th><td>  }</td></tr>
<tr><th id="512">512</th><td>  <a class="local col0 ref" href="#50total" title='total' data-ref="50total" data-ref-filename="50total">total</a> += <a class="local col1 ref" href="#51len" title='len' data-ref="51len" data-ref-filename="51len">len</a>;</td></tr>
<tr><th id="513">513</th><td>  <b>if</b> (!<a class="ref fn" href="../include/openssl/cipher.h.html#EVP_EncryptFinal_ex" title='EVP_EncryptFinal_ex' data-ref="EVP_EncryptFinal_ex" data-ref-filename="EVP_EncryptFinal_ex">EVP_EncryptFinal_ex</a>(<a class="local col1 ref" href="#41ctx" title='ctx' data-ref="41ctx" data-ref-filename="41ctx">ctx</a>.<a class="ref fn" href="../include/openssl/base.h.html#_ZN4bssl8internal14StackAllocated3getEv" title='bssl::internal::StackAllocated::get' data-ref="_ZN4bssl8internal14StackAllocated3getEv" data-ref-filename="_ZN4bssl8internal14StackAllocated3getEv">get</a>(), <a class="local col9 ref" href="#49ptr" title='ptr' data-ref="49ptr" data-ref-filename="49ptr">ptr</a> + <a class="local col0 ref" href="#50total" title='total' data-ref="50total" data-ref-filename="50total">total</a>, &amp;<a class="local col1 ref" href="#51len" title='len' data-ref="51len" data-ref-filename="51len">len</a>)) {</td></tr>
<tr><th id="514">514</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="515">515</th><td>  }</td></tr>
<tr><th id="516">516</th><td>  <a class="local col0 ref" href="#50total" title='total' data-ref="50total" data-ref-filename="50total">total</a> += <a class="local col1 ref" href="#51len" title='len' data-ref="51len" data-ref-filename="51len">len</a>;</td></tr>
<tr><th id="517">517</th><td><u>#<span data-ppcond="504">endif</span></u></td></tr>
<tr><th id="518">518</th><td>  <b>if</b> (!<a class="ref fn" href="../include/openssl/bytestring.h.html#CBB_did_write" title='CBB_did_write' data-ref="CBB_did_write" data-ref-filename="CBB_did_write">CBB_did_write</a>(<a class="local col8 ref" href="#38out" title='out' data-ref="38out" data-ref-filename="38out">out</a>, <a class="local col0 ref" href="#50total" title='total' data-ref="50total" data-ref-filename="50total">total</a>)) {</td></tr>
<tr><th id="519">519</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="520">520</th><td>  }</td></tr>
<tr><th id="521">521</th><td></td></tr>
<tr><th id="522">522</th><td>  <em>unsigned</em> <dfn class="local col2 decl" id="52hlen" title='hlen' data-type='unsigned int' data-ref="52hlen" data-ref-filename="52hlen">hlen</dfn>;</td></tr>
<tr><th id="523">523</th><td>  <b>if</b> (!<a class="ref fn" href="../include/openssl/hmac.h.html#HMAC_Update" title='HMAC_Update' data-ref="HMAC_Update" data-ref-filename="HMAC_Update">HMAC_Update</a>(<a class="local col2 ref" href="#42hctx" title='hctx' data-ref="42hctx" data-ref-filename="42hctx">hctx</a>.<a class="ref fn" href="../include/openssl/base.h.html#_ZN4bssl8internal14StackAllocated3getEv" title='bssl::internal::StackAllocated::get' data-ref="_ZN4bssl8internal14StackAllocated3getEv" data-ref-filename="_ZN4bssl8internal14StackAllocated3getEv">get</a>(), <a class="ref fn" href="../include/openssl/bytestring.h.html#CBB_data" title='CBB_data' data-ref="CBB_data" data-ref-filename="CBB_data">CBB_data</a>(<a class="local col8 ref" href="#38out" title='out' data-ref="38out" data-ref-filename="38out">out</a>), <a class="ref fn" href="../include/openssl/bytestring.h.html#CBB_len" title='CBB_len' data-ref="CBB_len" data-ref-filename="CBB_len">CBB_len</a>(<a class="local col8 ref" href="#38out" title='out' data-ref="38out" data-ref-filename="38out">out</a>)) ||</td></tr>
<tr><th id="524">524</th><td>      !<a class="ref fn" href="../include/openssl/bytestring.h.html#CBB_reserve" title='CBB_reserve' data-ref="CBB_reserve" data-ref-filename="CBB_reserve">CBB_reserve</a>(<a class="local col8 ref" href="#38out" title='out' data-ref="38out" data-ref-filename="38out">out</a>, &amp;<a class="local col9 ref" href="#49ptr" title='ptr' data-ref="49ptr" data-ref-filename="49ptr">ptr</a>, <a class="macro" href="../include/openssl/digest.h.html#152" title="64" data-ref="_M/EVP_MAX_MD_SIZE">EVP_MAX_MD_SIZE</a>) ||</td></tr>
<tr><th id="525">525</th><td>      !<a class="ref fn" href="../include/openssl/hmac.h.html#HMAC_Final" title='HMAC_Final' data-ref="HMAC_Final" data-ref-filename="HMAC_Final">HMAC_Final</a>(<a class="local col2 ref" href="#42hctx" title='hctx' data-ref="42hctx" data-ref-filename="42hctx">hctx</a>.<a class="ref fn" href="../include/openssl/base.h.html#_ZN4bssl8internal14StackAllocated3getEv" title='bssl::internal::StackAllocated::get' data-ref="_ZN4bssl8internal14StackAllocated3getEv" data-ref-filename="_ZN4bssl8internal14StackAllocated3getEv">get</a>(), <a class="local col9 ref" href="#49ptr" title='ptr' data-ref="49ptr" data-ref-filename="49ptr">ptr</a>, &amp;<a class="local col2 ref" href="#52hlen" title='hlen' data-ref="52hlen" data-ref-filename="52hlen">hlen</a>) ||</td></tr>
<tr><th id="526">526</th><td>      !<a class="ref fn" href="../include/openssl/bytestring.h.html#CBB_did_write" title='CBB_did_write' data-ref="CBB_did_write" data-ref-filename="CBB_did_write">CBB_did_write</a>(<a class="local col8 ref" href="#38out" title='out' data-ref="38out" data-ref-filename="38out">out</a>, <a class="local col2 ref" href="#52hlen" title='hlen' data-ref="52hlen" data-ref-filename="52hlen">hlen</a>)) {</td></tr>
<tr><th id="527">527</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="528">528</th><td>  }</td></tr>
<tr><th id="529">529</th><td></td></tr>
<tr><th id="530">530</th><td>  <b>return</b> <var>1</var>;</td></tr>
<tr><th id="531">531</th><td>}</td></tr>
<tr><th id="532">532</th><td></td></tr>
<tr><th id="533">533</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="_ZN4bsslL30ssl_encrypt_ticket_with_methodEPNS_13SSL_HANDSHAKEEP6cbb_stPKhm" title='bssl::ssl_encrypt_ticket_with_method' data-type='int bssl::ssl_encrypt_ticket_with_method(bssl::SSL_HANDSHAKE * hs, CBB * out, const uint8_t * session_buf, size_t session_len)' data-ref="_ZN4bsslL30ssl_encrypt_ticket_with_methodEPNS_13SSL_HANDSHAKEEP6cbb_stPKhm" data-ref-filename="_ZN4bsslL30ssl_encrypt_ticket_with_methodEPNS_13SSL_HANDSHAKEEP6cbb_stPKhm">ssl_encrypt_ticket_with_method</dfn>(<a class="type" href="internal.h.html#bssl::SSL_HANDSHAKE" title='bssl::SSL_HANDSHAKE' data-ref="bssl::SSL_HANDSHAKE" data-ref-filename="bssl..SSL_HANDSHAKE">SSL_HANDSHAKE</a> *<dfn class="local col3 decl" id="53hs" title='hs' data-type='bssl::SSL_HANDSHAKE *' data-ref="53hs" data-ref-filename="53hs">hs</dfn>, <a class="typedef" href="../include/openssl/base.h.html#CBB" title='CBB' data-type='struct cbb_st' data-ref="CBB" data-ref-filename="CBB">CBB</a> *<dfn class="local col4 decl" id="54out" title='out' data-type='CBB *' data-ref="54out" data-ref-filename="54out">out</dfn>,</td></tr>
<tr><th id="534">534</th><td>                                          <em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> *<dfn class="local col5 decl" id="55session_buf" title='session_buf' data-type='const uint8_t *' data-ref="55session_buf" data-ref-filename="55session_buf">session_buf</dfn>,</td></tr>
<tr><th id="535">535</th><td>                                          <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col6 decl" id="56session_len" title='session_len' data-type='size_t' data-ref="56session_len" data-ref-filename="56session_len">session_len</dfn>) {</td></tr>
<tr><th id="536">536</th><td>  <a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<em>const</em> <dfn class="local col7 decl" id="57ssl" title='ssl' data-type='SSL *const' data-ref="57ssl" data-ref-filename="57ssl">ssl</dfn> = <a class="local col3 ref" href="#53hs" title='hs' data-ref="53hs" data-ref-filename="53hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::ssl" title='bssl::SSL_HANDSHAKE::ssl' data-ref="bssl::SSL_HANDSHAKE::ssl" data-ref-filename="bssl..SSL_HANDSHAKE..ssl">ssl</a>;</td></tr>
<tr><th id="537">537</th><td>  <em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_TICKET_AEAD_METHOD" title='SSL_TICKET_AEAD_METHOD' data-type='struct ssl_ticket_aead_method_st' data-ref="SSL_TICKET_AEAD_METHOD" data-ref-filename="SSL_TICKET_AEAD_METHOD">SSL_TICKET_AEAD_METHOD</a> *<dfn class="local col8 decl" id="58method" title='method' data-type='const SSL_TICKET_AEAD_METHOD *' data-ref="58method" data-ref-filename="58method">method</dfn> = <a class="local col7 ref" href="#57ssl" title='ssl' data-ref="57ssl" data-ref-filename="57ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session_ctx" title='ssl_st::session_ctx' data-ref="ssl_st::session_ctx" data-ref-filename="ssl_st..session_ctx">session_ctx</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_aead_method" title='ssl_ctx_st::ticket_aead_method' data-ref="ssl_ctx_st::ticket_aead_method" data-ref-filename="ssl_ctx_st..ticket_aead_method">ticket_aead_method</a>;</td></tr>
<tr><th id="538">538</th><td>  <em>const</em> <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col9 decl" id="59max_overhead" title='max_overhead' data-type='const size_t' data-ref="59max_overhead" data-ref-filename="59max_overhead">max_overhead</dfn> = <a class="local col8 ref" href="#58method" title='method' data-ref="58method" data-ref-filename="58method">method</a>-&gt;<a class="ref field" href="../include/openssl/ssl.h.html#ssl_ticket_aead_method_st::max_overhead" title='ssl_ticket_aead_method_st::max_overhead' data-ref="ssl_ticket_aead_method_st::max_overhead" data-ref-filename="ssl_ticket_aead_method_st..max_overhead">max_overhead</a>(<a class="local col7 ref" href="#57ssl" title='ssl' data-ref="57ssl" data-ref-filename="57ssl">ssl</a>);</td></tr>
<tr><th id="539">539</th><td>  <em>const</em> <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col0 decl" id="60max_out" title='max_out' data-type='const size_t' data-ref="60max_out" data-ref-filename="60max_out">max_out</dfn> = <a class="local col6 ref" href="#56session_len" title='session_len' data-ref="56session_len" data-ref-filename="56session_len">session_len</a> + <a class="local col9 ref" href="#59max_overhead" title='max_overhead' data-ref="59max_overhead" data-ref-filename="59max_overhead">max_overhead</a>;</td></tr>
<tr><th id="540">540</th><td>  <b>if</b> (<a class="local col0 ref" href="#60max_out" title='max_out' data-ref="60max_out" data-ref-filename="60max_out">max_out</a> &lt; <a class="local col9 ref" href="#59max_overhead" title='max_overhead' data-ref="59max_overhead" data-ref-filename="59max_overhead">max_overhead</a>) {</td></tr>
<tr><th id="541">541</th><td>    <a class="macro" href="../include/openssl/err.h.html#423" title="ERR_put_error(ERR_LIB_SSL, 0, (5 | 64), &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/third_party/boringssl/src/ssl/ssl_session.cc&quot;, 541)" data-ref="_M/OPENSSL_PUT_ERROR">OPENSSL_PUT_ERROR</a>(SSL, <a class="macro" href="../include/openssl/err.h.html#375" title="(5 | 64)" data-ref="_M/ERR_R_OVERFLOW">ERR_R_OVERFLOW</a>);</td></tr>
<tr><th id="542">542</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="543">543</th><td>  }</td></tr>
<tr><th id="544">544</th><td></td></tr>
<tr><th id="545">545</th><td>  <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> *<dfn class="local col1 decl" id="61ptr" title='ptr' data-type='uint8_t *' data-ref="61ptr" data-ref-filename="61ptr">ptr</dfn>;</td></tr>
<tr><th id="546">546</th><td>  <b>if</b> (!<a class="ref fn" href="../include/openssl/bytestring.h.html#CBB_reserve" title='CBB_reserve' data-ref="CBB_reserve" data-ref-filename="CBB_reserve">CBB_reserve</a>(<a class="local col4 ref" href="#54out" title='out' data-ref="54out" data-ref-filename="54out">out</a>, &amp;<a class="local col1 ref" href="#61ptr" title='ptr' data-ref="61ptr" data-ref-filename="61ptr">ptr</a>, <a class="local col0 ref" href="#60max_out" title='max_out' data-ref="60max_out" data-ref-filename="60max_out">max_out</a>)) {</td></tr>
<tr><th id="547">547</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="548">548</th><td>  }</td></tr>
<tr><th id="549">549</th><td></td></tr>
<tr><th id="550">550</th><td>  <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col2 decl" id="62out_len" title='out_len' data-type='size_t' data-ref="62out_len" data-ref-filename="62out_len">out_len</dfn>;</td></tr>
<tr><th id="551">551</th><td>  <b>if</b> (!<a class="local col8 ref" href="#58method" title='method' data-ref="58method" data-ref-filename="58method">method</a>-&gt;<a class="ref field" href="../include/openssl/ssl.h.html#ssl_ticket_aead_method_st::seal" title='ssl_ticket_aead_method_st::seal' data-ref="ssl_ticket_aead_method_st::seal" data-ref-filename="ssl_ticket_aead_method_st..seal">seal</a>(<a class="local col7 ref" href="#57ssl" title='ssl' data-ref="57ssl" data-ref-filename="57ssl">ssl</a>, <a class="local col1 ref" href="#61ptr" title='ptr' data-ref="61ptr" data-ref-filename="61ptr">ptr</a>, &amp;<a class="local col2 ref" href="#62out_len" title='out_len' data-ref="62out_len" data-ref-filename="62out_len">out_len</a>, <a class="local col0 ref" href="#60max_out" title='max_out' data-ref="60max_out" data-ref-filename="60max_out">max_out</a>, <a class="local col5 ref" href="#55session_buf" title='session_buf' data-ref="55session_buf" data-ref-filename="55session_buf">session_buf</a>,</td></tr>
<tr><th id="552">552</th><td>                    <a class="local col6 ref" href="#56session_len" title='session_len' data-ref="56session_len" data-ref-filename="56session_len">session_len</a>)) {</td></tr>
<tr><th id="553">553</th><td>    <a class="macro" href="../include/openssl/err.h.html#423" title="ERR_put_error(ERR_LIB_SSL, 0, 276, &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/third_party/boringssl/src/ssl/ssl_session.cc&quot;, 553)" data-ref="_M/OPENSSL_PUT_ERROR">OPENSSL_PUT_ERROR</a>(SSL, <a class="macro" href="../include/openssl/ssl.h.html#5446" title="276" data-ref="_M/SSL_R_TICKET_ENCRYPTION_FAILED">SSL_R_TICKET_ENCRYPTION_FAILED</a>);</td></tr>
<tr><th id="554">554</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="555">555</th><td>  }</td></tr>
<tr><th id="556">556</th><td></td></tr>
<tr><th id="557">557</th><td>  <b>if</b> (!<a class="ref fn" href="../include/openssl/bytestring.h.html#CBB_did_write" title='CBB_did_write' data-ref="CBB_did_write" data-ref-filename="CBB_did_write">CBB_did_write</a>(<a class="local col4 ref" href="#54out" title='out' data-ref="54out" data-ref-filename="54out">out</a>, <a class="local col2 ref" href="#62out_len" title='out_len' data-ref="62out_len" data-ref-filename="62out_len">out_len</a>)) {</td></tr>
<tr><th id="558">558</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="559">559</th><td>  }</td></tr>
<tr><th id="560">560</th><td></td></tr>
<tr><th id="561">561</th><td>  <b>return</b> <var>1</var>;</td></tr>
<tr><th id="562">562</th><td>}</td></tr>
<tr><th id="563">563</th><td></td></tr>
<tr><th id="564">564</th><td><em>int</em> <dfn class="decl def fn" id="_ZN4bssl18ssl_encrypt_ticketEPNS_13SSL_HANDSHAKEEP6cbb_stPK14ssl_session_st" title='bssl::ssl_encrypt_ticket' data-ref="_ZN4bssl18ssl_encrypt_ticketEPNS_13SSL_HANDSHAKEEP6cbb_stPK14ssl_session_st" data-ref-filename="_ZN4bssl18ssl_encrypt_ticketEPNS_13SSL_HANDSHAKEEP6cbb_stPK14ssl_session_st">ssl_encrypt_ticket</dfn>(<a class="type" href="internal.h.html#bssl::SSL_HANDSHAKE" title='bssl::SSL_HANDSHAKE' data-ref="bssl::SSL_HANDSHAKE" data-ref-filename="bssl..SSL_HANDSHAKE">SSL_HANDSHAKE</a> *<dfn class="local col3 decl" id="63hs" title='hs' data-type='bssl::SSL_HANDSHAKE *' data-ref="63hs" data-ref-filename="63hs">hs</dfn>, <a class="typedef" href="../include/openssl/base.h.html#CBB" title='CBB' data-type='struct cbb_st' data-ref="CBB" data-ref-filename="CBB">CBB</a> *<dfn class="local col4 decl" id="64out" title='out' data-type='CBB *' data-ref="64out" data-ref-filename="64out">out</dfn>,</td></tr>
<tr><th id="565">565</th><td>                       <em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col5 decl" id="65session" title='session' data-type='const SSL_SESSION *' data-ref="65session" data-ref-filename="65session">session</dfn>) {</td></tr>
<tr><th id="566">566</th><td>  <i>// Serialize the SSL_SESSION to be encoded into the ticket.</i></td></tr>
<tr><th id="567">567</th><td>  <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> *<dfn class="local col6 decl" id="66session_buf" title='session_buf' data-type='uint8_t *' data-ref="66session_buf" data-ref-filename="66session_buf">session_buf</dfn> = <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="568">568</th><td>  <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col7 decl" id="67session_len" title='session_len' data-type='size_t' data-ref="67session_len" data-ref-filename="67session_len">session_len</dfn>;</td></tr>
<tr><th id="569">569</th><td>  <b>if</b> (!<a class="ref fn" href="../include/openssl/ssl.h.html#SSL_SESSION_to_bytes_for_ticket" title='SSL_SESSION_to_bytes_for_ticket' data-ref="SSL_SESSION_to_bytes_for_ticket" data-ref-filename="SSL_SESSION_to_bytes_for_ticket">SSL_SESSION_to_bytes_for_ticket</a>(<a class="local col5 ref" href="#65session" title='session' data-ref="65session" data-ref-filename="65session">session</a>, &amp;<a class="local col6 ref" href="#66session_buf" title='session_buf' data-ref="66session_buf" data-ref-filename="66session_buf">session_buf</a>, &amp;<a class="local col7 ref" href="#67session_len" title='session_len' data-ref="67session_len" data-ref-filename="67session_len">session_len</a>)) {</td></tr>
<tr><th id="570">570</th><td>    <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="571">571</th><td>  }</td></tr>
<tr><th id="572">572</th><td></td></tr>
<tr><th id="573">573</th><td>  <em>int</em> <dfn class="local col8 decl" id="68ret" title='ret' data-type='int' data-ref="68ret" data-ref-filename="68ret">ret</dfn> = <var>0</var>;</td></tr>
<tr><th id="574">574</th><td>  <b>if</b> (<a class="local col3 ref" href="#63hs" title='hs' data-ref="63hs" data-ref-filename="63hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::ssl" title='bssl::SSL_HANDSHAKE::ssl' data-ref="bssl::SSL_HANDSHAKE::ssl" data-ref-filename="bssl..SSL_HANDSHAKE..ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session_ctx" title='ssl_st::session_ctx' data-ref="ssl_st::session_ctx" data-ref-filename="ssl_st..session_ctx">session_ctx</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_ctx_st::ticket_aead_method" title='ssl_ctx_st::ticket_aead_method' data-ref="ssl_ctx_st::ticket_aead_method" data-ref-filename="ssl_ctx_st..ticket_aead_method">ticket_aead_method</a>) {</td></tr>
<tr><th id="575">575</th><td>    <a class="local col8 ref" href="#68ret" title='ret' data-ref="68ret" data-ref-filename="68ret">ret</a> = <a class="tu ref fn" href="#_ZN4bsslL30ssl_encrypt_ticket_with_methodEPNS_13SSL_HANDSHAKEEP6cbb_stPKhm" title='bssl::ssl_encrypt_ticket_with_method' data-use='c' data-ref="_ZN4bsslL30ssl_encrypt_ticket_with_methodEPNS_13SSL_HANDSHAKEEP6cbb_stPKhm" data-ref-filename="_ZN4bsslL30ssl_encrypt_ticket_with_methodEPNS_13SSL_HANDSHAKEEP6cbb_stPKhm">ssl_encrypt_ticket_with_method</a>(<a class="local col3 ref" href="#63hs" title='hs' data-ref="63hs" data-ref-filename="63hs">hs</a>, <a class="local col4 ref" href="#64out" title='out' data-ref="64out" data-ref-filename="64out">out</a>, <a class="local col6 ref" href="#66session_buf" title='session_buf' data-ref="66session_buf" data-ref-filename="66session_buf">session_buf</a>, <a class="local col7 ref" href="#67session_len" title='session_len' data-ref="67session_len" data-ref-filename="67session_len">session_len</a>);</td></tr>
<tr><th id="576">576</th><td>  } <b>else</b> {</td></tr>
<tr><th id="577">577</th><td>    <a class="local col8 ref" href="#68ret" title='ret' data-ref="68ret" data-ref-filename="68ret">ret</a> = <a class="tu ref fn" href="#_ZN4bsslL34ssl_encrypt_ticket_with_cipher_ctxEPNS_13SSL_HANDSHAKEEP6cbb_stPKhm" title='bssl::ssl_encrypt_ticket_with_cipher_ctx' data-use='c' data-ref="_ZN4bsslL34ssl_encrypt_ticket_with_cipher_ctxEPNS_13SSL_HANDSHAKEEP6cbb_stPKhm" data-ref-filename="_ZN4bsslL34ssl_encrypt_ticket_with_cipher_ctxEPNS_13SSL_HANDSHAKEEP6cbb_stPKhm">ssl_encrypt_ticket_with_cipher_ctx</a>(<a class="local col3 ref" href="#63hs" title='hs' data-ref="63hs" data-ref-filename="63hs">hs</a>, <a class="local col4 ref" href="#64out" title='out' data-ref="64out" data-ref-filename="64out">out</a>, <a class="local col6 ref" href="#66session_buf" title='session_buf' data-ref="66session_buf" data-ref-filename="66session_buf">session_buf</a>, <a class="local col7 ref" href="#67session_len" title='session_len' data-ref="67session_len" data-ref-filename="67session_len">session_len</a>);</td></tr>
<tr><th id="578">578</th><td>  }</td></tr>
<tr><th id="579">579</th><td></td></tr>
<tr><th id="580">580</th><td>  <a class="ref fn" href="../include/openssl/mem.h.html#OPENSSL_free" title='OPENSSL_free' data-ref="OPENSSL_free" data-ref-filename="OPENSSL_free">OPENSSL_free</a>(<a class="local col6 ref" href="#66session_buf" title='session_buf' data-ref="66session_buf" data-ref-filename="66session_buf">session_buf</a>);</td></tr>
<tr><th id="581">581</th><td>  <b>return</b> <a class="local col8 ref" href="#68ret" title='ret' data-ref="68ret" data-ref-filename="68ret">ret</a>;</td></tr>
<tr><th id="582">582</th><td>}</td></tr>
<tr><th id="583">583</th><td></td></tr>
<tr><th id="584">584</th><td><em>int</em> <dfn class="decl def fn" id="_ZN4bssl28ssl_session_is_context_validEPKNS_13SSL_HANDSHAKEEPK14ssl_session_st" title='bssl::ssl_session_is_context_valid' data-ref="_ZN4bssl28ssl_session_is_context_validEPKNS_13SSL_HANDSHAKEEPK14ssl_session_st" data-ref-filename="_ZN4bssl28ssl_session_is_context_validEPKNS_13SSL_HANDSHAKEEPK14ssl_session_st">ssl_session_is_context_valid</dfn>(<em>const</em> <a class="type" href="internal.h.html#bssl::SSL_HANDSHAKE" title='bssl::SSL_HANDSHAKE' data-ref="bssl::SSL_HANDSHAKE" data-ref-filename="bssl..SSL_HANDSHAKE">SSL_HANDSHAKE</a> *<dfn class="local col9 decl" id="69hs" title='hs' data-type='const bssl::SSL_HANDSHAKE *' data-ref="69hs" data-ref-filename="69hs">hs</dfn>,</td></tr>
<tr><th id="585">585</th><td>                                 <em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col0 decl" id="70session" title='session' data-type='const SSL_SESSION *' data-ref="70session" data-ref-filename="70session">session</dfn>) {</td></tr>
<tr><th id="586">586</th><td>  <b>if</b> (<a class="local col0 ref" href="#70session" title='session' data-ref="70session" data-ref-filename="70session">session</a> == <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="587">587</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="588">588</th><td>  }</td></tr>
<tr><th id="589">589</th><td></td></tr>
<tr><th id="590">590</th><td>  <b>return</b> <a class="local col0 ref" href="#70session" title='session' data-ref="70session" data-ref-filename="70session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx_length" title='ssl_session_st::sid_ctx_length' data-ref="ssl_session_st::sid_ctx_length" data-ref-filename="ssl_session_st..sid_ctx_length">sid_ctx_length</a> == <a class="local col9 ref" href="#69hs" title='hs' data-ref="69hs" data-ref-filename="69hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::config" title='bssl::SSL_HANDSHAKE::config' data-ref="bssl::SSL_HANDSHAKE::config" data-ref-filename="bssl..SSL_HANDSHAKE..config">config</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_CONFIG::cert" title='bssl::SSL_CONFIG::cert' data-ref="bssl::SSL_CONFIG::cert" data-ref-filename="bssl..SSL_CONFIG..cert">cert</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::CERT::sid_ctx_length" title='bssl::CERT::sid_ctx_length' data-ref="bssl::CERT::sid_ctx_length" data-ref-filename="bssl..CERT..sid_ctx_length">sid_ctx_length</a> &amp;&amp;</td></tr>
<tr><th id="591">591</th><td>         <a class="ref fn" href="../crypto/internal.h.html#_ZL14OPENSSL_memcmpPKvS0_m" title='OPENSSL_memcmp' data-ref="_ZL14OPENSSL_memcmpPKvS0_m" data-ref-filename="_ZL14OPENSSL_memcmpPKvS0_m">OPENSSL_memcmp</a>(<a class="local col0 ref" href="#70session" title='session' data-ref="70session" data-ref-filename="70session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx" title='ssl_session_st::sid_ctx' data-ref="ssl_session_st::sid_ctx" data-ref-filename="ssl_session_st..sid_ctx">sid_ctx</a>, <a class="local col9 ref" href="#69hs" title='hs' data-ref="69hs" data-ref-filename="69hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::config" title='bssl::SSL_HANDSHAKE::config' data-ref="bssl::SSL_HANDSHAKE::config" data-ref-filename="bssl..SSL_HANDSHAKE..config">config</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_CONFIG::cert" title='bssl::SSL_CONFIG::cert' data-ref="bssl::SSL_CONFIG::cert" data-ref-filename="bssl..SSL_CONFIG..cert">cert</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::CERT::sid_ctx" title='bssl::CERT::sid_ctx' data-ref="bssl::CERT::sid_ctx" data-ref-filename="bssl..CERT..sid_ctx">sid_ctx</a>,</td></tr>
<tr><th id="592">592</th><td>                        <a class="local col9 ref" href="#69hs" title='hs' data-ref="69hs" data-ref-filename="69hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::config" title='bssl::SSL_HANDSHAKE::config' data-ref="bssl::SSL_HANDSHAKE::config" data-ref-filename="bssl..SSL_HANDSHAKE..config">config</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_CONFIG::cert" title='bssl::SSL_CONFIG::cert' data-ref="bssl::SSL_CONFIG::cert" data-ref-filename="bssl..SSL_CONFIG..cert">cert</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::CERT::sid_ctx_length" title='bssl::CERT::sid_ctx_length' data-ref="bssl::CERT::sid_ctx_length" data-ref-filename="bssl..CERT..sid_ctx_length">sid_ctx_length</a>) == <var>0</var>;</td></tr>
<tr><th id="593">593</th><td>}</td></tr>
<tr><th id="594">594</th><td></td></tr>
<tr><th id="595">595</th><td><em>int</em> <dfn class="decl def fn" id="_ZN4bssl25ssl_session_is_time_validEPK6ssl_stPK14ssl_session_st" title='bssl::ssl_session_is_time_valid' data-ref="_ZN4bssl25ssl_session_is_time_validEPK6ssl_stPK14ssl_session_st" data-ref-filename="_ZN4bssl25ssl_session_is_time_validEPK6ssl_stPK14ssl_session_st">ssl_session_is_time_valid</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<dfn class="local col1 decl" id="71ssl" title='ssl' data-type='const SSL *' data-ref="71ssl" data-ref-filename="71ssl">ssl</dfn>, <em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col2 decl" id="72session" title='session' data-type='const SSL_SESSION *' data-ref="72session" data-ref-filename="72session">session</dfn>) {</td></tr>
<tr><th id="596">596</th><td>  <b>if</b> (<a class="local col2 ref" href="#72session" title='session' data-ref="72session" data-ref-filename="72session">session</a> == <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="597">597</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="598">598</th><td>  }</td></tr>
<tr><th id="599">599</th><td></td></tr>
<tr><th id="600">600</th><td>  <b>struct</b> <a class="type" href="internal.h.html#bssl::OPENSSL_timeval" title='bssl::OPENSSL_timeval' data-ref="bssl::OPENSSL_timeval" data-ref-filename="bssl..OPENSSL_timeval">OPENSSL_timeval</a> <a class="ref fn fake" href="internal.h.html#2735" title='bssl::OPENSSL_timeval::OPENSSL_timeval' data-ref="_ZN4bssl15OPENSSL_timevalC1Ev" data-ref-filename="_ZN4bssl15OPENSSL_timevalC1Ev"></a><dfn class="local col3 decl" id="73now" title='now' data-type='struct OPENSSL_timeval' data-ref="73now" data-ref-filename="73now">now</dfn>;</td></tr>
<tr><th id="601">601</th><td>  <a class="ref fn" href="internal.h.html#_ZN4bssl20ssl_get_current_timeEPK6ssl_stPNS_15OPENSSL_timevalE" title='bssl::ssl_get_current_time' data-ref="_ZN4bssl20ssl_get_current_timeEPK6ssl_stPNS_15OPENSSL_timevalE" data-ref-filename="_ZN4bssl20ssl_get_current_timeEPK6ssl_stPNS_15OPENSSL_timevalE">ssl_get_current_time</a>(<a class="local col1 ref" href="#71ssl" title='ssl' data-ref="71ssl" data-ref-filename="71ssl">ssl</a>, &amp;<a class="local col3 ref" href="#73now" title='now' data-ref="73now" data-ref-filename="73now">now</a>);</td></tr>
<tr><th id="602">602</th><td></td></tr>
<tr><th id="603">603</th><td>  <i>// Reject tickets from the future to avoid underflow.</i></td></tr>
<tr><th id="604">604</th><td>  <b>if</b> (<a class="local col3 ref" href="#73now" title='now' data-ref="73now" data-ref-filename="73now">now</a>.<a class="ref field" href="internal.h.html#bssl::OPENSSL_timeval::tv_sec" title='bssl::OPENSSL_timeval::tv_sec' data-ref="bssl::OPENSSL_timeval::tv_sec" data-ref-filename="bssl..OPENSSL_timeval..tv_sec">tv_sec</a> &lt; <a class="local col2 ref" href="#72session" title='session' data-ref="72session" data-ref-filename="72session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::time" title='ssl_session_st::time' data-ref="ssl_session_st::time" data-ref-filename="ssl_session_st..time">time</a>) {</td></tr>
<tr><th id="605">605</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="606">606</th><td>  }</td></tr>
<tr><th id="607">607</th><td></td></tr>
<tr><th id="608">608</th><td>  <b>return</b> <a class="local col2 ref" href="#72session" title='session' data-ref="72session" data-ref-filename="72session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a> &gt; <a class="local col3 ref" href="#73now" title='now' data-ref="73now" data-ref-filename="73now">now</a>.<a class="ref field" href="internal.h.html#bssl::OPENSSL_timeval::tv_sec" title='bssl::OPENSSL_timeval::tv_sec' data-ref="bssl::OPENSSL_timeval::tv_sec" data-ref-filename="bssl..OPENSSL_timeval..tv_sec">tv_sec</a> - <a class="local col2 ref" href="#72session" title='session' data-ref="72session" data-ref-filename="72session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::time" title='ssl_session_st::time' data-ref="ssl_session_st::time" data-ref-filename="ssl_session_st..time">time</a>;</td></tr>
<tr><th id="609">609</th><td>}</td></tr>
<tr><th id="610">610</th><td></td></tr>
<tr><th id="611">611</th><td><em>int</em> <dfn class="decl def fn" id="_ZN4bssl24ssl_session_is_resumableEPKNS_13SSL_HANDSHAKEEPK14ssl_session_st" title='bssl::ssl_session_is_resumable' data-ref="_ZN4bssl24ssl_session_is_resumableEPKNS_13SSL_HANDSHAKEEPK14ssl_session_st" data-ref-filename="_ZN4bssl24ssl_session_is_resumableEPKNS_13SSL_HANDSHAKEEPK14ssl_session_st">ssl_session_is_resumable</dfn>(<em>const</em> <a class="type" href="internal.h.html#bssl::SSL_HANDSHAKE" title='bssl::SSL_HANDSHAKE' data-ref="bssl::SSL_HANDSHAKE" data-ref-filename="bssl..SSL_HANDSHAKE">SSL_HANDSHAKE</a> *<dfn class="local col4 decl" id="74hs" title='hs' data-type='const bssl::SSL_HANDSHAKE *' data-ref="74hs" data-ref-filename="74hs">hs</dfn>,</td></tr>
<tr><th id="612">612</th><td>                             <em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col5 decl" id="75session" title='session' data-type='const SSL_SESSION *' data-ref="75session" data-ref-filename="75session">session</dfn>) {</td></tr>
<tr><th id="613">613</th><td>  <em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<em>const</em> <dfn class="local col6 decl" id="76ssl" title='ssl' data-type='const SSL *const' data-ref="76ssl" data-ref-filename="76ssl">ssl</dfn> = <a class="local col4 ref" href="#74hs" title='hs' data-ref="74hs" data-ref-filename="74hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::ssl" title='bssl::SSL_HANDSHAKE::ssl' data-ref="bssl::SSL_HANDSHAKE::ssl" data-ref-filename="bssl..SSL_HANDSHAKE..ssl">ssl</a>;</td></tr>
<tr><th id="614">614</th><td>  <b>return</b> <a class="ref fn" href="#_ZN4bssl28ssl_session_is_context_validEPKNS_13SSL_HANDSHAKEEPK14ssl_session_st" title='bssl::ssl_session_is_context_valid' data-ref="_ZN4bssl28ssl_session_is_context_validEPKNS_13SSL_HANDSHAKEEPK14ssl_session_st" data-ref-filename="_ZN4bssl28ssl_session_is_context_validEPKNS_13SSL_HANDSHAKEEPK14ssl_session_st">ssl_session_is_context_valid</a>(<a class="local col4 ref" href="#74hs" title='hs' data-ref="74hs" data-ref-filename="74hs">hs</a>, <a class="local col5 ref" href="#75session" title='session' data-ref="75session" data-ref-filename="75session">session</a>) &amp;&amp;</td></tr>
<tr><th id="615">615</th><td>         <i>// The session must have been created by the same type of end point as</i></td></tr>
<tr><th id="616">616</th><td><i>         // we're now using it with.</i></td></tr>
<tr><th id="617">617</th><td>         <a class="local col6 ref" href="#76ssl" title='ssl' data-ref="76ssl" data-ref-filename="76ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::server" title='ssl_st::server' data-ref="ssl_st::server" data-ref-filename="ssl_st..server">server</a> == <a class="local col5 ref" href="#75session" title='session' data-ref="75session" data-ref-filename="75session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::is_server" title='ssl_session_st::is_server' data-ref="ssl_session_st::is_server" data-ref-filename="ssl_session_st..is_server">is_server</a> &amp;&amp;</td></tr>
<tr><th id="618">618</th><td>         <i>// The session must not be expired.</i></td></tr>
<tr><th id="619">619</th><td>         <a class="ref fn" href="#_ZN4bssl25ssl_session_is_time_validEPK6ssl_stPK14ssl_session_st" title='bssl::ssl_session_is_time_valid' data-ref="_ZN4bssl25ssl_session_is_time_validEPK6ssl_stPK14ssl_session_st" data-ref-filename="_ZN4bssl25ssl_session_is_time_validEPK6ssl_stPK14ssl_session_st">ssl_session_is_time_valid</a>(<a class="local col6 ref" href="#76ssl" title='ssl' data-ref="76ssl" data-ref-filename="76ssl">ssl</a>, <a class="local col5 ref" href="#75session" title='session' data-ref="75session" data-ref-filename="75session">session</a>) &amp;&amp;</td></tr>
<tr><th id="620">620</th><td>         <i>// Only resume if the session's version matches the negotiated</i></td></tr>
<tr><th id="621">621</th><td><i>         // version.</i></td></tr>
<tr><th id="622">622</th><td>         <a class="local col6 ref" href="#76ssl" title='ssl' data-ref="76ssl" data-ref-filename="76ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::version" title='ssl_st::version' data-ref="ssl_st::version" data-ref-filename="ssl_st..version">version</a> == <a class="local col5 ref" href="#75session" title='session' data-ref="75session" data-ref-filename="75session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ssl_version" title='ssl_session_st::ssl_version' data-ref="ssl_session_st::ssl_version" data-ref-filename="ssl_session_st..ssl_version">ssl_version</a> &amp;&amp;</td></tr>
<tr><th id="623">623</th><td>         <i>// Only resume if the session's cipher matches the negotiated one. This</i></td></tr>
<tr><th id="624">624</th><td><i>         // is stricter than necessary for TLS 1.3, which allows cross-cipher</i></td></tr>
<tr><th id="625">625</th><td><i>         // resumption if the PRF hashes match. We require an exact match for</i></td></tr>
<tr><th id="626">626</th><td><i>         // simplicity. If loosening this, the 0-RTT accept logic must be</i></td></tr>
<tr><th id="627">627</th><td><i>         // updated to check the cipher.</i></td></tr>
<tr><th id="628">628</th><td>         <a class="local col4 ref" href="#74hs" title='hs' data-ref="74hs" data-ref-filename="74hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::new_cipher" title='bssl::SSL_HANDSHAKE::new_cipher' data-ref="bssl::SSL_HANDSHAKE::new_cipher" data-ref-filename="bssl..SSL_HANDSHAKE..new_cipher">new_cipher</a> == <a class="local col5 ref" href="#75session" title='session' data-ref="75session" data-ref-filename="75session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::cipher" title='ssl_session_st::cipher' data-ref="ssl_session_st::cipher" data-ref-filename="ssl_session_st..cipher">cipher</a> &amp;&amp;</td></tr>
<tr><th id="629">629</th><td>         <i>// If the session contains a client certificate (either the full</i></td></tr>
<tr><th id="630">630</th><td><i>         // certificate or just the hash) then require that the form of the</i></td></tr>
<tr><th id="631">631</th><td><i>         // certificate matches the current configuration.</i></td></tr>
<tr><th id="632">632</th><td>         ((<a class="ref fn" href="../include/openssl/pool.h.html#34" title='sk_CRYPTO_BUFFER_num' data-ref="sk_CRYPTO_BUFFER_num" data-ref-filename="sk_CRYPTO_BUFFER_num">sk_CRYPTO_BUFFER_num</a>(<a class="local col5 ref" href="#75session" title='session' data-ref="75session" data-ref-filename="75session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::certs" title='ssl_session_st::certs' data-ref="ssl_session_st::certs" data-ref-filename="ssl_session_st..certs">certs</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>()) == <var>0</var> &amp;&amp;</td></tr>
<tr><th id="633">633</th><td>           !<a class="local col5 ref" href="#75session" title='session' data-ref="75session" data-ref-filename="75session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::peer_sha256_valid" title='ssl_session_st::peer_sha256_valid' data-ref="ssl_session_st::peer_sha256_valid" data-ref-filename="ssl_session_st..peer_sha256_valid">peer_sha256_valid</a>) ||</td></tr>
<tr><th id="634">634</th><td>          <a class="local col5 ref" href="#75session" title='session' data-ref="75session" data-ref-filename="75session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::peer_sha256_valid" title='ssl_session_st::peer_sha256_valid' data-ref="ssl_session_st::peer_sha256_valid" data-ref-filename="ssl_session_st..peer_sha256_valid">peer_sha256_valid</a> ==</td></tr>
<tr><th id="635">635</th><td>              <a class="local col4 ref" href="#74hs" title='hs' data-ref="74hs" data-ref-filename="74hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::config" title='bssl::SSL_HANDSHAKE::config' data-ref="bssl::SSL_HANDSHAKE::config" data-ref-filename="bssl..SSL_HANDSHAKE..config">config</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_CONFIG::retain_only_sha256_of_client_certs" title='bssl::SSL_CONFIG::retain_only_sha256_of_client_certs' data-ref="bssl::SSL_CONFIG::retain_only_sha256_of_client_certs" data-ref-filename="bssl..SSL_CONFIG..retain_only_sha256_of_client_certs">retain_only_sha256_of_client_certs</a>) &amp;&amp;</td></tr>
<tr><th id="636">636</th><td>         <i>// Only resume if the underlying transport protocol hasn't changed.</i></td></tr>
<tr><th id="637">637</th><td><i>         // This is to prevent cross-protocol resumption between QUIC and TCP.</i></td></tr>
<tr><th id="638">638</th><td>         (<a class="local col4 ref" href="#74hs" title='hs' data-ref="74hs" data-ref-filename="74hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::ssl" title='bssl::SSL_HANDSHAKE::ssl' data-ref="bssl::SSL_HANDSHAKE::ssl" data-ref-filename="bssl..SSL_HANDSHAKE..ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::quic_method" title='ssl_st::quic_method' data-ref="ssl_st::quic_method" data-ref-filename="ssl_st..quic_method">quic_method</a> != <b>nullptr</b>) == <a class="local col5 ref" href="#75session" title='session' data-ref="75session" data-ref-filename="75session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::is_quic" title='ssl_session_st::is_quic' data-ref="ssl_session_st::is_quic" data-ref-filename="ssl_session_st..is_quic">is_quic</a>;</td></tr>
<tr><th id="639">639</th><td>}</td></tr>
<tr><th id="640">640</th><td></td></tr>
<tr><th id="641">641</th><td><i  data-doc="_ZN4bsslL18ssl_lookup_sessionEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEENS_4SpanIKhEE">// ssl_lookup_session looks up |session_id| in the session cache and sets</i></td></tr>
<tr><th id="642">642</th><td><i  data-doc="_ZN4bsslL18ssl_lookup_sessionEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEENS_4SpanIKhEE">// |*out_session| to an |SSL_SESSION| object if found.</i></td></tr>
<tr><th id="643">643</th><td><em>static</em> <b>enum</b> <a class="type" href="internal.h.html#bssl::ssl_hs_wait_t" title='bssl::ssl_hs_wait_t' data-ref="bssl::ssl_hs_wait_t" data-ref-filename="bssl..ssl_hs_wait_t">ssl_hs_wait_t</a> <dfn class="tu decl def fn" id="_ZN4bsslL18ssl_lookup_sessionEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEENS_4SpanIKhEE" title='bssl::ssl_lookup_session' data-type='enum ssl_hs_wait_t bssl::ssl_lookup_session(bssl::SSL_HANDSHAKE * hs, UniquePtr&lt;SSL_SESSION&gt; * out_session, Span&lt;const uint8_t&gt; session_id)' data-ref="_ZN4bsslL18ssl_lookup_sessionEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEENS_4SpanIKhEE" data-ref-filename="_ZN4bsslL18ssl_lookup_sessionEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEENS_4SpanIKhEE">ssl_lookup_session</dfn>(</td></tr>
<tr><th id="644">644</th><td>    <a class="type" href="internal.h.html#bssl::SSL_HANDSHAKE" title='bssl::SSL_HANDSHAKE' data-ref="bssl::SSL_HANDSHAKE" data-ref-filename="bssl..SSL_HANDSHAKE">SSL_HANDSHAKE</a> *<dfn class="local col7 decl" id="77hs" title='hs' data-type='bssl::SSL_HANDSHAKE *' data-ref="77hs" data-ref-filename="77hs">hs</dfn>, <a class="type" href="../include/openssl/base.h.html#bssl::UniquePtr" title='bssl::UniquePtr' data-ref="bssl::UniquePtr" data-ref-filename="bssl..UniquePtr">UniquePtr</a>&lt;<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a>&gt; *<dfn class="local col8 decl" id="78out_session" title='out_session' data-type='UniquePtr&lt;SSL_SESSION&gt; *' data-ref="78out_session" data-ref-filename="78out_session">out_session</dfn>,</td></tr>
<tr><th id="645">645</th><td>    <a class="type" href="../include/openssl/span.h.html#bssl::Span" title='bssl::Span' data-ref="bssl::Span" data-ref-filename="bssl..Span">Span</a>&lt;<em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span>&gt; <dfn class="local col9 decl" id="79session_id" title='session_id' data-type='Span&lt;const uint8_t&gt;' data-ref="79session_id" data-ref-filename="79session_id">session_id</dfn>) {</td></tr>
<tr><th id="646">646</th><td>  <a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<em>const</em> <dfn class="local col0 decl" id="80ssl" title='ssl' data-type='SSL *const' data-ref="80ssl" data-ref-filename="80ssl">ssl</dfn> = <a class="local col7 ref" href="#77hs" title='hs' data-ref="77hs" data-ref-filename="77hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::ssl" title='bssl::SSL_HANDSHAKE::ssl' data-ref="bssl::SSL_HANDSHAKE::ssl" data-ref-filename="bssl..SSL_HANDSHAKE..ssl">ssl</a>;</td></tr>
<tr><th id="647">647</th><td>  <a class="local col8 ref" href="#78out_session" title='out_session' data-ref="78out_session" data-ref-filename="78out_session">out_session</a>-&gt;<span class='ref fn' title='std::__1::unique_ptr::reset' data-ref="_ZNSt3__110unique_ptr5resetENS_14__pointer_typeIT_T0_E4typeE" data-ref-filename="_ZNSt3__110unique_ptr5resetENS_14__pointer_typeIT_T0_E4typeE">reset</span>();</td></tr>
<tr><th id="648">648</th><td></td></tr>
<tr><th id="649">649</th><td>  <b>if</b> (<a class="local col9 ref" href="#79session_id" title='session_id' data-ref="79session_id" data-ref-filename="79session_id">session_id</a>.<a class="ref fn" href="../include/openssl/span.h.html#_ZNK4bssl4Span5emptyEv" title='bssl::Span::empty' data-ref="_ZNK4bssl4Span5emptyEv" data-ref-filename="_ZNK4bssl4Span5emptyEv">empty</a>() || <a class="local col9 ref" href="#79session_id" title='session_id' data-ref="79session_id" data-ref-filename="79session_id">session_id</a>.<a class="ref fn" href="../include/openssl/span.h.html#_ZNK4bssl4Span4sizeEv" title='bssl::Span::size' data-ref="_ZNK4bssl4Span4sizeEv" data-ref-filename="_ZNK4bssl4Span4sizeEv">size</a>() &gt; <a class="macro" href="../include/openssl/ssl.h.html#1699" title="32" data-ref="_M/SSL_MAX_SSL_SESSION_ID_LENGTH">SSL_MAX_SSL_SESSION_ID_LENGTH</a>) {</td></tr>
<tr><th id="650">650</th><td>    <b>return</b> <a class="enum" href="internal.h.html#bssl::ssl_hs_ok" title='bssl::ssl_hs_ok' data-ref="bssl::ssl_hs_ok" data-ref-filename="bssl..ssl_hs_ok">ssl_hs_ok</a>;</td></tr>
<tr><th id="651">651</th><td>  }</td></tr>
<tr><th id="652">652</th><td></td></tr>
<tr><th id="653">653</th><td>  <a class="type" href="../include/openssl/base.h.html#bssl::UniquePtr" title='bssl::UniquePtr' data-ref="bssl::UniquePtr" data-ref-filename="bssl..UniquePtr">UniquePtr</a>&lt;<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a>&gt; <span class='ref fn fake' title='std::__1::unique_ptr::unique_ptr&lt;_Tp, _Dp&gt;' data-ref="_ZNSt3__110unique_ptrC1Ev" data-ref-filename="_ZNSt3__110unique_ptrC1Ev"></span><dfn class="local col1 decl" id="81session" title='session' data-type='UniquePtr&lt;SSL_SESSION&gt;' data-ref="81session" data-ref-filename="81session">session</dfn>;</td></tr>
<tr><th id="654">654</th><td>  <i>// Try the internal cache, if it exists.</i></td></tr>
<tr><th id="655">655</th><td>  <b>if</b> (!(<a class="local col0 ref" href="#80ssl" title='ssl' data-ref="80ssl" data-ref-filename="80ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session_ctx" title='ssl_st::session_ctx' data-ref="ssl_st::session_ctx" data-ref-filename="ssl_st..session_ctx">session_ctx</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_mode" title='ssl_ctx_st::session_cache_mode' data-ref="ssl_ctx_st::session_cache_mode" data-ref-filename="ssl_ctx_st..session_cache_mode">session_cache_mode</a> &amp;</td></tr>
<tr><th id="656">656</th><td>        <a class="macro" href="../include/openssl/ssl.h.html#1909" title="0x0100" data-ref="_M/SSL_SESS_CACHE_NO_INTERNAL_LOOKUP">SSL_SESS_CACHE_NO_INTERNAL_LOOKUP</a>)) {</td></tr>
<tr><th id="657">657</th><td>    <span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span> <dfn class="local col2 decl" id="82hash" title='hash' data-type='uint32_t' data-ref="82hash" data-ref-filename="82hash">hash</dfn> = <a class="ref fn" href="#_ZN4bssl19ssl_hash_session_idENS_4SpanIKhEE" title='bssl::ssl_hash_session_id' data-ref="_ZN4bssl19ssl_hash_session_idENS_4SpanIKhEE" data-ref-filename="_ZN4bssl19ssl_hash_session_idENS_4SpanIKhEE">ssl_hash_session_id</a>(<a class="ref fn fake" href="../include/openssl/span.h.html#95" title='bssl::Span&lt;const unsigned char&gt;::Span' data-ref="_ZN4bssl4SpanIKhEC1ERKS2_" data-ref-filename="_ZN4bssl4SpanIKhEC1ERKS2_"></a><a class="local col9 ref" href="#79session_id" title='session_id' data-ref="79session_id" data-ref-filename="79session_id">session_id</a>);</td></tr>
<tr><th id="658">658</th><td>    <em>auto</em> <dfn class="local col3 decl" id="83cmp" title='cmp' data-type='(lambda at /Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/third_party/boringssl/src/ssl/ssl_session.cc:658:16)' data-ref="83cmp" data-ref-filename="83cmp">cmp</dfn> = [](<em>const</em> <em>void</em> *<dfn class="local col4 decl" id="84key" title='key' data-type='const void *' data-ref="84key" data-ref-filename="84key">key</dfn>, <em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col5 decl" id="85sess" title='sess' data-type='const SSL_SESSION *' data-ref="85sess" data-ref-filename="85sess">sess</dfn>) -&gt; <em>int</em> {</td></tr>
<tr><th id="659">659</th><td>      <a class="type" href="../include/openssl/span.h.html#bssl::Span" title='bssl::Span' data-ref="bssl::Span" data-ref-filename="bssl..Span">Span</a>&lt;<em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span>&gt; <dfn class="local col6 decl" id="86key_id" title='key_id' data-type='Span&lt;const uint8_t&gt;' data-ref="86key_id" data-ref-filename="86key_id">key_id</dfn> =</td></tr>
<tr><th id="660">660</th><td>          <a class="ref fn fake" href="../include/openssl/span.h.html#95" title='bssl::Span&lt;const unsigned char&gt;::Span' data-ref="_ZN4bssl4SpanIKhEC1ERKS2_" data-ref-filename="_ZN4bssl4SpanIKhEC1ERKS2_"></a>*<b>reinterpret_cast</b>&lt;<em>const</em> <a class="type" href="../include/openssl/span.h.html#bssl::Span" title='bssl::Span' data-ref="bssl::Span" data-ref-filename="bssl..Span">Span</a>&lt;<em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span>&gt; *&gt;(<a class="local col4 ref" href="#84key" title='key' data-ref="84key" data-ref-filename="84key">key</a>);</td></tr>
<tr><th id="661">661</th><td>      <a class="type" href="../include/openssl/span.h.html#bssl::Span" title='bssl::Span' data-ref="bssl::Span" data-ref-filename="bssl..Span">Span</a>&lt;<em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span>&gt; <dfn class="local col7 decl" id="87sess_id" title='sess_id' data-type='Span&lt;const uint8_t&gt;' data-ref="87sess_id" data-ref-filename="87sess_id">sess_id</dfn> =</td></tr>
<tr><th id="662">662</th><td>          <a class="ref fn" href="../include/openssl/span.h.html#_ZN4bssl13MakeConstSpanEPT_m" title='bssl::MakeConstSpan' data-ref="_ZN4bssl13MakeConstSpanEPT_m" data-ref-filename="_ZN4bssl13MakeConstSpanEPT_m">MakeConstSpan</a>(<a class="local col5 ref" href="#85sess" title='sess' data-ref="85sess" data-ref-filename="85sess">sess</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::session_id" title='ssl_session_st::session_id' data-ref="ssl_session_st::session_id" data-ref-filename="ssl_session_st..session_id">session_id</a>, <a class="local col5 ref" href="#85sess" title='sess' data-ref="85sess" data-ref-filename="85sess">sess</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::session_id_length" title='ssl_session_st::session_id_length' data-ref="ssl_session_st::session_id_length" data-ref-filename="ssl_session_st..session_id_length">session_id_length</a>);</td></tr>
<tr><th id="663">663</th><td>      <b>return</b> <a class="ref fn fake" href="../include/openssl/span.h.html#95" title='bssl::Span&lt;const unsigned char&gt;::Span' data-ref="_ZN4bssl4SpanIKhEC1ERKS2_" data-ref-filename="_ZN4bssl4SpanIKhEC1ERKS2_"></a><a class="local col6 ref" href="#86key_id" title='key_id' data-ref="86key_id" data-ref-filename="86key_id">key_id</a> <a class="ref fn" href="../include/openssl/span.h.html#_ZN4bssl8internaleqENS_4SpanIT_EES3_" title='bssl::internal::operator==' data-ref="_ZN4bssl8internaleqENS_4SpanIT_EES3_" data-ref-filename="_ZN4bssl8internaleqENS_4SpanIT_EES3_">==</a> <a class="ref fn fake" href="../include/openssl/span.h.html#95" title='bssl::Span&lt;const unsigned char&gt;::Span' data-ref="_ZN4bssl4SpanIKhEC1ERKS2_" data-ref-filename="_ZN4bssl4SpanIKhEC1ERKS2_"></a><a class="local col7 ref" href="#87sess_id" title='sess_id' data-ref="87sess_id" data-ref-filename="87sess_id">sess_id</a> ? <var>0</var> : <var>1</var>;</td></tr>
<tr><th id="664">664</th><td>    };</td></tr>
<tr><th id="665">665</th><td>    <a class="typedef" href="../crypto/internal.h.html#bssl::MutexReadLock" title='bssl::MutexReadLock' data-type='internal::MutexLockBase&lt;CRYPTO_MUTEX_lock_read, CRYPTO_MUTEX_unlock_read&gt;' data-ref="bssl::MutexReadLock" data-ref-filename="bssl..MutexReadLock">MutexReadLock</a> <dfn class="local col8 decl" id="88lock" title='lock' data-type='bssl::MutexReadLock' data-ref="88lock" data-ref-filename="88lock">lock</dfn><a class="ref fn" href="../crypto/internal.h.html#_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t" title='bssl::internal::MutexLockBase::MutexLockBase&lt;LockFunc, ReleaseFunc&gt;' data-ref="_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t" data-ref-filename="_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t">(</a>&amp;<a class="local col0 ref" href="#80ssl" title='ssl' data-ref="80ssl" data-ref-filename="80ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session_ctx" title='ssl_st::session_ctx' data-ref="ssl_st::session_ctx" data-ref-filename="ssl_st..session_ctx">session_ctx</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_ctx_st::lock" title='ssl_ctx_st::lock' data-ref="ssl_ctx_st::lock" data-ref-filename="ssl_ctx_st..lock">lock</a>);</td></tr>
<tr><th id="666">666</th><td>    <i>// |lh_SSL_SESSION_retrieve_key| returns a non-owning pointer.</i></td></tr>
<tr><th id="667">667</th><td>    <a class="local col1 ref" href="#81session" title='session' data-ref="81session" data-ref-filename="81session">session</a> <span class='ref fn' title='std::__1::unique_ptr::operator=' data-ref="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE" data-ref-filename="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE">=</span> <a class="ref fn" href="../include/openssl/ssl.h.html#5147" title='bssl::UpRef' data-ref="_ZN4bssl5UpRefEP14ssl_session_st" data-ref-filename="_ZN4bssl5UpRefEP14ssl_session_st">UpRef</a>(<a class="ref fn" href="internal.h.html#2464" title='lh_SSL_SESSION_retrieve_key' data-ref="_Z27lh_SSL_SESSION_retrieve_keyPK20lhash_st_SSL_SESSIONPKvjPFiS3_PK14ssl_session_stE" data-ref-filename="_Z27lh_SSL_SESSION_retrieve_keyPK20lhash_st_SSL_SESSIONPKvjPFiS3_PK14ssl_session_stE">lh_SSL_SESSION_retrieve_key</a>(<a class="local col0 ref" href="#80ssl" title='ssl' data-ref="80ssl" data-ref-filename="80ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session_ctx" title='ssl_st::session_ctx' data-ref="ssl_st::session_ctx" data-ref-filename="ssl_st..session_ctx">session_ctx</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_ctx_st::sessions" title='ssl_ctx_st::sessions' data-ref="ssl_ctx_st::sessions" data-ref-filename="ssl_ctx_st..sessions">sessions</a>,</td></tr>
<tr><th id="668">668</th><td>                                                &amp;<a class="local col9 ref" href="#79session_id" title='session_id' data-ref="79session_id" data-ref-filename="79session_id">session_id</a>, <a class="local col2 ref" href="#82hash" title='hash' data-ref="82hash" data-ref-filename="82hash">hash</a>, <a class="tu ref fn fake" href="#658" title='bssl::ssl_lookup_session(bssl::SSL_HANDSHAKE *, UniquePtr&lt;SSL_SESSION&gt; *, Span&lt;const uint8_t&gt;)::(anonymous class)::operator int (*)(const void *, const ssl_session_st *)' data-use='c' data-ref="_ZZN4bsslL18ssl_lookup_sessionEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEENS_4SpanIKhEEENK3$_1cvPFiPKvPKS4_EEv" data-ref-filename="_ZZN4bsslL18ssl_lookup_sessionEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEENS_4SpanIKhEEENK3$_1cvPFiPKvPKS4_EEv"></a><a class="local col3 ref" href="#83cmp" title='cmp' data-ref="83cmp" data-ref-filename="83cmp">cmp</a>));</td></tr>
<tr><th id="669">669</th><td>    <i>// TODO(davidben): This should probably move it to the front of the list.</i></td></tr>
<tr><th id="670">670</th><td>  }</td></tr>
<tr><th id="671">671</th><td></td></tr>
<tr><th id="672">672</th><td>  <i>// Fall back to the external cache, if it exists.</i></td></tr>
<tr><th id="673">673</th><td>  <b>if</b> (!<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col1 ref" href="#81session" title='session' data-ref="81session" data-ref-filename="81session">session</a> &amp;&amp; <a class="local col0 ref" href="#80ssl" title='ssl' data-ref="80ssl" data-ref-filename="80ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session_ctx" title='ssl_st::session_ctx' data-ref="ssl_st::session_ctx" data-ref-filename="ssl_st..session_ctx">session_ctx</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_ctx_st::get_session_cb" title='ssl_ctx_st::get_session_cb' data-ref="ssl_ctx_st::get_session_cb" data-ref-filename="ssl_ctx_st..get_session_cb">get_session_cb</a> != <b>nullptr</b>) {</td></tr>
<tr><th id="674">674</th><td>    <em>int</em> <dfn class="local col9 decl" id="89copy" title='copy' data-type='int' data-ref="89copy" data-ref-filename="89copy">copy</dfn> = <var>1</var>;</td></tr>
<tr><th id="675">675</th><td>    <a class="local col1 ref" href="#81session" title='session' data-ref="81session" data-ref-filename="81session">session</a>.<span class='ref fn' title='std::__1::unique_ptr::reset' data-ref="_ZNSt3__110unique_ptr5resetENS_14__pointer_typeIT_T0_E4typeE" data-ref-filename="_ZNSt3__110unique_ptr5resetENS_14__pointer_typeIT_T0_E4typeE">reset</span>(<a class="local col0 ref" href="#80ssl" title='ssl' data-ref="80ssl" data-ref-filename="80ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session_ctx" title='ssl_st::session_ctx' data-ref="ssl_st::session_ctx" data-ref-filename="ssl_st..session_ctx">session_ctx</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_ctx_st::get_session_cb" title='ssl_ctx_st::get_session_cb' data-ref="ssl_ctx_st::get_session_cb" data-ref-filename="ssl_ctx_st..get_session_cb">get_session_cb</a>(<a class="local col0 ref" href="#80ssl" title='ssl' data-ref="80ssl" data-ref-filename="80ssl">ssl</a>, <a class="local col9 ref" href="#79session_id" title='session_id' data-ref="79session_id" data-ref-filename="79session_id">session_id</a>.<a class="ref fn" href="../include/openssl/span.h.html#_ZNK4bssl4Span4dataEv" title='bssl::Span::data' data-ref="_ZNK4bssl4Span4dataEv" data-ref-filename="_ZNK4bssl4Span4dataEv">data</a>(),</td></tr>
<tr><th id="676">676</th><td>                                                   <a class="local col9 ref" href="#79session_id" title='session_id' data-ref="79session_id" data-ref-filename="79session_id">session_id</a>.<a class="ref fn" href="../include/openssl/span.h.html#_ZNK4bssl4Span4sizeEv" title='bssl::Span::size' data-ref="_ZNK4bssl4Span4sizeEv" data-ref-filename="_ZNK4bssl4Span4sizeEv">size</a>(), &amp;<a class="local col9 ref" href="#89copy" title='copy' data-ref="89copy" data-ref-filename="89copy">copy</a>));</td></tr>
<tr><th id="677">677</th><td>    <b>if</b> (!<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col1 ref" href="#81session" title='session' data-ref="81session" data-ref-filename="81session">session</a>) {</td></tr>
<tr><th id="678">678</th><td>      <b>return</b> <a class="enum" href="internal.h.html#bssl::ssl_hs_ok" title='bssl::ssl_hs_ok' data-ref="bssl::ssl_hs_ok" data-ref-filename="bssl..ssl_hs_ok">ssl_hs_ok</a>;</td></tr>
<tr><th id="679">679</th><td>    }</td></tr>
<tr><th id="680">680</th><td></td></tr>
<tr><th id="681">681</th><td>    <b>if</b> (<a class="local col1 ref" href="#81session" title='session' data-ref="81session" data-ref-filename="81session">session</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>() == <a class="ref fn" href="#SSL_magic_pending_session_ptr" title='SSL_magic_pending_session_ptr' data-ref="SSL_magic_pending_session_ptr" data-ref-filename="SSL_magic_pending_session_ptr">SSL_magic_pending_session_ptr</a>()) {</td></tr>
<tr><th id="682">682</th><td>      <a class="local col1 ref" href="#81session" title='session' data-ref="81session" data-ref-filename="81session">session</a>.<span class='ref fn' title='std::__1::unique_ptr::release' data-ref="_ZNSt3__110unique_ptr7releaseEv" data-ref-filename="_ZNSt3__110unique_ptr7releaseEv">release</span>();  <i>// This pointer is not actually owned.</i></td></tr>
<tr><th id="683">683</th><td>      <b>return</b> <a class="enum" href="internal.h.html#bssl::ssl_hs_pending_session" title='bssl::ssl_hs_pending_session' data-ref="bssl::ssl_hs_pending_session" data-ref-filename="bssl..ssl_hs_pending_session">ssl_hs_pending_session</a>;</td></tr>
<tr><th id="684">684</th><td>    }</td></tr>
<tr><th id="685">685</th><td></td></tr>
<tr><th id="686">686</th><td>    <i>// Increment reference count now if the session callback asks us to do so</i></td></tr>
<tr><th id="687">687</th><td><i>    // (note that if the session structures returned by the callback are shared</i></td></tr>
<tr><th id="688">688</th><td><i>    // between threads, it must handle the reference count itself [i.e. copy ==</i></td></tr>
<tr><th id="689">689</th><td><i>    // 0], or things won't be thread-safe).</i></td></tr>
<tr><th id="690">690</th><td>    <b>if</b> (<a class="local col9 ref" href="#89copy" title='copy' data-ref="89copy" data-ref-filename="89copy">copy</a>) {</td></tr>
<tr><th id="691">691</th><td>      <a class="ref fn" href="#SSL_SESSION_up_ref" title='SSL_SESSION_up_ref' data-ref="SSL_SESSION_up_ref" data-ref-filename="SSL_SESSION_up_ref">SSL_SESSION_up_ref</a>(<a class="local col1 ref" href="#81session" title='session' data-ref="81session" data-ref-filename="81session">session</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>());</td></tr>
<tr><th id="692">692</th><td>    }</td></tr>
<tr><th id="693">693</th><td></td></tr>
<tr><th id="694">694</th><td>    <i>// Add the externally cached session to the internal cache if necessary.</i></td></tr>
<tr><th id="695">695</th><td>    <b>if</b> (!(<a class="local col0 ref" href="#80ssl" title='ssl' data-ref="80ssl" data-ref-filename="80ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session_ctx" title='ssl_st::session_ctx' data-ref="ssl_st::session_ctx" data-ref-filename="ssl_st..session_ctx">session_ctx</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_mode" title='ssl_ctx_st::session_cache_mode' data-ref="ssl_ctx_st::session_cache_mode" data-ref-filename="ssl_ctx_st..session_cache_mode">session_cache_mode</a> &amp;</td></tr>
<tr><th id="696">696</th><td>          <a class="macro" href="../include/openssl/ssl.h.html#1913" title="0x0200" data-ref="_M/SSL_SESS_CACHE_NO_INTERNAL_STORE">SSL_SESS_CACHE_NO_INTERNAL_STORE</a>)) {</td></tr>
<tr><th id="697">697</th><td>      <a class="ref fn" href="#SSL_CTX_add_session" title='SSL_CTX_add_session' data-ref="SSL_CTX_add_session" data-ref-filename="SSL_CTX_add_session">SSL_CTX_add_session</a>(<a class="local col0 ref" href="#80ssl" title='ssl' data-ref="80ssl" data-ref-filename="80ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session_ctx" title='ssl_st::session_ctx' data-ref="ssl_st::session_ctx" data-ref-filename="ssl_st..session_ctx">session_ctx</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>(), <a class="local col1 ref" href="#81session" title='session' data-ref="81session" data-ref-filename="81session">session</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>());</td></tr>
<tr><th id="698">698</th><td>    }</td></tr>
<tr><th id="699">699</th><td>  }</td></tr>
<tr><th id="700">700</th><td></td></tr>
<tr><th id="701">701</th><td>  <b>if</b> (<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col1 ref" href="#81session" title='session' data-ref="81session" data-ref-filename="81session">session</a> &amp;&amp; !<a class="ref fn" href="#_ZN4bssl25ssl_session_is_time_validEPK6ssl_stPK14ssl_session_st" title='bssl::ssl_session_is_time_valid' data-ref="_ZN4bssl25ssl_session_is_time_validEPK6ssl_stPK14ssl_session_st" data-ref-filename="_ZN4bssl25ssl_session_is_time_validEPK6ssl_stPK14ssl_session_st">ssl_session_is_time_valid</a>(<a class="local col0 ref" href="#80ssl" title='ssl' data-ref="80ssl" data-ref-filename="80ssl">ssl</a>, <a class="local col1 ref" href="#81session" title='session' data-ref="81session" data-ref-filename="81session">session</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>())) {</td></tr>
<tr><th id="702">702</th><td>    <i>// The session was from the cache, so remove it.</i></td></tr>
<tr><th id="703">703</th><td>    <a class="ref fn" href="#SSL_CTX_remove_session" title='SSL_CTX_remove_session' data-ref="SSL_CTX_remove_session" data-ref-filename="SSL_CTX_remove_session">SSL_CTX_remove_session</a>(<a class="local col0 ref" href="#80ssl" title='ssl' data-ref="80ssl" data-ref-filename="80ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session_ctx" title='ssl_st::session_ctx' data-ref="ssl_st::session_ctx" data-ref-filename="ssl_st..session_ctx">session_ctx</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>(), <a class="local col1 ref" href="#81session" title='session' data-ref="81session" data-ref-filename="81session">session</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>());</td></tr>
<tr><th id="704">704</th><td>    <a class="local col1 ref" href="#81session" title='session' data-ref="81session" data-ref-filename="81session">session</a>.<span class='ref fn' title='std::__1::unique_ptr::reset' data-ref="_ZNSt3__110unique_ptr5resetENS_14__pointer_typeIT_T0_E4typeE" data-ref-filename="_ZNSt3__110unique_ptr5resetENS_14__pointer_typeIT_T0_E4typeE">reset</span>();</td></tr>
<tr><th id="705">705</th><td>  }</td></tr>
<tr><th id="706">706</th><td></td></tr>
<tr><th id="707">707</th><td>  *<a class="local col8 ref" href="#78out_session" title='out_session' data-ref="78out_session" data-ref-filename="78out_session">out_session</a> <span class='ref fn' title='std::__1::unique_ptr::operator=' data-ref="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE" data-ref-filename="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE">=</span> <span class="namespace">std::</span><span class='ref fn' title='std::__1::move' data-ref="_ZNSt3__1L4moveEOT_" data-ref-filename="_ZNSt3__1L4moveEOT_">move</span>(<span class='refarg'><a class="local col1 ref" href="#81session" title='session' data-ref="81session" data-ref-filename="81session">session</a></span>);</td></tr>
<tr><th id="708">708</th><td>  <b>return</b> <a class="enum" href="internal.h.html#bssl::ssl_hs_ok" title='bssl::ssl_hs_ok' data-ref="bssl::ssl_hs_ok" data-ref-filename="bssl..ssl_hs_ok">ssl_hs_ok</a>;</td></tr>
<tr><th id="709">709</th><td>}</td></tr>
<tr><th id="710">710</th><td></td></tr>
<tr><th id="711">711</th><td><b>enum</b> <a class="type" href="internal.h.html#bssl::ssl_hs_wait_t" title='bssl::ssl_hs_wait_t' data-ref="bssl::ssl_hs_wait_t" data-ref-filename="bssl..ssl_hs_wait_t">ssl_hs_wait_t</a> <dfn class="decl def fn" id="_ZN4bssl20ssl_get_prev_sessionEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEEPbSA_PK22ssl_early_callback_ctx" title='bssl::ssl_get_prev_session' data-ref="_ZN4bssl20ssl_get_prev_sessionEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEEPbSA_PK22ssl_early_callback_ctx" data-ref-filename="_ZN4bssl20ssl_get_prev_sessionEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEEPbSA_PK22ssl_early_callback_ctx">ssl_get_prev_session</dfn>(<a class="type" href="internal.h.html#bssl::SSL_HANDSHAKE" title='bssl::SSL_HANDSHAKE' data-ref="bssl::SSL_HANDSHAKE" data-ref-filename="bssl..SSL_HANDSHAKE">SSL_HANDSHAKE</a> *<dfn class="local col0 decl" id="90hs" title='hs' data-type='bssl::SSL_HANDSHAKE *' data-ref="90hs" data-ref-filename="90hs">hs</dfn>,</td></tr>
<tr><th id="712">712</th><td>                                        <a class="type" href="../include/openssl/base.h.html#bssl::UniquePtr" title='bssl::UniquePtr' data-ref="bssl::UniquePtr" data-ref-filename="bssl..UniquePtr">UniquePtr</a>&lt;<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a>&gt; *<dfn class="local col1 decl" id="91out_session" title='out_session' data-type='UniquePtr&lt;SSL_SESSION&gt; *' data-ref="91out_session" data-ref-filename="91out_session">out_session</dfn>,</td></tr>
<tr><th id="713">713</th><td>                                        <em>bool</em> *<dfn class="local col2 decl" id="92out_tickets_supported" title='out_tickets_supported' data-type='bool *' data-ref="92out_tickets_supported" data-ref-filename="92out_tickets_supported">out_tickets_supported</dfn>,</td></tr>
<tr><th id="714">714</th><td>                                        <em>bool</em> *<dfn class="local col3 decl" id="93out_renew_ticket" title='out_renew_ticket' data-type='bool *' data-ref="93out_renew_ticket" data-ref-filename="93out_renew_ticket">out_renew_ticket</dfn>,</td></tr>
<tr><th id="715">715</th><td>                                        <em>const</em> <a class="typedef" href="../include/openssl/ssl.h.html#SSL_CLIENT_HELLO" title='SSL_CLIENT_HELLO' data-type='struct ssl_early_callback_ctx' data-ref="SSL_CLIENT_HELLO" data-ref-filename="SSL_CLIENT_HELLO">SSL_CLIENT_HELLO</a> *<dfn class="local col4 decl" id="94client_hello" title='client_hello' data-type='const SSL_CLIENT_HELLO *' data-ref="94client_hello" data-ref-filename="94client_hello">client_hello</dfn>) {</td></tr>
<tr><th id="716">716</th><td>  <i>// This is used only by servers.</i></td></tr>
<tr><th id="717">717</th><td>  <span class="macro" title="(__builtin_expect(!(hs-&gt;ssl-&gt;server), 0) ? __assert_rtn(__func__, &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/third_party/boringssl/src/ssl/ssl_session.cc&quot;, 717, &quot;hs-&gt;ssl-&gt;server&quot;) : (void)0)" data-ref="_M/assert">assert</span>(<a class="local col0 ref" href="#90hs" title='hs' data-ref="90hs" data-ref-filename="90hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::ssl" title='bssl::SSL_HANDSHAKE::ssl' data-ref="bssl::SSL_HANDSHAKE::ssl" data-ref-filename="bssl..SSL_HANDSHAKE..ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::server" title='ssl_st::server' data-ref="ssl_st::server" data-ref-filename="ssl_st..server">server</a>);</td></tr>
<tr><th id="718">718</th><td>  <a class="type" href="../include/openssl/base.h.html#bssl::UniquePtr" title='bssl::UniquePtr' data-ref="bssl::UniquePtr" data-ref-filename="bssl..UniquePtr">UniquePtr</a>&lt;<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a>&gt; <span class='ref fn fake' title='std::__1::unique_ptr::unique_ptr&lt;_Tp, _Dp&gt;' data-ref="_ZNSt3__110unique_ptrC1Ev" data-ref-filename="_ZNSt3__110unique_ptrC1Ev"></span><dfn class="local col5 decl" id="95session" title='session' data-type='UniquePtr&lt;SSL_SESSION&gt;' data-ref="95session" data-ref-filename="95session">session</dfn>;</td></tr>
<tr><th id="719">719</th><td>  <em>bool</em> <dfn class="local col6 decl" id="96renew_ticket" title='renew_ticket' data-type='bool' data-ref="96renew_ticket" data-ref-filename="96renew_ticket">renew_ticket</dfn> = <b>false</b>;</td></tr>
<tr><th id="720">720</th><td></td></tr>
<tr><th id="721">721</th><td>  <i>// If tickets are disabled, always behave as if no tickets are present.</i></td></tr>
<tr><th id="722">722</th><td>  <a class="typedef" href="../include/openssl/base.h.html#CBS" title='CBS' data-type='struct cbs_st' data-ref="CBS" data-ref-filename="CBS">CBS</a> <a class="ref fn fake" href="../include/openssl/bytestring.h.html#_ZN6cbs_stC1Ev" title='cbs_st::cbs_st' data-ref="_ZN6cbs_stC1Ev" data-ref-filename="_ZN6cbs_stC1Ev"></a><dfn class="local col7 decl" id="97ticket" title='ticket' data-type='CBS' data-ref="97ticket" data-ref-filename="97ticket">ticket</dfn>;</td></tr>
<tr><th id="723">723</th><td>  <em>const</em> <em>bool</em> <dfn class="local col8 decl" id="98tickets_supported" title='tickets_supported' data-type='const bool' data-ref="98tickets_supported" data-ref-filename="98tickets_supported">tickets_supported</dfn> =</td></tr>
<tr><th id="724">724</th><td>      !(<a class="macro" href="../include/openssl/ssl.h.html#5106" title="SSL_get_options" data-ref="_M/SSL_get_options">SSL_get_options</a>(<a class="local col0 ref" href="#90hs" title='hs' data-ref="90hs" data-ref-filename="90hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::ssl" title='bssl::SSL_HANDSHAKE::ssl' data-ref="bssl::SSL_HANDSHAKE::ssl" data-ref-filename="bssl..SSL_HANDSHAKE..ssl">ssl</a>) &amp; <a class="macro" href="../include/openssl/ssl.h.html#690" title="0x00004000L" data-ref="_M/SSL_OP_NO_TICKET">SSL_OP_NO_TICKET</a>) &amp;&amp;</td></tr>
<tr><th id="725">725</th><td>      <a class="ref fn" href="internal.h.html#_ZN4bssl30ssl_client_hello_get_extensionEPK22ssl_early_callback_ctxP6cbs_stt" title='bssl::ssl_client_hello_get_extension' data-ref="_ZN4bssl30ssl_client_hello_get_extensionEPK22ssl_early_callback_ctxP6cbs_stt" data-ref-filename="_ZN4bssl30ssl_client_hello_get_extensionEPK22ssl_early_callback_ctxP6cbs_stt">ssl_client_hello_get_extension</a>(<a class="local col4 ref" href="#94client_hello" title='client_hello' data-ref="94client_hello" data-ref-filename="94client_hello">client_hello</a>, &amp;<a class="local col7 ref" href="#97ticket" title='ticket' data-ref="97ticket" data-ref-filename="97ticket">ticket</a>,</td></tr>
<tr><th id="726">726</th><td>                                     <a class="macro" href="../include/openssl/tls1.h.html#233" title="35" data-ref="_M/TLSEXT_TYPE_session_ticket">TLSEXT_TYPE_session_ticket</a>);</td></tr>
<tr><th id="727">727</th><td>  <b>if</b> (<a class="local col8 ref" href="#98tickets_supported" title='tickets_supported' data-ref="98tickets_supported" data-ref-filename="98tickets_supported">tickets_supported</a> &amp;&amp; <a class="ref fn" href="../include/openssl/bytestring.h.html#CBS_len" title='CBS_len' data-ref="CBS_len" data-ref-filename="CBS_len">CBS_len</a>(&amp;<a class="local col7 ref" href="#97ticket" title='ticket' data-ref="97ticket" data-ref-filename="97ticket">ticket</a>) != <var>0</var>) {</td></tr>
<tr><th id="728">728</th><td>    <b>switch</b> (<a class="ref fn" href="internal.h.html#_ZN4bssl18ssl_process_ticketEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEEPbNS_4SpanIKhEESD_" title='bssl::ssl_process_ticket' data-ref="_ZN4bssl18ssl_process_ticketEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEEPbNS_4SpanIKhEESD_" data-ref-filename="_ZN4bssl18ssl_process_ticketEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEEPbNS_4SpanIKhEESD_">ssl_process_ticket</a>(<a class="local col0 ref" href="#90hs" title='hs' data-ref="90hs" data-ref-filename="90hs">hs</a>, &amp;<a class="local col5 ref" href="#95session" title='session' data-ref="95session" data-ref-filename="95session">session</a>, &amp;<a class="local col6 ref" href="#96renew_ticket" title='renew_ticket' data-ref="96renew_ticket" data-ref-filename="96renew_ticket">renew_ticket</a>, <a class="ref fn fake" href="../include/openssl/bytestring.h.html#_ZNK6cbs_stcvN4bssl4SpanIKhEEEv" title='cbs_st::operator Span' data-ref="_ZNK6cbs_stcvN4bssl4SpanIKhEEEv" data-ref-filename="_ZNK6cbs_stcvN4bssl4SpanIKhEEEv"></a><a class="local col7 ref" href="#97ticket" title='ticket' data-ref="97ticket" data-ref-filename="97ticket">ticket</a>,</td></tr>
<tr><th id="729">729</th><td>                               <a class="ref fn" href="../include/openssl/span.h.html#_ZN4bssl13MakeConstSpanEPT_m" title='bssl::MakeConstSpan' data-ref="_ZN4bssl13MakeConstSpanEPT_m" data-ref-filename="_ZN4bssl13MakeConstSpanEPT_m">MakeConstSpan</a>(<a class="local col4 ref" href="#94client_hello" title='client_hello' data-ref="94client_hello" data-ref-filename="94client_hello">client_hello</a>-&gt;<a class="ref field" href="../include/openssl/ssl.h.html#ssl_early_callback_ctx::session_id" title='ssl_early_callback_ctx::session_id' data-ref="ssl_early_callback_ctx::session_id" data-ref-filename="ssl_early_callback_ctx..session_id">session_id</a>,</td></tr>
<tr><th id="730">730</th><td>                                             <a class="local col4 ref" href="#94client_hello" title='client_hello' data-ref="94client_hello" data-ref-filename="94client_hello">client_hello</a>-&gt;<a class="ref field" href="../include/openssl/ssl.h.html#ssl_early_callback_ctx::session_id_len" title='ssl_early_callback_ctx::session_id_len' data-ref="ssl_early_callback_ctx::session_id_len" data-ref-filename="ssl_early_callback_ctx..session_id_len">session_id_len</a>))) {</td></tr>
<tr><th id="731">731</th><td>      <b>case</b> <a class="enum" href="../include/openssl/ssl.h.html#ssl_ticket_aead_success" title='ssl_ticket_aead_success' data-ref="ssl_ticket_aead_success" data-ref-filename="ssl_ticket_aead_success">ssl_ticket_aead_success</a>:</td></tr>
<tr><th id="732">732</th><td>        <b>break</b>;</td></tr>
<tr><th id="733">733</th><td>      <b>case</b> <a class="enum" href="../include/openssl/ssl.h.html#ssl_ticket_aead_ignore_ticket" title='ssl_ticket_aead_ignore_ticket' data-ref="ssl_ticket_aead_ignore_ticket" data-ref-filename="ssl_ticket_aead_ignore_ticket">ssl_ticket_aead_ignore_ticket</a>:</td></tr>
<tr><th id="734">734</th><td>        <span class="macro" title="(__builtin_expect(!(!session), 0) ? __assert_rtn(__func__, &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/third_party/boringssl/src/ssl/ssl_session.cc&quot;, 734, &quot;!session&quot;) : (void)0)" data-ref="_M/assert">assert</span>(!<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col5 ref" href="#95session" title='session' data-ref="95session" data-ref-filename="95session">session</a>);</td></tr>
<tr><th id="735">735</th><td>        <b>break</b>;</td></tr>
<tr><th id="736">736</th><td>      <b>case</b> <a class="enum" href="../include/openssl/ssl.h.html#ssl_ticket_aead_error" title='ssl_ticket_aead_error' data-ref="ssl_ticket_aead_error" data-ref-filename="ssl_ticket_aead_error">ssl_ticket_aead_error</a>:</td></tr>
<tr><th id="737">737</th><td>        <b>return</b> <a class="enum" href="internal.h.html#bssl::ssl_hs_error" title='bssl::ssl_hs_error' data-ref="bssl::ssl_hs_error" data-ref-filename="bssl..ssl_hs_error">ssl_hs_error</a>;</td></tr>
<tr><th id="738">738</th><td>      <b>case</b> <a class="enum" href="../include/openssl/ssl.h.html#ssl_ticket_aead_retry" title='ssl_ticket_aead_retry' data-ref="ssl_ticket_aead_retry" data-ref-filename="ssl_ticket_aead_retry">ssl_ticket_aead_retry</a>:</td></tr>
<tr><th id="739">739</th><td>        <b>return</b> <a class="enum" href="internal.h.html#bssl::ssl_hs_pending_ticket" title='bssl::ssl_hs_pending_ticket' data-ref="bssl::ssl_hs_pending_ticket" data-ref-filename="bssl..ssl_hs_pending_ticket">ssl_hs_pending_ticket</a>;</td></tr>
<tr><th id="740">740</th><td>    }</td></tr>
<tr><th id="741">741</th><td>  } <b>else</b> {</td></tr>
<tr><th id="742">742</th><td>    <i>// The client didn't send a ticket, so the session ID is a real ID.</i></td></tr>
<tr><th id="743">743</th><td>    <b>enum</b> <a class="type" href="internal.h.html#bssl::ssl_hs_wait_t" title='bssl::ssl_hs_wait_t' data-ref="bssl::ssl_hs_wait_t" data-ref-filename="bssl..ssl_hs_wait_t">ssl_hs_wait_t</a> <dfn class="local col9 decl" id="99lookup_ret" title='lookup_ret' data-type='enum ssl_hs_wait_t' data-ref="99lookup_ret" data-ref-filename="99lookup_ret">lookup_ret</dfn> = <a class="tu ref fn" href="#_ZN4bsslL18ssl_lookup_sessionEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEENS_4SpanIKhEE" title='bssl::ssl_lookup_session' data-use='c' data-ref="_ZN4bsslL18ssl_lookup_sessionEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEENS_4SpanIKhEE" data-ref-filename="_ZN4bsslL18ssl_lookup_sessionEPNS_13SSL_HANDSHAKEEPNSt3__110unique_ptrI14ssl_session_stNS_8internal7DeleterIS4_EEEENS_4SpanIKhEE">ssl_lookup_session</a>(</td></tr>
<tr><th id="744">744</th><td>        <a class="local col0 ref" href="#90hs" title='hs' data-ref="90hs" data-ref-filename="90hs">hs</a>, &amp;<a class="local col5 ref" href="#95session" title='session' data-ref="95session" data-ref-filename="95session">session</a>,</td></tr>
<tr><th id="745">745</th><td>        <a class="ref fn" href="../include/openssl/span.h.html#_ZN4bssl13MakeConstSpanEPT_m" title='bssl::MakeConstSpan' data-ref="_ZN4bssl13MakeConstSpanEPT_m" data-ref-filename="_ZN4bssl13MakeConstSpanEPT_m">MakeConstSpan</a>(<a class="local col4 ref" href="#94client_hello" title='client_hello' data-ref="94client_hello" data-ref-filename="94client_hello">client_hello</a>-&gt;<a class="ref field" href="../include/openssl/ssl.h.html#ssl_early_callback_ctx::session_id" title='ssl_early_callback_ctx::session_id' data-ref="ssl_early_callback_ctx::session_id" data-ref-filename="ssl_early_callback_ctx..session_id">session_id</a>, <a class="local col4 ref" href="#94client_hello" title='client_hello' data-ref="94client_hello" data-ref-filename="94client_hello">client_hello</a>-&gt;<a class="ref field" href="../include/openssl/ssl.h.html#ssl_early_callback_ctx::session_id_len" title='ssl_early_callback_ctx::session_id_len' data-ref="ssl_early_callback_ctx::session_id_len" data-ref-filename="ssl_early_callback_ctx..session_id_len">session_id_len</a>));</td></tr>
<tr><th id="746">746</th><td>    <b>if</b> (<a class="local col9 ref" href="#99lookup_ret" title='lookup_ret' data-ref="99lookup_ret" data-ref-filename="99lookup_ret">lookup_ret</a> != <a class="enum" href="internal.h.html#bssl::ssl_hs_ok" title='bssl::ssl_hs_ok' data-ref="bssl::ssl_hs_ok" data-ref-filename="bssl..ssl_hs_ok">ssl_hs_ok</a>) {</td></tr>
<tr><th id="747">747</th><td>      <b>return</b> <a class="local col9 ref" href="#99lookup_ret" title='lookup_ret' data-ref="99lookup_ret" data-ref-filename="99lookup_ret">lookup_ret</a>;</td></tr>
<tr><th id="748">748</th><td>    }</td></tr>
<tr><th id="749">749</th><td>  }</td></tr>
<tr><th id="750">750</th><td></td></tr>
<tr><th id="751">751</th><td>  *<a class="local col1 ref" href="#91out_session" title='out_session' data-ref="91out_session" data-ref-filename="91out_session">out_session</a> <span class='ref fn' title='std::__1::unique_ptr::operator=' data-ref="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE" data-ref-filename="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE">=</span> <span class="namespace">std::</span><span class='ref fn' title='std::__1::move' data-ref="_ZNSt3__1L4moveEOT_" data-ref-filename="_ZNSt3__1L4moveEOT_">move</span>(<span class='refarg'><a class="local col5 ref" href="#95session" title='session' data-ref="95session" data-ref-filename="95session">session</a></span>);</td></tr>
<tr><th id="752">752</th><td>  *<a class="local col2 ref" href="#92out_tickets_supported" title='out_tickets_supported' data-ref="92out_tickets_supported" data-ref-filename="92out_tickets_supported">out_tickets_supported</a> = <a class="local col8 ref" href="#98tickets_supported" title='tickets_supported' data-ref="98tickets_supported" data-ref-filename="98tickets_supported">tickets_supported</a>;</td></tr>
<tr><th id="753">753</th><td>  *<a class="local col3 ref" href="#93out_renew_ticket" title='out_renew_ticket' data-ref="93out_renew_ticket" data-ref-filename="93out_renew_ticket">out_renew_ticket</a> = <a class="local col6 ref" href="#96renew_ticket" title='renew_ticket' data-ref="96renew_ticket" data-ref-filename="96renew_ticket">renew_ticket</a>;</td></tr>
<tr><th id="754">754</th><td>  <b>return</b> <a class="enum" href="internal.h.html#bssl::ssl_hs_ok" title='bssl::ssl_hs_ok' data-ref="bssl::ssl_hs_ok" data-ref-filename="bssl..ssl_hs_ok">ssl_hs_ok</a>;</td></tr>
<tr><th id="755">755</th><td>}</td></tr>
<tr><th id="756">756</th><td></td></tr>
<tr><th id="757">757</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="_ZN4bsslL19remove_session_lockEP10ssl_ctx_stP14ssl_session_sti" title='bssl::remove_session_lock' data-type='int bssl::remove_session_lock(SSL_CTX * ctx, SSL_SESSION * session, int lock)' data-ref="_ZN4bsslL19remove_session_lockEP10ssl_ctx_stP14ssl_session_sti" data-ref-filename="_ZN4bsslL19remove_session_lockEP10ssl_ctx_stP14ssl_session_sti">remove_session_lock</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col0 decl" id="100ctx" title='ctx' data-type='SSL_CTX *' data-ref="100ctx" data-ref-filename="100ctx">ctx</dfn>, <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col1 decl" id="101session" title='session' data-type='SSL_SESSION *' data-ref="101session" data-ref-filename="101session">session</dfn>, <em>int</em> <dfn class="local col2 decl" id="102lock" title='lock' data-type='int' data-ref="102lock" data-ref-filename="102lock">lock</dfn>) {</td></tr>
<tr><th id="758">758</th><td>  <em>int</em> <dfn class="local col3 decl" id="103ret" title='ret' data-type='int' data-ref="103ret" data-ref-filename="103ret">ret</dfn> = <var>0</var>;</td></tr>
<tr><th id="759">759</th><td></td></tr>
<tr><th id="760">760</th><td>  <b>if</b> (<a class="local col1 ref" href="#101session" title='session' data-ref="101session" data-ref-filename="101session">session</a> != <span class="macro" title="__null" data-ref="_M/NULL">NULL</span> &amp;&amp; <a class="local col1 ref" href="#101session" title='session' data-ref="101session" data-ref-filename="101session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::session_id_length" title='ssl_session_st::session_id_length' data-ref="ssl_session_st::session_id_length" data-ref-filename="ssl_session_st..session_id_length">session_id_length</a> != <var>0</var>) {</td></tr>
<tr><th id="761">761</th><td>    <b>if</b> (<a class="local col2 ref" href="#102lock" title='lock' data-ref="102lock" data-ref-filename="102lock">lock</a>) {</td></tr>
<tr><th id="762">762</th><td>      <a class="ref fn" href="../crypto/internal.h.html#CRYPTO_MUTEX_lock_write" title='CRYPTO_MUTEX_lock_write' data-ref="CRYPTO_MUTEX_lock_write" data-ref-filename="CRYPTO_MUTEX_lock_write">CRYPTO_MUTEX_lock_write</a>(&amp;<a class="local col0 ref" href="#100ctx" title='ctx' data-ref="100ctx" data-ref-filename="100ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::lock" title='ssl_ctx_st::lock' data-ref="ssl_ctx_st::lock" data-ref-filename="ssl_ctx_st..lock">lock</a>);</td></tr>
<tr><th id="763">763</th><td>    }</td></tr>
<tr><th id="764">764</th><td>    <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col4 decl" id="104found_session" title='found_session' data-type='SSL_SESSION *' data-ref="104found_session" data-ref-filename="104found_session">found_session</dfn> = <a class="ref fn" href="internal.h.html#2464" title='lh_SSL_SESSION_retrieve' data-ref="_Z23lh_SSL_SESSION_retrievePK20lhash_st_SSL_SESSIONPK14ssl_session_st" data-ref-filename="_Z23lh_SSL_SESSION_retrievePK20lhash_st_SSL_SESSIONPK14ssl_session_st">lh_SSL_SESSION_retrieve</a>(<a class="local col0 ref" href="#100ctx" title='ctx' data-ref="100ctx" data-ref-filename="100ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::sessions" title='ssl_ctx_st::sessions' data-ref="ssl_ctx_st::sessions" data-ref-filename="ssl_ctx_st..sessions">sessions</a>,</td></tr>
<tr><th id="765">765</th><td>                                                         <a class="local col1 ref" href="#101session" title='session' data-ref="101session" data-ref-filename="101session">session</a>);</td></tr>
<tr><th id="766">766</th><td>    <b>if</b> (<a class="local col4 ref" href="#104found_session" title='found_session' data-ref="104found_session" data-ref-filename="104found_session">found_session</a> == <a class="local col1 ref" href="#101session" title='session' data-ref="101session" data-ref-filename="101session">session</a>) {</td></tr>
<tr><th id="767">767</th><td>      <a class="local col3 ref" href="#103ret" title='ret' data-ref="103ret" data-ref-filename="103ret">ret</a> = <var>1</var>;</td></tr>
<tr><th id="768">768</th><td>      <a class="local col4 ref" href="#104found_session" title='found_session' data-ref="104found_session" data-ref-filename="104found_session">found_session</a> = <a class="ref fn" href="internal.h.html#2464" title='lh_SSL_SESSION_delete' data-ref="_Z21lh_SSL_SESSION_deleteP20lhash_st_SSL_SESSIONPK14ssl_session_st" data-ref-filename="_Z21lh_SSL_SESSION_deleteP20lhash_st_SSL_SESSIONPK14ssl_session_st">lh_SSL_SESSION_delete</a>(<a class="local col0 ref" href="#100ctx" title='ctx' data-ref="100ctx" data-ref-filename="100ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::sessions" title='ssl_ctx_st::sessions' data-ref="ssl_ctx_st::sessions" data-ref-filename="ssl_ctx_st..sessions">sessions</a>, <a class="local col1 ref" href="#101session" title='session' data-ref="101session" data-ref-filename="101session">session</a>);</td></tr>
<tr><th id="769">769</th><td>      <a class="tu ref fn" href="#_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st" title='bssl::SSL_SESSION_list_remove' data-use='c' data-ref="_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st" data-ref-filename="_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st">SSL_SESSION_list_remove</a>(<a class="local col0 ref" href="#100ctx" title='ctx' data-ref="100ctx" data-ref-filename="100ctx">ctx</a>, <a class="local col1 ref" href="#101session" title='session' data-ref="101session" data-ref-filename="101session">session</a>);</td></tr>
<tr><th id="770">770</th><td>    }</td></tr>
<tr><th id="771">771</th><td></td></tr>
<tr><th id="772">772</th><td>    <b>if</b> (<a class="local col2 ref" href="#102lock" title='lock' data-ref="102lock" data-ref-filename="102lock">lock</a>) {</td></tr>
<tr><th id="773">773</th><td>      <a class="ref fn" href="../crypto/internal.h.html#CRYPTO_MUTEX_unlock_write" title='CRYPTO_MUTEX_unlock_write' data-ref="CRYPTO_MUTEX_unlock_write" data-ref-filename="CRYPTO_MUTEX_unlock_write">CRYPTO_MUTEX_unlock_write</a>(&amp;<a class="local col0 ref" href="#100ctx" title='ctx' data-ref="100ctx" data-ref-filename="100ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::lock" title='ssl_ctx_st::lock' data-ref="ssl_ctx_st::lock" data-ref-filename="ssl_ctx_st..lock">lock</a>);</td></tr>
<tr><th id="774">774</th><td>    }</td></tr>
<tr><th id="775">775</th><td></td></tr>
<tr><th id="776">776</th><td>    <b>if</b> (<a class="local col3 ref" href="#103ret" title='ret' data-ref="103ret" data-ref-filename="103ret">ret</a>) {</td></tr>
<tr><th id="777">777</th><td>      <b>if</b> (<a class="local col0 ref" href="#100ctx" title='ctx' data-ref="100ctx" data-ref-filename="100ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::remove_session_cb" title='ssl_ctx_st::remove_session_cb' data-ref="ssl_ctx_st::remove_session_cb" data-ref-filename="ssl_ctx_st..remove_session_cb">remove_session_cb</a> != <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="778">778</th><td>        <a class="local col0 ref" href="#100ctx" title='ctx' data-ref="100ctx" data-ref-filename="100ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::remove_session_cb" title='ssl_ctx_st::remove_session_cb' data-ref="ssl_ctx_st::remove_session_cb" data-ref-filename="ssl_ctx_st..remove_session_cb">remove_session_cb</a>(<a class="local col0 ref" href="#100ctx" title='ctx' data-ref="100ctx" data-ref-filename="100ctx">ctx</a>, <a class="local col4 ref" href="#104found_session" title='found_session' data-ref="104found_session" data-ref-filename="104found_session">found_session</a>);</td></tr>
<tr><th id="779">779</th><td>      }</td></tr>
<tr><th id="780">780</th><td>      <a class="ref fn" href="#SSL_SESSION_free" title='SSL_SESSION_free' data-ref="SSL_SESSION_free" data-ref-filename="SSL_SESSION_free">SSL_SESSION_free</a>(<a class="local col4 ref" href="#104found_session" title='found_session' data-ref="104found_session" data-ref-filename="104found_session">found_session</a>);</td></tr>
<tr><th id="781">781</th><td>    }</td></tr>
<tr><th id="782">782</th><td>  }</td></tr>
<tr><th id="783">783</th><td></td></tr>
<tr><th id="784">784</th><td>  <b>return</b> <a class="local col3 ref" href="#103ret" title='ret' data-ref="103ret" data-ref-filename="103ret">ret</a>;</td></tr>
<tr><th id="785">785</th><td>}</td></tr>
<tr><th id="786">786</th><td></td></tr>
<tr><th id="787">787</th><td><em>void</em> <dfn class="decl def fn" id="_ZN4bssl15ssl_set_sessionEP6ssl_stP14ssl_session_st" title='bssl::ssl_set_session' data-ref="_ZN4bssl15ssl_set_sessionEP6ssl_stP14ssl_session_st" data-ref-filename="_ZN4bssl15ssl_set_sessionEP6ssl_stP14ssl_session_st">ssl_set_session</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<dfn class="local col5 decl" id="105ssl" title='ssl' data-type='SSL *' data-ref="105ssl" data-ref-filename="105ssl">ssl</dfn>, <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col6 decl" id="106session" title='session' data-type='SSL_SESSION *' data-ref="106session" data-ref-filename="106session">session</dfn>) {</td></tr>
<tr><th id="788">788</th><td>  <b>if</b> (<a class="local col5 ref" href="#105ssl" title='ssl' data-ref="105ssl" data-ref-filename="105ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session" title='ssl_st::session' data-ref="ssl_st::session" data-ref-filename="ssl_st..session">session</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>() == <a class="local col6 ref" href="#106session" title='session' data-ref="106session" data-ref-filename="106session">session</a>) {</td></tr>
<tr><th id="789">789</th><td>    <b>return</b>;</td></tr>
<tr><th id="790">790</th><td>  }</td></tr>
<tr><th id="791">791</th><td></td></tr>
<tr><th id="792">792</th><td>  <a class="local col5 ref" href="#105ssl" title='ssl' data-ref="105ssl" data-ref-filename="105ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session" title='ssl_st::session' data-ref="ssl_st::session" data-ref-filename="ssl_st..session">session</a> <span class='ref fn' title='std::__1::unique_ptr::operator=' data-ref="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE" data-ref-filename="_ZNSt3__110unique_ptraSEONS_10unique_ptrIT_T0_EE">=</span> <a class="ref fn" href="../include/openssl/ssl.h.html#5147" title='bssl::UpRef' data-ref="_ZN4bssl5UpRefEP14ssl_session_st" data-ref-filename="_ZN4bssl5UpRefEP14ssl_session_st">UpRef</a>(<a class="local col6 ref" href="#106session" title='session' data-ref="106session" data-ref-filename="106session">session</a>);</td></tr>
<tr><th id="793">793</th><td>}</td></tr>
<tr><th id="794">794</th><td></td></tr>
<tr><th id="795">795</th><td><i  data-doc="_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st">// locked by SSL_CTX in the calling function</i></td></tr>
<tr><th id="796">796</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st" title='bssl::SSL_SESSION_list_remove' data-type='void bssl::SSL_SESSION_list_remove(SSL_CTX * ctx, SSL_SESSION * session)' data-ref="_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st" data-ref-filename="_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st">SSL_SESSION_list_remove</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col7 decl" id="107ctx" title='ctx' data-type='SSL_CTX *' data-ref="107ctx" data-ref-filename="107ctx">ctx</dfn>, <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col8 decl" id="108session" title='session' data-type='SSL_SESSION *' data-ref="108session" data-ref-filename="108session">session</dfn>) {</td></tr>
<tr><th id="797">797</th><td>  <b>if</b> (<a class="local col8 ref" href="#108session" title='session' data-ref="108session" data-ref-filename="108session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::next" title='ssl_session_st::next' data-ref="ssl_session_st::next" data-ref-filename="ssl_session_st..next">next</a> == <span class="macro" title="__null" data-ref="_M/NULL">NULL</span> || <a class="local col8 ref" href="#108session" title='session' data-ref="108session" data-ref-filename="108session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::prev" title='ssl_session_st::prev' data-ref="ssl_session_st::prev" data-ref-filename="ssl_session_st..prev">prev</a> == <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="798">798</th><td>    <b>return</b>;</td></tr>
<tr><th id="799">799</th><td>  }</td></tr>
<tr><th id="800">800</th><td></td></tr>
<tr><th id="801">801</th><td>  <b>if</b> (<a class="local col8 ref" href="#108session" title='session' data-ref="108session" data-ref-filename="108session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::next" title='ssl_session_st::next' data-ref="ssl_session_st::next" data-ref-filename="ssl_session_st..next">next</a> == (<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *)&amp;<a class="local col7 ref" href="#107ctx" title='ctx' data-ref="107ctx" data-ref-filename="107ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_tail" title='ssl_ctx_st::session_cache_tail' data-ref="ssl_ctx_st::session_cache_tail" data-ref-filename="ssl_ctx_st..session_cache_tail">session_cache_tail</a>) {</td></tr>
<tr><th id="802">802</th><td>    <i>// last element in list</i></td></tr>
<tr><th id="803">803</th><td>    <b>if</b> (<a class="local col8 ref" href="#108session" title='session' data-ref="108session" data-ref-filename="108session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::prev" title='ssl_session_st::prev' data-ref="ssl_session_st::prev" data-ref-filename="ssl_session_st..prev">prev</a> == (<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *)&amp;<a class="local col7 ref" href="#107ctx" title='ctx' data-ref="107ctx" data-ref-filename="107ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_head" title='ssl_ctx_st::session_cache_head' data-ref="ssl_ctx_st::session_cache_head" data-ref-filename="ssl_ctx_st..session_cache_head">session_cache_head</a>) {</td></tr>
<tr><th id="804">804</th><td>      <i>// only one element in list</i></td></tr>
<tr><th id="805">805</th><td>      <a class="local col7 ref" href="#107ctx" title='ctx' data-ref="107ctx" data-ref-filename="107ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_head" title='ssl_ctx_st::session_cache_head' data-ref="ssl_ctx_st::session_cache_head" data-ref-filename="ssl_ctx_st..session_cache_head">session_cache_head</a> = <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="806">806</th><td>      <a class="local col7 ref" href="#107ctx" title='ctx' data-ref="107ctx" data-ref-filename="107ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_tail" title='ssl_ctx_st::session_cache_tail' data-ref="ssl_ctx_st::session_cache_tail" data-ref-filename="ssl_ctx_st..session_cache_tail">session_cache_tail</a> = <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="807">807</th><td>    } <b>else</b> {</td></tr>
<tr><th id="808">808</th><td>      <a class="local col7 ref" href="#107ctx" title='ctx' data-ref="107ctx" data-ref-filename="107ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_tail" title='ssl_ctx_st::session_cache_tail' data-ref="ssl_ctx_st::session_cache_tail" data-ref-filename="ssl_ctx_st..session_cache_tail">session_cache_tail</a> = <a class="local col8 ref" href="#108session" title='session' data-ref="108session" data-ref-filename="108session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::prev" title='ssl_session_st::prev' data-ref="ssl_session_st::prev" data-ref-filename="ssl_session_st..prev">prev</a>;</td></tr>
<tr><th id="809">809</th><td>      <a class="local col8 ref" href="#108session" title='session' data-ref="108session" data-ref-filename="108session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::prev" title='ssl_session_st::prev' data-ref="ssl_session_st::prev" data-ref-filename="ssl_session_st..prev">prev</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::next" title='ssl_session_st::next' data-ref="ssl_session_st::next" data-ref-filename="ssl_session_st..next">next</a> = (<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *)&amp;(<a class="local col7 ref" href="#107ctx" title='ctx' data-ref="107ctx" data-ref-filename="107ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_tail" title='ssl_ctx_st::session_cache_tail' data-ref="ssl_ctx_st::session_cache_tail" data-ref-filename="ssl_ctx_st..session_cache_tail">session_cache_tail</a>);</td></tr>
<tr><th id="810">810</th><td>    }</td></tr>
<tr><th id="811">811</th><td>  } <b>else</b> {</td></tr>
<tr><th id="812">812</th><td>    <b>if</b> (<a class="local col8 ref" href="#108session" title='session' data-ref="108session" data-ref-filename="108session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::prev" title='ssl_session_st::prev' data-ref="ssl_session_st::prev" data-ref-filename="ssl_session_st..prev">prev</a> == (<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *)&amp;<a class="local col7 ref" href="#107ctx" title='ctx' data-ref="107ctx" data-ref-filename="107ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_head" title='ssl_ctx_st::session_cache_head' data-ref="ssl_ctx_st::session_cache_head" data-ref-filename="ssl_ctx_st..session_cache_head">session_cache_head</a>) {</td></tr>
<tr><th id="813">813</th><td>      <i>// first element in list</i></td></tr>
<tr><th id="814">814</th><td>      <a class="local col7 ref" href="#107ctx" title='ctx' data-ref="107ctx" data-ref-filename="107ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_head" title='ssl_ctx_st::session_cache_head' data-ref="ssl_ctx_st::session_cache_head" data-ref-filename="ssl_ctx_st..session_cache_head">session_cache_head</a> = <a class="local col8 ref" href="#108session" title='session' data-ref="108session" data-ref-filename="108session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::next" title='ssl_session_st::next' data-ref="ssl_session_st::next" data-ref-filename="ssl_session_st..next">next</a>;</td></tr>
<tr><th id="815">815</th><td>      <a class="local col8 ref" href="#108session" title='session' data-ref="108session" data-ref-filename="108session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::next" title='ssl_session_st::next' data-ref="ssl_session_st::next" data-ref-filename="ssl_session_st..next">next</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::prev" title='ssl_session_st::prev' data-ref="ssl_session_st::prev" data-ref-filename="ssl_session_st..prev">prev</a> = (<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *)&amp;(<a class="local col7 ref" href="#107ctx" title='ctx' data-ref="107ctx" data-ref-filename="107ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_head" title='ssl_ctx_st::session_cache_head' data-ref="ssl_ctx_st::session_cache_head" data-ref-filename="ssl_ctx_st..session_cache_head">session_cache_head</a>);</td></tr>
<tr><th id="816">816</th><td>    } <b>else</b> {  <i>// middle of list</i></td></tr>
<tr><th id="817">817</th><td>      <a class="local col8 ref" href="#108session" title='session' data-ref="108session" data-ref-filename="108session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::next" title='ssl_session_st::next' data-ref="ssl_session_st::next" data-ref-filename="ssl_session_st..next">next</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::prev" title='ssl_session_st::prev' data-ref="ssl_session_st::prev" data-ref-filename="ssl_session_st..prev">prev</a> = <a class="local col8 ref" href="#108session" title='session' data-ref="108session" data-ref-filename="108session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::prev" title='ssl_session_st::prev' data-ref="ssl_session_st::prev" data-ref-filename="ssl_session_st..prev">prev</a>;</td></tr>
<tr><th id="818">818</th><td>      <a class="local col8 ref" href="#108session" title='session' data-ref="108session" data-ref-filename="108session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::prev" title='ssl_session_st::prev' data-ref="ssl_session_st::prev" data-ref-filename="ssl_session_st..prev">prev</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::next" title='ssl_session_st::next' data-ref="ssl_session_st::next" data-ref-filename="ssl_session_st..next">next</a> = <a class="local col8 ref" href="#108session" title='session' data-ref="108session" data-ref-filename="108session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::next" title='ssl_session_st::next' data-ref="ssl_session_st::next" data-ref-filename="ssl_session_st..next">next</a>;</td></tr>
<tr><th id="819">819</th><td>    }</td></tr>
<tr><th id="820">820</th><td>  }</td></tr>
<tr><th id="821">821</th><td>  <a class="local col8 ref" href="#108session" title='session' data-ref="108session" data-ref-filename="108session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::prev" title='ssl_session_st::prev' data-ref="ssl_session_st::prev" data-ref-filename="ssl_session_st..prev">prev</a> = <a class="local col8 ref" href="#108session" title='session' data-ref="108session" data-ref-filename="108session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::next" title='ssl_session_st::next' data-ref="ssl_session_st::next" data-ref-filename="ssl_session_st..next">next</a> = <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="822">822</th><td>}</td></tr>
<tr><th id="823">823</th><td></td></tr>
<tr><th id="824">824</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="_ZN4bsslL20SSL_SESSION_list_addEP10ssl_ctx_stP14ssl_session_st" title='bssl::SSL_SESSION_list_add' data-type='void bssl::SSL_SESSION_list_add(SSL_CTX * ctx, SSL_SESSION * session)' data-ref="_ZN4bsslL20SSL_SESSION_list_addEP10ssl_ctx_stP14ssl_session_st" data-ref-filename="_ZN4bsslL20SSL_SESSION_list_addEP10ssl_ctx_stP14ssl_session_st">SSL_SESSION_list_add</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col9 decl" id="109ctx" title='ctx' data-type='SSL_CTX *' data-ref="109ctx" data-ref-filename="109ctx">ctx</dfn>, <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col0 decl" id="110session" title='session' data-type='SSL_SESSION *' data-ref="110session" data-ref-filename="110session">session</dfn>) {</td></tr>
<tr><th id="825">825</th><td>  <b>if</b> (<a class="local col0 ref" href="#110session" title='session' data-ref="110session" data-ref-filename="110session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::next" title='ssl_session_st::next' data-ref="ssl_session_st::next" data-ref-filename="ssl_session_st..next">next</a> != <span class="macro" title="__null" data-ref="_M/NULL">NULL</span> &amp;&amp; <a class="local col0 ref" href="#110session" title='session' data-ref="110session" data-ref-filename="110session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::prev" title='ssl_session_st::prev' data-ref="ssl_session_st::prev" data-ref-filename="ssl_session_st..prev">prev</a> != <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="826">826</th><td>    <a class="tu ref fn" href="#_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st" title='bssl::SSL_SESSION_list_remove' data-use='c' data-ref="_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st" data-ref-filename="_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st">SSL_SESSION_list_remove</a>(<a class="local col9 ref" href="#109ctx" title='ctx' data-ref="109ctx" data-ref-filename="109ctx">ctx</a>, <a class="local col0 ref" href="#110session" title='session' data-ref="110session" data-ref-filename="110session">session</a>);</td></tr>
<tr><th id="827">827</th><td>  }</td></tr>
<tr><th id="828">828</th><td></td></tr>
<tr><th id="829">829</th><td>  <b>if</b> (<a class="local col9 ref" href="#109ctx" title='ctx' data-ref="109ctx" data-ref-filename="109ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_head" title='ssl_ctx_st::session_cache_head' data-ref="ssl_ctx_st::session_cache_head" data-ref-filename="ssl_ctx_st..session_cache_head">session_cache_head</a> == <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="830">830</th><td>    <a class="local col9 ref" href="#109ctx" title='ctx' data-ref="109ctx" data-ref-filename="109ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_head" title='ssl_ctx_st::session_cache_head' data-ref="ssl_ctx_st::session_cache_head" data-ref-filename="ssl_ctx_st..session_cache_head">session_cache_head</a> = <a class="local col0 ref" href="#110session" title='session' data-ref="110session" data-ref-filename="110session">session</a>;</td></tr>
<tr><th id="831">831</th><td>    <a class="local col9 ref" href="#109ctx" title='ctx' data-ref="109ctx" data-ref-filename="109ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_tail" title='ssl_ctx_st::session_cache_tail' data-ref="ssl_ctx_st::session_cache_tail" data-ref-filename="ssl_ctx_st..session_cache_tail">session_cache_tail</a> = <a class="local col0 ref" href="#110session" title='session' data-ref="110session" data-ref-filename="110session">session</a>;</td></tr>
<tr><th id="832">832</th><td>    <a class="local col0 ref" href="#110session" title='session' data-ref="110session" data-ref-filename="110session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::prev" title='ssl_session_st::prev' data-ref="ssl_session_st::prev" data-ref-filename="ssl_session_st..prev">prev</a> = (<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *)&amp;(<a class="local col9 ref" href="#109ctx" title='ctx' data-ref="109ctx" data-ref-filename="109ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_head" title='ssl_ctx_st::session_cache_head' data-ref="ssl_ctx_st::session_cache_head" data-ref-filename="ssl_ctx_st..session_cache_head">session_cache_head</a>);</td></tr>
<tr><th id="833">833</th><td>    <a class="local col0 ref" href="#110session" title='session' data-ref="110session" data-ref-filename="110session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::next" title='ssl_session_st::next' data-ref="ssl_session_st::next" data-ref-filename="ssl_session_st..next">next</a> = (<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *)&amp;(<a class="local col9 ref" href="#109ctx" title='ctx' data-ref="109ctx" data-ref-filename="109ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_tail" title='ssl_ctx_st::session_cache_tail' data-ref="ssl_ctx_st::session_cache_tail" data-ref-filename="ssl_ctx_st..session_cache_tail">session_cache_tail</a>);</td></tr>
<tr><th id="834">834</th><td>  } <b>else</b> {</td></tr>
<tr><th id="835">835</th><td>    <a class="local col0 ref" href="#110session" title='session' data-ref="110session" data-ref-filename="110session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::next" title='ssl_session_st::next' data-ref="ssl_session_st::next" data-ref-filename="ssl_session_st..next">next</a> = <a class="local col9 ref" href="#109ctx" title='ctx' data-ref="109ctx" data-ref-filename="109ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_head" title='ssl_ctx_st::session_cache_head' data-ref="ssl_ctx_st::session_cache_head" data-ref-filename="ssl_ctx_st..session_cache_head">session_cache_head</a>;</td></tr>
<tr><th id="836">836</th><td>    <a class="local col0 ref" href="#110session" title='session' data-ref="110session" data-ref-filename="110session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::next" title='ssl_session_st::next' data-ref="ssl_session_st::next" data-ref-filename="ssl_session_st..next">next</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::prev" title='ssl_session_st::prev' data-ref="ssl_session_st::prev" data-ref-filename="ssl_session_st..prev">prev</a> = <a class="local col0 ref" href="#110session" title='session' data-ref="110session" data-ref-filename="110session">session</a>;</td></tr>
<tr><th id="837">837</th><td>    <a class="local col0 ref" href="#110session" title='session' data-ref="110session" data-ref-filename="110session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::prev" title='ssl_session_st::prev' data-ref="ssl_session_st::prev" data-ref-filename="ssl_session_st..prev">prev</a> = (<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *)&amp;(<a class="local col9 ref" href="#109ctx" title='ctx' data-ref="109ctx" data-ref-filename="109ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_head" title='ssl_ctx_st::session_cache_head' data-ref="ssl_ctx_st::session_cache_head" data-ref-filename="ssl_ctx_st..session_cache_head">session_cache_head</a>);</td></tr>
<tr><th id="838">838</th><td>    <a class="local col9 ref" href="#109ctx" title='ctx' data-ref="109ctx" data-ref-filename="109ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_head" title='ssl_ctx_st::session_cache_head' data-ref="ssl_ctx_st::session_cache_head" data-ref-filename="ssl_ctx_st..session_cache_head">session_cache_head</a> = <a class="local col0 ref" href="#110session" title='session' data-ref="110session" data-ref-filename="110session">session</a>;</td></tr>
<tr><th id="839">839</th><td>  }</td></tr>
<tr><th id="840">840</th><td>}</td></tr>
<tr><th id="841">841</th><td></td></tr>
<tr><th id="842">842</th><td><a class="macro" href="../include/openssl/base.h.html#477" title="}" data-ref="_M/BSSL_NAMESPACE_END">BSSL_NAMESPACE_END</a></td></tr>
<tr><th id="843">843</th><td></td></tr>
<tr><th id="844">844</th><td><b>using</b> <b>namespace</b> <span class="namespace">bssl</span>;</td></tr>
<tr><th id="845">845</th><td></td></tr>
<tr><th id="846">846</th><td><a class="type" href="internal.h.html#ssl_session_st" title='ssl_session_st' data-ref="ssl_session_st" data-ref-filename="ssl_session_st">ssl_session_st</a>::<dfn class="decl def fn" id="_ZN14ssl_session_stC1EPKN4bssl15SSL_X509_METHODE" title='ssl_session_st::ssl_session_st' data-ref="_ZN14ssl_session_stC1EPKN4bssl15SSL_X509_METHODE" data-ref-filename="_ZN14ssl_session_stC1EPKN4bssl15SSL_X509_METHODE">ssl_session_st</dfn>(<em>const</em> <a class="type" href="internal.h.html#bssl::SSL_X509_METHOD" title='bssl::SSL_X509_METHOD' data-ref="bssl::SSL_X509_METHOD" data-ref-filename="bssl..SSL_X509_METHOD">SSL_X509_METHOD</a> *<dfn class="local col1 decl" id="111method" title='method' data-type='const bssl::SSL_X509_METHOD *' data-ref="111method" data-ref-filename="111method">method</dfn>)</td></tr>
<tr><th id="847">847</th><td>    : <a class="member field" href="internal.h.html#ssl_session_st::x509_method" title='ssl_session_st::x509_method' data-ref="ssl_session_st::x509_method" data-ref-filename="ssl_session_st..x509_method">x509_method</a>(<a class="local col1 ref" href="#111method" title='method' data-ref="111method" data-ref-filename="111method">method</a>),</td></tr>
<tr><th id="848">848</th><td>      <a class="member field" href="internal.h.html#ssl_session_st::extended_master_secret" title='ssl_session_st::extended_master_secret' data-ref="ssl_session_st::extended_master_secret" data-ref-filename="ssl_session_st..extended_master_secret">extended_master_secret</a>(<b>false</b>),</td></tr>
<tr><th id="849">849</th><td>      <a class="member field" href="internal.h.html#ssl_session_st::peer_sha256_valid" title='ssl_session_st::peer_sha256_valid' data-ref="ssl_session_st::peer_sha256_valid" data-ref-filename="ssl_session_st..peer_sha256_valid">peer_sha256_valid</a>(<b>false</b>),</td></tr>
<tr><th id="850">850</th><td>      <a class="member field" href="internal.h.html#ssl_session_st::not_resumable" title='ssl_session_st::not_resumable' data-ref="ssl_session_st::not_resumable" data-ref-filename="ssl_session_st..not_resumable">not_resumable</a>(<b>false</b>),</td></tr>
<tr><th id="851">851</th><td>      <a class="member field" href="internal.h.html#ssl_session_st::ticket_age_add_valid" title='ssl_session_st::ticket_age_add_valid' data-ref="ssl_session_st::ticket_age_add_valid" data-ref-filename="ssl_session_st..ticket_age_add_valid">ticket_age_add_valid</a>(<b>false</b>),</td></tr>
<tr><th id="852">852</th><td>      <a class="member field" href="internal.h.html#ssl_session_st::is_server" title='ssl_session_st::is_server' data-ref="ssl_session_st::is_server" data-ref-filename="ssl_session_st..is_server">is_server</a>(<b>false</b>),</td></tr>
<tr><th id="853">853</th><td>      <a class="member field" href="internal.h.html#ssl_session_st::is_quic" title='ssl_session_st::is_quic' data-ref="ssl_session_st::is_quic" data-ref-filename="ssl_session_st..is_quic">is_quic</a>(<b>false</b>),</td></tr>
<tr><th id="854">854</th><td>      <a class="member field" href="internal.h.html#ssl_session_st::has_application_settings" title='ssl_session_st::has_application_settings' data-ref="ssl_session_st::has_application_settings" data-ref-filename="ssl_session_st..has_application_settings">has_application_settings</a>(<b>false</b>) {</td></tr>
<tr><th id="855">855</th><td>  <a class="ref fn" href="../crypto/internal.h.html#CRYPTO_new_ex_data" title='CRYPTO_new_ex_data' data-ref="CRYPTO_new_ex_data" data-ref-filename="CRYPTO_new_ex_data">CRYPTO_new_ex_data</a>(&amp;<a class="member field" href="internal.h.html#ssl_session_st::ex_data" title='ssl_session_st::ex_data' data-ref="ssl_session_st::ex_data" data-ref-filename="ssl_session_st..ex_data">ex_data</a>);</td></tr>
<tr><th id="856">856</th><td>  <a class="member field" href="internal.h.html#ssl_session_st::time" title='ssl_session_st::time' data-ref="ssl_session_st::time" data-ref-filename="ssl_session_st..time">time</a> = ::<span class='ref fn' title='time' data-ref="time" data-ref-filename="time">time</span>(<b>nullptr</b>);</td></tr>
<tr><th id="857">857</th><td>}</td></tr>
<tr><th id="858">858</th><td></td></tr>
<tr><th id="859">859</th><td><a class="type" href="internal.h.html#ssl_session_st" title='ssl_session_st' data-ref="ssl_session_st" data-ref-filename="ssl_session_st">ssl_session_st</a>::<dfn class="decl def fn" id="_ZN14ssl_session_stD1Ev" title='ssl_session_st::~ssl_session_st' data-ref="_ZN14ssl_session_stD1Ev" data-ref-filename="_ZN14ssl_session_stD1Ev">~ssl_session_st</dfn>() {</td></tr>
<tr><th id="860">860</th><td>  <a class="ref fn" href="../crypto/internal.h.html#CRYPTO_free_ex_data" title='CRYPTO_free_ex_data' data-ref="CRYPTO_free_ex_data" data-ref-filename="CRYPTO_free_ex_data">CRYPTO_free_ex_data</a>(&amp;<a class="tu ref" href="#bssl::g_ex_data_class" title='bssl::g_ex_data_class' data-use='a' data-ref="bssl::g_ex_data_class" data-ref-filename="bssl..g_ex_data_class">g_ex_data_class</a>, <b>this</b>, &amp;<a class="member field" href="internal.h.html#ssl_session_st::ex_data" title='ssl_session_st::ex_data' data-ref="ssl_session_st::ex_data" data-ref-filename="ssl_session_st..ex_data">ex_data</a>);</td></tr>
<tr><th id="861">861</th><td>  <a class="member field" href="internal.h.html#ssl_session_st::x509_method" title='ssl_session_st::x509_method' data-ref="ssl_session_st::x509_method" data-ref-filename="ssl_session_st..x509_method">x509_method</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_X509_METHOD::session_clear" title='bssl::SSL_X509_METHOD::session_clear' data-ref="bssl::SSL_X509_METHOD::session_clear" data-ref-filename="bssl..SSL_X509_METHOD..session_clear">session_clear</a>(<b>this</b>);</td></tr>
<tr><th id="862">862</th><td>}</td></tr>
<tr><th id="863">863</th><td></td></tr>
<tr><th id="864">864</th><td><a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="decl def fn" id="SSL_SESSION_new" title='SSL_SESSION_new' data-ref="SSL_SESSION_new" data-ref-filename="SSL_SESSION_new">SSL_SESSION_new</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col2 decl" id="112ctx" title='ctx' data-type='const SSL_CTX *' data-ref="112ctx" data-ref-filename="112ctx">ctx</dfn>) {</td></tr>
<tr><th id="865">865</th><td>  <b>return</b> <a class="ref fn" href="#_ZN4bssl15ssl_session_newEPKNS_15SSL_X509_METHODE" title='bssl::ssl_session_new' data-ref="_ZN4bssl15ssl_session_newEPKNS_15SSL_X509_METHODE" data-ref-filename="_ZN4bssl15ssl_session_newEPKNS_15SSL_X509_METHODE">ssl_session_new</a>(<a class="local col2 ref" href="#112ctx" title='ctx' data-ref="112ctx" data-ref-filename="112ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::x509_method" title='ssl_ctx_st::x509_method' data-ref="ssl_ctx_st::x509_method" data-ref-filename="ssl_ctx_st..x509_method">x509_method</a>).<span class='ref fn' title='std::__1::unique_ptr::release' data-ref="_ZNSt3__110unique_ptr7releaseEv" data-ref-filename="_ZNSt3__110unique_ptr7releaseEv">release</span>();</td></tr>
<tr><th id="866">866</th><td>}</td></tr>
<tr><th id="867">867</th><td></td></tr>
<tr><th id="868">868</th><td><em>int</em> <dfn class="decl def fn" id="SSL_SESSION_up_ref" title='SSL_SESSION_up_ref' data-ref="SSL_SESSION_up_ref" data-ref-filename="SSL_SESSION_up_ref">SSL_SESSION_up_ref</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col3 decl" id="113session" title='session' data-type='SSL_SESSION *' data-ref="113session" data-ref-filename="113session">session</dfn>) {</td></tr>
<tr><th id="869">869</th><td>  <a class="ref fn" href="../crypto/internal.h.html#CRYPTO_refcount_inc" title='CRYPTO_refcount_inc' data-ref="CRYPTO_refcount_inc" data-ref-filename="CRYPTO_refcount_inc">CRYPTO_refcount_inc</a>(&amp;<a class="local col3 ref" href="#113session" title='session' data-ref="113session" data-ref-filename="113session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::references" title='ssl_session_st::references' data-ref="ssl_session_st::references" data-ref-filename="ssl_session_st..references">references</a>);</td></tr>
<tr><th id="870">870</th><td>  <b>return</b> <var>1</var>;</td></tr>
<tr><th id="871">871</th><td>}</td></tr>
<tr><th id="872">872</th><td></td></tr>
<tr><th id="873">873</th><td><em>void</em> <dfn class="decl def fn" id="SSL_SESSION_free" title='SSL_SESSION_free' data-ref="SSL_SESSION_free" data-ref-filename="SSL_SESSION_free">SSL_SESSION_free</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col4 decl" id="114session" title='session' data-type='SSL_SESSION *' data-ref="114session" data-ref-filename="114session">session</dfn>) {</td></tr>
<tr><th id="874">874</th><td>  <b>if</b> (<a class="local col4 ref" href="#114session" title='session' data-ref="114session" data-ref-filename="114session">session</a> == <span class="macro" title="__null" data-ref="_M/NULL">NULL</span> ||</td></tr>
<tr><th id="875">875</th><td>      !<a class="ref fn" href="../crypto/internal.h.html#CRYPTO_refcount_dec_and_test_zero" title='CRYPTO_refcount_dec_and_test_zero' data-ref="CRYPTO_refcount_dec_and_test_zero" data-ref-filename="CRYPTO_refcount_dec_and_test_zero">CRYPTO_refcount_dec_and_test_zero</a>(&amp;<a class="local col4 ref" href="#114session" title='session' data-ref="114session" data-ref-filename="114session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::references" title='ssl_session_st::references' data-ref="ssl_session_st::references" data-ref-filename="ssl_session_st..references">references</a>)) {</td></tr>
<tr><th id="876">876</th><td>    <b>return</b>;</td></tr>
<tr><th id="877">877</th><td>  }</td></tr>
<tr><th id="878">878</th><td></td></tr>
<tr><th id="879">879</th><td>  <a class="local col4 ref" href="#114session" title='session' data-ref="114session" data-ref-filename="114session">session</a>-&gt;<a class="ref fn" href="#_ZN14ssl_session_stD1Ev" title='ssl_session_st::~ssl_session_st' data-ref="_ZN14ssl_session_stD1Ev" data-ref-filename="_ZN14ssl_session_stD1Ev">~ssl_session_st</a>();</td></tr>
<tr><th id="880">880</th><td>  <a class="ref fn" href="../include/openssl/mem.h.html#OPENSSL_free" title='OPENSSL_free' data-ref="OPENSSL_free" data-ref-filename="OPENSSL_free">OPENSSL_free</a>(<a class="local col4 ref" href="#114session" title='session' data-ref="114session" data-ref-filename="114session">session</a>);</td></tr>
<tr><th id="881">881</th><td>}</td></tr>
<tr><th id="882">882</th><td></td></tr>
<tr><th id="883">883</th><td><em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> *<dfn class="decl def fn" id="SSL_SESSION_get_id" title='SSL_SESSION_get_id' data-ref="SSL_SESSION_get_id" data-ref-filename="SSL_SESSION_get_id">SSL_SESSION_get_id</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col5 decl" id="115session" title='session' data-type='const SSL_SESSION *' data-ref="115session" data-ref-filename="115session">session</dfn>,</td></tr>
<tr><th id="884">884</th><td>                                  <em>unsigned</em> *<dfn class="local col6 decl" id="116out_len" title='out_len' data-type='unsigned int *' data-ref="116out_len" data-ref-filename="116out_len">out_len</dfn>) {</td></tr>
<tr><th id="885">885</th><td>  <b>if</b> (<a class="local col6 ref" href="#116out_len" title='out_len' data-ref="116out_len" data-ref-filename="116out_len">out_len</a> != <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="886">886</th><td>    *<a class="local col6 ref" href="#116out_len" title='out_len' data-ref="116out_len" data-ref-filename="116out_len">out_len</a> = <a class="local col5 ref" href="#115session" title='session' data-ref="115session" data-ref-filename="115session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::session_id_length" title='ssl_session_st::session_id_length' data-ref="ssl_session_st::session_id_length" data-ref-filename="ssl_session_st..session_id_length">session_id_length</a>;</td></tr>
<tr><th id="887">887</th><td>  }</td></tr>
<tr><th id="888">888</th><td>  <b>return</b> <a class="local col5 ref" href="#115session" title='session' data-ref="115session" data-ref-filename="115session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::session_id" title='ssl_session_st::session_id' data-ref="ssl_session_st::session_id" data-ref-filename="ssl_session_st..session_id">session_id</a>;</td></tr>
<tr><th id="889">889</th><td>}</td></tr>
<tr><th id="890">890</th><td></td></tr>
<tr><th id="891">891</th><td><em>int</em> <dfn class="decl def fn" id="SSL_SESSION_set1_id" title='SSL_SESSION_set1_id' data-ref="SSL_SESSION_set1_id" data-ref-filename="SSL_SESSION_set1_id">SSL_SESSION_set1_id</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col7 decl" id="117session" title='session' data-type='SSL_SESSION *' data-ref="117session" data-ref-filename="117session">session</dfn>, <em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> *<dfn class="local col8 decl" id="118sid" title='sid' data-type='const uint8_t *' data-ref="118sid" data-ref-filename="118sid">sid</dfn>,</td></tr>
<tr><th id="892">892</th><td>                        <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col9 decl" id="119sid_len" title='sid_len' data-type='size_t' data-ref="119sid_len" data-ref-filename="119sid_len">sid_len</dfn>) {</td></tr>
<tr><th id="893">893</th><td>  <b>if</b> (<a class="local col9 ref" href="#119sid_len" title='sid_len' data-ref="119sid_len" data-ref-filename="119sid_len">sid_len</a> &gt; <a class="macro" href="../include/openssl/ssl.h.html#1699" title="32" data-ref="_M/SSL_MAX_SSL_SESSION_ID_LENGTH">SSL_MAX_SSL_SESSION_ID_LENGTH</a>) {</td></tr>
<tr><th id="894">894</th><td>    <a class="macro" href="../include/openssl/err.h.html#423" title="ERR_put_error(ERR_LIB_SSL, 0, 290, &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/third_party/boringssl/src/ssl/ssl_session.cc&quot;, 894)" data-ref="_M/OPENSSL_PUT_ERROR">OPENSSL_PUT_ERROR</a>(SSL, <a class="macro" href="../include/openssl/ssl.h.html#5460" title="290" data-ref="_M/SSL_R_SSL_SESSION_ID_TOO_LONG">SSL_R_SSL_SESSION_ID_TOO_LONG</a>);</td></tr>
<tr><th id="895">895</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="896">896</th><td>  }</td></tr>
<tr><th id="897">897</th><td></td></tr>
<tr><th id="898">898</th><td>  <i>// Use memmove in case someone passes in the output of |SSL_SESSION_get_id|.</i></td></tr>
<tr><th id="899">899</th><td>  <a class="ref fn" href="../crypto/internal.h.html#_ZL15OPENSSL_memmovePvPKvm" title='OPENSSL_memmove' data-ref="_ZL15OPENSSL_memmovePvPKvm" data-ref-filename="_ZL15OPENSSL_memmovePvPKvm">OPENSSL_memmove</a>(<a class="local col7 ref" href="#117session" title='session' data-ref="117session" data-ref-filename="117session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::session_id" title='ssl_session_st::session_id' data-ref="ssl_session_st::session_id" data-ref-filename="ssl_session_st..session_id">session_id</a>, <a class="local col8 ref" href="#118sid" title='sid' data-ref="118sid" data-ref-filename="118sid">sid</a>, <a class="local col9 ref" href="#119sid_len" title='sid_len' data-ref="119sid_len" data-ref-filename="119sid_len">sid_len</a>);</td></tr>
<tr><th id="900">900</th><td>  <a class="local col7 ref" href="#117session" title='session' data-ref="117session" data-ref-filename="117session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::session_id_length" title='ssl_session_st::session_id_length' data-ref="ssl_session_st::session_id_length" data-ref-filename="ssl_session_st..session_id_length">session_id_length</a> = <a class="local col9 ref" href="#119sid_len" title='sid_len' data-ref="119sid_len" data-ref-filename="119sid_len">sid_len</a>;</td></tr>
<tr><th id="901">901</th><td>  <b>return</b> <var>1</var>;</td></tr>
<tr><th id="902">902</th><td>}</td></tr>
<tr><th id="903">903</th><td></td></tr>
<tr><th id="904">904</th><td><span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span> <dfn class="decl def fn" id="SSL_SESSION_get_timeout" title='SSL_SESSION_get_timeout' data-ref="SSL_SESSION_get_timeout" data-ref-filename="SSL_SESSION_get_timeout">SSL_SESSION_get_timeout</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col0 decl" id="120session" title='session' data-type='const SSL_SESSION *' data-ref="120session" data-ref-filename="120session">session</dfn>) {</td></tr>
<tr><th id="905">905</th><td>  <b>return</b> <a class="local col0 ref" href="#120session" title='session' data-ref="120session" data-ref-filename="120session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a>;</td></tr>
<tr><th id="906">906</th><td>}</td></tr>
<tr><th id="907">907</th><td></td></tr>
<tr><th id="908">908</th><td><span class='typedef' title='uint64_t' data-type='unsigned long long' data-ref="uint64_t" data-ref-filename="uint64_t">uint64_t</span> <dfn class="decl def fn" id="SSL_SESSION_get_time" title='SSL_SESSION_get_time' data-ref="SSL_SESSION_get_time" data-ref-filename="SSL_SESSION_get_time">SSL_SESSION_get_time</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col1 decl" id="121session" title='session' data-type='const SSL_SESSION *' data-ref="121session" data-ref-filename="121session">session</dfn>) {</td></tr>
<tr><th id="909">909</th><td>  <b>if</b> (<a class="local col1 ref" href="#121session" title='session' data-ref="121session" data-ref-filename="121session">session</a> == <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="910">910</th><td>    <i>// NULL should crash, but silently accept it here for compatibility.</i></td></tr>
<tr><th id="911">911</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="912">912</th><td>  }</td></tr>
<tr><th id="913">913</th><td>  <b>return</b> <a class="local col1 ref" href="#121session" title='session' data-ref="121session" data-ref-filename="121session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::time" title='ssl_session_st::time' data-ref="ssl_session_st::time" data-ref-filename="ssl_session_st..time">time</a>;</td></tr>
<tr><th id="914">914</th><td>}</td></tr>
<tr><th id="915">915</th><td></td></tr>
<tr><th id="916">916</th><td><a class="typedef" href="../include/openssl/base.h.html#X509" title='X509' data-type='struct x509_st' data-ref="X509" data-ref-filename="X509">X509</a> *<dfn class="decl def fn" id="SSL_SESSION_get0_peer" title='SSL_SESSION_get0_peer' data-ref="SSL_SESSION_get0_peer" data-ref-filename="SSL_SESSION_get0_peer">SSL_SESSION_get0_peer</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col2 decl" id="122session" title='session' data-type='const SSL_SESSION *' data-ref="122session" data-ref-filename="122session">session</dfn>) {</td></tr>
<tr><th id="917">917</th><td>  <b>return</b> <a class="local col2 ref" href="#122session" title='session' data-ref="122session" data-ref-filename="122session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::x509_peer" title='ssl_session_st::x509_peer' data-ref="ssl_session_st::x509_peer" data-ref-filename="ssl_session_st..x509_peer">x509_peer</a>;</td></tr>
<tr><th id="918">918</th><td>}</td></tr>
<tr><th id="919">919</th><td></td></tr>
<tr><th id="920">920</th><td><em>const</em> <a class="macro" href="../include/openssl/stack.h.html#125" title="struct stack_st_CRYPTO_BUFFER" data-ref="_M/STACK_OF">STACK_OF</a>(CRYPTO_BUFFER) *</td></tr>
<tr><th id="921">921</th><td>    <dfn class="decl def fn" id="SSL_SESSION_get0_peer_certificates" title='SSL_SESSION_get0_peer_certificates' data-ref="SSL_SESSION_get0_peer_certificates" data-ref-filename="SSL_SESSION_get0_peer_certificates">SSL_SESSION_get0_peer_certificates</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col3 decl" id="123session" title='session' data-type='const SSL_SESSION *' data-ref="123session" data-ref-filename="123session">session</dfn>) {</td></tr>
<tr><th id="922">922</th><td>  <b>return</b> <a class="local col3 ref" href="#123session" title='session' data-ref="123session" data-ref-filename="123session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::certs" title='ssl_session_st::certs' data-ref="ssl_session_st::certs" data-ref-filename="ssl_session_st..certs">certs</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>();</td></tr>
<tr><th id="923">923</th><td>}</td></tr>
<tr><th id="924">924</th><td></td></tr>
<tr><th id="925">925</th><td><em>void</em> <dfn class="decl def fn" id="SSL_SESSION_get0_signed_cert_timestamp_list" title='SSL_SESSION_get0_signed_cert_timestamp_list' data-ref="SSL_SESSION_get0_signed_cert_timestamp_list" data-ref-filename="SSL_SESSION_get0_signed_cert_timestamp_list">SSL_SESSION_get0_signed_cert_timestamp_list</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col4 decl" id="124session" title='session' data-type='const SSL_SESSION *' data-ref="124session" data-ref-filename="124session">session</dfn>,</td></tr>
<tr><th id="926">926</th><td>                                                 <em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> **<dfn class="local col5 decl" id="125out" title='out' data-type='const uint8_t **' data-ref="125out" data-ref-filename="125out">out</dfn>,</td></tr>
<tr><th id="927">927</th><td>                                                 <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> *<dfn class="local col6 decl" id="126out_len" title='out_len' data-type='size_t *' data-ref="126out_len" data-ref-filename="126out_len">out_len</dfn>) {</td></tr>
<tr><th id="928">928</th><td>  <b>if</b> (<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col4 ref" href="#124session" title='session' data-ref="124session" data-ref-filename="124session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::signed_cert_timestamp_list" title='ssl_session_st::signed_cert_timestamp_list' data-ref="ssl_session_st::signed_cert_timestamp_list" data-ref-filename="ssl_session_st..signed_cert_timestamp_list">signed_cert_timestamp_list</a>) {</td></tr>
<tr><th id="929">929</th><td>    *<a class="local col5 ref" href="#125out" title='out' data-ref="125out" data-ref-filename="125out">out</a> = <a class="ref fn" href="../include/openssl/pool.h.html#CRYPTO_BUFFER_data" title='CRYPTO_BUFFER_data' data-ref="CRYPTO_BUFFER_data" data-ref-filename="CRYPTO_BUFFER_data">CRYPTO_BUFFER_data</a>(<a class="local col4 ref" href="#124session" title='session' data-ref="124session" data-ref-filename="124session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::signed_cert_timestamp_list" title='ssl_session_st::signed_cert_timestamp_list' data-ref="ssl_session_st::signed_cert_timestamp_list" data-ref-filename="ssl_session_st..signed_cert_timestamp_list">signed_cert_timestamp_list</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>());</td></tr>
<tr><th id="930">930</th><td>    *<a class="local col6 ref" href="#126out_len" title='out_len' data-ref="126out_len" data-ref-filename="126out_len">out_len</a> = <a class="ref fn" href="../include/openssl/pool.h.html#CRYPTO_BUFFER_len" title='CRYPTO_BUFFER_len' data-ref="CRYPTO_BUFFER_len" data-ref-filename="CRYPTO_BUFFER_len">CRYPTO_BUFFER_len</a>(<a class="local col4 ref" href="#124session" title='session' data-ref="124session" data-ref-filename="124session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::signed_cert_timestamp_list" title='ssl_session_st::signed_cert_timestamp_list' data-ref="ssl_session_st::signed_cert_timestamp_list" data-ref-filename="ssl_session_st..signed_cert_timestamp_list">signed_cert_timestamp_list</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>());</td></tr>
<tr><th id="931">931</th><td>  } <b>else</b> {</td></tr>
<tr><th id="932">932</th><td>    *<a class="local col5 ref" href="#125out" title='out' data-ref="125out" data-ref-filename="125out">out</a> = <b>nullptr</b>;</td></tr>
<tr><th id="933">933</th><td>    *<a class="local col6 ref" href="#126out_len" title='out_len' data-ref="126out_len" data-ref-filename="126out_len">out_len</a> = <var>0</var>;</td></tr>
<tr><th id="934">934</th><td>  }</td></tr>
<tr><th id="935">935</th><td>}</td></tr>
<tr><th id="936">936</th><td></td></tr>
<tr><th id="937">937</th><td><em>void</em> <dfn class="decl def fn" id="SSL_SESSION_get0_ocsp_response" title='SSL_SESSION_get0_ocsp_response' data-ref="SSL_SESSION_get0_ocsp_response" data-ref-filename="SSL_SESSION_get0_ocsp_response">SSL_SESSION_get0_ocsp_response</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col7 decl" id="127session" title='session' data-type='const SSL_SESSION *' data-ref="127session" data-ref-filename="127session">session</dfn>,</td></tr>
<tr><th id="938">938</th><td>                                    <em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> **<dfn class="local col8 decl" id="128out" title='out' data-type='const uint8_t **' data-ref="128out" data-ref-filename="128out">out</dfn>, <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> *<dfn class="local col9 decl" id="129out_len" title='out_len' data-type='size_t *' data-ref="129out_len" data-ref-filename="129out_len">out_len</dfn>) {</td></tr>
<tr><th id="939">939</th><td>  <b>if</b> (<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col7 ref" href="#127session" title='session' data-ref="127session" data-ref-filename="127session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ocsp_response" title='ssl_session_st::ocsp_response' data-ref="ssl_session_st::ocsp_response" data-ref-filename="ssl_session_st..ocsp_response">ocsp_response</a>) {</td></tr>
<tr><th id="940">940</th><td>    *<a class="local col8 ref" href="#128out" title='out' data-ref="128out" data-ref-filename="128out">out</a> = <a class="ref fn" href="../include/openssl/pool.h.html#CRYPTO_BUFFER_data" title='CRYPTO_BUFFER_data' data-ref="CRYPTO_BUFFER_data" data-ref-filename="CRYPTO_BUFFER_data">CRYPTO_BUFFER_data</a>(<a class="local col7 ref" href="#127session" title='session' data-ref="127session" data-ref-filename="127session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ocsp_response" title='ssl_session_st::ocsp_response' data-ref="ssl_session_st::ocsp_response" data-ref-filename="ssl_session_st..ocsp_response">ocsp_response</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>());</td></tr>
<tr><th id="941">941</th><td>    *<a class="local col9 ref" href="#129out_len" title='out_len' data-ref="129out_len" data-ref-filename="129out_len">out_len</a> = <a class="ref fn" href="../include/openssl/pool.h.html#CRYPTO_BUFFER_len" title='CRYPTO_BUFFER_len' data-ref="CRYPTO_BUFFER_len" data-ref-filename="CRYPTO_BUFFER_len">CRYPTO_BUFFER_len</a>(<a class="local col7 ref" href="#127session" title='session' data-ref="127session" data-ref-filename="127session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ocsp_response" title='ssl_session_st::ocsp_response' data-ref="ssl_session_st::ocsp_response" data-ref-filename="ssl_session_st..ocsp_response">ocsp_response</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>());</td></tr>
<tr><th id="942">942</th><td>  } <b>else</b> {</td></tr>
<tr><th id="943">943</th><td>    *<a class="local col8 ref" href="#128out" title='out' data-ref="128out" data-ref-filename="128out">out</a> = <b>nullptr</b>;</td></tr>
<tr><th id="944">944</th><td>    *<a class="local col9 ref" href="#129out_len" title='out_len' data-ref="129out_len" data-ref-filename="129out_len">out_len</a> = <var>0</var>;</td></tr>
<tr><th id="945">945</th><td>  }</td></tr>
<tr><th id="946">946</th><td>}</td></tr>
<tr><th id="947">947</th><td></td></tr>
<tr><th id="948">948</th><td><span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="decl def fn" id="SSL_SESSION_get_master_key" title='SSL_SESSION_get_master_key' data-ref="SSL_SESSION_get_master_key" data-ref-filename="SSL_SESSION_get_master_key">SSL_SESSION_get_master_key</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col0 decl" id="130session" title='session' data-type='const SSL_SESSION *' data-ref="130session" data-ref-filename="130session">session</dfn>, <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> *<dfn class="local col1 decl" id="131out" title='out' data-type='uint8_t *' data-ref="131out" data-ref-filename="131out">out</dfn>,</td></tr>
<tr><th id="949">949</th><td>                                  <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col2 decl" id="132max_out" title='max_out' data-type='size_t' data-ref="132max_out" data-ref-filename="132max_out">max_out</dfn>) {</td></tr>
<tr><th id="950">950</th><td>  <i>// TODO(davidben): Fix secret_length's type and remove these casts.</i></td></tr>
<tr><th id="951">951</th><td>  <b>if</b> (<a class="local col2 ref" href="#132max_out" title='max_out' data-ref="132max_out" data-ref-filename="132max_out">max_out</a> == <var>0</var>) {</td></tr>
<tr><th id="952">952</th><td>    <b>return</b> (<span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span>)<a class="local col0 ref" href="#130session" title='session' data-ref="130session" data-ref-filename="130session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::secret_length" title='ssl_session_st::secret_length' data-ref="ssl_session_st::secret_length" data-ref-filename="ssl_session_st..secret_length">secret_length</a>;</td></tr>
<tr><th id="953">953</th><td>  }</td></tr>
<tr><th id="954">954</th><td>  <b>if</b> (<a class="local col2 ref" href="#132max_out" title='max_out' data-ref="132max_out" data-ref-filename="132max_out">max_out</a> &gt; (<span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span>)<a class="local col0 ref" href="#130session" title='session' data-ref="130session" data-ref-filename="130session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::secret_length" title='ssl_session_st::secret_length' data-ref="ssl_session_st::secret_length" data-ref-filename="ssl_session_st..secret_length">secret_length</a>) {</td></tr>
<tr><th id="955">955</th><td>    <a class="local col2 ref" href="#132max_out" title='max_out' data-ref="132max_out" data-ref-filename="132max_out">max_out</a> = (<span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span>)<a class="local col0 ref" href="#130session" title='session' data-ref="130session" data-ref-filename="130session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::secret_length" title='ssl_session_st::secret_length' data-ref="ssl_session_st::secret_length" data-ref-filename="ssl_session_st..secret_length">secret_length</a>;</td></tr>
<tr><th id="956">956</th><td>  }</td></tr>
<tr><th id="957">957</th><td>  <a class="ref fn" href="../crypto/internal.h.html#_ZL14OPENSSL_memcpyPvPKvm" title='OPENSSL_memcpy' data-ref="_ZL14OPENSSL_memcpyPvPKvm" data-ref-filename="_ZL14OPENSSL_memcpyPvPKvm">OPENSSL_memcpy</a>(<a class="local col1 ref" href="#131out" title='out' data-ref="131out" data-ref-filename="131out">out</a>, <a class="local col0 ref" href="#130session" title='session' data-ref="130session" data-ref-filename="130session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::secret" title='ssl_session_st::secret' data-ref="ssl_session_st::secret" data-ref-filename="ssl_session_st..secret">secret</a>, <a class="local col2 ref" href="#132max_out" title='max_out' data-ref="132max_out" data-ref-filename="132max_out">max_out</a>);</td></tr>
<tr><th id="958">958</th><td>  <b>return</b> <a class="local col2 ref" href="#132max_out" title='max_out' data-ref="132max_out" data-ref-filename="132max_out">max_out</a>;</td></tr>
<tr><th id="959">959</th><td>}</td></tr>
<tr><th id="960">960</th><td></td></tr>
<tr><th id="961">961</th><td><span class='typedef' title='uint64_t' data-type='unsigned long long' data-ref="uint64_t" data-ref-filename="uint64_t">uint64_t</span> <dfn class="decl def fn" id="SSL_SESSION_set_time" title='SSL_SESSION_set_time' data-ref="SSL_SESSION_set_time" data-ref-filename="SSL_SESSION_set_time">SSL_SESSION_set_time</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col3 decl" id="133session" title='session' data-type='SSL_SESSION *' data-ref="133session" data-ref-filename="133session">session</dfn>, <span class='typedef' title='uint64_t' data-type='unsigned long long' data-ref="uint64_t" data-ref-filename="uint64_t">uint64_t</span> <dfn class="local col4 decl" id="134time" title='time' data-type='uint64_t' data-ref="134time" data-ref-filename="134time">time</dfn>) {</td></tr>
<tr><th id="962">962</th><td>  <b>if</b> (<a class="local col3 ref" href="#133session" title='session' data-ref="133session" data-ref-filename="133session">session</a> == <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="963">963</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="964">964</th><td>  }</td></tr>
<tr><th id="965">965</th><td></td></tr>
<tr><th id="966">966</th><td>  <a class="local col3 ref" href="#133session" title='session' data-ref="133session" data-ref-filename="133session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::time" title='ssl_session_st::time' data-ref="ssl_session_st::time" data-ref-filename="ssl_session_st..time">time</a> = <a class="local col4 ref" href="#134time" title='time' data-ref="134time" data-ref-filename="134time">time</a>;</td></tr>
<tr><th id="967">967</th><td>  <b>return</b> <a class="local col4 ref" href="#134time" title='time' data-ref="134time" data-ref-filename="134time">time</a>;</td></tr>
<tr><th id="968">968</th><td>}</td></tr>
<tr><th id="969">969</th><td></td></tr>
<tr><th id="970">970</th><td><span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span> <dfn class="decl def fn" id="SSL_SESSION_set_timeout" title='SSL_SESSION_set_timeout' data-ref="SSL_SESSION_set_timeout" data-ref-filename="SSL_SESSION_set_timeout">SSL_SESSION_set_timeout</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col5 decl" id="135session" title='session' data-type='SSL_SESSION *' data-ref="135session" data-ref-filename="135session">session</dfn>, <span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span> <dfn class="local col6 decl" id="136timeout" title='timeout' data-type='uint32_t' data-ref="136timeout" data-ref-filename="136timeout">timeout</dfn>) {</td></tr>
<tr><th id="971">971</th><td>  <b>if</b> (<a class="local col5 ref" href="#135session" title='session' data-ref="135session" data-ref-filename="135session">session</a> == <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="972">972</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="973">973</th><td>  }</td></tr>
<tr><th id="974">974</th><td></td></tr>
<tr><th id="975">975</th><td>  <a class="local col5 ref" href="#135session" title='session' data-ref="135session" data-ref-filename="135session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a> = <a class="local col6 ref" href="#136timeout" title='timeout' data-ref="136timeout" data-ref-filename="136timeout">timeout</a>;</td></tr>
<tr><th id="976">976</th><td>  <a class="local col5 ref" href="#135session" title='session' data-ref="135session" data-ref-filename="135session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::auth_timeout" title='ssl_session_st::auth_timeout' data-ref="ssl_session_st::auth_timeout" data-ref-filename="ssl_session_st..auth_timeout">auth_timeout</a> = <a class="local col6 ref" href="#136timeout" title='timeout' data-ref="136timeout" data-ref-filename="136timeout">timeout</a>;</td></tr>
<tr><th id="977">977</th><td>  <b>return</b> <var>1</var>;</td></tr>
<tr><th id="978">978</th><td>}</td></tr>
<tr><th id="979">979</th><td></td></tr>
<tr><th id="980">980</th><td><em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> *<dfn class="decl def fn" id="SSL_SESSION_get0_id_context" title='SSL_SESSION_get0_id_context' data-ref="SSL_SESSION_get0_id_context" data-ref-filename="SSL_SESSION_get0_id_context">SSL_SESSION_get0_id_context</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col7 decl" id="137session" title='session' data-type='const SSL_SESSION *' data-ref="137session" data-ref-filename="137session">session</dfn>,</td></tr>
<tr><th id="981">981</th><td>                                           <em>unsigned</em> *<dfn class="local col8 decl" id="138out_len" title='out_len' data-type='unsigned int *' data-ref="138out_len" data-ref-filename="138out_len">out_len</dfn>) {</td></tr>
<tr><th id="982">982</th><td>  <b>if</b> (<a class="local col8 ref" href="#138out_len" title='out_len' data-ref="138out_len" data-ref-filename="138out_len">out_len</a> != <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="983">983</th><td>    *<a class="local col8 ref" href="#138out_len" title='out_len' data-ref="138out_len" data-ref-filename="138out_len">out_len</a> = <a class="local col7 ref" href="#137session" title='session' data-ref="137session" data-ref-filename="137session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx_length" title='ssl_session_st::sid_ctx_length' data-ref="ssl_session_st::sid_ctx_length" data-ref-filename="ssl_session_st..sid_ctx_length">sid_ctx_length</a>;</td></tr>
<tr><th id="984">984</th><td>  }</td></tr>
<tr><th id="985">985</th><td>  <b>return</b> <a class="local col7 ref" href="#137session" title='session' data-ref="137session" data-ref-filename="137session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx" title='ssl_session_st::sid_ctx' data-ref="ssl_session_st::sid_ctx" data-ref-filename="ssl_session_st..sid_ctx">sid_ctx</a>;</td></tr>
<tr><th id="986">986</th><td>}</td></tr>
<tr><th id="987">987</th><td></td></tr>
<tr><th id="988">988</th><td><em>int</em> <dfn class="decl def fn" id="SSL_SESSION_set1_id_context" title='SSL_SESSION_set1_id_context' data-ref="SSL_SESSION_set1_id_context" data-ref-filename="SSL_SESSION_set1_id_context">SSL_SESSION_set1_id_context</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col9 decl" id="139session" title='session' data-type='SSL_SESSION *' data-ref="139session" data-ref-filename="139session">session</dfn>, <em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> *<dfn class="local col0 decl" id="140sid_ctx" title='sid_ctx' data-type='const uint8_t *' data-ref="140sid_ctx" data-ref-filename="140sid_ctx">sid_ctx</dfn>,</td></tr>
<tr><th id="989">989</th><td>                                <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col1 decl" id="141sid_ctx_len" title='sid_ctx_len' data-type='size_t' data-ref="141sid_ctx_len" data-ref-filename="141sid_ctx_len">sid_ctx_len</dfn>) {</td></tr>
<tr><th id="990">990</th><td>  <b>if</b> (<a class="local col1 ref" href="#141sid_ctx_len" title='sid_ctx_len' data-ref="141sid_ctx_len" data-ref-filename="141sid_ctx_len">sid_ctx_len</a> &gt; <b>sizeof</b>(<a class="local col9 ref" href="#139session" title='session' data-ref="139session" data-ref-filename="139session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx" title='ssl_session_st::sid_ctx' data-ref="ssl_session_st::sid_ctx" data-ref-filename="ssl_session_st..sid_ctx">sid_ctx</a>)) {</td></tr>
<tr><th id="991">991</th><td>    <a class="macro" href="../include/openssl/err.h.html#423" title="ERR_put_error(ERR_LIB_SSL, 0, 216, &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/third_party/boringssl/src/ssl/ssl_session.cc&quot;, 991)" data-ref="_M/OPENSSL_PUT_ERROR">OPENSSL_PUT_ERROR</a>(SSL, <a class="macro" href="../include/openssl/ssl.h.html#5386" title="216" data-ref="_M/SSL_R_SSL_SESSION_ID_CONTEXT_TOO_LONG">SSL_R_SSL_SESSION_ID_CONTEXT_TOO_LONG</a>);</td></tr>
<tr><th id="992">992</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="993">993</th><td>  }</td></tr>
<tr><th id="994">994</th><td></td></tr>
<tr><th id="995">995</th><td>  <b>static_assert</b>(<b>sizeof</b>(<a class="local col9 ref" href="#139session" title='session' data-ref="139session" data-ref-filename="139session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx" title='ssl_session_st::sid_ctx' data-ref="ssl_session_st::sid_ctx" data-ref-filename="ssl_session_st..sid_ctx">sid_ctx</a>) &lt; <var>256</var>, <q>"sid_ctx_len does not fit"</q>);</td></tr>
<tr><th id="996">996</th><td>  <a class="local col9 ref" href="#139session" title='session' data-ref="139session" data-ref-filename="139session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx_length" title='ssl_session_st::sid_ctx_length' data-ref="ssl_session_st::sid_ctx_length" data-ref-filename="ssl_session_st..sid_ctx_length">sid_ctx_length</a> = (<span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span>)<a class="local col1 ref" href="#141sid_ctx_len" title='sid_ctx_len' data-ref="141sid_ctx_len" data-ref-filename="141sid_ctx_len">sid_ctx_len</a>;</td></tr>
<tr><th id="997">997</th><td>  <a class="ref fn" href="../crypto/internal.h.html#_ZL14OPENSSL_memcpyPvPKvm" title='OPENSSL_memcpy' data-ref="_ZL14OPENSSL_memcpyPvPKvm" data-ref-filename="_ZL14OPENSSL_memcpyPvPKvm">OPENSSL_memcpy</a>(<a class="local col9 ref" href="#139session" title='session' data-ref="139session" data-ref-filename="139session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::sid_ctx" title='ssl_session_st::sid_ctx' data-ref="ssl_session_st::sid_ctx" data-ref-filename="ssl_session_st..sid_ctx">sid_ctx</a>, <a class="local col0 ref" href="#140sid_ctx" title='sid_ctx' data-ref="140sid_ctx" data-ref-filename="140sid_ctx">sid_ctx</a>, <a class="local col1 ref" href="#141sid_ctx_len" title='sid_ctx_len' data-ref="141sid_ctx_len" data-ref-filename="141sid_ctx_len">sid_ctx_len</a>);</td></tr>
<tr><th id="998">998</th><td></td></tr>
<tr><th id="999">999</th><td>  <b>return</b> <var>1</var>;</td></tr>
<tr><th id="1000">1000</th><td>}</td></tr>
<tr><th id="1001">1001</th><td></td></tr>
<tr><th id="1002">1002</th><td><em>int</em> <dfn class="decl def fn" id="SSL_SESSION_should_be_single_use" title='SSL_SESSION_should_be_single_use' data-ref="SSL_SESSION_should_be_single_use" data-ref-filename="SSL_SESSION_should_be_single_use">SSL_SESSION_should_be_single_use</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col2 decl" id="142session" title='session' data-type='const SSL_SESSION *' data-ref="142session" data-ref-filename="142session">session</dfn>) {</td></tr>
<tr><th id="1003">1003</th><td>  <b>return</b> <a class="ref fn" href="#_ZN4bssl28ssl_session_protocol_versionEPK14ssl_session_st" title='bssl::ssl_session_protocol_version' data-ref="_ZN4bssl28ssl_session_protocol_versionEPK14ssl_session_st" data-ref-filename="_ZN4bssl28ssl_session_protocol_versionEPK14ssl_session_st">ssl_session_protocol_version</a>(<a class="local col2 ref" href="#142session" title='session' data-ref="142session" data-ref-filename="142session">session</a>) &gt;= <a class="macro" href="../include/openssl/ssl.h.html#634" title="0x0304" data-ref="_M/TLS1_3_VERSION">TLS1_3_VERSION</a>;</td></tr>
<tr><th id="1004">1004</th><td>}</td></tr>
<tr><th id="1005">1005</th><td></td></tr>
<tr><th id="1006">1006</th><td><em>int</em> <dfn class="decl def fn" id="SSL_SESSION_is_resumable" title='SSL_SESSION_is_resumable' data-ref="SSL_SESSION_is_resumable" data-ref-filename="SSL_SESSION_is_resumable">SSL_SESSION_is_resumable</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col3 decl" id="143session" title='session' data-type='const SSL_SESSION *' data-ref="143session" data-ref-filename="143session">session</dfn>) {</td></tr>
<tr><th id="1007">1007</th><td>  <b>return</b> !<a class="local col3 ref" href="#143session" title='session' data-ref="143session" data-ref-filename="143session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::not_resumable" title='ssl_session_st::not_resumable' data-ref="ssl_session_st::not_resumable" data-ref-filename="ssl_session_st..not_resumable">not_resumable</a> &amp;&amp;</td></tr>
<tr><th id="1008">1008</th><td>         (<a class="local col3 ref" href="#143session" title='session' data-ref="143session" data-ref-filename="143session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::session_id_length" title='ssl_session_st::session_id_length' data-ref="ssl_session_st::session_id_length" data-ref-filename="ssl_session_st..session_id_length">session_id_length</a> != <var>0</var> || !<a class="local col3 ref" href="#143session" title='session' data-ref="143session" data-ref-filename="143session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ticket" title='ssl_session_st::ticket' data-ref="ssl_session_st::ticket" data-ref-filename="ssl_session_st..ticket">ticket</a>.<a class="ref fn" href="internal.h.html#_ZNK4bssl5Array5emptyEv" title='bssl::Array::empty' data-ref="_ZNK4bssl5Array5emptyEv" data-ref-filename="_ZNK4bssl5Array5emptyEv">empty</a>());</td></tr>
<tr><th id="1009">1009</th><td>}</td></tr>
<tr><th id="1010">1010</th><td></td></tr>
<tr><th id="1011">1011</th><td><em>int</em> <dfn class="decl def fn" id="SSL_SESSION_has_ticket" title='SSL_SESSION_has_ticket' data-ref="SSL_SESSION_has_ticket" data-ref-filename="SSL_SESSION_has_ticket">SSL_SESSION_has_ticket</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col4 decl" id="144session" title='session' data-type='const SSL_SESSION *' data-ref="144session" data-ref-filename="144session">session</dfn>) {</td></tr>
<tr><th id="1012">1012</th><td>  <b>return</b> !<a class="local col4 ref" href="#144session" title='session' data-ref="144session" data-ref-filename="144session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ticket" title='ssl_session_st::ticket' data-ref="ssl_session_st::ticket" data-ref-filename="ssl_session_st..ticket">ticket</a>.<a class="ref fn" href="internal.h.html#_ZNK4bssl5Array5emptyEv" title='bssl::Array::empty' data-ref="_ZNK4bssl5Array5emptyEv" data-ref-filename="_ZNK4bssl5Array5emptyEv">empty</a>();</td></tr>
<tr><th id="1013">1013</th><td>}</td></tr>
<tr><th id="1014">1014</th><td></td></tr>
<tr><th id="1015">1015</th><td><em>void</em> <dfn class="decl def fn" id="SSL_SESSION_get0_ticket" title='SSL_SESSION_get0_ticket' data-ref="SSL_SESSION_get0_ticket" data-ref-filename="SSL_SESSION_get0_ticket">SSL_SESSION_get0_ticket</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col5 decl" id="145session" title='session' data-type='const SSL_SESSION *' data-ref="145session" data-ref-filename="145session">session</dfn>,</td></tr>
<tr><th id="1016">1016</th><td>                             <em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> **<dfn class="local col6 decl" id="146out_ticket" title='out_ticket' data-type='const uint8_t **' data-ref="146out_ticket" data-ref-filename="146out_ticket">out_ticket</dfn>, <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> *<dfn class="local col7 decl" id="147out_len" title='out_len' data-type='size_t *' data-ref="147out_len" data-ref-filename="147out_len">out_len</dfn>) {</td></tr>
<tr><th id="1017">1017</th><td>  <b>if</b> (<a class="local col6 ref" href="#146out_ticket" title='out_ticket' data-ref="146out_ticket" data-ref-filename="146out_ticket">out_ticket</a> != <b>nullptr</b>) {</td></tr>
<tr><th id="1018">1018</th><td>    *<a class="local col6 ref" href="#146out_ticket" title='out_ticket' data-ref="146out_ticket" data-ref-filename="146out_ticket">out_ticket</a> = <a class="local col5 ref" href="#145session" title='session' data-ref="145session" data-ref-filename="145session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ticket" title='ssl_session_st::ticket' data-ref="ssl_session_st::ticket" data-ref-filename="ssl_session_st..ticket">ticket</a>.<a class="ref fn" href="internal.h.html#_ZNK4bssl5Array4dataEv" title='bssl::Array::data' data-ref="_ZNK4bssl5Array4dataEv" data-ref-filename="_ZNK4bssl5Array4dataEv">data</a>();</td></tr>
<tr><th id="1019">1019</th><td>  }</td></tr>
<tr><th id="1020">1020</th><td>  *<a class="local col7 ref" href="#147out_len" title='out_len' data-ref="147out_len" data-ref-filename="147out_len">out_len</a> = <a class="local col5 ref" href="#145session" title='session' data-ref="145session" data-ref-filename="145session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ticket" title='ssl_session_st::ticket' data-ref="ssl_session_st::ticket" data-ref-filename="ssl_session_st..ticket">ticket</a>.<a class="ref fn" href="internal.h.html#_ZNK4bssl5Array4sizeEv" title='bssl::Array::size' data-ref="_ZNK4bssl5Array4sizeEv" data-ref-filename="_ZNK4bssl5Array4sizeEv">size</a>();</td></tr>
<tr><th id="1021">1021</th><td>}</td></tr>
<tr><th id="1022">1022</th><td></td></tr>
<tr><th id="1023">1023</th><td><em>int</em> <dfn class="decl def fn" id="SSL_SESSION_set_ticket" title='SSL_SESSION_set_ticket' data-ref="SSL_SESSION_set_ticket" data-ref-filename="SSL_SESSION_set_ticket">SSL_SESSION_set_ticket</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col8 decl" id="148session" title='session' data-type='SSL_SESSION *' data-ref="148session" data-ref-filename="148session">session</dfn>, <em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> *<dfn class="local col9 decl" id="149ticket" title='ticket' data-type='const uint8_t *' data-ref="149ticket" data-ref-filename="149ticket">ticket</dfn>,</td></tr>
<tr><th id="1024">1024</th><td>                           <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col0 decl" id="150ticket_len" title='ticket_len' data-type='size_t' data-ref="150ticket_len" data-ref-filename="150ticket_len">ticket_len</dfn>) {</td></tr>
<tr><th id="1025">1025</th><td>  <b>return</b> <a class="local col8 ref" href="#148session" title='session' data-ref="148session" data-ref-filename="148session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ticket" title='ssl_session_st::ticket' data-ref="ssl_session_st::ticket" data-ref-filename="ssl_session_st..ticket">ticket</a>.<a class="ref fn" href="internal.h.html#_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE" title='bssl::Array::CopyFrom' data-ref="_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE" data-ref-filename="_ZN4bssl5Array8CopyFromENS_4SpanIKT_EE">CopyFrom</a>(<a class="ref fn" href="../include/openssl/span.h.html#_ZN4bssl13MakeConstSpanEPT_m" title='bssl::MakeConstSpan' data-ref="_ZN4bssl13MakeConstSpanEPT_m" data-ref-filename="_ZN4bssl13MakeConstSpanEPT_m">MakeConstSpan</a>(<a class="local col9 ref" href="#149ticket" title='ticket' data-ref="149ticket" data-ref-filename="149ticket">ticket</a>, <a class="local col0 ref" href="#150ticket_len" title='ticket_len' data-ref="150ticket_len" data-ref-filename="150ticket_len">ticket_len</a>));</td></tr>
<tr><th id="1026">1026</th><td>}</td></tr>
<tr><th id="1027">1027</th><td></td></tr>
<tr><th id="1028">1028</th><td><span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span> <dfn class="decl def fn" id="SSL_SESSION_get_ticket_lifetime_hint" title='SSL_SESSION_get_ticket_lifetime_hint' data-ref="SSL_SESSION_get_ticket_lifetime_hint" data-ref-filename="SSL_SESSION_get_ticket_lifetime_hint">SSL_SESSION_get_ticket_lifetime_hint</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col1 decl" id="151session" title='session' data-type='const SSL_SESSION *' data-ref="151session" data-ref-filename="151session">session</dfn>) {</td></tr>
<tr><th id="1029">1029</th><td>  <b>return</b> <a class="local col1 ref" href="#151session" title='session' data-ref="151session" data-ref-filename="151session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ticket_lifetime_hint" title='ssl_session_st::ticket_lifetime_hint' data-ref="ssl_session_st::ticket_lifetime_hint" data-ref-filename="ssl_session_st..ticket_lifetime_hint">ticket_lifetime_hint</a>;</td></tr>
<tr><th id="1030">1030</th><td>}</td></tr>
<tr><th id="1031">1031</th><td></td></tr>
<tr><th id="1032">1032</th><td><em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_CIPHER" title='SSL_CIPHER' data-type='struct ssl_cipher_st' data-ref="SSL_CIPHER" data-ref-filename="SSL_CIPHER">SSL_CIPHER</a> *<dfn class="decl def fn" id="SSL_SESSION_get0_cipher" title='SSL_SESSION_get0_cipher' data-ref="SSL_SESSION_get0_cipher" data-ref-filename="SSL_SESSION_get0_cipher">SSL_SESSION_get0_cipher</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col2 decl" id="152session" title='session' data-type='const SSL_SESSION *' data-ref="152session" data-ref-filename="152session">session</dfn>) {</td></tr>
<tr><th id="1033">1033</th><td>  <b>return</b> <a class="local col2 ref" href="#152session" title='session' data-ref="152session" data-ref-filename="152session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::cipher" title='ssl_session_st::cipher' data-ref="ssl_session_st::cipher" data-ref-filename="ssl_session_st..cipher">cipher</a>;</td></tr>
<tr><th id="1034">1034</th><td>}</td></tr>
<tr><th id="1035">1035</th><td></td></tr>
<tr><th id="1036">1036</th><td><em>int</em> <dfn class="decl def fn" id="SSL_SESSION_has_peer_sha256" title='SSL_SESSION_has_peer_sha256' data-ref="SSL_SESSION_has_peer_sha256" data-ref-filename="SSL_SESSION_has_peer_sha256">SSL_SESSION_has_peer_sha256</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col3 decl" id="153session" title='session' data-type='const SSL_SESSION *' data-ref="153session" data-ref-filename="153session">session</dfn>) {</td></tr>
<tr><th id="1037">1037</th><td>  <b>return</b> <a class="local col3 ref" href="#153session" title='session' data-ref="153session" data-ref-filename="153session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::peer_sha256_valid" title='ssl_session_st::peer_sha256_valid' data-ref="ssl_session_st::peer_sha256_valid" data-ref-filename="ssl_session_st..peer_sha256_valid">peer_sha256_valid</a>;</td></tr>
<tr><th id="1038">1038</th><td>}</td></tr>
<tr><th id="1039">1039</th><td></td></tr>
<tr><th id="1040">1040</th><td><em>void</em> <dfn class="decl def fn" id="SSL_SESSION_get0_peer_sha256" title='SSL_SESSION_get0_peer_sha256' data-ref="SSL_SESSION_get0_peer_sha256" data-ref-filename="SSL_SESSION_get0_peer_sha256">SSL_SESSION_get0_peer_sha256</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col4 decl" id="154session" title='session' data-type='const SSL_SESSION *' data-ref="154session" data-ref-filename="154session">session</dfn>,</td></tr>
<tr><th id="1041">1041</th><td>                                  <em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> **<dfn class="local col5 decl" id="155out_ptr" title='out_ptr' data-type='const uint8_t **' data-ref="155out_ptr" data-ref-filename="155out_ptr">out_ptr</dfn>, <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> *<dfn class="local col6 decl" id="156out_len" title='out_len' data-type='size_t *' data-ref="156out_len" data-ref-filename="156out_len">out_len</dfn>) {</td></tr>
<tr><th id="1042">1042</th><td>  <b>if</b> (<a class="local col4 ref" href="#154session" title='session' data-ref="154session" data-ref-filename="154session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::peer_sha256_valid" title='ssl_session_st::peer_sha256_valid' data-ref="ssl_session_st::peer_sha256_valid" data-ref-filename="ssl_session_st..peer_sha256_valid">peer_sha256_valid</a>) {</td></tr>
<tr><th id="1043">1043</th><td>    *<a class="local col5 ref" href="#155out_ptr" title='out_ptr' data-ref="155out_ptr" data-ref-filename="155out_ptr">out_ptr</a> = <a class="local col4 ref" href="#154session" title='session' data-ref="154session" data-ref-filename="154session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::peer_sha256" title='ssl_session_st::peer_sha256' data-ref="ssl_session_st::peer_sha256" data-ref-filename="ssl_session_st..peer_sha256">peer_sha256</a>;</td></tr>
<tr><th id="1044">1044</th><td>    *<a class="local col6 ref" href="#156out_len" title='out_len' data-ref="156out_len" data-ref-filename="156out_len">out_len</a> = <b>sizeof</b>(<a class="local col4 ref" href="#154session" title='session' data-ref="154session" data-ref-filename="154session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::peer_sha256" title='ssl_session_st::peer_sha256' data-ref="ssl_session_st::peer_sha256" data-ref-filename="ssl_session_st..peer_sha256">peer_sha256</a>);</td></tr>
<tr><th id="1045">1045</th><td>  } <b>else</b> {</td></tr>
<tr><th id="1046">1046</th><td>    *<a class="local col5 ref" href="#155out_ptr" title='out_ptr' data-ref="155out_ptr" data-ref-filename="155out_ptr">out_ptr</a> = <b>nullptr</b>;</td></tr>
<tr><th id="1047">1047</th><td>    *<a class="local col6 ref" href="#156out_len" title='out_len' data-ref="156out_len" data-ref-filename="156out_len">out_len</a> = <var>0</var>;</td></tr>
<tr><th id="1048">1048</th><td>  }</td></tr>
<tr><th id="1049">1049</th><td>}</td></tr>
<tr><th id="1050">1050</th><td></td></tr>
<tr><th id="1051">1051</th><td><em>int</em> <dfn class="decl def fn" id="SSL_SESSION_early_data_capable" title='SSL_SESSION_early_data_capable' data-ref="SSL_SESSION_early_data_capable" data-ref-filename="SSL_SESSION_early_data_capable">SSL_SESSION_early_data_capable</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col7 decl" id="157session" title='session' data-type='const SSL_SESSION *' data-ref="157session" data-ref-filename="157session">session</dfn>) {</td></tr>
<tr><th id="1052">1052</th><td>  <b>return</b> <a class="ref fn" href="#_ZN4bssl28ssl_session_protocol_versionEPK14ssl_session_st" title='bssl::ssl_session_protocol_version' data-ref="_ZN4bssl28ssl_session_protocol_versionEPK14ssl_session_st" data-ref-filename="_ZN4bssl28ssl_session_protocol_versionEPK14ssl_session_st">ssl_session_protocol_version</a>(<a class="local col7 ref" href="#157session" title='session' data-ref="157session" data-ref-filename="157session">session</a>) &gt;= <a class="macro" href="../include/openssl/ssl.h.html#634" title="0x0304" data-ref="_M/TLS1_3_VERSION">TLS1_3_VERSION</a> &amp;&amp;</td></tr>
<tr><th id="1053">1053</th><td>         <a class="local col7 ref" href="#157session" title='session' data-ref="157session" data-ref-filename="157session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ticket_max_early_data" title='ssl_session_st::ticket_max_early_data' data-ref="ssl_session_st::ticket_max_early_data" data-ref-filename="ssl_session_st..ticket_max_early_data">ticket_max_early_data</a> != <var>0</var>;</td></tr>
<tr><th id="1054">1054</th><td>}</td></tr>
<tr><th id="1055">1055</th><td></td></tr>
<tr><th id="1056">1056</th><td><a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="decl def fn" id="SSL_SESSION_copy_without_early_data" title='SSL_SESSION_copy_without_early_data' data-ref="SSL_SESSION_copy_without_early_data" data-ref-filename="SSL_SESSION_copy_without_early_data">SSL_SESSION_copy_without_early_data</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col8 decl" id="158session" title='session' data-type='SSL_SESSION *' data-ref="158session" data-ref-filename="158session">session</dfn>) {</td></tr>
<tr><th id="1057">1057</th><td>  <b>if</b> (!<a class="ref fn" href="#SSL_SESSION_early_data_capable" title='SSL_SESSION_early_data_capable' data-ref="SSL_SESSION_early_data_capable" data-ref-filename="SSL_SESSION_early_data_capable">SSL_SESSION_early_data_capable</a>(<a class="local col8 ref" href="#158session" title='session' data-ref="158session" data-ref-filename="158session">session</a>)) {</td></tr>
<tr><th id="1058">1058</th><td>    <b>return</b> <a class="ref fn" href="../include/openssl/ssl.h.html#5147" title='bssl::UpRef' data-ref="_ZN4bssl5UpRefEP14ssl_session_st" data-ref-filename="_ZN4bssl5UpRefEP14ssl_session_st">UpRef</a>(<a class="local col8 ref" href="#158session" title='session' data-ref="158session" data-ref-filename="158session">session</a>).<span class='ref fn' title='std::__1::unique_ptr::release' data-ref="_ZNSt3__110unique_ptr7releaseEv" data-ref-filename="_ZNSt3__110unique_ptr7releaseEv">release</span>();</td></tr>
<tr><th id="1059">1059</th><td>  }</td></tr>
<tr><th id="1060">1060</th><td></td></tr>
<tr><th id="1061">1061</th><td>  <span class="namespace">bssl::</span><a class="type" href="../include/openssl/base.h.html#bssl::UniquePtr" title='bssl::UniquePtr' data-ref="bssl::UniquePtr" data-ref-filename="bssl..UniquePtr">UniquePtr</a>&lt;<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a>&gt; <dfn class="local col9 decl" id="159copy" title='copy' data-type='bssl::UniquePtr&lt;SSL_SESSION&gt;' data-ref="159copy" data-ref-filename="159copy">copy</dfn> =</td></tr>
<tr><th id="1062">1062</th><td>      <a class="ref fn" href="#_ZN4bssl15SSL_SESSION_dupEP14ssl_session_sti" title='bssl::SSL_SESSION_dup' data-ref="_ZN4bssl15SSL_SESSION_dupEP14ssl_session_sti" data-ref-filename="_ZN4bssl15SSL_SESSION_dupEP14ssl_session_sti">SSL_SESSION_dup</a>(<a class="local col8 ref" href="#158session" title='session' data-ref="158session" data-ref-filename="158session">session</a>, <a class="macro" href="internal.h.html#3031" title="(0x1 | 0x2)" data-ref="_M/SSL_SESSION_DUP_ALL">SSL_SESSION_DUP_ALL</a>);</td></tr>
<tr><th id="1063">1063</th><td>  <b>if</b> (!<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col9 ref" href="#159copy" title='copy' data-ref="159copy" data-ref-filename="159copy">copy</a>) {</td></tr>
<tr><th id="1064">1064</th><td>    <b>return</b> <b>nullptr</b>;</td></tr>
<tr><th id="1065">1065</th><td>  }</td></tr>
<tr><th id="1066">1066</th><td></td></tr>
<tr><th id="1067">1067</th><td>  <a class="local col9 ref" href="#159copy" title='copy' data-ref="159copy" data-ref-filename="159copy">copy</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::ticket_max_early_data" title='ssl_session_st::ticket_max_early_data' data-ref="ssl_session_st::ticket_max_early_data" data-ref-filename="ssl_session_st..ticket_max_early_data">ticket_max_early_data</a> = <var>0</var>;</td></tr>
<tr><th id="1068">1068</th><td>  <i>// Copied sessions are non-resumable until they're completely filled in.</i></td></tr>
<tr><th id="1069">1069</th><td>  <a class="local col9 ref" href="#159copy" title='copy' data-ref="159copy" data-ref-filename="159copy">copy</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#ssl_session_st::not_resumable" title='ssl_session_st::not_resumable' data-ref="ssl_session_st::not_resumable" data-ref-filename="ssl_session_st..not_resumable">not_resumable</a> = <a class="local col8 ref" href="#158session" title='session' data-ref="158session" data-ref-filename="158session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::not_resumable" title='ssl_session_st::not_resumable' data-ref="ssl_session_st::not_resumable" data-ref-filename="ssl_session_st..not_resumable">not_resumable</a>;</td></tr>
<tr><th id="1070">1070</th><td>  <span class="macro" title="(__builtin_expect(!(!SSL_SESSION_early_data_capable(copy.get())), 0) ? __assert_rtn(__func__, &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/third_party/boringssl/src/ssl/ssl_session.cc&quot;, 1070, &quot;!SSL_SESSION_early_data_capable(copy.get())&quot;) : (void)0)" data-ref="_M/assert">assert</span>(!<a class="ref fn" href="#SSL_SESSION_early_data_capable" title='SSL_SESSION_early_data_capable' data-ref="SSL_SESSION_early_data_capable" data-ref-filename="SSL_SESSION_early_data_capable">SSL_SESSION_early_data_capable</a>(<a class="local col9 ref" href="#159copy" title='copy' data-ref="159copy" data-ref-filename="159copy">copy</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>()));</td></tr>
<tr><th id="1071">1071</th><td>  <b>return</b> <a class="local col9 ref" href="#159copy" title='copy' data-ref="159copy" data-ref-filename="159copy">copy</a>.<span class='ref fn' title='std::__1::unique_ptr::release' data-ref="_ZNSt3__110unique_ptr7releaseEv" data-ref-filename="_ZNSt3__110unique_ptr7releaseEv">release</span>();</td></tr>
<tr><th id="1072">1072</th><td>}</td></tr>
<tr><th id="1073">1073</th><td></td></tr>
<tr><th id="1074">1074</th><td><a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="decl def fn" id="SSL_magic_pending_session_ptr" title='SSL_magic_pending_session_ptr' data-ref="SSL_magic_pending_session_ptr" data-ref-filename="SSL_magic_pending_session_ptr">SSL_magic_pending_session_ptr</dfn>(<em>void</em>) {</td></tr>
<tr><th id="1075">1075</th><td>  <b>return</b> (<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *)&amp;<a class="tu ref" href="#bssl::g_pending_session_magic" title='bssl::g_pending_session_magic' data-use='a' data-ref="bssl::g_pending_session_magic" data-ref-filename="bssl..g_pending_session_magic">g_pending_session_magic</a>;</td></tr>
<tr><th id="1076">1076</th><td>}</td></tr>
<tr><th id="1077">1077</th><td></td></tr>
<tr><th id="1078">1078</th><td><a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="decl def fn" id="SSL_get_session" title='SSL_get_session' data-ref="SSL_get_session" data-ref-filename="SSL_get_session">SSL_get_session</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<dfn class="local col0 decl" id="160ssl" title='ssl' data-type='const SSL *' data-ref="160ssl" data-ref-filename="160ssl">ssl</dfn>) {</td></tr>
<tr><th id="1079">1079</th><td>  <i>// Once the handshake completes we return the established session. Otherwise</i></td></tr>
<tr><th id="1080">1080</th><td><i>  // we return the intermediate session, either |session| (for resumption) or</i></td></tr>
<tr><th id="1081">1081</th><td><i>  // |new_session| if doing a full handshake.</i></td></tr>
<tr><th id="1082">1082</th><td>  <b>if</b> (!<a class="ref fn" href="../include/openssl/ssl.h.html#SSL_in_init" title='SSL_in_init' data-ref="SSL_in_init" data-ref-filename="SSL_in_init">SSL_in_init</a>(<a class="local col0 ref" href="#160ssl" title='ssl' data-ref="160ssl" data-ref-filename="160ssl">ssl</a>)) {</td></tr>
<tr><th id="1083">1083</th><td>    <b>return</b> <a class="local col0 ref" href="#160ssl" title='ssl' data-ref="160ssl" data-ref-filename="160ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::s3" title='ssl_st::s3' data-ref="ssl_st::s3" data-ref-filename="ssl_st..s3">s3</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL3_STATE::established_session" title='bssl::SSL3_STATE::established_session' data-ref="bssl::SSL3_STATE::established_session" data-ref-filename="bssl..SSL3_STATE..established_session">established_session</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>();</td></tr>
<tr><th id="1084">1084</th><td>  }</td></tr>
<tr><th id="1085">1085</th><td>  <a class="type" href="internal.h.html#bssl::SSL_HANDSHAKE" title='bssl::SSL_HANDSHAKE' data-ref="bssl::SSL_HANDSHAKE" data-ref-filename="bssl..SSL_HANDSHAKE">SSL_HANDSHAKE</a> *<dfn class="local col1 decl" id="161hs" title='hs' data-type='bssl::SSL_HANDSHAKE *' data-ref="161hs" data-ref-filename="161hs">hs</dfn> = <a class="local col0 ref" href="#160ssl" title='ssl' data-ref="160ssl" data-ref-filename="160ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::s3" title='ssl_st::s3' data-ref="ssl_st::s3" data-ref-filename="ssl_st..s3">s3</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL3_STATE::hs" title='bssl::SSL3_STATE::hs' data-ref="bssl::SSL3_STATE::hs" data-ref-filename="bssl..SSL3_STATE..hs">hs</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>();</td></tr>
<tr><th id="1086">1086</th><td>  <b>if</b> (<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col1 ref" href="#161hs" title='hs' data-ref="161hs" data-ref-filename="161hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::early_session" title='bssl::SSL_HANDSHAKE::early_session' data-ref="bssl::SSL_HANDSHAKE::early_session" data-ref-filename="bssl..SSL_HANDSHAKE..early_session">early_session</a>) {</td></tr>
<tr><th id="1087">1087</th><td>    <b>return</b> <a class="local col1 ref" href="#161hs" title='hs' data-ref="161hs" data-ref-filename="161hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::early_session" title='bssl::SSL_HANDSHAKE::early_session' data-ref="bssl::SSL_HANDSHAKE::early_session" data-ref-filename="bssl..SSL_HANDSHAKE..early_session">early_session</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>();</td></tr>
<tr><th id="1088">1088</th><td>  }</td></tr>
<tr><th id="1089">1089</th><td>  <b>if</b> (<span class='ref fn fake' title='std::__1::unique_ptr::operator bool' data-ref="_ZNKSt3__110unique_ptrcvbEv" data-ref-filename="_ZNKSt3__110unique_ptrcvbEv"></span><a class="local col1 ref" href="#161hs" title='hs' data-ref="161hs" data-ref-filename="161hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::new_session" title='bssl::SSL_HANDSHAKE::new_session' data-ref="bssl::SSL_HANDSHAKE::new_session" data-ref-filename="bssl..SSL_HANDSHAKE..new_session">new_session</a>) {</td></tr>
<tr><th id="1090">1090</th><td>    <b>return</b> <a class="local col1 ref" href="#161hs" title='hs' data-ref="161hs" data-ref-filename="161hs">hs</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::new_session" title='bssl::SSL_HANDSHAKE::new_session' data-ref="bssl::SSL_HANDSHAKE::new_session" data-ref-filename="bssl..SSL_HANDSHAKE..new_session">new_session</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>();</td></tr>
<tr><th id="1091">1091</th><td>  }</td></tr>
<tr><th id="1092">1092</th><td>  <b>return</b> <a class="local col0 ref" href="#160ssl" title='ssl' data-ref="160ssl" data-ref-filename="160ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::session" title='ssl_st::session' data-ref="ssl_st::session" data-ref-filename="ssl_st..session">session</a>.<span class='ref fn' title='std::__1::unique_ptr::get' data-ref="_ZNKSt3__110unique_ptr3getEv" data-ref-filename="_ZNKSt3__110unique_ptr3getEv">get</span>();</td></tr>
<tr><th id="1093">1093</th><td>}</td></tr>
<tr><th id="1094">1094</th><td></td></tr>
<tr><th id="1095">1095</th><td><a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="decl def fn" id="SSL_get1_session" title='SSL_get1_session' data-ref="SSL_get1_session" data-ref-filename="SSL_get1_session">SSL_get1_session</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<dfn class="local col2 decl" id="162ssl" title='ssl' data-type='SSL *' data-ref="162ssl" data-ref-filename="162ssl">ssl</dfn>) {</td></tr>
<tr><th id="1096">1096</th><td>  <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col3 decl" id="163ret" title='ret' data-type='SSL_SESSION *' data-ref="163ret" data-ref-filename="163ret">ret</dfn> = <a class="ref fn" href="#SSL_get_session" title='SSL_get_session' data-ref="SSL_get_session" data-ref-filename="SSL_get_session">SSL_get_session</a>(<a class="local col2 ref" href="#162ssl" title='ssl' data-ref="162ssl" data-ref-filename="162ssl">ssl</a>);</td></tr>
<tr><th id="1097">1097</th><td>  <b>if</b> (<a class="local col3 ref" href="#163ret" title='ret' data-ref="163ret" data-ref-filename="163ret">ret</a> != <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1098">1098</th><td>    <a class="ref fn" href="#SSL_SESSION_up_ref" title='SSL_SESSION_up_ref' data-ref="SSL_SESSION_up_ref" data-ref-filename="SSL_SESSION_up_ref">SSL_SESSION_up_ref</a>(<a class="local col3 ref" href="#163ret" title='ret' data-ref="163ret" data-ref-filename="163ret">ret</a>);</td></tr>
<tr><th id="1099">1099</th><td>  }</td></tr>
<tr><th id="1100">1100</th><td>  <b>return</b> <a class="local col3 ref" href="#163ret" title='ret' data-ref="163ret" data-ref-filename="163ret">ret</a>;</td></tr>
<tr><th id="1101">1101</th><td>}</td></tr>
<tr><th id="1102">1102</th><td></td></tr>
<tr><th id="1103">1103</th><td><em>int</em> <dfn class="decl def fn" id="SSL_SESSION_get_ex_new_index" title='SSL_SESSION_get_ex_new_index' data-ref="SSL_SESSION_get_ex_new_index" data-ref-filename="SSL_SESSION_get_ex_new_index">SSL_SESSION_get_ex_new_index</dfn>(<em>long</em> <dfn class="local col4 decl" id="164argl" title='argl' data-type='long' data-ref="164argl" data-ref-filename="164argl">argl</dfn>, <em>void</em> *<dfn class="local col5 decl" id="165argp" title='argp' data-type='void *' data-ref="165argp" data-ref-filename="165argp">argp</dfn>,</td></tr>
<tr><th id="1104">1104</th><td>                                 <a class="typedef" href="../include/openssl/ex_data.h.html#CRYPTO_EX_unused" title='CRYPTO_EX_unused' data-type='int' data-ref="CRYPTO_EX_unused" data-ref-filename="CRYPTO_EX_unused">CRYPTO_EX_unused</a> *<dfn class="local col6 decl" id="166unused" title='unused' data-type='CRYPTO_EX_unused *' data-ref="166unused" data-ref-filename="166unused">unused</dfn>,</td></tr>
<tr><th id="1105">1105</th><td>                                 <a class="typedef" href="../include/openssl/ex_data.h.html#CRYPTO_EX_dup" title='CRYPTO_EX_dup' data-type='int (CRYPTO_EX_DATA *, const CRYPTO_EX_DATA *, void **, int, long, void *)' data-ref="CRYPTO_EX_dup" data-ref-filename="CRYPTO_EX_dup">CRYPTO_EX_dup</a> *<dfn class="local col7 decl" id="167dup_unused" title='dup_unused' data-type='CRYPTO_EX_dup *' data-ref="167dup_unused" data-ref-filename="167dup_unused">dup_unused</dfn>,</td></tr>
<tr><th id="1106">1106</th><td>                                 <a class="typedef" href="../include/openssl/ex_data.h.html#CRYPTO_EX_free" title='CRYPTO_EX_free' data-type='void (void *, void *, CRYPTO_EX_DATA *, int, long, void *)' data-ref="CRYPTO_EX_free" data-ref-filename="CRYPTO_EX_free">CRYPTO_EX_free</a> *<dfn class="local col8 decl" id="168free_func" title='free_func' data-type='CRYPTO_EX_free *' data-ref="168free_func" data-ref-filename="168free_func">free_func</dfn>) {</td></tr>
<tr><th id="1107">1107</th><td>  <em>int</em> <dfn class="local col9 decl" id="169index" title='index' data-type='int' data-ref="169index" data-ref-filename="169index">index</dfn>;</td></tr>
<tr><th id="1108">1108</th><td>  <b>if</b> (!<a class="ref fn" href="../crypto/internal.h.html#CRYPTO_get_ex_new_index" title='CRYPTO_get_ex_new_index' data-ref="CRYPTO_get_ex_new_index" data-ref-filename="CRYPTO_get_ex_new_index">CRYPTO_get_ex_new_index</a>(&amp;<a class="tu ref" href="#bssl::g_ex_data_class" title='bssl::g_ex_data_class' data-use='a' data-ref="bssl::g_ex_data_class" data-ref-filename="bssl..g_ex_data_class">g_ex_data_class</a>, &amp;<a class="local col9 ref" href="#169index" title='index' data-ref="169index" data-ref-filename="169index">index</a>, <a class="local col4 ref" href="#164argl" title='argl' data-ref="164argl" data-ref-filename="164argl">argl</a>, <a class="local col5 ref" href="#165argp" title='argp' data-ref="165argp" data-ref-filename="165argp">argp</a>,</td></tr>
<tr><th id="1109">1109</th><td>                               <a class="local col8 ref" href="#168free_func" title='free_func' data-ref="168free_func" data-ref-filename="168free_func">free_func</a>)) {</td></tr>
<tr><th id="1110">1110</th><td>    <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="1111">1111</th><td>  }</td></tr>
<tr><th id="1112">1112</th><td>  <b>return</b> <a class="local col9 ref" href="#169index" title='index' data-ref="169index" data-ref-filename="169index">index</a>;</td></tr>
<tr><th id="1113">1113</th><td>}</td></tr>
<tr><th id="1114">1114</th><td></td></tr>
<tr><th id="1115">1115</th><td><em>int</em> <dfn class="decl def fn" id="SSL_SESSION_set_ex_data" title='SSL_SESSION_set_ex_data' data-ref="SSL_SESSION_set_ex_data" data-ref-filename="SSL_SESSION_set_ex_data">SSL_SESSION_set_ex_data</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col0 decl" id="170session" title='session' data-type='SSL_SESSION *' data-ref="170session" data-ref-filename="170session">session</dfn>, <em>int</em> <dfn class="local col1 decl" id="171idx" title='idx' data-type='int' data-ref="171idx" data-ref-filename="171idx">idx</dfn>, <em>void</em> *<dfn class="local col2 decl" id="172arg" title='arg' data-type='void *' data-ref="172arg" data-ref-filename="172arg">arg</dfn>) {</td></tr>
<tr><th id="1116">1116</th><td>  <b>return</b> <a class="ref fn" href="../crypto/internal.h.html#CRYPTO_set_ex_data" title='CRYPTO_set_ex_data' data-ref="CRYPTO_set_ex_data" data-ref-filename="CRYPTO_set_ex_data">CRYPTO_set_ex_data</a>(&amp;<a class="local col0 ref" href="#170session" title='session' data-ref="170session" data-ref-filename="170session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ex_data" title='ssl_session_st::ex_data' data-ref="ssl_session_st::ex_data" data-ref-filename="ssl_session_st..ex_data">ex_data</a>, <a class="local col1 ref" href="#171idx" title='idx' data-ref="171idx" data-ref-filename="171idx">idx</a>, <a class="local col2 ref" href="#172arg" title='arg' data-ref="172arg" data-ref-filename="172arg">arg</a>);</td></tr>
<tr><th id="1117">1117</th><td>}</td></tr>
<tr><th id="1118">1118</th><td></td></tr>
<tr><th id="1119">1119</th><td><em>void</em> *<dfn class="decl def fn" id="SSL_SESSION_get_ex_data" title='SSL_SESSION_get_ex_data' data-ref="SSL_SESSION_get_ex_data" data-ref-filename="SSL_SESSION_get_ex_data">SSL_SESSION_get_ex_data</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col3 decl" id="173session" title='session' data-type='const SSL_SESSION *' data-ref="173session" data-ref-filename="173session">session</dfn>, <em>int</em> <dfn class="local col4 decl" id="174idx" title='idx' data-type='int' data-ref="174idx" data-ref-filename="174idx">idx</dfn>) {</td></tr>
<tr><th id="1120">1120</th><td>  <b>return</b> <a class="ref fn" href="../crypto/internal.h.html#CRYPTO_get_ex_data" title='CRYPTO_get_ex_data' data-ref="CRYPTO_get_ex_data" data-ref-filename="CRYPTO_get_ex_data">CRYPTO_get_ex_data</a>(&amp;<a class="local col3 ref" href="#173session" title='session' data-ref="173session" data-ref-filename="173session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::ex_data" title='ssl_session_st::ex_data' data-ref="ssl_session_st::ex_data" data-ref-filename="ssl_session_st..ex_data">ex_data</a>, <a class="local col4 ref" href="#174idx" title='idx' data-ref="174idx" data-ref-filename="174idx">idx</a>);</td></tr>
<tr><th id="1121">1121</th><td>}</td></tr>
<tr><th id="1122">1122</th><td></td></tr>
<tr><th id="1123">1123</th><td><em>int</em> <dfn class="decl def fn" id="SSL_CTX_add_session" title='SSL_CTX_add_session' data-ref="SSL_CTX_add_session" data-ref-filename="SSL_CTX_add_session">SSL_CTX_add_session</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col5 decl" id="175ctx" title='ctx' data-type='SSL_CTX *' data-ref="175ctx" data-ref-filename="175ctx">ctx</dfn>, <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col6 decl" id="176session" title='session' data-type='SSL_SESSION *' data-ref="176session" data-ref-filename="176session">session</dfn>) {</td></tr>
<tr><th id="1124">1124</th><td>  <i>// Although |session| is inserted into two structures (a doubly-linked list</i></td></tr>
<tr><th id="1125">1125</th><td><i>  // and the hash table), |ctx| only takes one reference.</i></td></tr>
<tr><th id="1126">1126</th><td>  <a class="type" href="../include/openssl/base.h.html#bssl::UniquePtr" title='bssl::UniquePtr' data-ref="bssl::UniquePtr" data-ref-filename="bssl..UniquePtr">UniquePtr</a>&lt;<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a>&gt; <dfn class="local col7 decl" id="177owned_session" title='owned_session' data-type='UniquePtr&lt;SSL_SESSION&gt;' data-ref="177owned_session" data-ref-filename="177owned_session">owned_session</dfn> = <a class="ref fn" href="../include/openssl/ssl.h.html#5147" title='bssl::UpRef' data-ref="_ZN4bssl5UpRefEP14ssl_session_st" data-ref-filename="_ZN4bssl5UpRefEP14ssl_session_st">UpRef</a>(<a class="local col6 ref" href="#176session" title='session' data-ref="176session" data-ref-filename="176session">session</a>);</td></tr>
<tr><th id="1127">1127</th><td></td></tr>
<tr><th id="1128">1128</th><td>  <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col8 decl" id="178old_session" title='old_session' data-type='SSL_SESSION *' data-ref="178old_session" data-ref-filename="178old_session">old_session</dfn>;</td></tr>
<tr><th id="1129">1129</th><td>  <a class="typedef" href="../crypto/internal.h.html#bssl::MutexWriteLock" title='bssl::MutexWriteLock' data-type='internal::MutexLockBase&lt;CRYPTO_MUTEX_lock_write, CRYPTO_MUTEX_unlock_write&gt;' data-ref="bssl::MutexWriteLock" data-ref-filename="bssl..MutexWriteLock">MutexWriteLock</a> <dfn class="local col9 decl" id="179lock" title='lock' data-type='bssl::MutexWriteLock' data-ref="179lock" data-ref-filename="179lock">lock</dfn><a class="ref fn" href="../crypto/internal.h.html#_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t" title='bssl::internal::MutexLockBase::MutexLockBase&lt;LockFunc, ReleaseFunc&gt;' data-ref="_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t" data-ref-filename="_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t">(</a>&amp;<a class="local col5 ref" href="#175ctx" title='ctx' data-ref="175ctx" data-ref-filename="175ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::lock" title='ssl_ctx_st::lock' data-ref="ssl_ctx_st::lock" data-ref-filename="ssl_ctx_st..lock">lock</a>);</td></tr>
<tr><th id="1130">1130</th><td>  <b>if</b> (!<a class="ref fn" href="internal.h.html#2464" title='lh_SSL_SESSION_insert' data-ref="_Z21lh_SSL_SESSION_insertP20lhash_st_SSL_SESSIONPP14ssl_session_stS2_" data-ref-filename="_Z21lh_SSL_SESSION_insertP20lhash_st_SSL_SESSIONPP14ssl_session_stS2_">lh_SSL_SESSION_insert</a>(<a class="local col5 ref" href="#175ctx" title='ctx' data-ref="175ctx" data-ref-filename="175ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::sessions" title='ssl_ctx_st::sessions' data-ref="ssl_ctx_st::sessions" data-ref-filename="ssl_ctx_st..sessions">sessions</a>, &amp;<a class="local col8 ref" href="#178old_session" title='old_session' data-ref="178old_session" data-ref-filename="178old_session">old_session</a>, <a class="local col6 ref" href="#176session" title='session' data-ref="176session" data-ref-filename="176session">session</a>)) {</td></tr>
<tr><th id="1131">1131</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="1132">1132</th><td>  }</td></tr>
<tr><th id="1133">1133</th><td>  <i>// |ctx-&gt;sessions| took ownership of |session| and gave us back a reference to</i></td></tr>
<tr><th id="1134">1134</th><td><i>  // |old_session|. (|old_session| may be the same as |session|, in which case</i></td></tr>
<tr><th id="1135">1135</th><td><i>  // we traded identical references with |ctx-&gt;sessions|.)</i></td></tr>
<tr><th id="1136">1136</th><td>  <a class="local col7 ref" href="#177owned_session" title='owned_session' data-ref="177owned_session" data-ref-filename="177owned_session">owned_session</a>.<span class='ref fn' title='std::__1::unique_ptr::release' data-ref="_ZNSt3__110unique_ptr7releaseEv" data-ref-filename="_ZNSt3__110unique_ptr7releaseEv">release</span>();</td></tr>
<tr><th id="1137">1137</th><td>  <a class="local col7 ref" href="#177owned_session" title='owned_session' data-ref="177owned_session" data-ref-filename="177owned_session">owned_session</a>.<span class='ref fn' title='std::__1::unique_ptr::reset' data-ref="_ZNSt3__110unique_ptr5resetENS_14__pointer_typeIT_T0_E4typeE" data-ref-filename="_ZNSt3__110unique_ptr5resetENS_14__pointer_typeIT_T0_E4typeE">reset</span>(<a class="local col8 ref" href="#178old_session" title='old_session' data-ref="178old_session" data-ref-filename="178old_session">old_session</a>);</td></tr>
<tr><th id="1138">1138</th><td></td></tr>
<tr><th id="1139">1139</th><td>  <b>if</b> (<a class="local col8 ref" href="#178old_session" title='old_session' data-ref="178old_session" data-ref-filename="178old_session">old_session</a> != <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1140">1140</th><td>    <b>if</b> (<a class="local col8 ref" href="#178old_session" title='old_session' data-ref="178old_session" data-ref-filename="178old_session">old_session</a> == <a class="local col6 ref" href="#176session" title='session' data-ref="176session" data-ref-filename="176session">session</a>) {</td></tr>
<tr><th id="1141">1141</th><td>      <i>// |session| was already in the cache. There are no linked list pointers</i></td></tr>
<tr><th id="1142">1142</th><td><i>      // to update.</i></td></tr>
<tr><th id="1143">1143</th><td>      <b>return</b> <var>0</var>;</td></tr>
<tr><th id="1144">1144</th><td>    }</td></tr>
<tr><th id="1145">1145</th><td></td></tr>
<tr><th id="1146">1146</th><td>    <i>// There was a session ID collision. |old_session| was replaced with</i></td></tr>
<tr><th id="1147">1147</th><td><i>    // |session| in the hash table, so |old_session| must be removed from the</i></td></tr>
<tr><th id="1148">1148</th><td><i>    // linked list to match.</i></td></tr>
<tr><th id="1149">1149</th><td>    <a class="tu ref fn" href="#_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st" title='bssl::SSL_SESSION_list_remove' data-use='c' data-ref="_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st" data-ref-filename="_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st">SSL_SESSION_list_remove</a>(<a class="local col5 ref" href="#175ctx" title='ctx' data-ref="175ctx" data-ref-filename="175ctx">ctx</a>, <a class="local col8 ref" href="#178old_session" title='old_session' data-ref="178old_session" data-ref-filename="178old_session">old_session</a>);</td></tr>
<tr><th id="1150">1150</th><td>  }</td></tr>
<tr><th id="1151">1151</th><td></td></tr>
<tr><th id="1152">1152</th><td>  <a class="tu ref fn" href="#_ZN4bsslL20SSL_SESSION_list_addEP10ssl_ctx_stP14ssl_session_st" title='bssl::SSL_SESSION_list_add' data-use='c' data-ref="_ZN4bsslL20SSL_SESSION_list_addEP10ssl_ctx_stP14ssl_session_st" data-ref-filename="_ZN4bsslL20SSL_SESSION_list_addEP10ssl_ctx_stP14ssl_session_st">SSL_SESSION_list_add</a>(<a class="local col5 ref" href="#175ctx" title='ctx' data-ref="175ctx" data-ref-filename="175ctx">ctx</a>, <a class="local col6 ref" href="#176session" title='session' data-ref="176session" data-ref-filename="176session">session</a>);</td></tr>
<tr><th id="1153">1153</th><td></td></tr>
<tr><th id="1154">1154</th><td>  <i>// Enforce any cache size limits.</i></td></tr>
<tr><th id="1155">1155</th><td>  <b>if</b> (<a class="macro" href="../include/openssl/ssl.h.html#5076" title="SSL_CTX_sess_get_cache_size" data-ref="_M/SSL_CTX_sess_get_cache_size">SSL_CTX_sess_get_cache_size</a>(<a class="local col5 ref" href="#175ctx" title='ctx' data-ref="175ctx" data-ref-filename="175ctx">ctx</a>) &gt; <var>0</var>) {</td></tr>
<tr><th id="1156">1156</th><td>    <b>while</b> (<a class="ref fn" href="internal.h.html#2464" title='lh_SSL_SESSION_num_items' data-ref="_Z24lh_SSL_SESSION_num_itemsPK20lhash_st_SSL_SESSION" data-ref-filename="_Z24lh_SSL_SESSION_num_itemsPK20lhash_st_SSL_SESSION">lh_SSL_SESSION_num_items</a>(<a class="local col5 ref" href="#175ctx" title='ctx' data-ref="175ctx" data-ref-filename="175ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::sessions" title='ssl_ctx_st::sessions' data-ref="ssl_ctx_st::sessions" data-ref-filename="ssl_ctx_st..sessions">sessions</a>) &gt;</td></tr>
<tr><th id="1157">1157</th><td>           <a class="macro" href="../include/openssl/ssl.h.html#5076" title="SSL_CTX_sess_get_cache_size" data-ref="_M/SSL_CTX_sess_get_cache_size">SSL_CTX_sess_get_cache_size</a>(<a class="local col5 ref" href="#175ctx" title='ctx' data-ref="175ctx" data-ref-filename="175ctx">ctx</a>)) {</td></tr>
<tr><th id="1158">1158</th><td>      <b>if</b> (!<a class="tu ref fn" href="#_ZN4bsslL19remove_session_lockEP10ssl_ctx_stP14ssl_session_sti" title='bssl::remove_session_lock' data-use='c' data-ref="_ZN4bsslL19remove_session_lockEP10ssl_ctx_stP14ssl_session_sti" data-ref-filename="_ZN4bsslL19remove_session_lockEP10ssl_ctx_stP14ssl_session_sti">remove_session_lock</a>(<a class="local col5 ref" href="#175ctx" title='ctx' data-ref="175ctx" data-ref-filename="175ctx">ctx</a>, <a class="local col5 ref" href="#175ctx" title='ctx' data-ref="175ctx" data-ref-filename="175ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_cache_tail" title='ssl_ctx_st::session_cache_tail' data-ref="ssl_ctx_st::session_cache_tail" data-ref-filename="ssl_ctx_st..session_cache_tail">session_cache_tail</a>, <var>0</var>)) {</td></tr>
<tr><th id="1159">1159</th><td>        <b>break</b>;</td></tr>
<tr><th id="1160">1160</th><td>      }</td></tr>
<tr><th id="1161">1161</th><td>    }</td></tr>
<tr><th id="1162">1162</th><td>  }</td></tr>
<tr><th id="1163">1163</th><td></td></tr>
<tr><th id="1164">1164</th><td>  <b>return</b> <var>1</var>;</td></tr>
<tr><th id="1165">1165</th><td>}</td></tr>
<tr><th id="1166">1166</th><td></td></tr>
<tr><th id="1167">1167</th><td><em>int</em> <dfn class="decl def fn" id="SSL_CTX_remove_session" title='SSL_CTX_remove_session' data-ref="SSL_CTX_remove_session" data-ref-filename="SSL_CTX_remove_session">SSL_CTX_remove_session</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col0 decl" id="180ctx" title='ctx' data-type='SSL_CTX *' data-ref="180ctx" data-ref-filename="180ctx">ctx</dfn>, <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col1 decl" id="181session" title='session' data-type='SSL_SESSION *' data-ref="181session" data-ref-filename="181session">session</dfn>) {</td></tr>
<tr><th id="1168">1168</th><td>  <b>return</b> <a class="tu ref fn" href="#_ZN4bsslL19remove_session_lockEP10ssl_ctx_stP14ssl_session_sti" title='bssl::remove_session_lock' data-use='c' data-ref="_ZN4bsslL19remove_session_lockEP10ssl_ctx_stP14ssl_session_sti" data-ref-filename="_ZN4bsslL19remove_session_lockEP10ssl_ctx_stP14ssl_session_sti">remove_session_lock</a>(<a class="local col0 ref" href="#180ctx" title='ctx' data-ref="180ctx" data-ref-filename="180ctx">ctx</a>, <a class="local col1 ref" href="#181session" title='session' data-ref="181session" data-ref-filename="181session">session</a>, <var>1</var>);</td></tr>
<tr><th id="1169">1169</th><td>}</td></tr>
<tr><th id="1170">1170</th><td></td></tr>
<tr><th id="1171">1171</th><td><em>int</em> <dfn class="decl def fn" id="SSL_set_session" title='SSL_set_session' data-ref="SSL_set_session" data-ref-filename="SSL_set_session">SSL_set_session</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<dfn class="local col2 decl" id="182ssl" title='ssl' data-type='SSL *' data-ref="182ssl" data-ref-filename="182ssl">ssl</dfn>, <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col3 decl" id="183session" title='session' data-type='SSL_SESSION *' data-ref="183session" data-ref-filename="183session">session</dfn>) {</td></tr>
<tr><th id="1172">1172</th><td>  <i>// SSL_set_session may only be called before the handshake has started.</i></td></tr>
<tr><th id="1173">1173</th><td>  <b>if</b> (<a class="local col2 ref" href="#182ssl" title='ssl' data-ref="182ssl" data-ref-filename="182ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::s3" title='ssl_st::s3' data-ref="ssl_st::s3" data-ref-filename="ssl_st..s3">s3</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL3_STATE::initial_handshake_complete" title='bssl::SSL3_STATE::initial_handshake_complete' data-ref="bssl::SSL3_STATE::initial_handshake_complete" data-ref-filename="bssl..SSL3_STATE..initial_handshake_complete">initial_handshake_complete</a> ||</td></tr>
<tr><th id="1174">1174</th><td>      <a class="local col2 ref" href="#182ssl" title='ssl' data-ref="182ssl" data-ref-filename="182ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::s3" title='ssl_st::s3' data-ref="ssl_st::s3" data-ref-filename="ssl_st..s3">s3</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL3_STATE::hs" title='bssl::SSL3_STATE::hs' data-ref="bssl::SSL3_STATE::hs" data-ref-filename="bssl..SSL3_STATE..hs">hs</a> <span class='ref fn' title='std::__1::operator==' data-ref="_ZNSt3__1eqERKNS_10unique_ptrIT_T0_EEDn" data-ref-filename="_ZNSt3__1eqERKNS_10unique_ptrIT_T0_EEDn">==</span> <span class="macro" title="__null" data-ref="_M/NULL">NULL</span> ||</td></tr>
<tr><th id="1175">1175</th><td>      <a class="local col2 ref" href="#182ssl" title='ssl' data-ref="182ssl" data-ref-filename="182ssl">ssl</a>-&gt;<a class="ref field" href="internal.h.html#ssl_st::s3" title='ssl_st::s3' data-ref="ssl_st::s3" data-ref-filename="ssl_st..s3">s3</a>-&gt;<a class="ref field" href="internal.h.html#bssl::SSL3_STATE::hs" title='bssl::SSL3_STATE::hs' data-ref="bssl::SSL3_STATE::hs" data-ref-filename="bssl..SSL3_STATE..hs">hs</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref field" href="internal.h.html#bssl::SSL_HANDSHAKE::state" title='bssl::SSL_HANDSHAKE::state' data-ref="bssl::SSL_HANDSHAKE::state" data-ref-filename="bssl..SSL_HANDSHAKE..state">state</a> != <var>0</var>) {</td></tr>
<tr><th id="1176">1176</th><td>    <span class='ref fn' title='abort' data-ref="abort" data-ref-filename="abort">abort</span>();</td></tr>
<tr><th id="1177">1177</th><td>  }</td></tr>
<tr><th id="1178">1178</th><td></td></tr>
<tr><th id="1179">1179</th><td>  <a class="ref fn" href="#_ZN4bssl15ssl_set_sessionEP6ssl_stP14ssl_session_st" title='bssl::ssl_set_session' data-ref="_ZN4bssl15ssl_set_sessionEP6ssl_stP14ssl_session_st" data-ref-filename="_ZN4bssl15ssl_set_sessionEP6ssl_stP14ssl_session_st">ssl_set_session</a>(<a class="local col2 ref" href="#182ssl" title='ssl' data-ref="182ssl" data-ref-filename="182ssl">ssl</a>, <a class="local col3 ref" href="#183session" title='session' data-ref="183session" data-ref-filename="183session">session</a>);</td></tr>
<tr><th id="1180">1180</th><td>  <b>return</b> <var>1</var>;</td></tr>
<tr><th id="1181">1181</th><td>}</td></tr>
<tr><th id="1182">1182</th><td></td></tr>
<tr><th id="1183">1183</th><td><span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span> <dfn class="decl def fn" id="SSL_CTX_set_timeout" title='SSL_CTX_set_timeout' data-ref="SSL_CTX_set_timeout" data-ref-filename="SSL_CTX_set_timeout">SSL_CTX_set_timeout</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col4 decl" id="184ctx" title='ctx' data-type='SSL_CTX *' data-ref="184ctx" data-ref-filename="184ctx">ctx</dfn>, <span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span> <dfn class="local col5 decl" id="185timeout" title='timeout' data-type='uint32_t' data-ref="185timeout" data-ref-filename="185timeout">timeout</dfn>) {</td></tr>
<tr><th id="1184">1184</th><td>  <b>if</b> (<a class="local col4 ref" href="#184ctx" title='ctx' data-ref="184ctx" data-ref-filename="184ctx">ctx</a> == <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1185">1185</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="1186">1186</th><td>  }</td></tr>
<tr><th id="1187">1187</th><td></td></tr>
<tr><th id="1188">1188</th><td>  <i>// Historically, zero was treated as |SSL_DEFAULT_SESSION_TIMEOUT|.</i></td></tr>
<tr><th id="1189">1189</th><td>  <b>if</b> (<a class="local col5 ref" href="#185timeout" title='timeout' data-ref="185timeout" data-ref-filename="185timeout">timeout</a> == <var>0</var>) {</td></tr>
<tr><th id="1190">1190</th><td>    <a class="local col5 ref" href="#185timeout" title='timeout' data-ref="185timeout" data-ref-filename="185timeout">timeout</a> = <a class="macro" href="../include/openssl/ssl.h.html#1942" title="(2 * 60 * 60)" data-ref="_M/SSL_DEFAULT_SESSION_TIMEOUT">SSL_DEFAULT_SESSION_TIMEOUT</a>;</td></tr>
<tr><th id="1191">1191</th><td>  }</td></tr>
<tr><th id="1192">1192</th><td></td></tr>
<tr><th id="1193">1193</th><td>  <span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span> <dfn class="local col6 decl" id="186old_timeout" title='old_timeout' data-type='uint32_t' data-ref="186old_timeout" data-ref-filename="186old_timeout">old_timeout</dfn> = <a class="local col4 ref" href="#184ctx" title='ctx' data-ref="184ctx" data-ref-filename="184ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_timeout" title='ssl_ctx_st::session_timeout' data-ref="ssl_ctx_st::session_timeout" data-ref-filename="ssl_ctx_st..session_timeout">session_timeout</a>;</td></tr>
<tr><th id="1194">1194</th><td>  <a class="local col4 ref" href="#184ctx" title='ctx' data-ref="184ctx" data-ref-filename="184ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_timeout" title='ssl_ctx_st::session_timeout' data-ref="ssl_ctx_st::session_timeout" data-ref-filename="ssl_ctx_st..session_timeout">session_timeout</a> = <a class="local col5 ref" href="#185timeout" title='timeout' data-ref="185timeout" data-ref-filename="185timeout">timeout</a>;</td></tr>
<tr><th id="1195">1195</th><td>  <b>return</b> <a class="local col6 ref" href="#186old_timeout" title='old_timeout' data-ref="186old_timeout" data-ref-filename="186old_timeout">old_timeout</a>;</td></tr>
<tr><th id="1196">1196</th><td>}</td></tr>
<tr><th id="1197">1197</th><td></td></tr>
<tr><th id="1198">1198</th><td><span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span> <dfn class="decl def fn" id="SSL_CTX_get_timeout" title='SSL_CTX_get_timeout' data-ref="SSL_CTX_get_timeout" data-ref-filename="SSL_CTX_get_timeout">SSL_CTX_get_timeout</dfn>(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col7 decl" id="187ctx" title='ctx' data-type='const SSL_CTX *' data-ref="187ctx" data-ref-filename="187ctx">ctx</dfn>) {</td></tr>
<tr><th id="1199">1199</th><td>  <b>if</b> (<a class="local col7 ref" href="#187ctx" title='ctx' data-ref="187ctx" data-ref-filename="187ctx">ctx</a> == <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1200">1200</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="1201">1201</th><td>  }</td></tr>
<tr><th id="1202">1202</th><td></td></tr>
<tr><th id="1203">1203</th><td>  <b>return</b> <a class="local col7 ref" href="#187ctx" title='ctx' data-ref="187ctx" data-ref-filename="187ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_timeout" title='ssl_ctx_st::session_timeout' data-ref="ssl_ctx_st::session_timeout" data-ref-filename="ssl_ctx_st..session_timeout">session_timeout</a>;</td></tr>
<tr><th id="1204">1204</th><td>}</td></tr>
<tr><th id="1205">1205</th><td></td></tr>
<tr><th id="1206">1206</th><td><em>void</em> <dfn class="decl def fn" id="SSL_CTX_set_session_psk_dhe_timeout" title='SSL_CTX_set_session_psk_dhe_timeout' data-ref="SSL_CTX_set_session_psk_dhe_timeout" data-ref-filename="SSL_CTX_set_session_psk_dhe_timeout">SSL_CTX_set_session_psk_dhe_timeout</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col8 decl" id="188ctx" title='ctx' data-type='SSL_CTX *' data-ref="188ctx" data-ref-filename="188ctx">ctx</dfn>, <span class='typedef' title='uint32_t' data-type='unsigned int' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</span> <dfn class="local col9 decl" id="189timeout" title='timeout' data-type='uint32_t' data-ref="189timeout" data-ref-filename="189timeout">timeout</dfn>) {</td></tr>
<tr><th id="1207">1207</th><td>  <a class="local col8 ref" href="#188ctx" title='ctx' data-ref="188ctx" data-ref-filename="188ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::session_psk_dhe_timeout" title='ssl_ctx_st::session_psk_dhe_timeout' data-ref="ssl_ctx_st::session_psk_dhe_timeout" data-ref-filename="ssl_ctx_st..session_psk_dhe_timeout">session_psk_dhe_timeout</a> = <a class="local col9 ref" href="#189timeout" title='timeout' data-ref="189timeout" data-ref-filename="189timeout">timeout</a>;</td></tr>
<tr><th id="1208">1208</th><td>}</td></tr>
<tr><th id="1209">1209</th><td></td></tr>
<tr><th id="1210">1210</th><td><b>typedef</b> <b>struct</b> <dfn class="type def" id="timeout_param_st" title='timeout_param_st' data-ref="timeout_param_st" data-ref-filename="timeout_param_st"><a class="type" href="#timeout_param_st" title='timeout_param_st' data-ref="timeout_param_st" data-ref-filename="timeout_param_st">timeout_param_st</a></dfn> {</td></tr>
<tr><th id="1211">1211</th><td>  <a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="tu decl field" id="timeout_param_st::ctx" title='timeout_param_st::ctx' data-type='SSL_CTX *' data-ref="timeout_param_st::ctx" data-ref-filename="timeout_param_st..ctx">ctx</dfn>;</td></tr>
<tr><th id="1212">1212</th><td>  <span class='typedef' title='uint64_t' data-type='unsigned long long' data-ref="uint64_t" data-ref-filename="uint64_t">uint64_t</span> <dfn class="tu decl field" id="timeout_param_st::time" title='timeout_param_st::time' data-type='uint64_t' data-ref="timeout_param_st::time" data-ref-filename="timeout_param_st..time">time</dfn>;</td></tr>
<tr><th id="1213">1213</th><td>  <a class="macro" href="../include/openssl/lhash.h.html#88" title="struct lhash_st_SSL_SESSION" data-ref="_M/LHASH_OF">LHASH_OF</a>(SSL_SESSION) *<dfn class="tu decl field" id="timeout_param_st::cache" title='timeout_param_st::cache' data-type='struct lhash_st_SSL_SESSION *' data-ref="timeout_param_st::cache" data-ref-filename="timeout_param_st..cache">cache</dfn>;</td></tr>
<tr><th id="1214">1214</th><td>} <dfn class="typedef" id="TIMEOUT_PARAM" title='TIMEOUT_PARAM' data-type='struct timeout_param_st' data-ref="TIMEOUT_PARAM" data-ref-filename="TIMEOUT_PARAM">TIMEOUT_PARAM</dfn>;</td></tr>
<tr><th id="1215">1215</th><td></td></tr>
<tr><th id="1216">1216</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="_ZL17timeout_doall_argP14ssl_session_stPv" title='timeout_doall_arg' data-type='void timeout_doall_arg(SSL_SESSION * session, void * void_param)' data-ref="_ZL17timeout_doall_argP14ssl_session_stPv" data-ref-filename="_ZL17timeout_doall_argP14ssl_session_stPv">timeout_doall_arg</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col0 decl" id="190session" title='session' data-type='SSL_SESSION *' data-ref="190session" data-ref-filename="190session">session</dfn>, <em>void</em> *<dfn class="local col1 decl" id="191void_param" title='void_param' data-type='void *' data-ref="191void_param" data-ref-filename="191void_param">void_param</dfn>) {</td></tr>
<tr><th id="1217">1217</th><td>  <a class="typedef" href="#TIMEOUT_PARAM" title='TIMEOUT_PARAM' data-type='struct timeout_param_st' data-ref="TIMEOUT_PARAM" data-ref-filename="TIMEOUT_PARAM">TIMEOUT_PARAM</a> *<dfn class="local col2 decl" id="192param" title='param' data-type='TIMEOUT_PARAM *' data-ref="192param" data-ref-filename="192param">param</dfn> = <b>reinterpret_cast</b>&lt;<a class="typedef" href="#TIMEOUT_PARAM" title='TIMEOUT_PARAM' data-type='struct timeout_param_st' data-ref="TIMEOUT_PARAM" data-ref-filename="TIMEOUT_PARAM">TIMEOUT_PARAM</a> *&gt;(<a class="local col1 ref" href="#191void_param" title='void_param' data-ref="191void_param" data-ref-filename="191void_param">void_param</a>);</td></tr>
<tr><th id="1218">1218</th><td></td></tr>
<tr><th id="1219">1219</th><td>  <b>if</b> (<a class="local col2 ref" href="#192param" title='param' data-ref="192param" data-ref-filename="192param">param</a>-&gt;<a class="tu ref field" href="#timeout_param_st::time" title='timeout_param_st::time' data-use='r' data-ref="timeout_param_st::time" data-ref-filename="timeout_param_st..time">time</a> == <var>0</var> ||</td></tr>
<tr><th id="1220">1220</th><td>      <a class="local col0 ref" href="#190session" title='session' data-ref="190session" data-ref-filename="190session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::time" title='ssl_session_st::time' data-ref="ssl_session_st::time" data-ref-filename="ssl_session_st..time">time</a> + <a class="local col0 ref" href="#190session" title='session' data-ref="190session" data-ref-filename="190session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a> &lt; <a class="local col0 ref" href="#190session" title='session' data-ref="190session" data-ref-filename="190session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::time" title='ssl_session_st::time' data-ref="ssl_session_st::time" data-ref-filename="ssl_session_st..time">time</a> ||</td></tr>
<tr><th id="1221">1221</th><td>      <a class="local col2 ref" href="#192param" title='param' data-ref="192param" data-ref-filename="192param">param</a>-&gt;<a class="tu ref field" href="#timeout_param_st::time" title='timeout_param_st::time' data-use='r' data-ref="timeout_param_st::time" data-ref-filename="timeout_param_st..time">time</a> &gt; (<a class="local col0 ref" href="#190session" title='session' data-ref="190session" data-ref-filename="190session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::time" title='ssl_session_st::time' data-ref="ssl_session_st::time" data-ref-filename="ssl_session_st..time">time</a> + <a class="local col0 ref" href="#190session" title='session' data-ref="190session" data-ref-filename="190session">session</a>-&gt;<a class="ref field" href="internal.h.html#ssl_session_st::timeout" title='ssl_session_st::timeout' data-ref="ssl_session_st::timeout" data-ref-filename="ssl_session_st..timeout">timeout</a>)) {</td></tr>
<tr><th id="1222">1222</th><td>    <i>// The reason we don't call SSL_CTX_remove_session() is to</i></td></tr>
<tr><th id="1223">1223</th><td><i>    // save on locking overhead</i></td></tr>
<tr><th id="1224">1224</th><td>    (<em>void</em>) <a class="ref fn" href="internal.h.html#2464" title='lh_SSL_SESSION_delete' data-ref="_Z21lh_SSL_SESSION_deleteP20lhash_st_SSL_SESSIONPK14ssl_session_st" data-ref-filename="_Z21lh_SSL_SESSION_deleteP20lhash_st_SSL_SESSIONPK14ssl_session_st">lh_SSL_SESSION_delete</a>(<a class="local col2 ref" href="#192param" title='param' data-ref="192param" data-ref-filename="192param">param</a>-&gt;<a class="tu ref field" href="#timeout_param_st::cache" title='timeout_param_st::cache' data-use='r' data-ref="timeout_param_st::cache" data-ref-filename="timeout_param_st..cache">cache</a>, <a class="local col0 ref" href="#190session" title='session' data-ref="190session" data-ref-filename="190session">session</a>);</td></tr>
<tr><th id="1225">1225</th><td>    <a class="tu ref fn" href="#_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st" title='bssl::SSL_SESSION_list_remove' data-use='c' data-ref="_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st" data-ref-filename="_ZN4bsslL23SSL_SESSION_list_removeEP10ssl_ctx_stP14ssl_session_st">SSL_SESSION_list_remove</a>(<a class="local col2 ref" href="#192param" title='param' data-ref="192param" data-ref-filename="192param">param</a>-&gt;<a class="tu ref field" href="#timeout_param_st::ctx" title='timeout_param_st::ctx' data-use='r' data-ref="timeout_param_st::ctx" data-ref-filename="timeout_param_st..ctx">ctx</a>, <a class="local col0 ref" href="#190session" title='session' data-ref="190session" data-ref-filename="190session">session</a>);</td></tr>
<tr><th id="1226">1226</th><td>    <b>if</b> (<a class="local col2 ref" href="#192param" title='param' data-ref="192param" data-ref-filename="192param">param</a>-&gt;<a class="tu ref field" href="#timeout_param_st::ctx" title='timeout_param_st::ctx' data-use='r' data-ref="timeout_param_st::ctx" data-ref-filename="timeout_param_st..ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::remove_session_cb" title='ssl_ctx_st::remove_session_cb' data-ref="ssl_ctx_st::remove_session_cb" data-ref-filename="ssl_ctx_st..remove_session_cb">remove_session_cb</a> != <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1227">1227</th><td>      <a class="local col2 ref" href="#192param" title='param' data-ref="192param" data-ref-filename="192param">param</a>-&gt;<a class="tu ref field" href="#timeout_param_st::ctx" title='timeout_param_st::ctx' data-use='r' data-ref="timeout_param_st::ctx" data-ref-filename="timeout_param_st..ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::remove_session_cb" title='ssl_ctx_st::remove_session_cb' data-ref="ssl_ctx_st::remove_session_cb" data-ref-filename="ssl_ctx_st..remove_session_cb">remove_session_cb</a>(<a class="local col2 ref" href="#192param" title='param' data-ref="192param" data-ref-filename="192param">param</a>-&gt;<a class="tu ref field" href="#timeout_param_st::ctx" title='timeout_param_st::ctx' data-use='r' data-ref="timeout_param_st::ctx" data-ref-filename="timeout_param_st..ctx">ctx</a>, <a class="local col0 ref" href="#190session" title='session' data-ref="190session" data-ref-filename="190session">session</a>);</td></tr>
<tr><th id="1228">1228</th><td>    }</td></tr>
<tr><th id="1229">1229</th><td>    <a class="ref fn" href="#SSL_SESSION_free" title='SSL_SESSION_free' data-ref="SSL_SESSION_free" data-ref-filename="SSL_SESSION_free">SSL_SESSION_free</a>(<a class="local col0 ref" href="#190session" title='session' data-ref="190session" data-ref-filename="190session">session</a>);</td></tr>
<tr><th id="1230">1230</th><td>  }</td></tr>
<tr><th id="1231">1231</th><td>}</td></tr>
<tr><th id="1232">1232</th><td></td></tr>
<tr><th id="1233">1233</th><td><em>void</em> <dfn class="decl def fn" id="SSL_CTX_flush_sessions" title='SSL_CTX_flush_sessions' data-ref="SSL_CTX_flush_sessions" data-ref-filename="SSL_CTX_flush_sessions">SSL_CTX_flush_sessions</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col3 decl" id="193ctx" title='ctx' data-type='SSL_CTX *' data-ref="193ctx" data-ref-filename="193ctx">ctx</dfn>, <span class='typedef' title='uint64_t' data-type='unsigned long long' data-ref="uint64_t" data-ref-filename="uint64_t">uint64_t</span> <dfn class="local col4 decl" id="194time" title='time' data-type='uint64_t' data-ref="194time" data-ref-filename="194time">time</dfn>) {</td></tr>
<tr><th id="1234">1234</th><td>  <a class="typedef" href="#TIMEOUT_PARAM" title='TIMEOUT_PARAM' data-type='struct timeout_param_st' data-ref="TIMEOUT_PARAM" data-ref-filename="TIMEOUT_PARAM">TIMEOUT_PARAM</a> <a class="tu ref fn fake" href="#1210" title='timeout_param_st::timeout_param_st' data-use='c' data-ref="_ZN16timeout_param_stC1Ev" data-ref-filename="_ZN16timeout_param_stC1Ev"></a><dfn class="local col5 decl" id="195tp" title='tp' data-type='TIMEOUT_PARAM' data-ref="195tp" data-ref-filename="195tp">tp</dfn>;</td></tr>
<tr><th id="1235">1235</th><td></td></tr>
<tr><th id="1236">1236</th><td>  <a class="local col5 ref" href="#195tp" title='tp' data-ref="195tp" data-ref-filename="195tp">tp</a>.<a class="tu ref field" href="#timeout_param_st::ctx" title='timeout_param_st::ctx' data-use='w' data-ref="timeout_param_st::ctx" data-ref-filename="timeout_param_st..ctx">ctx</a> = <a class="local col3 ref" href="#193ctx" title='ctx' data-ref="193ctx" data-ref-filename="193ctx">ctx</a>;</td></tr>
<tr><th id="1237">1237</th><td>  <a class="local col5 ref" href="#195tp" title='tp' data-ref="195tp" data-ref-filename="195tp">tp</a>.<a class="tu ref field" href="#timeout_param_st::cache" title='timeout_param_st::cache' data-use='w' data-ref="timeout_param_st::cache" data-ref-filename="timeout_param_st..cache">cache</a> = <a class="local col3 ref" href="#193ctx" title='ctx' data-ref="193ctx" data-ref-filename="193ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::sessions" title='ssl_ctx_st::sessions' data-ref="ssl_ctx_st::sessions" data-ref-filename="ssl_ctx_st..sessions">sessions</a>;</td></tr>
<tr><th id="1238">1238</th><td>  <b>if</b> (<a class="local col5 ref" href="#195tp" title='tp' data-ref="195tp" data-ref-filename="195tp">tp</a>.<a class="tu ref field" href="#timeout_param_st::cache" title='timeout_param_st::cache' data-use='r' data-ref="timeout_param_st::cache" data-ref-filename="timeout_param_st..cache">cache</a> == <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1239">1239</th><td>    <b>return</b>;</td></tr>
<tr><th id="1240">1240</th><td>  }</td></tr>
<tr><th id="1241">1241</th><td>  <a class="local col5 ref" href="#195tp" title='tp' data-ref="195tp" data-ref-filename="195tp">tp</a>.<a class="tu ref field" href="#timeout_param_st::time" title='timeout_param_st::time' data-use='w' data-ref="timeout_param_st::time" data-ref-filename="timeout_param_st..time">time</a> = <a class="local col4 ref" href="#194time" title='time' data-ref="194time" data-ref-filename="194time">time</a>;</td></tr>
<tr><th id="1242">1242</th><td>  <a class="typedef" href="../crypto/internal.h.html#bssl::MutexWriteLock" title='bssl::MutexWriteLock' data-type='internal::MutexLockBase&lt;CRYPTO_MUTEX_lock_write, CRYPTO_MUTEX_unlock_write&gt;' data-ref="bssl::MutexWriteLock" data-ref-filename="bssl..MutexWriteLock">MutexWriteLock</a> <dfn class="local col6 decl" id="196lock" title='lock' data-type='bssl::MutexWriteLock' data-ref="196lock" data-ref-filename="196lock">lock</dfn><a class="ref fn" href="../crypto/internal.h.html#_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t" title='bssl::internal::MutexLockBase::MutexLockBase&lt;LockFunc, ReleaseFunc&gt;' data-ref="_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t" data-ref-filename="_ZN4bssl8internal13MutexLockBaseC1EP24_opaque_pthread_rwlock_t">(</a>&amp;<a class="local col3 ref" href="#193ctx" title='ctx' data-ref="193ctx" data-ref-filename="193ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::lock" title='ssl_ctx_st::lock' data-ref="ssl_ctx_st::lock" data-ref-filename="ssl_ctx_st..lock">lock</a>);</td></tr>
<tr><th id="1243">1243</th><td>  <a class="ref fn" href="internal.h.html#2464" title='lh_SSL_SESSION_doall_arg' data-ref="_Z24lh_SSL_SESSION_doall_argP20lhash_st_SSL_SESSIONPFvP14ssl_session_stPvES3_" data-ref-filename="_Z24lh_SSL_SESSION_doall_argP20lhash_st_SSL_SESSIONPFvP14ssl_session_stPvES3_">lh_SSL_SESSION_doall_arg</a>(<a class="local col5 ref" href="#195tp" title='tp' data-ref="195tp" data-ref-filename="195tp">tp</a>.<a class="tu ref field" href="#timeout_param_st::cache" title='timeout_param_st::cache' data-use='r' data-ref="timeout_param_st::cache" data-ref-filename="timeout_param_st..cache">cache</a>, <a class="tu ref fn" href="#_ZL17timeout_doall_argP14ssl_session_stPv" title='timeout_doall_arg' data-use='r' data-ref="_ZL17timeout_doall_argP14ssl_session_stPv" data-ref-filename="_ZL17timeout_doall_argP14ssl_session_stPv">timeout_doall_arg</a>, &amp;<a class="local col5 ref" href="#195tp" title='tp' data-ref="195tp" data-ref-filename="195tp">tp</a>);</td></tr>
<tr><th id="1244">1244</th><td>}</td></tr>
<tr><th id="1245">1245</th><td></td></tr>
<tr><th id="1246">1246</th><td><em>void</em> <dfn class="decl def fn" id="SSL_CTX_sess_set_new_cb" title='SSL_CTX_sess_set_new_cb' data-ref="SSL_CTX_sess_set_new_cb" data-ref-filename="SSL_CTX_sess_set_new_cb">SSL_CTX_sess_set_new_cb</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col7 decl" id="197ctx" title='ctx' data-type='SSL_CTX *' data-ref="197ctx" data-ref-filename="197ctx">ctx</dfn>,</td></tr>
<tr><th id="1247">1247</th><td>                             <em>int</em> (*<dfn class="local col8 decl" id="198cb" title='cb' data-type='int (*)(SSL *, SSL_SESSION *)' data-ref="198cb" data-ref-filename="198cb">cb</dfn>)(<a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<dfn class="local col9 decl" id="199ssl" title='ssl' data-type='SSL *' data-ref="199ssl" data-ref-filename="199ssl">ssl</dfn>, <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col0 decl" id="200session" title='session' data-type='SSL_SESSION *' data-ref="200session" data-ref-filename="200session">session</dfn>)) {</td></tr>
<tr><th id="1248">1248</th><td>  <a class="local col7 ref" href="#197ctx" title='ctx' data-ref="197ctx" data-ref-filename="197ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::new_session_cb" title='ssl_ctx_st::new_session_cb' data-ref="ssl_ctx_st::new_session_cb" data-ref-filename="ssl_ctx_st..new_session_cb">new_session_cb</a> = <a class="local col8 ref" href="#198cb" title='cb' data-ref="198cb" data-ref-filename="198cb">cb</a>;</td></tr>
<tr><th id="1249">1249</th><td>}</td></tr>
<tr><th id="1250">1250</th><td></td></tr>
<tr><th id="1251">1251</th><td><em>int</em> (*<dfn class="decl def fn" id="SSL_CTX_sess_get_new_cb" title='SSL_CTX_sess_get_new_cb' data-ref="SSL_CTX_sess_get_new_cb" data-ref-filename="SSL_CTX_sess_get_new_cb">SSL_CTX_sess_get_new_cb</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col3 decl" id="203ctx" title='ctx' data-type='SSL_CTX *' data-ref="203ctx" data-ref-filename="203ctx">ctx</dfn>))(<a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<dfn class="local col1 decl" id="201ssl" title='ssl' data-type='SSL *' data-ref="201ssl" data-ref-filename="201ssl">ssl</dfn>, <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col2 decl" id="202session" title='session' data-type='SSL_SESSION *' data-ref="202session" data-ref-filename="202session">session</dfn>) {</td></tr>
<tr><th id="1252">1252</th><td>  <b>return</b> <a class="local col3 ref" href="#203ctx" title='ctx' data-ref="203ctx" data-ref-filename="203ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::new_session_cb" title='ssl_ctx_st::new_session_cb' data-ref="ssl_ctx_st::new_session_cb" data-ref-filename="ssl_ctx_st..new_session_cb">new_session_cb</a>;</td></tr>
<tr><th id="1253">1253</th><td>}</td></tr>
<tr><th id="1254">1254</th><td></td></tr>
<tr><th id="1255">1255</th><td><em>void</em> <dfn class="decl def fn" id="SSL_CTX_sess_set_remove_cb" title='SSL_CTX_sess_set_remove_cb' data-ref="SSL_CTX_sess_set_remove_cb" data-ref-filename="SSL_CTX_sess_set_remove_cb">SSL_CTX_sess_set_remove_cb</dfn>(</td></tr>
<tr><th id="1256">1256</th><td>    <a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col4 decl" id="204ctx" title='ctx' data-type='SSL_CTX *' data-ref="204ctx" data-ref-filename="204ctx">ctx</dfn>, <em>void</em> (*<dfn class="local col5 decl" id="205cb" title='cb' data-type='void (*)(SSL_CTX *, SSL_SESSION *)' data-ref="205cb" data-ref-filename="205cb">cb</dfn>)(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col6 decl" id="206ctx" title='ctx' data-type='SSL_CTX *' data-ref="206ctx" data-ref-filename="206ctx">ctx</dfn>, <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col7 decl" id="207session" title='session' data-type='SSL_SESSION *' data-ref="207session" data-ref-filename="207session">session</dfn>)) {</td></tr>
<tr><th id="1257">1257</th><td>  <a class="local col4 ref" href="#204ctx" title='ctx' data-ref="204ctx" data-ref-filename="204ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::remove_session_cb" title='ssl_ctx_st::remove_session_cb' data-ref="ssl_ctx_st::remove_session_cb" data-ref-filename="ssl_ctx_st..remove_session_cb">remove_session_cb</a> = <a class="local col5 ref" href="#205cb" title='cb' data-ref="205cb" data-ref-filename="205cb">cb</a>;</td></tr>
<tr><th id="1258">1258</th><td>}</td></tr>
<tr><th id="1259">1259</th><td></td></tr>
<tr><th id="1260">1260</th><td><em>void</em> (*<dfn class="decl def fn" id="SSL_CTX_sess_get_remove_cb" title='SSL_CTX_sess_get_remove_cb' data-ref="SSL_CTX_sess_get_remove_cb" data-ref-filename="SSL_CTX_sess_get_remove_cb">SSL_CTX_sess_get_remove_cb</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col0 decl" id="210ctx" title='ctx' data-type='SSL_CTX *' data-ref="210ctx" data-ref-filename="210ctx">ctx</dfn>))(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col8 decl" id="208ctx" title='ctx' data-type='SSL_CTX *' data-ref="208ctx" data-ref-filename="208ctx">ctx</dfn>,</td></tr>
<tr><th id="1261">1261</th><td>                                                 <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *<dfn class="local col9 decl" id="209session" title='session' data-type='SSL_SESSION *' data-ref="209session" data-ref-filename="209session">session</dfn>) {</td></tr>
<tr><th id="1262">1262</th><td>  <b>return</b> <a class="local col0 ref" href="#210ctx" title='ctx' data-ref="210ctx" data-ref-filename="210ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::remove_session_cb" title='ssl_ctx_st::remove_session_cb' data-ref="ssl_ctx_st::remove_session_cb" data-ref-filename="ssl_ctx_st..remove_session_cb">remove_session_cb</a>;</td></tr>
<tr><th id="1263">1263</th><td>}</td></tr>
<tr><th id="1264">1264</th><td></td></tr>
<tr><th id="1265">1265</th><td><em>void</em> <dfn class="decl def fn" id="SSL_CTX_sess_set_get_cb" title='SSL_CTX_sess_set_get_cb' data-ref="SSL_CTX_sess_set_get_cb" data-ref-filename="SSL_CTX_sess_set_get_cb">SSL_CTX_sess_set_get_cb</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col1 decl" id="211ctx" title='ctx' data-type='SSL_CTX *' data-ref="211ctx" data-ref-filename="211ctx">ctx</dfn>,</td></tr>
<tr><th id="1266">1266</th><td>                             <a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *(*<dfn class="local col2 decl" id="212cb" title='cb' data-type='SSL_SESSION *(*)(SSL *, const uint8_t *, int, int *)' data-ref="212cb" data-ref-filename="212cb">cb</dfn>)(<a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<dfn class="local col3 decl" id="213ssl" title='ssl' data-type='SSL *' data-ref="213ssl" data-ref-filename="213ssl">ssl</dfn>, <em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> *<dfn class="local col4 decl" id="214id" title='id' data-type='const uint8_t *' data-ref="214id" data-ref-filename="214id">id</dfn>,</td></tr>
<tr><th id="1267">1267</th><td>                                                <em>int</em> <dfn class="local col5 decl" id="215id_len" title='id_len' data-type='int' data-ref="215id_len" data-ref-filename="215id_len">id_len</dfn>, <em>int</em> *<dfn class="local col6 decl" id="216out_copy" title='out_copy' data-type='int *' data-ref="216out_copy" data-ref-filename="216out_copy">out_copy</dfn>)) {</td></tr>
<tr><th id="1268">1268</th><td>  <a class="local col1 ref" href="#211ctx" title='ctx' data-ref="211ctx" data-ref-filename="211ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::get_session_cb" title='ssl_ctx_st::get_session_cb' data-ref="ssl_ctx_st::get_session_cb" data-ref-filename="ssl_ctx_st..get_session_cb">get_session_cb</a> = <a class="local col2 ref" href="#212cb" title='cb' data-ref="212cb" data-ref-filename="212cb">cb</a>;</td></tr>
<tr><th id="1269">1269</th><td>}</td></tr>
<tr><th id="1270">1270</th><td></td></tr>
<tr><th id="1271">1271</th><td><a class="typedef" href="../include/openssl/base.h.html#SSL_SESSION" title='SSL_SESSION' data-type='struct ssl_session_st' data-ref="SSL_SESSION" data-ref-filename="SSL_SESSION">SSL_SESSION</a> *(*<dfn class="decl def fn" id="SSL_CTX_sess_get_get_cb" title='SSL_CTX_sess_get_get_cb' data-ref="SSL_CTX_sess_get_get_cb" data-ref-filename="SSL_CTX_sess_get_get_cb">SSL_CTX_sess_get_get_cb</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col1 decl" id="221ctx" title='ctx' data-type='SSL_CTX *' data-ref="221ctx" data-ref-filename="221ctx">ctx</dfn>))(<a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<dfn class="local col7 decl" id="217ssl" title='ssl' data-type='SSL *' data-ref="217ssl" data-ref-filename="217ssl">ssl</dfn>,</td></tr>
<tr><th id="1272">1272</th><td>                                                      <em>const</em> <span class='typedef' title='uint8_t' data-type='unsigned char' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</span> *<dfn class="local col8 decl" id="218id" title='id' data-type='const uint8_t *' data-ref="218id" data-ref-filename="218id">id</dfn>,</td></tr>
<tr><th id="1273">1273</th><td>                                                      <em>int</em> <dfn class="local col9 decl" id="219id_len" title='id_len' data-type='int' data-ref="219id_len" data-ref-filename="219id_len">id_len</dfn>,</td></tr>
<tr><th id="1274">1274</th><td>                                                      <em>int</em> *<dfn class="local col0 decl" id="220out_copy" title='out_copy' data-type='int *' data-ref="220out_copy" data-ref-filename="220out_copy">out_copy</dfn>) {</td></tr>
<tr><th id="1275">1275</th><td>  <b>return</b> <a class="local col1 ref" href="#221ctx" title='ctx' data-ref="221ctx" data-ref-filename="221ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::get_session_cb" title='ssl_ctx_st::get_session_cb' data-ref="ssl_ctx_st::get_session_cb" data-ref-filename="ssl_ctx_st..get_session_cb">get_session_cb</a>;</td></tr>
<tr><th id="1276">1276</th><td>}</td></tr>
<tr><th id="1277">1277</th><td></td></tr>
<tr><th id="1278">1278</th><td><em>void</em> <dfn class="decl def fn" id="SSL_CTX_set_info_callback" title='SSL_CTX_set_info_callback' data-ref="SSL_CTX_set_info_callback" data-ref-filename="SSL_CTX_set_info_callback">SSL_CTX_set_info_callback</dfn>(</td></tr>
<tr><th id="1279">1279</th><td>    <a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col2 decl" id="222ctx" title='ctx' data-type='SSL_CTX *' data-ref="222ctx" data-ref-filename="222ctx">ctx</dfn>, <em>void</em> (*<dfn class="local col3 decl" id="223cb" title='cb' data-type='void (*)(const SSL *, int, int)' data-ref="223cb" data-ref-filename="223cb">cb</dfn>)(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<dfn class="local col4 decl" id="224ssl" title='ssl' data-type='const SSL *' data-ref="224ssl" data-ref-filename="224ssl">ssl</dfn>, <em>int</em> <dfn class="local col5 decl" id="225type" title='type' data-type='int' data-ref="225type" data-ref-filename="225type">type</dfn>, <em>int</em> <dfn class="local col6 decl" id="226value" title='value' data-type='int' data-ref="226value" data-ref-filename="226value">value</dfn>)) {</td></tr>
<tr><th id="1280">1280</th><td>  <a class="local col2 ref" href="#222ctx" title='ctx' data-ref="222ctx" data-ref-filename="222ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::info_callback" title='ssl_ctx_st::info_callback' data-ref="ssl_ctx_st::info_callback" data-ref-filename="ssl_ctx_st..info_callback">info_callback</a> = <a class="local col3 ref" href="#223cb" title='cb' data-ref="223cb" data-ref-filename="223cb">cb</a>;</td></tr>
<tr><th id="1281">1281</th><td>}</td></tr>
<tr><th id="1282">1282</th><td></td></tr>
<tr><th id="1283">1283</th><td><em>void</em> (*<dfn class="decl def fn" id="SSL_CTX_get_info_callback" title='SSL_CTX_get_info_callback' data-ref="SSL_CTX_get_info_callback" data-ref-filename="SSL_CTX_get_info_callback">SSL_CTX_get_info_callback</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col0 decl" id="230ctx" title='ctx' data-type='SSL_CTX *' data-ref="230ctx" data-ref-filename="230ctx">ctx</dfn>))(<em>const</em> <a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<dfn class="local col7 decl" id="227ssl" title='ssl' data-type='const SSL *' data-ref="227ssl" data-ref-filename="227ssl">ssl</dfn>, <em>int</em> <dfn class="local col8 decl" id="228type" title='type' data-type='int' data-ref="228type" data-ref-filename="228type">type</dfn>,</td></tr>
<tr><th id="1284">1284</th><td>                                                <em>int</em> <dfn class="local col9 decl" id="229value" title='value' data-type='int' data-ref="229value" data-ref-filename="229value">value</dfn>) {</td></tr>
<tr><th id="1285">1285</th><td>  <b>return</b> <a class="local col0 ref" href="#230ctx" title='ctx' data-ref="230ctx" data-ref-filename="230ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::info_callback" title='ssl_ctx_st::info_callback' data-ref="ssl_ctx_st::info_callback" data-ref-filename="ssl_ctx_st..info_callback">info_callback</a>;</td></tr>
<tr><th id="1286">1286</th><td>}</td></tr>
<tr><th id="1287">1287</th><td></td></tr>
<tr><th id="1288">1288</th><td><em>void</em> <dfn class="decl def fn" id="SSL_CTX_set_channel_id_cb" title='SSL_CTX_set_channel_id_cb' data-ref="SSL_CTX_set_channel_id_cb" data-ref-filename="SSL_CTX_set_channel_id_cb">SSL_CTX_set_channel_id_cb</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col1 decl" id="231ctx" title='ctx' data-type='SSL_CTX *' data-ref="231ctx" data-ref-filename="231ctx">ctx</dfn>,</td></tr>
<tr><th id="1289">1289</th><td>                               <em>void</em> (*<dfn class="local col2 decl" id="232cb" title='cb' data-type='void (*)(SSL *, EVP_PKEY **)' data-ref="232cb" data-ref-filename="232cb">cb</dfn>)(<a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<dfn class="local col3 decl" id="233ssl" title='ssl' data-type='SSL *' data-ref="233ssl" data-ref-filename="233ssl">ssl</dfn>, <a class="typedef" href="../include/openssl/base.h.html#EVP_PKEY" title='EVP_PKEY' data-type='struct evp_pkey_st' data-ref="EVP_PKEY" data-ref-filename="EVP_PKEY">EVP_PKEY</a> **<dfn class="local col4 decl" id="234pkey" title='pkey' data-type='EVP_PKEY **' data-ref="234pkey" data-ref-filename="234pkey">pkey</dfn>)) {</td></tr>
<tr><th id="1290">1290</th><td>  <a class="local col1 ref" href="#231ctx" title='ctx' data-ref="231ctx" data-ref-filename="231ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::channel_id_cb" title='ssl_ctx_st::channel_id_cb' data-ref="ssl_ctx_st::channel_id_cb" data-ref-filename="ssl_ctx_st..channel_id_cb">channel_id_cb</a> = <a class="local col2 ref" href="#232cb" title='cb' data-ref="232cb" data-ref-filename="232cb">cb</a>;</td></tr>
<tr><th id="1291">1291</th><td>}</td></tr>
<tr><th id="1292">1292</th><td></td></tr>
<tr><th id="1293">1293</th><td><em>void</em> (*<dfn class="decl def fn" id="SSL_CTX_get_channel_id_cb" title='SSL_CTX_get_channel_id_cb' data-ref="SSL_CTX_get_channel_id_cb" data-ref-filename="SSL_CTX_get_channel_id_cb">SSL_CTX_get_channel_id_cb</dfn>(<a class="typedef" href="../include/openssl/base.h.html#SSL_CTX" title='SSL_CTX' data-type='struct ssl_ctx_st' data-ref="SSL_CTX" data-ref-filename="SSL_CTX">SSL_CTX</a> *<dfn class="local col7 decl" id="237ctx" title='ctx' data-type='SSL_CTX *' data-ref="237ctx" data-ref-filename="237ctx">ctx</dfn>))(<a class="typedef" href="../include/openssl/base.h.html#SSL" title='SSL' data-type='struct ssl_st' data-ref="SSL" data-ref-filename="SSL">SSL</a> *<dfn class="local col5 decl" id="235ssl" title='ssl' data-type='SSL *' data-ref="235ssl" data-ref-filename="235ssl">ssl</dfn>, <a class="typedef" href="../include/openssl/base.h.html#EVP_PKEY" title='EVP_PKEY' data-type='struct evp_pkey_st' data-ref="EVP_PKEY" data-ref-filename="EVP_PKEY">EVP_PKEY</a> **<dfn class="local col6 decl" id="236pkey" title='pkey' data-type='EVP_PKEY **' data-ref="236pkey" data-ref-filename="236pkey">pkey</dfn>) {</td></tr>
<tr><th id="1294">1294</th><td>  <b>return</b> <a class="local col7 ref" href="#237ctx" title='ctx' data-ref="237ctx" data-ref-filename="237ctx">ctx</a>-&gt;<a class="ref field" href="internal.h.html#ssl_ctx_st::channel_id_cb" title='ssl_ctx_st::channel_id_cb' data-ref="ssl_ctx_st::channel_id_cb" data-ref-filename="ssl_ctx_st..channel_id_cb">channel_id_cb</a>;</td></tr>
<tr><th id="1295">1295</th><td>}</td></tr>
<tr><th id="1296">1296</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2021-Jul-06</em> from project webkit<br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
