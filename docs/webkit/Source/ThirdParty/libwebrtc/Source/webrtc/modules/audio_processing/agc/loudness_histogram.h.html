<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>loudness_histogram.h source code [webkit/Source/ThirdParty/libwebrtc/Source/webrtc/modules/audio_processing/agc/loudness_histogram.h] - Woboq Code Browser</title>
<meta name="woboq:interestingDefinitions" content="webrtc::LoudnessHistogram "/>
<link rel="stylesheet" href="../../../../../../../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../../../../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../../../../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../../../../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'webkit/Source/ThirdParty/libwebrtc/Source/webrtc/modules/audio_processing/agc/loudness_histogram.h'; var root_path = '../../../../../../../../..'; var data_path = '../../../../../../../../../../data'; var ecma_script_api_version = 2;</script>
<script src='../../../../../../../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../../../../../..'>webkit</a>/<a href='../../../../../../..'>Source</a>/<a href='../../../../../..'>ThirdParty</a>/<a href='../../../../..'>libwebrtc</a>/<a href='../../../..'>Source</a>/<a href='../../..'>webrtc</a>/<a href='../..'>modules</a>/<a href='..'>audio_processing</a>/<a href='./'>agc</a>/<a href='loudness_histogram.h.html'>loudness_histogram.h</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> *  Copyright (c) 2012 The WebRTC project authors. All Rights Reserved.</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> *  Use of this source code is governed by a BSD-style license</i></td></tr>
<tr><th id="5">5</th><td><i> *  that can be found in the LICENSE file in the root of the source</i></td></tr>
<tr><th id="6">6</th><td><i> *  tree. An additional intellectual property rights grant can be found</i></td></tr>
<tr><th id="7">7</th><td><i> *  in the file PATENTS.  All contributing project authors may</i></td></tr>
<tr><th id="8">8</th><td><i> *  be found in the AUTHORS file in the root of the source tree.</i></td></tr>
<tr><th id="9">9</th><td><i> */</i></td></tr>
<tr><th id="10">10</th><td></td></tr>
<tr><th id="11">11</th><td><u>#<span data-ppcond="11">ifndef</span> <span class="macro" data-ref="_M/MODULES_AUDIO_PROCESSING_AGC_LOUDNESS_HISTOGRAM_H_">MODULES_AUDIO_PROCESSING_AGC_LOUDNESS_HISTOGRAM_H_</span></u></td></tr>
<tr><th id="12">12</th><td><u>#define <dfn class="macro" id="_M/MODULES_AUDIO_PROCESSING_AGC_LOUDNESS_HISTOGRAM_H_" data-ref="_M/MODULES_AUDIO_PROCESSING_AGC_LOUDNESS_HISTOGRAM_H_">MODULES_AUDIO_PROCESSING_AGC_LOUDNESS_HISTOGRAM_H_</dfn></u></td></tr>
<tr><th id="13">13</th><td></td></tr>
<tr><th id="14">14</th><td><u>#include &lt;stdint.h&gt;</u></td></tr>
<tr><th id="15">15</th><td></td></tr>
<tr><th id="16">16</th><td><u>#include &lt;memory&gt;</u></td></tr>
<tr><th id="17">17</th><td></td></tr>
<tr><th id="18">18</th><td><b>namespace</b> <span class="namespace">webrtc</span> {</td></tr>
<tr><th id="19">19</th><td></td></tr>
<tr><th id="20">20</th><td><i>// This class implements the histogram of loudness with circular buffers so that</i></td></tr>
<tr><th id="21">21</th><td><i>// the histogram tracks the last T seconds of the loudness.</i></td></tr>
<tr><th id="22">22</th><td><b>class</b> <dfn class="type def" id="webrtc::LoudnessHistogram" title='webrtc::LoudnessHistogram' data-ref="webrtc::LoudnessHistogram" data-ref-filename="webrtc..LoudnessHistogram">LoudnessHistogram</dfn> {</td></tr>
<tr><th id="23">23</th><td> <b>public</b>:</td></tr>
<tr><th id="24">24</th><td>  <i>// Create a non-sliding LoudnessHistogram.</i></td></tr>
<tr><th id="25">25</th><td>  <em>static</em> <a class="type" href="#webrtc::LoudnessHistogram" title='webrtc::LoudnessHistogram' data-ref="webrtc::LoudnessHistogram" data-ref-filename="webrtc..LoudnessHistogram">LoudnessHistogram</a>* <dfn class="decl fn" id="_ZN6webrtc17LoudnessHistogram6CreateEv" title='webrtc::LoudnessHistogram::Create' data-ref="_ZN6webrtc17LoudnessHistogram6CreateEv" data-ref-filename="_ZN6webrtc17LoudnessHistogram6CreateEv">Create</dfn>();</td></tr>
<tr><th id="26">26</th><td></td></tr>
<tr><th id="27">27</th><td>  <i>// Create a sliding LoudnessHistogram, i.e. the histogram represents the last</i></td></tr>
<tr><th id="28">28</th><td><i>  // |window_size| samples.</i></td></tr>
<tr><th id="29">29</th><td>  <em>static</em> <a class="type" href="#webrtc::LoudnessHistogram" title='webrtc::LoudnessHistogram' data-ref="webrtc::LoudnessHistogram" data-ref-filename="webrtc..LoudnessHistogram">LoudnessHistogram</a>* <dfn class="decl fn" id="_ZN6webrtc17LoudnessHistogram6CreateEi" title='webrtc::LoudnessHistogram::Create' data-ref="_ZN6webrtc17LoudnessHistogram6CreateEi" data-ref-filename="_ZN6webrtc17LoudnessHistogram6CreateEi">Create</dfn>(<em>int</em> <dfn class="local col5 decl" id="35window_size" title='window_size' data-type='int' data-ref="35window_size" data-ref-filename="35window_size">window_size</dfn>);</td></tr>
<tr><th id="30">30</th><td>  <dfn class="decl fn" id="_ZN6webrtc17LoudnessHistogramD1Ev" title='webrtc::LoudnessHistogram::~LoudnessHistogram' data-ref="_ZN6webrtc17LoudnessHistogramD1Ev" data-ref-filename="_ZN6webrtc17LoudnessHistogramD1Ev">~LoudnessHistogram</dfn>();</td></tr>
<tr><th id="31">31</th><td></td></tr>
<tr><th id="32">32</th><td>  <i>// Insert RMS and the corresponding activity probability.</i></td></tr>
<tr><th id="33">33</th><td>  <em>void</em> <dfn class="decl fn" id="_ZN6webrtc17LoudnessHistogram6UpdateEdd" title='webrtc::LoudnessHistogram::Update' data-ref="_ZN6webrtc17LoudnessHistogram6UpdateEdd" data-ref-filename="_ZN6webrtc17LoudnessHistogram6UpdateEdd">Update</dfn>(<em>double</em> <dfn class="local col6 decl" id="36rms" title='rms' data-type='double' data-ref="36rms" data-ref-filename="36rms">rms</dfn>, <em>double</em> <dfn class="local col7 decl" id="37activity_probability" title='activity_probability' data-type='double' data-ref="37activity_probability" data-ref-filename="37activity_probability">activity_probability</dfn>);</td></tr>
<tr><th id="34">34</th><td></td></tr>
<tr><th id="35">35</th><td>  <i>// Reset the histogram, forget the past.</i></td></tr>
<tr><th id="36">36</th><td>  <em>void</em> <dfn class="decl fn" id="_ZN6webrtc17LoudnessHistogram5ResetEv" title='webrtc::LoudnessHistogram::Reset' data-ref="_ZN6webrtc17LoudnessHistogram5ResetEv" data-ref-filename="_ZN6webrtc17LoudnessHistogram5ResetEv">Reset</dfn>();</td></tr>
<tr><th id="37">37</th><td></td></tr>
<tr><th id="38">38</th><td>  <i>// Current loudness, which is actually the mean of histogram in loudness</i></td></tr>
<tr><th id="39">39</th><td><i>  // domain.</i></td></tr>
<tr><th id="40">40</th><td>  <em>double</em> <dfn class="decl fn" id="_ZNK6webrtc17LoudnessHistogram10CurrentRmsEv" title='webrtc::LoudnessHistogram::CurrentRms' data-ref="_ZNK6webrtc17LoudnessHistogram10CurrentRmsEv" data-ref-filename="_ZNK6webrtc17LoudnessHistogram10CurrentRmsEv">CurrentRms</dfn>() <em>const</em>;</td></tr>
<tr><th id="41">41</th><td></td></tr>
<tr><th id="42">42</th><td>  <i>// Sum of the histogram content.</i></td></tr>
<tr><th id="43">43</th><td>  <em>double</em> <dfn class="decl fn" id="_ZNK6webrtc17LoudnessHistogram12AudioContentEv" title='webrtc::LoudnessHistogram::AudioContent' data-ref="_ZNK6webrtc17LoudnessHistogram12AudioContentEv" data-ref-filename="_ZNK6webrtc17LoudnessHistogram12AudioContentEv">AudioContent</dfn>() <em>const</em>;</td></tr>
<tr><th id="44">44</th><td></td></tr>
<tr><th id="45">45</th><td>  <i>// Number of times the histogram has been updated.</i></td></tr>
<tr><th id="46">46</th><td>  <em>int</em> <dfn class="decl def fn" id="_ZNK6webrtc17LoudnessHistogram11num_updatesEv" title='webrtc::LoudnessHistogram::num_updates' data-ref="_ZNK6webrtc17LoudnessHistogram11num_updatesEv" data-ref-filename="_ZNK6webrtc17LoudnessHistogram11num_updatesEv">num_updates</dfn>() <em>const</em> { <b>return</b> <a class="member field" href="#webrtc::LoudnessHistogram::num_updates_" title='webrtc::LoudnessHistogram::num_updates_' data-ref="webrtc::LoudnessHistogram::num_updates_" data-ref-filename="webrtc..LoudnessHistogram..num_updates_">num_updates_</a>; }</td></tr>
<tr><th id="47">47</th><td></td></tr>
<tr><th id="48">48</th><td> <b>private</b>:</td></tr>
<tr><th id="49">49</th><td>  <dfn class="decl fn" id="_ZN6webrtc17LoudnessHistogramC1Ev" title='webrtc::LoudnessHistogram::LoudnessHistogram' data-ref="_ZN6webrtc17LoudnessHistogramC1Ev" data-ref-filename="_ZN6webrtc17LoudnessHistogramC1Ev">LoudnessHistogram</dfn>();</td></tr>
<tr><th id="50">50</th><td>  <b>explicit</b> <dfn class="decl fn" id="_ZN6webrtc17LoudnessHistogramC1Ei" title='webrtc::LoudnessHistogram::LoudnessHistogram' data-ref="_ZN6webrtc17LoudnessHistogramC1Ei" data-ref-filename="_ZN6webrtc17LoudnessHistogramC1Ei">LoudnessHistogram</dfn>(<em>int</em> <dfn class="local col8 decl" id="38window" title='window' data-type='int' data-ref="38window" data-ref-filename="38window">window</dfn>);</td></tr>
<tr><th id="51">51</th><td></td></tr>
<tr><th id="52">52</th><td>  <i>// Find the histogram bin associated with the given |rms|.</i></td></tr>
<tr><th id="53">53</th><td>  <em>int</em> <dfn class="decl fn" id="_ZN6webrtc17LoudnessHistogram11GetBinIndexEd" title='webrtc::LoudnessHistogram::GetBinIndex' data-ref="_ZN6webrtc17LoudnessHistogram11GetBinIndexEd" data-ref-filename="_ZN6webrtc17LoudnessHistogram11GetBinIndexEd">GetBinIndex</dfn>(<em>double</em> <dfn class="local col9 decl" id="39rms" title='rms' data-type='double' data-ref="39rms" data-ref-filename="39rms">rms</dfn>);</td></tr>
<tr><th id="54">54</th><td></td></tr>
<tr><th id="55">55</th><td>  <em>void</em> <dfn class="decl fn" id="_ZN6webrtc17LoudnessHistogram26RemoveOldestEntryAndUpdateEv" title='webrtc::LoudnessHistogram::RemoveOldestEntryAndUpdate' data-ref="_ZN6webrtc17LoudnessHistogram26RemoveOldestEntryAndUpdateEv" data-ref-filename="_ZN6webrtc17LoudnessHistogram26RemoveOldestEntryAndUpdateEv">RemoveOldestEntryAndUpdate</dfn>();</td></tr>
<tr><th id="56">56</th><td>  <em>void</em> <dfn class="decl fn" id="_ZN6webrtc17LoudnessHistogram26InsertNewestEntryAndUpdateEii" title='webrtc::LoudnessHistogram::InsertNewestEntryAndUpdate' data-ref="_ZN6webrtc17LoudnessHistogram26InsertNewestEntryAndUpdateEii" data-ref-filename="_ZN6webrtc17LoudnessHistogram26InsertNewestEntryAndUpdateEii">InsertNewestEntryAndUpdate</dfn>(<em>int</em> <dfn class="local col0 decl" id="40activity_prob_q10" title='activity_prob_q10' data-type='int' data-ref="40activity_prob_q10" data-ref-filename="40activity_prob_q10">activity_prob_q10</dfn>, <em>int</em> <dfn class="local col1 decl" id="41hist_index" title='hist_index' data-type='int' data-ref="41hist_index" data-ref-filename="41hist_index">hist_index</dfn>);</td></tr>
<tr><th id="57">57</th><td>  <em>void</em> <dfn class="decl fn" id="_ZN6webrtc17LoudnessHistogram10UpdateHistEii" title='webrtc::LoudnessHistogram::UpdateHist' data-ref="_ZN6webrtc17LoudnessHistogram10UpdateHistEii" data-ref-filename="_ZN6webrtc17LoudnessHistogram10UpdateHistEii">UpdateHist</dfn>(<em>int</em> <dfn class="local col2 decl" id="42activity_prob_q10" title='activity_prob_q10' data-type='int' data-ref="42activity_prob_q10" data-ref-filename="42activity_prob_q10">activity_prob_q10</dfn>, <em>int</em> <dfn class="local col3 decl" id="43hist_index" title='hist_index' data-type='int' data-ref="43hist_index" data-ref-filename="43hist_index">hist_index</dfn>);</td></tr>
<tr><th id="58">58</th><td>  <em>void</em> <dfn class="decl fn" id="_ZN6webrtc17LoudnessHistogram15RemoveTransientEv" title='webrtc::LoudnessHistogram::RemoveTransient' data-ref="_ZN6webrtc17LoudnessHistogram15RemoveTransientEv" data-ref-filename="_ZN6webrtc17LoudnessHistogram15RemoveTransientEv">RemoveTransient</dfn>();</td></tr>
<tr><th id="59">59</th><td></td></tr>
<tr><th id="60">60</th><td>  <i>// Number of histogram bins.</i></td></tr>
<tr><th id="61">61</th><td>  <em>static</em> <em>const</em> <em>int</em> <dfn class="decl" id="webrtc::LoudnessHistogram::kHistSize" title='webrtc::LoudnessHistogram::kHistSize' data-ref="webrtc::LoudnessHistogram::kHistSize" data-ref-filename="webrtc..LoudnessHistogram..kHistSize">kHistSize</dfn> = <var>77</var>;</td></tr>
<tr><th id="62">62</th><td></td></tr>
<tr><th id="63">63</th><td>  <i>// Number of times the histogram is updated</i></td></tr>
<tr><th id="64">64</th><td>  <em>int</em> <dfn class="decl field" id="webrtc::LoudnessHistogram::num_updates_" title='webrtc::LoudnessHistogram::num_updates_' data-ref="webrtc::LoudnessHistogram::num_updates_" data-ref-filename="webrtc..LoudnessHistogram..num_updates_">num_updates_</dfn>;</td></tr>
<tr><th id="65">65</th><td>  <i>// Audio content, this should be equal to the sum of the components of</i></td></tr>
<tr><th id="66">66</th><td><i>  // |bin_count_q10_|.</i></td></tr>
<tr><th id="67">67</th><td>  <span class='typedef' title='int64_t' data-type='long long' data-ref="int64_t" data-ref-filename="int64_t">int64_t</span> <dfn class="decl field" id="webrtc::LoudnessHistogram::audio_content_q10_" title='webrtc::LoudnessHistogram::audio_content_q10_' data-ref="webrtc::LoudnessHistogram::audio_content_q10_" data-ref-filename="webrtc..LoudnessHistogram..audio_content_q10_">audio_content_q10_</dfn>;</td></tr>
<tr><th id="68">68</th><td></td></tr>
<tr><th id="69">69</th><td>  <i>// LoudnessHistogram of input RMS in Q10 with |kHistSize_| bins. In each</i></td></tr>
<tr><th id="70">70</th><td><i>  // 'Update(),' we increment the associated histogram-bin with the given</i></td></tr>
<tr><th id="71">71</th><td><i>  // probability. The increment is implemented in Q10 to avoid rounding errors.</i></td></tr>
<tr><th id="72">72</th><td>  <span class='typedef' title='int64_t' data-type='long long' data-ref="int64_t" data-ref-filename="int64_t">int64_t</span> <dfn class="decl field" id="webrtc::LoudnessHistogram::bin_count_q10_" title='webrtc::LoudnessHistogram::bin_count_q10_' data-ref="webrtc::LoudnessHistogram::bin_count_q10_" data-ref-filename="webrtc..LoudnessHistogram..bin_count_q10_">bin_count_q10_</dfn>[<a class="ref" href="#webrtc::LoudnessHistogram::kHistSize" title='webrtc::LoudnessHistogram::kHistSize' data-ref="webrtc::LoudnessHistogram::kHistSize" data-ref-filename="webrtc..LoudnessHistogram..kHistSize">kHistSize</a>];</td></tr>
<tr><th id="73">73</th><td></td></tr>
<tr><th id="74">74</th><td>  <i>// Circular buffer for probabilities</i></td></tr>
<tr><th id="75">75</th><td>  <span class="namespace">std::</span><span class='type' title='std::__1::unique_ptr' data-ref="std::__1::unique_ptr" data-ref-filename="std..__1..unique_ptr">unique_ptr</span>&lt;<em>int</em>[]&gt; <dfn class="decl field" id="webrtc::LoudnessHistogram::activity_probability_" title='webrtc::LoudnessHistogram::activity_probability_' data-ref="webrtc::LoudnessHistogram::activity_probability_" data-ref-filename="webrtc..LoudnessHistogram..activity_probability_">activity_probability_</dfn>;</td></tr>
<tr><th id="76">76</th><td>  <i>// Circular buffer for histogram-indices of probabilities.</i></td></tr>
<tr><th id="77">77</th><td>  <span class="namespace">std::</span><span class='type' title='std::__1::unique_ptr' data-ref="std::__1::unique_ptr" data-ref-filename="std..__1..unique_ptr">unique_ptr</span>&lt;<em>int</em>[]&gt; <dfn class="decl field" id="webrtc::LoudnessHistogram::hist_bin_index_" title='webrtc::LoudnessHistogram::hist_bin_index_' data-ref="webrtc::LoudnessHistogram::hist_bin_index_" data-ref-filename="webrtc..LoudnessHistogram..hist_bin_index_">hist_bin_index_</dfn>;</td></tr>
<tr><th id="78">78</th><td>  <i>// Current index of circular buffer, where the newest data will be written to,</i></td></tr>
<tr><th id="79">79</th><td><i>  // therefore, pointing to the oldest data if buffer is full.</i></td></tr>
<tr><th id="80">80</th><td>  <em>int</em> <dfn class="decl field" id="webrtc::LoudnessHistogram::buffer_index_" title='webrtc::LoudnessHistogram::buffer_index_' data-ref="webrtc::LoudnessHistogram::buffer_index_" data-ref-filename="webrtc..LoudnessHistogram..buffer_index_">buffer_index_</dfn>;</td></tr>
<tr><th id="81">81</th><td>  <i>// Indicating if buffer is full and we had a wrap around.</i></td></tr>
<tr><th id="82">82</th><td>  <em>int</em> <dfn class="decl field" id="webrtc::LoudnessHistogram::buffer_is_full_" title='webrtc::LoudnessHistogram::buffer_is_full_' data-ref="webrtc::LoudnessHistogram::buffer_is_full_" data-ref-filename="webrtc..LoudnessHistogram..buffer_is_full_">buffer_is_full_</dfn>;</td></tr>
<tr><th id="83">83</th><td>  <i>// Size of circular buffer.</i></td></tr>
<tr><th id="84">84</th><td>  <em>int</em> <dfn class="decl field" id="webrtc::LoudnessHistogram::len_circular_buffer_" title='webrtc::LoudnessHistogram::len_circular_buffer_' data-ref="webrtc::LoudnessHistogram::len_circular_buffer_" data-ref-filename="webrtc..LoudnessHistogram..len_circular_buffer_">len_circular_buffer_</dfn>;</td></tr>
<tr><th id="85">85</th><td>  <em>int</em> <dfn class="decl field" id="webrtc::LoudnessHistogram::len_high_activity_" title='webrtc::LoudnessHistogram::len_high_activity_' data-ref="webrtc::LoudnessHistogram::len_high_activity_" data-ref-filename="webrtc..LoudnessHistogram..len_high_activity_">len_high_activity_</dfn>;</td></tr>
<tr><th id="86">86</th><td>};</td></tr>
<tr><th id="87">87</th><td></td></tr>
<tr><th id="88">88</th><td>}  <i>// namespace webrtc</i></td></tr>
<tr><th id="89">89</th><td></td></tr>
<tr><th id="90">90</th><td><u>#<span data-ppcond="11">endif</span>  // MODULES_AUDIO_PROCESSING_AGC_LOUDNESS_HISTOGRAM_H_</u></td></tr>
<tr><th id="91">91</th><td></td></tr>
</table><hr/><p id='footer'>
Generated while processing <a href='agc.cc.html'>webkit/Source/ThirdParty/libwebrtc/Source/webrtc/modules/audio_processing/agc/agc.cc</a><br/>Generated on <em>2021-Jul-06</em> from project webkit<br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
