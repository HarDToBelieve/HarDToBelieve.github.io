<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>swap_queue.h source code [webkit/Source/ThirdParty/libwebrtc/Source/webrtc/rtc_base/swap_queue.h] - Woboq Code Browser</title>
<meta name="woboq:interestingDefinitions" content="webrtc::SwapQueue,webrtc::SwapQueueItemVerifier "/>
<link rel="stylesheet" href="../../../../../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'webkit/Source/ThirdParty/libwebrtc/Source/webrtc/rtc_base/swap_queue.h'; var root_path = '../../../../../../..'; var data_path = '../../../../../../../../data'; var ecma_script_api_version = 2;</script>
<script src='../../../../../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../../../..'>webkit</a>/<a href='../../../../..'>Source</a>/<a href='../../../..'>ThirdParty</a>/<a href='../../..'>libwebrtc</a>/<a href='../..'>Source</a>/<a href='..'>webrtc</a>/<a href='./'>rtc_base</a>/<a href='swap_queue.h.html'>swap_queue.h</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> *  Copyright (c) 2015 The WebRTC project authors. All Rights Reserved.</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> *  Use of this source code is governed by a BSD-style license</i></td></tr>
<tr><th id="5">5</th><td><i> *  that can be found in the LICENSE file in the root of the source</i></td></tr>
<tr><th id="6">6</th><td><i> *  tree. An additional intellectual property rights grant can be found</i></td></tr>
<tr><th id="7">7</th><td><i> *  in the file PATENTS.  All contributing project authors may</i></td></tr>
<tr><th id="8">8</th><td><i> *  be found in the AUTHORS file in the root of the source tree.</i></td></tr>
<tr><th id="9">9</th><td><i> */</i></td></tr>
<tr><th id="10">10</th><td></td></tr>
<tr><th id="11">11</th><td><u>#<span data-ppcond="11">ifndef</span> <span class="macro" data-ref="_M/RTC_BASE_SWAP_QUEUE_H_">RTC_BASE_SWAP_QUEUE_H_</span></u></td></tr>
<tr><th id="12">12</th><td><u>#define <dfn class="macro" id="_M/RTC_BASE_SWAP_QUEUE_H_" data-ref="_M/RTC_BASE_SWAP_QUEUE_H_">RTC_BASE_SWAP_QUEUE_H_</dfn></u></td></tr>
<tr><th id="13">13</th><td></td></tr>
<tr><th id="14">14</th><td><u>#include &lt;stddef.h&gt;</u></td></tr>
<tr><th id="15">15</th><td></td></tr>
<tr><th id="16">16</th><td><u>#include &lt;atomic&gt;</u></td></tr>
<tr><th id="17">17</th><td><u>#include &lt;utility&gt;</u></td></tr>
<tr><th id="18">18</th><td><u>#include &lt;vector&gt;</u></td></tr>
<tr><th id="19">19</th><td></td></tr>
<tr><th id="20">20</th><td><u>#include <a href="../../third_party/abseil-cpp/absl/base/attributes.h.html">"absl/base/attributes.h"</a></u></td></tr>
<tr><th id="21">21</th><td><u>#include <a href="checks.h.html">"rtc_base/checks.h"</a></u></td></tr>
<tr><th id="22">22</th><td></td></tr>
<tr><th id="23">23</th><td><b>namespace</b> <span class="namespace">webrtc</span> {</td></tr>
<tr><th id="24">24</th><td></td></tr>
<tr><th id="25">25</th><td><b>namespace</b> <span class="namespace">internal</span> {</td></tr>
<tr><th id="26">26</th><td></td></tr>
<tr><th id="27">27</th><td><i>// (Internal; please don't use outside this file.)</i></td></tr>
<tr><th id="28">28</th><td><b>template</b> &lt;<b>typename</b> T&gt;</td></tr>
<tr><th id="29">29</th><td><em>bool</em> <dfn class="decl def fn" id="_ZN6webrtc8internal33NoopSwapQueueItemVerifierFunctionERKT_" title='webrtc::internal::NoopSwapQueueItemVerifierFunction' data-ref="_ZN6webrtc8internal33NoopSwapQueueItemVerifierFunctionERKT_" data-ref-filename="_ZN6webrtc8internal33NoopSwapQueueItemVerifierFunctionERKT_">NoopSwapQueueItemVerifierFunction</dfn>(<em>const</em> T&amp;) {</td></tr>
<tr><th id="30">30</th><td>  <b>return</b> <b>true</b>;</td></tr>
<tr><th id="31">31</th><td>}</td></tr>
<tr><th id="32">32</th><td></td></tr>
<tr><th id="33">33</th><td>}  <i>// namespace internal</i></td></tr>
<tr><th id="34">34</th><td></td></tr>
<tr><th id="35">35</th><td><i>// Functor to use when supplying a verifier function for the queue.</i></td></tr>
<tr><th id="36">36</th><td><b>template</b> &lt;<b>typename</b> T,</td></tr>
<tr><th id="37">37</th><td>          <em>bool</em> (*QueueItemVerifierFunction)(<em>const</em> T&amp;) =</td></tr>
<tr><th id="38">38</th><td>              <span class="namespace">internal::</span>NoopSwapQueueItemVerifierFunction&gt;</td></tr>
<tr><th id="39">39</th><td><b>class</b> <dfn class="type def" id="webrtc::SwapQueueItemVerifier" title='webrtc::SwapQueueItemVerifier' data-ref="webrtc::SwapQueueItemVerifier" data-ref-filename="webrtc..SwapQueueItemVerifier">SwapQueueItemVerifier</dfn> {</td></tr>
<tr><th id="40">40</th><td> <b>public</b>:</td></tr>
<tr><th id="41">41</th><td>  <em>bool</em> <dfn class="decl def fn" id="_ZNK6webrtc21SwapQueueItemVerifierclERKT_" title='webrtc::SwapQueueItemVerifier::operator()' data-ref="_ZNK6webrtc21SwapQueueItemVerifierclERKT_" data-ref-filename="_ZNK6webrtc21SwapQueueItemVerifierclERKT_"><b>operator</b>()</dfn>(<em>const</em> T&amp; <dfn class="local col2 decl" id="512t" title='t' data-type='const T &amp;' data-ref="512t" data-ref-filename="512t">t</dfn>) <em>const</em> { <b>return</b> <a class="tu member" href="#webrtc::SwapQueueItemVerifier::QueueItemVerifierFunction" title='webrtc::SwapQueueItemVerifier::QueueItemVerifierFunction' data-use='c' data-ref="webrtc::SwapQueueItemVerifier::QueueItemVerifierFunction" data-ref-filename="webrtc..SwapQueueItemVerifier..QueueItemVerifierFunction">QueueItemVerifierFunction</a>(<a class="local col2 ref" href="#512t" title='t' data-ref="512t" data-ref-filename="512t">t</a>); }</td></tr>
<tr><th id="42">42</th><td>};</td></tr>
<tr><th id="43">43</th><td></td></tr>
<tr><th id="44">44</th><td><i>// This class is a fixed-size queue. A single producer calls Insert() to insert</i></td></tr>
<tr><th id="45">45</th><td><i>// an element of type T at the back of the queue, and a single consumer calls</i></td></tr>
<tr><th id="46">46</th><td><i>// Remove() to remove an element from the front of the queue. It's safe for the</i></td></tr>
<tr><th id="47">47</th><td><i>// producer and the consumer to access the queue concurrently, from different</i></td></tr>
<tr><th id="48">48</th><td><i>// threads.</i></td></tr>
<tr><th id="49">49</th><td><i>//</i></td></tr>
<tr><th id="50">50</th><td><i>// To avoid the construction, copying, and destruction of Ts that a naive</i></td></tr>
<tr><th id="51">51</th><td><i>// queue implementation would require, for each "full" T passed from</i></td></tr>
<tr><th id="52">52</th><td><i>// producer to consumer, SwapQueue&lt;T&gt; passes an "empty" T in the other</i></td></tr>
<tr><th id="53">53</th><td><i>// direction (an "empty" T is one that contains nothing of value for the</i></td></tr>
<tr><th id="54">54</th><td><i>// consumer). This bidirectional movement is implemented with swap().</i></td></tr>
<tr><th id="55">55</th><td><i>//</i></td></tr>
<tr><th id="56">56</th><td><i>// // Create queue:</i></td></tr>
<tr><th id="57">57</th><td><i>// Bottle proto(568);  // Prepare an empty Bottle. Heap allocates space for</i></td></tr>
<tr><th id="58">58</th><td><i>//                     // 568 ml.</i></td></tr>
<tr><th id="59">59</th><td><i>// SwapQueue&lt;Bottle&gt; q(N, proto);  // Init queue with N copies of proto.</i></td></tr>
<tr><th id="60">60</th><td><i>//                                 // Each copy allocates on the heap.</i></td></tr>
<tr><th id="61">61</th><td><i>// // Producer pseudo-code:</i></td></tr>
<tr><th id="62">62</th><td><i>// Bottle b(568); // Prepare an empty Bottle. Heap allocates space for 568 ml.</i></td></tr>
<tr><th id="63">63</th><td><i>// loop {</i></td></tr>
<tr><th id="64">64</th><td><i>//   b.Fill(amount);  // Where amount &lt;= 568 ml.</i></td></tr>
<tr><th id="65">65</th><td><i>//   q.Insert(&amp;b);    // Swap our full Bottle for an empty one from q.</i></td></tr>
<tr><th id="66">66</th><td><i>// }</i></td></tr>
<tr><th id="67">67</th><td><i>//</i></td></tr>
<tr><th id="68">68</th><td><i>// // Consumer pseudo-code:</i></td></tr>
<tr><th id="69">69</th><td><i>// Bottle b(568);  // Prepare an empty Bottle. Heap allocates space for 568 ml.</i></td></tr>
<tr><th id="70">70</th><td><i>// loop {</i></td></tr>
<tr><th id="71">71</th><td><i>//   q.Remove(&amp;b); // Swap our empty Bottle for the next-in-line full Bottle.</i></td></tr>
<tr><th id="72">72</th><td><i>//   Drink(&amp;b);</i></td></tr>
<tr><th id="73">73</th><td><i>// }</i></td></tr>
<tr><th id="74">74</th><td><i>//</i></td></tr>
<tr><th id="75">75</th><td><i>// For a well-behaved Bottle class, there are no allocations in the</i></td></tr>
<tr><th id="76">76</th><td><i>// producer, since it just fills an empty Bottle that's already large</i></td></tr>
<tr><th id="77">77</th><td><i>// enough; no deallocations in the consumer, since it returns each empty</i></td></tr>
<tr><th id="78">78</th><td><i>// Bottle to the queue after having drunk it; and no copies along the</i></td></tr>
<tr><th id="79">79</th><td><i>// way, since the queue uses swap() everywhere to move full Bottles in</i></td></tr>
<tr><th id="80">80</th><td><i>// one direction and empty ones in the other.</i></td></tr>
<tr><th id="81">81</th><td><b>template</b> &lt;<b>typename</b> T, <b>typename</b> QueueItemVerifier = <a class="type" href="#webrtc::SwapQueueItemVerifier" title='webrtc::SwapQueueItemVerifier' data-ref="webrtc::SwapQueueItemVerifier" data-ref-filename="webrtc..SwapQueueItemVerifier">SwapQueueItemVerifier</a>&lt;T&gt;&gt;</td></tr>
<tr><th id="82">82</th><td><b>class</b> <dfn class="type def" id="webrtc::SwapQueue" title='webrtc::SwapQueue' data-ref="webrtc::SwapQueue" data-ref-filename="webrtc..SwapQueue">SwapQueue</dfn> {</td></tr>
<tr><th id="83">83</th><td> <b>public</b>:</td></tr>
<tr><th id="84">84</th><td>  <i>// Creates a queue of size size and fills it with default constructed Ts.</i></td></tr>
<tr><th id="85">85</th><td>  <b>explicit</b> <dfn class="decl def fn" id="_ZN6webrtc9SwapQueueC1Em" title='webrtc::SwapQueue::SwapQueue&lt;T, QueueItemVerifier&gt;' data-ref="_ZN6webrtc9SwapQueueC1Em" data-ref-filename="_ZN6webrtc9SwapQueueC1Em">SwapQueue</dfn>(<span class='typedef' title='size_t' data-type='__darwin_size_t' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col3 decl" id="513size" title='size' data-type='size_t' data-ref="513size" data-ref-filename="513size">size</dfn>) : <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>(<a class="local col3 ref" href="#513size" title='size' data-ref="513size" data-ref-filename="513size">size</a>) {</td></tr>
<tr><th id="86">86</th><td>    <a class="macro" href="checks.h.html#429" title="(VerifyQueueSlots()) ? static_cast&lt;void&gt;(0) : ::rtc::webrtc_checks_impl::FatalLogCall&lt;false&gt;( &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/webrtc/rtc_base/swap_queue.h&quot;, 86, &quot;VerifyQueueSlots()&quot;) &amp; ::rtc::webrtc_checks_impl::LogStreamer&lt;&gt;()" data-ref="_M/RTC_DCHECK">RTC_DCHECK</a>(<a class="member fn" href="#_ZN6webrtc9SwapQueue16VerifyQueueSlotsEv" title='webrtc::SwapQueue::VerifyQueueSlots' data-ref="_ZN6webrtc9SwapQueue16VerifyQueueSlotsEv" data-ref-filename="_ZN6webrtc9SwapQueue16VerifyQueueSlotsEv">VerifyQueueSlots</a>());</td></tr>
<tr><th id="87">87</th><td>  }</td></tr>
<tr><th id="88">88</th><td></td></tr>
<tr><th id="89">89</th><td>  <i>// Same as above and accepts an item verification functor.</i></td></tr>
<tr><th id="90">90</th><td>  <dfn class="decl def fn" id="_ZN6webrtc9SwapQueueC1EmRKT0_" title='webrtc::SwapQueue::SwapQueue&lt;T, QueueItemVerifier&gt;' data-ref="_ZN6webrtc9SwapQueueC1EmRKT0_" data-ref-filename="_ZN6webrtc9SwapQueueC1EmRKT0_">SwapQueue</dfn>(<span class='typedef' title='size_t' data-type='__darwin_size_t' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col4 decl" id="514size" title='size' data-type='size_t' data-ref="514size" data-ref-filename="514size">size</dfn>, <em>const</em> QueueItemVerifier&amp; <dfn class="local col5 decl" id="515queue_item_verifier" title='queue_item_verifier' data-type='const QueueItemVerifier &amp;' data-ref="515queue_item_verifier" data-ref-filename="515queue_item_verifier">queue_item_verifier</dfn>)</td></tr>
<tr><th id="91">91</th><td>      : <a class="member field" href="#webrtc::SwapQueue::queue_item_verifier_" title='webrtc::SwapQueue::queue_item_verifier_' data-ref="webrtc::SwapQueue::queue_item_verifier_" data-ref-filename="webrtc..SwapQueue..queue_item_verifier_">queue_item_verifier_</a>(<a class="local col5 ref" href="#515queue_item_verifier" title='queue_item_verifier' data-ref="515queue_item_verifier" data-ref-filename="515queue_item_verifier">queue_item_verifier</a>), <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>(<a class="local col4 ref" href="#514size" title='size' data-ref="514size" data-ref-filename="514size">size</a>) {</td></tr>
<tr><th id="92">92</th><td>    <a class="macro" href="checks.h.html#429" title="(VerifyQueueSlots()) ? static_cast&lt;void&gt;(0) : ::rtc::webrtc_checks_impl::FatalLogCall&lt;false&gt;( &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/webrtc/rtc_base/swap_queue.h&quot;, 92, &quot;VerifyQueueSlots()&quot;) &amp; ::rtc::webrtc_checks_impl::LogStreamer&lt;&gt;()" data-ref="_M/RTC_DCHECK">RTC_DCHECK</a>(<a class="member fn" href="#_ZN6webrtc9SwapQueue16VerifyQueueSlotsEv" title='webrtc::SwapQueue::VerifyQueueSlots' data-ref="_ZN6webrtc9SwapQueue16VerifyQueueSlotsEv" data-ref-filename="_ZN6webrtc9SwapQueue16VerifyQueueSlotsEv">VerifyQueueSlots</a>());</td></tr>
<tr><th id="93">93</th><td>  }</td></tr>
<tr><th id="94">94</th><td></td></tr>
<tr><th id="95">95</th><td>  <i>// Creates a queue of size size and fills it with copies of prototype.</i></td></tr>
<tr><th id="96">96</th><td>  <dfn class="decl def fn" id="_ZN6webrtc9SwapQueueC1EmRKT_" title='webrtc::SwapQueue::SwapQueue&lt;T, QueueItemVerifier&gt;' data-ref="_ZN6webrtc9SwapQueueC1EmRKT_" data-ref-filename="_ZN6webrtc9SwapQueueC1EmRKT_">SwapQueue</dfn>(<span class='typedef' title='size_t' data-type='__darwin_size_t' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col6 decl" id="516size" title='size' data-type='size_t' data-ref="516size" data-ref-filename="516size">size</dfn>, <em>const</em> T&amp; <dfn class="local col7 decl" id="517prototype" title='prototype' data-type='const T &amp;' data-ref="517prototype" data-ref-filename="517prototype">prototype</dfn>) : <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>(<a class="local col6 ref" href="#516size" title='size' data-ref="516size" data-ref-filename="516size">size</a>, <a class="local col7 ref" href="#517prototype" title='prototype' data-ref="517prototype" data-ref-filename="517prototype">prototype</a>) {</td></tr>
<tr><th id="97">97</th><td>    <a class="macro" href="checks.h.html#429" title="(VerifyQueueSlots()) ? static_cast&lt;void&gt;(0) : ::rtc::webrtc_checks_impl::FatalLogCall&lt;false&gt;( &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/webrtc/rtc_base/swap_queue.h&quot;, 97, &quot;VerifyQueueSlots()&quot;) &amp; ::rtc::webrtc_checks_impl::LogStreamer&lt;&gt;()" data-ref="_M/RTC_DCHECK">RTC_DCHECK</a>(<a class="member fn" href="#_ZN6webrtc9SwapQueue16VerifyQueueSlotsEv" title='webrtc::SwapQueue::VerifyQueueSlots' data-ref="_ZN6webrtc9SwapQueue16VerifyQueueSlotsEv" data-ref-filename="_ZN6webrtc9SwapQueue16VerifyQueueSlotsEv">VerifyQueueSlots</a>());</td></tr>
<tr><th id="98">98</th><td>  }</td></tr>
<tr><th id="99">99</th><td></td></tr>
<tr><th id="100">100</th><td>  <i>// Same as above and accepts an item verification functor.</i></td></tr>
<tr><th id="101">101</th><td>  <dfn class="decl def fn" id="_ZN6webrtc9SwapQueueC1EmRKT_RKT0_" title='webrtc::SwapQueue::SwapQueue&lt;T, QueueItemVerifier&gt;' data-ref="_ZN6webrtc9SwapQueueC1EmRKT_RKT0_" data-ref-filename="_ZN6webrtc9SwapQueueC1EmRKT_RKT0_">SwapQueue</dfn>(<span class='typedef' title='size_t' data-type='__darwin_size_t' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col8 decl" id="518size" title='size' data-type='size_t' data-ref="518size" data-ref-filename="518size">size</dfn>,</td></tr>
<tr><th id="102">102</th><td>            <em>const</em> T&amp; <dfn class="local col9 decl" id="519prototype" title='prototype' data-type='const T &amp;' data-ref="519prototype" data-ref-filename="519prototype">prototype</dfn>,</td></tr>
<tr><th id="103">103</th><td>            <em>const</em> QueueItemVerifier&amp; <dfn class="local col0 decl" id="520queue_item_verifier" title='queue_item_verifier' data-type='const QueueItemVerifier &amp;' data-ref="520queue_item_verifier" data-ref-filename="520queue_item_verifier">queue_item_verifier</dfn>)</td></tr>
<tr><th id="104">104</th><td>      : <a class="member field" href="#webrtc::SwapQueue::queue_item_verifier_" title='webrtc::SwapQueue::queue_item_verifier_' data-ref="webrtc::SwapQueue::queue_item_verifier_" data-ref-filename="webrtc..SwapQueue..queue_item_verifier_">queue_item_verifier_</a>(<a class="local col0 ref" href="#520queue_item_verifier" title='queue_item_verifier' data-ref="520queue_item_verifier" data-ref-filename="520queue_item_verifier">queue_item_verifier</a>), <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>(<a class="local col8 ref" href="#518size" title='size' data-ref="518size" data-ref-filename="518size">size</a>, <a class="local col9 ref" href="#519prototype" title='prototype' data-ref="519prototype" data-ref-filename="519prototype">prototype</a>) {</td></tr>
<tr><th id="105">105</th><td>    <a class="macro" href="checks.h.html#429" title="(VerifyQueueSlots()) ? static_cast&lt;void&gt;(0) : ::rtc::webrtc_checks_impl::FatalLogCall&lt;false&gt;( &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/webrtc/rtc_base/swap_queue.h&quot;, 105, &quot;VerifyQueueSlots()&quot;) &amp; ::rtc::webrtc_checks_impl::LogStreamer&lt;&gt;()" data-ref="_M/RTC_DCHECK">RTC_DCHECK</a>(<a class="member fn" href="#_ZN6webrtc9SwapQueue16VerifyQueueSlotsEv" title='webrtc::SwapQueue::VerifyQueueSlots' data-ref="_ZN6webrtc9SwapQueue16VerifyQueueSlotsEv" data-ref-filename="_ZN6webrtc9SwapQueue16VerifyQueueSlotsEv">VerifyQueueSlots</a>());</td></tr>
<tr><th id="106">106</th><td>  }</td></tr>
<tr><th id="107">107</th><td></td></tr>
<tr><th id="108">108</th><td>  <i>// Resets the queue to have zero content while maintaining the queue size.</i></td></tr>
<tr><th id="109">109</th><td><i>  // Just like Remove(), this can only be called (safely) from the</i></td></tr>
<tr><th id="110">110</th><td><i>  // consumer.</i></td></tr>
<tr><th id="111">111</th><td>  <em>void</em> <dfn class="decl def fn" id="_ZN6webrtc9SwapQueue5ClearEv" title='webrtc::SwapQueue::Clear' data-ref="_ZN6webrtc9SwapQueue5ClearEv" data-ref-filename="_ZN6webrtc9SwapQueue5ClearEv">Clear</dfn>() {</td></tr>
<tr><th id="112">112</th><td>    <i>// Drop all non-empty elements by resetting num_elements_ and incrementing</i></td></tr>
<tr><th id="113">113</th><td><i>    // next_read_index_ by the previous value of num_elements_. Relaxed memory</i></td></tr>
<tr><th id="114">114</th><td><i>    // ordering is sufficient since the dropped elements are not accessed.</i></td></tr>
<tr><th id="115">115</th><td>    <a class="member field" href="#webrtc::SwapQueue::next_read_index_" title='webrtc::SwapQueue::next_read_index_' data-ref="webrtc::SwapQueue::next_read_index_" data-ref-filename="webrtc..SwapQueue..next_read_index_">next_read_index_</a> += <span class="namespace">std::</span><span class='ref fn' title='std::__1::atomic_exchange_explicit' data-ref="_ZNSt3__1L24atomic_exchange_explicitEPNS_6atomicIT_EES1_NS_12memory_orderE" data-ref-filename="_ZNSt3__1L24atomic_exchange_explicitEPNS_6atomicIT_EES1_NS_12memory_orderE">atomic_exchange_explicit</span>(</td></tr>
<tr><th id="116">116</th><td>        &amp;<a class="member field" href="#webrtc::SwapQueue::num_elements_" title='webrtc::SwapQueue::num_elements_' data-ref="webrtc::SwapQueue::num_elements_" data-ref-filename="webrtc..SwapQueue..num_elements_">num_elements_</a>, <span class='typedef' title='size_t' data-type='__darwin_size_t' data-ref="size_t" data-ref-filename="size_t">size_t</span>{<var>0</var>}, <span class="namespace">std::</span><span class='enum' title='std::__1::memory_order_relaxed' data-ref="std::__1::memory_order_relaxed" data-ref-filename="std..__1..memory_order_relaxed">memory_order_relaxed</span>);</td></tr>
<tr><th id="117">117</th><td>    <b>if</b> (<a class="member field" href="#webrtc::SwapQueue::next_read_index_" title='webrtc::SwapQueue::next_read_index_' data-ref="webrtc::SwapQueue::next_read_index_" data-ref-filename="webrtc..SwapQueue..next_read_index_">next_read_index_</a> &gt;= <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>.size()) {</td></tr>
<tr><th id="118">118</th><td>      <a class="member field" href="#webrtc::SwapQueue::next_read_index_" title='webrtc::SwapQueue::next_read_index_' data-ref="webrtc::SwapQueue::next_read_index_" data-ref-filename="webrtc..SwapQueue..next_read_index_">next_read_index_</a> -= <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>.size();</td></tr>
<tr><th id="119">119</th><td>    }</td></tr>
<tr><th id="120">120</th><td></td></tr>
<tr><th id="121">121</th><td>    <a class="macro" href="checks.h.html#433" title="::rtc::SafeLt((next_read_index_), (queue_.size())) ? static_cast&lt;void&gt;(0) : ::rtc::webrtc_checks_impl::FatalLogCall&lt;true&gt;( &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/webrtc/rtc_base/swap_queue.h&quot;, 121, &quot;next_read_index_&quot; &quot; &quot; &quot;&lt;&quot; &quot; &quot; &quot;queue_.size()&quot;) &amp; ::rtc::webrtc_checks_impl::LogStreamer&lt;&gt;() &lt;&lt; (next_read_index_) &lt;&lt; (queue_.size())" data-ref="_M/RTC_DCHECK_LT">RTC_DCHECK_LT</a>(<a class="member field" href="#webrtc::SwapQueue::next_read_index_" title='webrtc::SwapQueue::next_read_index_' data-ref="webrtc::SwapQueue::next_read_index_" data-ref-filename="webrtc..SwapQueue..next_read_index_">next_read_index_</a>, <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>.size());</td></tr>
<tr><th id="122">122</th><td>  }</td></tr>
<tr><th id="123">123</th><td></td></tr>
<tr><th id="124">124</th><td>  <i>// Inserts a "full" T at the back of the queue by swapping *input with an</i></td></tr>
<tr><th id="125">125</th><td><i>  // "empty" T from the queue.</i></td></tr>
<tr><th id="126">126</th><td><i>  // Returns true if the item was inserted or false if not (the queue was full).</i></td></tr>
<tr><th id="127">127</th><td><i>  // When specified, the T given in *input must pass the ItemVerifier() test.</i></td></tr>
<tr><th id="128">128</th><td><i>  // The contents of *input after the call are then also guaranteed to pass the</i></td></tr>
<tr><th id="129">129</th><td><i>  // ItemVerifier() test.</i></td></tr>
<tr><th id="130">130</th><td>  <a class="macro" href="../../third_party/abseil-cpp/absl/base/attributes.h.html#424" title="__attribute__((warn_unused_result))" data-ref="_M/ABSL_MUST_USE_RESULT">ABSL_MUST_USE_RESULT</a> <em>bool</em> <dfn class="decl def fn" id="_ZN6webrtc9SwapQueue6InsertEPT_" title='webrtc::SwapQueue::Insert' data-ref="_ZN6webrtc9SwapQueue6InsertEPT_" data-ref-filename="_ZN6webrtc9SwapQueue6InsertEPT_">Insert</dfn>(T* <dfn class="local col1 decl" id="521input" title='input' data-type='T *' data-ref="521input" data-ref-filename="521input">input</dfn>) {</td></tr>
<tr><th id="131">131</th><td>    <a class="macro" href="checks.h.html#429" title="(input) ? static_cast&lt;void&gt;(0) : ::rtc::webrtc_checks_impl::FatalLogCall&lt;false&gt;( &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/webrtc/rtc_base/swap_queue.h&quot;, 131, &quot;input&quot;) &amp; ::rtc::webrtc_checks_impl::LogStreamer&lt;&gt;()" data-ref="_M/RTC_DCHECK">RTC_DCHECK</a>(<a class="local col1 ref" href="#521input" title='input' data-ref="521input" data-ref-filename="521input">input</a>);</td></tr>
<tr><th id="132">132</th><td></td></tr>
<tr><th id="133">133</th><td>    <a class="macro" href="checks.h.html#429" title="(queue_item_verifier_(*input)) ? static_cast&lt;void&gt;(0) : ::rtc::webrtc_checks_impl::FatalLogCall&lt;false&gt;( &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/webrtc/rtc_base/swap_queue.h&quot;, 133, &quot;queue_item_verifier_(*input)&quot;) &amp; ::rtc::webrtc_checks_impl::LogStreamer&lt;&gt;()" data-ref="_M/RTC_DCHECK">RTC_DCHECK</a>(<a class="member field" href="#webrtc::SwapQueue::queue_item_verifier_" title='webrtc::SwapQueue::queue_item_verifier_' data-ref="webrtc::SwapQueue::queue_item_verifier_" data-ref-filename="webrtc..SwapQueue..queue_item_verifier_">queue_item_verifier_</a>(*<a class="local col1 ref" href="#521input" title='input' data-ref="521input" data-ref-filename="521input">input</a>));</td></tr>
<tr><th id="134">134</th><td></td></tr>
<tr><th id="135">135</th><td>    <i>// Load the value of num_elements_. Acquire memory ordering prevents reads</i></td></tr>
<tr><th id="136">136</th><td><i>    // and writes to queue_[next_write_index_] to be reordered to before the</i></td></tr>
<tr><th id="137">137</th><td><i>    // load. (That element might be accessed by a concurrent call to Remove()</i></td></tr>
<tr><th id="138">138</th><td><i>    // until the load finishes.)</i></td></tr>
<tr><th id="139">139</th><td>    <b>if</b> (<span class="namespace">std::</span><span class='ref fn' title='std::__1::atomic_load_explicit' data-ref="_ZNSt3__1L20atomic_load_explicitEPKNS_6atomicIT_EENS_12memory_orderE" data-ref-filename="_ZNSt3__1L20atomic_load_explicitEPKNS_6atomicIT_EENS_12memory_orderE">atomic_load_explicit</span>(&amp;<a class="member field" href="#webrtc::SwapQueue::num_elements_" title='webrtc::SwapQueue::num_elements_' data-ref="webrtc::SwapQueue::num_elements_" data-ref-filename="webrtc..SwapQueue..num_elements_">num_elements_</a>, <span class="namespace">std::</span><span class='enum' title='std::__1::memory_order_acquire' data-ref="std::__1::memory_order_acquire" data-ref-filename="std..__1..memory_order_acquire">memory_order_acquire</span>) ==</td></tr>
<tr><th id="140">140</th><td>        <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>.size()) {</td></tr>
<tr><th id="141">141</th><td>      <b>return</b> <b>false</b>;</td></tr>
<tr><th id="142">142</th><td>    }</td></tr>
<tr><th id="143">143</th><td></td></tr>
<tr><th id="144">144</th><td>    <b>using</b> <span class="namespace">std::</span>swap;</td></tr>
<tr><th id="145">145</th><td>    swap(*<a class="local col1 ref" href="#521input" title='input' data-ref="521input" data-ref-filename="521input">input</a>, <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>[<a class="member field" href="#webrtc::SwapQueue::next_write_index_" title='webrtc::SwapQueue::next_write_index_' data-ref="webrtc::SwapQueue::next_write_index_" data-ref-filename="webrtc..SwapQueue..next_write_index_">next_write_index_</a>]);</td></tr>
<tr><th id="146">146</th><td></td></tr>
<tr><th id="147">147</th><td>    <i>// Increment the value of num_elements_ to account for the inserted element.</i></td></tr>
<tr><th id="148">148</th><td><i>    // Release memory ordering prevents the reads and writes to</i></td></tr>
<tr><th id="149">149</th><td><i>    // queue_[next_write_index_] to be reordered to after the increment. (Once</i></td></tr>
<tr><th id="150">150</th><td><i>    // the increment has finished, Remove() might start accessing that element.)</i></td></tr>
<tr><th id="151">151</th><td>    <em>const</em> <span class='typedef' title='size_t' data-type='__darwin_size_t' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col2 decl" id="522old_num_elements" title='old_num_elements' data-type='const size_t' data-ref="522old_num_elements" data-ref-filename="522old_num_elements">old_num_elements</dfn> = <span class="namespace">std::</span><span class='ref fn' title='std::__1::atomic_fetch_add_explicit' data-ref="_ZNSt3__1L25atomic_fetch_add_explicitEPNS_6atomicIT_EES1_NS_12memory_orderE" data-ref-filename="_ZNSt3__1L25atomic_fetch_add_explicitEPNS_6atomicIT_EES1_NS_12memory_orderE">atomic_fetch_add_explicit</span>(</td></tr>
<tr><th id="152">152</th><td>        &amp;<a class="member field" href="#webrtc::SwapQueue::num_elements_" title='webrtc::SwapQueue::num_elements_' data-ref="webrtc::SwapQueue::num_elements_" data-ref-filename="webrtc..SwapQueue..num_elements_">num_elements_</a>, <span class='typedef' title='size_t' data-type='__darwin_size_t' data-ref="size_t" data-ref-filename="size_t">size_t</span>{<var>1</var>}, <span class="namespace">std::</span><span class='enum' title='std::__1::memory_order_release' data-ref="std::__1::memory_order_release" data-ref-filename="std..__1..memory_order_release">memory_order_release</span>);</td></tr>
<tr><th id="153">153</th><td></td></tr>
<tr><th id="154">154</th><td>    ++<a class="member field" href="#webrtc::SwapQueue::next_write_index_" title='webrtc::SwapQueue::next_write_index_' data-ref="webrtc::SwapQueue::next_write_index_" data-ref-filename="webrtc..SwapQueue..next_write_index_">next_write_index_</a>;</td></tr>
<tr><th id="155">155</th><td>    <b>if</b> (<a class="member field" href="#webrtc::SwapQueue::next_write_index_" title='webrtc::SwapQueue::next_write_index_' data-ref="webrtc::SwapQueue::next_write_index_" data-ref-filename="webrtc..SwapQueue..next_write_index_">next_write_index_</a> == <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>.size()) {</td></tr>
<tr><th id="156">156</th><td>      <a class="member field" href="#webrtc::SwapQueue::next_write_index_" title='webrtc::SwapQueue::next_write_index_' data-ref="webrtc::SwapQueue::next_write_index_" data-ref-filename="webrtc..SwapQueue..next_write_index_">next_write_index_</a> = <var>0</var>;</td></tr>
<tr><th id="157">157</th><td>    }</td></tr>
<tr><th id="158">158</th><td></td></tr>
<tr><th id="159">159</th><td>    <a class="macro" href="checks.h.html#433" title="::rtc::SafeLt((next_write_index_), (queue_.size())) ? static_cast&lt;void&gt;(0) : ::rtc::webrtc_checks_impl::FatalLogCall&lt;true&gt;( &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/webrtc/rtc_base/swap_queue.h&quot;, 159, &quot;next_write_index_&quot; &quot; &quot; &quot;&lt;&quot; &quot; &quot; &quot;queue_.size()&quot;) &amp; ::rtc::webrtc_checks_impl::LogStreamer&lt;&gt;() &lt;&lt; (next_write_index_) &lt;&lt; (queue_.size())" data-ref="_M/RTC_DCHECK_LT">RTC_DCHECK_LT</a>(<a class="member field" href="#webrtc::SwapQueue::next_write_index_" title='webrtc::SwapQueue::next_write_index_' data-ref="webrtc::SwapQueue::next_write_index_" data-ref-filename="webrtc..SwapQueue..next_write_index_">next_write_index_</a>, <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>.size());</td></tr>
<tr><th id="160">160</th><td>    <a class="macro" href="checks.h.html#433" title="::rtc::SafeLt((old_num_elements), (queue_.size())) ? static_cast&lt;void&gt;(0) : ::rtc::webrtc_checks_impl::FatalLogCall&lt;true&gt;( &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/webrtc/rtc_base/swap_queue.h&quot;, 160, &quot;old_num_elements&quot; &quot; &quot; &quot;&lt;&quot; &quot; &quot; &quot;queue_.size()&quot;) &amp; ::rtc::webrtc_checks_impl::LogStreamer&lt;&gt;() &lt;&lt; (old_num_elements) &lt;&lt; (queue_.size())" data-ref="_M/RTC_DCHECK_LT">RTC_DCHECK_LT</a>(<a class="local col2 ref" href="#522old_num_elements" title='old_num_elements' data-ref="522old_num_elements" data-ref-filename="522old_num_elements">old_num_elements</a>, <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>.size());</td></tr>
<tr><th id="161">161</th><td></td></tr>
<tr><th id="162">162</th><td>    <b>return</b> <b>true</b>;</td></tr>
<tr><th id="163">163</th><td>  }</td></tr>
<tr><th id="164">164</th><td></td></tr>
<tr><th id="165">165</th><td>  <i>// Removes the frontmost "full" T from the queue by swapping it with</i></td></tr>
<tr><th id="166">166</th><td><i>  // the "empty" T in *output.</i></td></tr>
<tr><th id="167">167</th><td><i>  // Returns true if an item could be removed or false if not (the queue was</i></td></tr>
<tr><th id="168">168</th><td><i>  // empty). When specified, The T given in *output must pass the ItemVerifier()</i></td></tr>
<tr><th id="169">169</th><td><i>  // test and the contents of *output after the call are then also guaranteed to</i></td></tr>
<tr><th id="170">170</th><td><i>  // pass the ItemVerifier() test.</i></td></tr>
<tr><th id="171">171</th><td>  <a class="macro" href="../../third_party/abseil-cpp/absl/base/attributes.h.html#424" title="__attribute__((warn_unused_result))" data-ref="_M/ABSL_MUST_USE_RESULT">ABSL_MUST_USE_RESULT</a> <em>bool</em> <dfn class="decl def fn" id="_ZN6webrtc9SwapQueue6RemoveEPT_" title='webrtc::SwapQueue::Remove' data-ref="_ZN6webrtc9SwapQueue6RemoveEPT_" data-ref-filename="_ZN6webrtc9SwapQueue6RemoveEPT_">Remove</dfn>(T* <dfn class="local col3 decl" id="523output" title='output' data-type='T *' data-ref="523output" data-ref-filename="523output">output</dfn>) {</td></tr>
<tr><th id="172">172</th><td>    <a class="macro" href="checks.h.html#429" title="(output) ? static_cast&lt;void&gt;(0) : ::rtc::webrtc_checks_impl::FatalLogCall&lt;false&gt;( &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/webrtc/rtc_base/swap_queue.h&quot;, 172, &quot;output&quot;) &amp; ::rtc::webrtc_checks_impl::LogStreamer&lt;&gt;()" data-ref="_M/RTC_DCHECK">RTC_DCHECK</a>(<a class="local col3 ref" href="#523output" title='output' data-ref="523output" data-ref-filename="523output">output</a>);</td></tr>
<tr><th id="173">173</th><td></td></tr>
<tr><th id="174">174</th><td>    <a class="macro" href="checks.h.html#429" title="(queue_item_verifier_(*output)) ? static_cast&lt;void&gt;(0) : ::rtc::webrtc_checks_impl::FatalLogCall&lt;false&gt;( &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/webrtc/rtc_base/swap_queue.h&quot;, 174, &quot;queue_item_verifier_(*output)&quot;) &amp; ::rtc::webrtc_checks_impl::LogStreamer&lt;&gt;()" data-ref="_M/RTC_DCHECK">RTC_DCHECK</a>(<a class="member field" href="#webrtc::SwapQueue::queue_item_verifier_" title='webrtc::SwapQueue::queue_item_verifier_' data-ref="webrtc::SwapQueue::queue_item_verifier_" data-ref-filename="webrtc..SwapQueue..queue_item_verifier_">queue_item_verifier_</a>(*<a class="local col3 ref" href="#523output" title='output' data-ref="523output" data-ref-filename="523output">output</a>));</td></tr>
<tr><th id="175">175</th><td></td></tr>
<tr><th id="176">176</th><td>    <i>// Load the value of num_elements_. Acquire memory ordering prevents reads</i></td></tr>
<tr><th id="177">177</th><td><i>    // and writes to queue_[next_read_index_] to be reordered to before the</i></td></tr>
<tr><th id="178">178</th><td><i>    // load. (That element might be accessed by a concurrent call to Insert()</i></td></tr>
<tr><th id="179">179</th><td><i>    // until the load finishes.)</i></td></tr>
<tr><th id="180">180</th><td>    <b>if</b> (<span class="namespace">std::</span><span class='ref fn' title='std::__1::atomic_load_explicit' data-ref="_ZNSt3__1L20atomic_load_explicitEPKNS_6atomicIT_EENS_12memory_orderE" data-ref-filename="_ZNSt3__1L20atomic_load_explicitEPKNS_6atomicIT_EENS_12memory_orderE">atomic_load_explicit</span>(&amp;<a class="member field" href="#webrtc::SwapQueue::num_elements_" title='webrtc::SwapQueue::num_elements_' data-ref="webrtc::SwapQueue::num_elements_" data-ref-filename="webrtc..SwapQueue..num_elements_">num_elements_</a>, <span class="namespace">std::</span><span class='enum' title='std::__1::memory_order_acquire' data-ref="std::__1::memory_order_acquire" data-ref-filename="std..__1..memory_order_acquire">memory_order_acquire</span>) ==</td></tr>
<tr><th id="181">181</th><td>        <var>0</var>) {</td></tr>
<tr><th id="182">182</th><td>      <b>return</b> <b>false</b>;</td></tr>
<tr><th id="183">183</th><td>    }</td></tr>
<tr><th id="184">184</th><td></td></tr>
<tr><th id="185">185</th><td>    <b>using</b> <span class="namespace">std::</span>swap;</td></tr>
<tr><th id="186">186</th><td>    swap(*<a class="local col3 ref" href="#523output" title='output' data-ref="523output" data-ref-filename="523output">output</a>, <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>[<a class="member field" href="#webrtc::SwapQueue::next_read_index_" title='webrtc::SwapQueue::next_read_index_' data-ref="webrtc::SwapQueue::next_read_index_" data-ref-filename="webrtc..SwapQueue..next_read_index_">next_read_index_</a>]);</td></tr>
<tr><th id="187">187</th><td></td></tr>
<tr><th id="188">188</th><td>    <i>// Decrement the value of num_elements_ to account for the removed element.</i></td></tr>
<tr><th id="189">189</th><td><i>    // Release memory ordering prevents the reads and writes to</i></td></tr>
<tr><th id="190">190</th><td><i>    // queue_[next_write_index_] to be reordered to after the decrement. (Once</i></td></tr>
<tr><th id="191">191</th><td><i>    // the decrement has finished, Insert() might start accessing that element.)</i></td></tr>
<tr><th id="192">192</th><td>    <span class="namespace">std::</span><span class='ref fn' title='std::__1::atomic_fetch_sub_explicit' data-ref="_ZNSt3__1L25atomic_fetch_sub_explicitEPNS_6atomicIT_EES1_NS_12memory_orderE" data-ref-filename="_ZNSt3__1L25atomic_fetch_sub_explicitEPNS_6atomicIT_EES1_NS_12memory_orderE">atomic_fetch_sub_explicit</span>(&amp;<a class="member field" href="#webrtc::SwapQueue::num_elements_" title='webrtc::SwapQueue::num_elements_' data-ref="webrtc::SwapQueue::num_elements_" data-ref-filename="webrtc..SwapQueue..num_elements_">num_elements_</a>, <span class='typedef' title='size_t' data-type='__darwin_size_t' data-ref="size_t" data-ref-filename="size_t">size_t</span>{<var>1</var>},</td></tr>
<tr><th id="193">193</th><td>                                   <span class="namespace">std::</span><span class='enum' title='std::__1::memory_order_release' data-ref="std::__1::memory_order_release" data-ref-filename="std..__1..memory_order_release">memory_order_release</span>);</td></tr>
<tr><th id="194">194</th><td></td></tr>
<tr><th id="195">195</th><td>    ++<a class="member field" href="#webrtc::SwapQueue::next_read_index_" title='webrtc::SwapQueue::next_read_index_' data-ref="webrtc::SwapQueue::next_read_index_" data-ref-filename="webrtc..SwapQueue..next_read_index_">next_read_index_</a>;</td></tr>
<tr><th id="196">196</th><td>    <b>if</b> (<a class="member field" href="#webrtc::SwapQueue::next_read_index_" title='webrtc::SwapQueue::next_read_index_' data-ref="webrtc::SwapQueue::next_read_index_" data-ref-filename="webrtc..SwapQueue..next_read_index_">next_read_index_</a> == <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>.size()) {</td></tr>
<tr><th id="197">197</th><td>      <a class="member field" href="#webrtc::SwapQueue::next_read_index_" title='webrtc::SwapQueue::next_read_index_' data-ref="webrtc::SwapQueue::next_read_index_" data-ref-filename="webrtc..SwapQueue..next_read_index_">next_read_index_</a> = <var>0</var>;</td></tr>
<tr><th id="198">198</th><td>    }</td></tr>
<tr><th id="199">199</th><td></td></tr>
<tr><th id="200">200</th><td>    <a class="macro" href="checks.h.html#433" title="::rtc::SafeLt((next_read_index_), (queue_.size())) ? static_cast&lt;void&gt;(0) : ::rtc::webrtc_checks_impl::FatalLogCall&lt;true&gt;( &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/webrtc/rtc_base/swap_queue.h&quot;, 200, &quot;next_read_index_&quot; &quot; &quot; &quot;&lt;&quot; &quot; &quot; &quot;queue_.size()&quot;) &amp; ::rtc::webrtc_checks_impl::LogStreamer&lt;&gt;() &lt;&lt; (next_read_index_) &lt;&lt; (queue_.size())" data-ref="_M/RTC_DCHECK_LT">RTC_DCHECK_LT</a>(<a class="member field" href="#webrtc::SwapQueue::next_read_index_" title='webrtc::SwapQueue::next_read_index_' data-ref="webrtc::SwapQueue::next_read_index_" data-ref-filename="webrtc..SwapQueue..next_read_index_">next_read_index_</a>, <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>.size());</td></tr>
<tr><th id="201">201</th><td></td></tr>
<tr><th id="202">202</th><td>    <b>return</b> <b>true</b>;</td></tr>
<tr><th id="203">203</th><td>  }</td></tr>
<tr><th id="204">204</th><td></td></tr>
<tr><th id="205">205</th><td>  <i>// Returns the current number of elements in the queue. Since elements may be</i></td></tr>
<tr><th id="206">206</th><td><i>  // concurrently added to the queue, the caller must treat this as a lower</i></td></tr>
<tr><th id="207">207</th><td><i>  // bound, not an exact count.</i></td></tr>
<tr><th id="208">208</th><td><i>  // May only be called by the consumer.</i></td></tr>
<tr><th id="209">209</th><td>  <span class='typedef' title='size_t' data-type='__darwin_size_t' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="decl def fn" id="_ZNK6webrtc9SwapQueue11SizeAtLeastEv" title='webrtc::SwapQueue::SizeAtLeast' data-ref="_ZNK6webrtc9SwapQueue11SizeAtLeastEv" data-ref-filename="_ZNK6webrtc9SwapQueue11SizeAtLeastEv">SizeAtLeast</dfn>() <em>const</em> {</td></tr>
<tr><th id="210">210</th><td>    <i>// Acquire memory ordering ensures that we wait for the producer to finish</i></td></tr>
<tr><th id="211">211</th><td><i>    // inserting any element in progress.</i></td></tr>
<tr><th id="212">212</th><td>    <b>return</b> <span class="namespace">std::</span><span class='ref fn' title='std::__1::atomic_load_explicit' data-ref="_ZNSt3__1L20atomic_load_explicitEPKNS_6atomicIT_EENS_12memory_orderE" data-ref-filename="_ZNSt3__1L20atomic_load_explicitEPKNS_6atomicIT_EENS_12memory_orderE">atomic_load_explicit</span>(&amp;<a class="member field" href="#webrtc::SwapQueue::num_elements_" title='webrtc::SwapQueue::num_elements_' data-ref="webrtc::SwapQueue::num_elements_" data-ref-filename="webrtc..SwapQueue..num_elements_">num_elements_</a>, <span class="namespace">std::</span><span class='enum' title='std::__1::memory_order_acquire' data-ref="std::__1::memory_order_acquire" data-ref-filename="std..__1..memory_order_acquire">memory_order_acquire</span>);</td></tr>
<tr><th id="213">213</th><td>  }</td></tr>
<tr><th id="214">214</th><td></td></tr>
<tr><th id="215">215</th><td> <b>private</b>:</td></tr>
<tr><th id="216">216</th><td>  <i>// Verify that the queue slots complies with the ItemVerifier test. This</i></td></tr>
<tr><th id="217">217</th><td><i>  // function is not thread-safe and can only be used in the constructors.</i></td></tr>
<tr><th id="218">218</th><td>  <em>bool</em> <dfn class="decl def fn" id="_ZN6webrtc9SwapQueue16VerifyQueueSlotsEv" title='webrtc::SwapQueue::VerifyQueueSlots' data-ref="_ZN6webrtc9SwapQueue16VerifyQueueSlotsEv" data-ref-filename="_ZN6webrtc9SwapQueue16VerifyQueueSlotsEv">VerifyQueueSlots</dfn>() {</td></tr>
<tr><th id="219">219</th><td>    <b>for</b> (<em>const</em> <em>auto</em>&amp; <dfn class="local col4 decl" id="524v" title='v' data-type='const auto &amp;' data-ref="524v" data-ref-filename="524v">v</dfn> : <a class="member field" href="#webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</a>) {</td></tr>
<tr><th id="220">220</th><td>      <a class="macro" href="checks.h.html#429" title="(queue_item_verifier_(v)) ? static_cast&lt;void&gt;(0) : ::rtc::webrtc_checks_impl::FatalLogCall&lt;false&gt;( &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/webrtc/rtc_base/swap_queue.h&quot;, 220, &quot;queue_item_verifier_(v)&quot;) &amp; ::rtc::webrtc_checks_impl::LogStreamer&lt;&gt;()" data-ref="_M/RTC_DCHECK">RTC_DCHECK</a>(<a class="member field" href="#webrtc::SwapQueue::queue_item_verifier_" title='webrtc::SwapQueue::queue_item_verifier_' data-ref="webrtc::SwapQueue::queue_item_verifier_" data-ref-filename="webrtc..SwapQueue..queue_item_verifier_">queue_item_verifier_</a>(<a class="local col4 ref" href="#524v" title='v' data-ref="524v" data-ref-filename="524v">v</a>));</td></tr>
<tr><th id="221">221</th><td>    }</td></tr>
<tr><th id="222">222</th><td>    <b>return</b> <b>true</b>;</td></tr>
<tr><th id="223">223</th><td>  }</td></tr>
<tr><th id="224">224</th><td></td></tr>
<tr><th id="225">225</th><td>  <i>// TODO(peah): Change this to use std::function() once we can use C++11 std</i></td></tr>
<tr><th id="226">226</th><td><i>  // lib.</i></td></tr>
<tr><th id="227">227</th><td>  QueueItemVerifier <dfn class="decl field" id="webrtc::SwapQueue::queue_item_verifier_" title='webrtc::SwapQueue::queue_item_verifier_' data-ref="webrtc::SwapQueue::queue_item_verifier_" data-ref-filename="webrtc..SwapQueue..queue_item_verifier_">queue_item_verifier_</dfn>;</td></tr>
<tr><th id="228">228</th><td></td></tr>
<tr><th id="229">229</th><td>  <i>// Only accessed by the single producer.</i></td></tr>
<tr><th id="230">230</th><td>  <span class='typedef' title='size_t' data-type='__darwin_size_t' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="decl field" id="webrtc::SwapQueue::next_write_index_" title='webrtc::SwapQueue::next_write_index_' data-ref="webrtc::SwapQueue::next_write_index_" data-ref-filename="webrtc..SwapQueue..next_write_index_">next_write_index_</dfn> = <var>0</var>;</td></tr>
<tr><th id="231">231</th><td></td></tr>
<tr><th id="232">232</th><td>  <i>// Only accessed by the single consumer.</i></td></tr>
<tr><th id="233">233</th><td>  <span class='typedef' title='size_t' data-type='__darwin_size_t' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="decl field" id="webrtc::SwapQueue::next_read_index_" title='webrtc::SwapQueue::next_read_index_' data-ref="webrtc::SwapQueue::next_read_index_" data-ref-filename="webrtc..SwapQueue..next_read_index_">next_read_index_</dfn> = <var>0</var>;</td></tr>
<tr><th id="234">234</th><td></td></tr>
<tr><th id="235">235</th><td>  <i>// Accessed by both the producer and the consumer and used for synchronization</i></td></tr>
<tr><th id="236">236</th><td><i>  // between them.</i></td></tr>
<tr><th id="237">237</th><td>  <span class="namespace">std::</span><span class='type' title='std::__1::atomic' data-ref="std::__1::atomic" data-ref-filename="std..__1..atomic">atomic</span>&lt;<span class='typedef' title='size_t' data-type='__darwin_size_t' data-ref="size_t" data-ref-filename="size_t">size_t</span>&gt; <dfn class="decl field" id="webrtc::SwapQueue::num_elements_" title='webrtc::SwapQueue::num_elements_' data-ref="webrtc::SwapQueue::num_elements_" data-ref-filename="webrtc..SwapQueue..num_elements_">num_elements_</dfn><span class='ref fn' title='std::__1::atomic::atomic&lt;_Tp&gt;' data-ref="_ZNSt3__16atomicC1ET_" data-ref-filename="_ZNSt3__16atomicC1ET_">{</span><var>0</var>};</td></tr>
<tr><th id="238">238</th><td></td></tr>
<tr><th id="239">239</th><td>  <i>// The elements of the queue are acced by both the producer and the consumer,</i></td></tr>
<tr><th id="240">240</th><td><i>  // mediated by num_elements_. queue_.size() is constant.</i></td></tr>
<tr><th id="241">241</th><td>  <span class="namespace">std::</span><span class='type' title='std::__1::vector' data-ref="std::__1::vector" data-ref-filename="std..__1..vector">vector</span>&lt;T&gt; <dfn class="decl field" id="webrtc::SwapQueue::queue_" title='webrtc::SwapQueue::queue_' data-ref="webrtc::SwapQueue::queue_" data-ref-filename="webrtc..SwapQueue..queue_">queue_</dfn>;</td></tr>
<tr><th id="242">242</th><td></td></tr>
<tr><th id="243">243</th><td>  <dfn class="decl def fn" id="_ZN6webrtc9SwapQueueC1ERKNS_9SwapQueueIT_T0_EE" title='webrtc::SwapQueue::SwapQueue&lt;T, QueueItemVerifier&gt;' data-ref="_ZN6webrtc9SwapQueueC1ERKNS_9SwapQueueIT_T0_EE" data-ref-filename="_ZN6webrtc9SwapQueueC1ERKNS_9SwapQueueIT_T0_EE">SwapQueue</dfn>(<em>const</em> SwapQueue&amp;) = <b>delete</b>;</td></tr>
<tr><th id="244">244</th><td>  SwapQueue&amp; <dfn class="decl def fn" id="_ZN6webrtc9SwapQueueaSERKNS_9SwapQueueIT_T0_EE" title='webrtc::SwapQueue::operator=' data-ref="_ZN6webrtc9SwapQueueaSERKNS_9SwapQueueIT_T0_EE" data-ref-filename="_ZN6webrtc9SwapQueueaSERKNS_9SwapQueueIT_T0_EE"><b>operator</b>=</dfn>(<em>const</em> SwapQueue&amp;) = <b>delete</b>;</td></tr>
<tr><th id="245">245</th><td>};</td></tr>
<tr><th id="246">246</th><td></td></tr>
<tr><th id="247">247</th><td>}  <i>// namespace webrtc</i></td></tr>
<tr><th id="248">248</th><td></td></tr>
<tr><th id="249">249</th><td><u>#<span data-ppcond="11">endif</span>  // RTC_BASE_SWAP_QUEUE_H_</u></td></tr>
<tr><th id="250">250</th><td></td></tr>
</table><hr/><p id='footer'>
Generated while processing <a href='../api/audio/echo_canceller3_factory.cc.html'>webkit/Source/ThirdParty/libwebrtc/Source/webrtc/api/audio/echo_canceller3_factory.cc</a><br/>Generated on <em>2021-Jul-06</em> from project webkit<br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
