<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>vp9_cost.c source code [webkit/Source/ThirdParty/libwebrtc/Source/third_party/libvpx/source/libvpx/vp9/encoder/vp9_cost.c] - Woboq Code Browser</title>
<link rel="stylesheet" href="../../../../../../../../../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../../../../../../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../../../../../../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../../../../../../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'webkit/Source/ThirdParty/libwebrtc/Source/third_party/libvpx/source/libvpx/vp9/encoder/vp9_cost.c'; var root_path = '../../../../../../../../../../..'; var data_path = '../../../../../../../../../../../../data'; var ecma_script_api_version = 2;</script>
<script src='../../../../../../../../../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../../../../../../../..'>webkit</a>/<a href='../../../../../../../../..'>Source</a>/<a href='../../../../../../../..'>ThirdParty</a>/<a href='../../../../../../..'>libwebrtc</a>/<a href='../../../../../..'>Source</a>/<a href='../../../../..'>third_party</a>/<a href='../../../..'>libvpx</a>/<a href='../../..'>source</a>/<a href='../..'>libvpx</a>/<a href='..'>vp9</a>/<a href='./'>encoder</a>/<a href='vp9_cost.c.html'>vp9_cost.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> *  Copyright (c) 2014 The WebM project authors. All Rights Reserved.</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> *  Use of this source code is governed by a BSD-style license</i></td></tr>
<tr><th id="5">5</th><td><i> *  that can be found in the LICENSE file in the root of the source</i></td></tr>
<tr><th id="6">6</th><td><i> *  tree. An additional intellectual property rights grant can be found</i></td></tr>
<tr><th id="7">7</th><td><i> *  in the file PATENTS.  All contributing project authors may</i></td></tr>
<tr><th id="8">8</th><td><i> *  be found in the AUTHORS file in the root of the source tree.</i></td></tr>
<tr><th id="9">9</th><td><i> */</i></td></tr>
<tr><th id="10">10</th><td><u>#include &lt;assert.h&gt;</u></td></tr>
<tr><th id="11">11</th><td></td></tr>
<tr><th id="12">12</th><td><u>#include <a href="vp9_cost.h.html">"vp9/encoder/vp9_cost.h"</a></u></td></tr>
<tr><th id="13">13</th><td></td></tr>
<tr><th id="14">14</th><td><i>/* round(-log2(i/256.) * (1 &lt;&lt; VP9_PROB_COST_SHIFT))</i></td></tr>
<tr><th id="15">15</th><td><i>   Begins with a bogus entry for simpler addressing. */</i></td></tr>
<tr><th id="16">16</th><td><em>const</em> <span class='typedef' title='uint16_t' data-type='unsigned short' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</span> <dfn class="decl def" id="vp9_prob_cost" title='vp9_prob_cost' data-ref="vp9_prob_cost" data-ref-filename="vp9_prob_cost">vp9_prob_cost</dfn>[<var>256</var>] = {</td></tr>
<tr><th id="17">17</th><td>  <var>4096</var>, <var>4096</var>, <var>3584</var>, <var>3284</var>, <var>3072</var>, <var>2907</var>, <var>2772</var>, <var>2659</var>, <var>2560</var>, <var>2473</var>, <var>2395</var>, <var>2325</var>, <var>2260</var>,</td></tr>
<tr><th id="18">18</th><td>  <var>2201</var>, <var>2147</var>, <var>2096</var>, <var>2048</var>, <var>2003</var>, <var>1961</var>, <var>1921</var>, <var>1883</var>, <var>1847</var>, <var>1813</var>, <var>1780</var>, <var>1748</var>, <var>1718</var>,</td></tr>
<tr><th id="19">19</th><td>  <var>1689</var>, <var>1661</var>, <var>1635</var>, <var>1609</var>, <var>1584</var>, <var>1559</var>, <var>1536</var>, <var>1513</var>, <var>1491</var>, <var>1470</var>, <var>1449</var>, <var>1429</var>, <var>1409</var>,</td></tr>
<tr><th id="20">20</th><td>  <var>1390</var>, <var>1371</var>, <var>1353</var>, <var>1335</var>, <var>1318</var>, <var>1301</var>, <var>1284</var>, <var>1268</var>, <var>1252</var>, <var>1236</var>, <var>1221</var>, <var>1206</var>, <var>1192</var>,</td></tr>
<tr><th id="21">21</th><td>  <var>1177</var>, <var>1163</var>, <var>1149</var>, <var>1136</var>, <var>1123</var>, <var>1110</var>, <var>1097</var>, <var>1084</var>, <var>1072</var>, <var>1059</var>, <var>1047</var>, <var>1036</var>, <var>1024</var>,</td></tr>
<tr><th id="22">22</th><td>  <var>1013</var>, <var>1001</var>, <var>990</var>,  <var>979</var>,  <var>968</var>,  <var>958</var>,  <var>947</var>,  <var>937</var>,  <var>927</var>,  <var>917</var>,  <var>907</var>,  <var>897</var>,  <var>887</var>,</td></tr>
<tr><th id="23">23</th><td>  <var>878</var>,  <var>868</var>,  <var>859</var>,  <var>850</var>,  <var>841</var>,  <var>832</var>,  <var>823</var>,  <var>814</var>,  <var>806</var>,  <var>797</var>,  <var>789</var>,  <var>780</var>,  <var>772</var>,</td></tr>
<tr><th id="24">24</th><td>  <var>764</var>,  <var>756</var>,  <var>748</var>,  <var>740</var>,  <var>732</var>,  <var>724</var>,  <var>717</var>,  <var>709</var>,  <var>702</var>,  <var>694</var>,  <var>687</var>,  <var>680</var>,  <var>673</var>,</td></tr>
<tr><th id="25">25</th><td>  <var>665</var>,  <var>658</var>,  <var>651</var>,  <var>644</var>,  <var>637</var>,  <var>631</var>,  <var>624</var>,  <var>617</var>,  <var>611</var>,  <var>604</var>,  <var>598</var>,  <var>591</var>,  <var>585</var>,</td></tr>
<tr><th id="26">26</th><td>  <var>578</var>,  <var>572</var>,  <var>566</var>,  <var>560</var>,  <var>554</var>,  <var>547</var>,  <var>541</var>,  <var>535</var>,  <var>530</var>,  <var>524</var>,  <var>518</var>,  <var>512</var>,  <var>506</var>,</td></tr>
<tr><th id="27">27</th><td>  <var>501</var>,  <var>495</var>,  <var>489</var>,  <var>484</var>,  <var>478</var>,  <var>473</var>,  <var>467</var>,  <var>462</var>,  <var>456</var>,  <var>451</var>,  <var>446</var>,  <var>441</var>,  <var>435</var>,</td></tr>
<tr><th id="28">28</th><td>  <var>430</var>,  <var>425</var>,  <var>420</var>,  <var>415</var>,  <var>410</var>,  <var>405</var>,  <var>400</var>,  <var>395</var>,  <var>390</var>,  <var>385</var>,  <var>380</var>,  <var>375</var>,  <var>371</var>,</td></tr>
<tr><th id="29">29</th><td>  <var>366</var>,  <var>361</var>,  <var>356</var>,  <var>352</var>,  <var>347</var>,  <var>343</var>,  <var>338</var>,  <var>333</var>,  <var>329</var>,  <var>324</var>,  <var>320</var>,  <var>316</var>,  <var>311</var>,</td></tr>
<tr><th id="30">30</th><td>  <var>307</var>,  <var>302</var>,  <var>298</var>,  <var>294</var>,  <var>289</var>,  <var>285</var>,  <var>281</var>,  <var>277</var>,  <var>273</var>,  <var>268</var>,  <var>264</var>,  <var>260</var>,  <var>256</var>,</td></tr>
<tr><th id="31">31</th><td>  <var>252</var>,  <var>248</var>,  <var>244</var>,  <var>240</var>,  <var>236</var>,  <var>232</var>,  <var>228</var>,  <var>224</var>,  <var>220</var>,  <var>216</var>,  <var>212</var>,  <var>209</var>,  <var>205</var>,</td></tr>
<tr><th id="32">32</th><td>  <var>201</var>,  <var>197</var>,  <var>194</var>,  <var>190</var>,  <var>186</var>,  <var>182</var>,  <var>179</var>,  <var>175</var>,  <var>171</var>,  <var>168</var>,  <var>164</var>,  <var>161</var>,  <var>157</var>,</td></tr>
<tr><th id="33">33</th><td>  <var>153</var>,  <var>150</var>,  <var>146</var>,  <var>143</var>,  <var>139</var>,  <var>136</var>,  <var>132</var>,  <var>129</var>,  <var>125</var>,  <var>122</var>,  <var>119</var>,  <var>115</var>,  <var>112</var>,</td></tr>
<tr><th id="34">34</th><td>  <var>109</var>,  <var>105</var>,  <var>102</var>,  <var>99</var>,   <var>95</var>,   <var>92</var>,   <var>89</var>,   <var>86</var>,   <var>82</var>,   <var>79</var>,   <var>76</var>,   <var>73</var>,   <var>70</var>,</td></tr>
<tr><th id="35">35</th><td>  <var>66</var>,   <var>63</var>,   <var>60</var>,   <var>57</var>,   <var>54</var>,   <var>51</var>,   <var>48</var>,   <var>45</var>,   <var>42</var>,   <var>38</var>,   <var>35</var>,   <var>32</var>,   <var>29</var>,</td></tr>
<tr><th id="36">36</th><td>  <var>26</var>,   <var>23</var>,   <var>20</var>,   <var>18</var>,   <var>15</var>,   <var>12</var>,   <var>9</var>,    <var>6</var>,    <var>3</var></td></tr>
<tr><th id="37">37</th><td>};</td></tr>
<tr><th id="38">38</th><td></td></tr>
<tr><th id="39">39</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="cost" title='cost' data-type='void cost(int * costs, const vpx_tree_index * tree, const vpx_prob * probs, int i, int c)' data-ref="cost" data-ref-filename="cost">cost</dfn>(<em>int</em> *<dfn class="local col1 decl" id="1costs" title='costs' data-type='int *' data-ref="1costs" data-ref-filename="1costs">costs</dfn>, <a class="typedef" href="../../vpx_dsp/prob.h.html#vpx_tree" title='vpx_tree' data-type='const vpx_tree_index []' data-ref="vpx_tree" data-ref-filename="vpx_tree">vpx_tree</a> <dfn class="local col2 decl" id="2tree" title='tree' data-type='const vpx_tree_index *' data-ref="2tree" data-ref-filename="2tree">tree</dfn>, <em>const</em> <a class="typedef" href="../../vpx_dsp/prob.h.html#vpx_prob" title='vpx_prob' data-type='uint8_t' data-ref="vpx_prob" data-ref-filename="vpx_prob">vpx_prob</a> *<dfn class="local col3 decl" id="3probs" title='probs' data-type='const vpx_prob *' data-ref="3probs" data-ref-filename="3probs">probs</dfn>, <em>int</em> <dfn class="local col4 decl" id="4i" title='i' data-type='int' data-ref="4i" data-ref-filename="4i">i</dfn>,</td></tr>
<tr><th id="40">40</th><td>                 <em>int</em> <dfn class="local col5 decl" id="5c" title='c' data-type='int' data-ref="5c" data-ref-filename="5c">c</dfn>) {</td></tr>
<tr><th id="41">41</th><td>  <em>const</em> <a class="typedef" href="../../vpx_dsp/prob.h.html#vpx_prob" title='vpx_prob' data-type='uint8_t' data-ref="vpx_prob" data-ref-filename="vpx_prob">vpx_prob</a> <dfn class="local col6 decl" id="6prob" title='prob' data-type='const vpx_prob' data-ref="6prob" data-ref-filename="6prob">prob</dfn> = <a class="local col3 ref" href="#3probs" title='probs' data-ref="3probs" data-ref-filename="3probs">probs</a>[<a class="local col4 ref" href="#4i" title='i' data-ref="4i" data-ref-filename="4i">i</a> / <var>2</var>];</td></tr>
<tr><th id="42">42</th><td>  <em>int</em> <dfn class="local col7 decl" id="7b" title='b' data-type='int' data-ref="7b" data-ref-filename="7b">b</dfn>;</td></tr>
<tr><th id="43">43</th><td></td></tr>
<tr><th id="44">44</th><td>  <span class="macro" title="(__builtin_expect(!(prob != 0), 0) ? __assert_rtn(__func__, &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/third_party/libvpx/source/libvpx/vp9/encoder/vp9_cost.c&quot;, 44, &quot;prob != 0&quot;) : (void)0)" data-ref="_M/assert">assert</span>(<a class="local col6 ref" href="#6prob" title='prob' data-ref="6prob" data-ref-filename="6prob">prob</a> != <var>0</var>);</td></tr>
<tr><th id="45">45</th><td>  <b>for</b> (<a class="local col7 ref" href="#7b" title='b' data-ref="7b" data-ref-filename="7b">b</a> = <var>0</var>; <a class="local col7 ref" href="#7b" title='b' data-ref="7b" data-ref-filename="7b">b</a> &lt;= <var>1</var>; ++<a class="local col7 ref" href="#7b" title='b' data-ref="7b" data-ref-filename="7b">b</a>) {</td></tr>
<tr><th id="46">46</th><td>    <em>const</em> <em>int</em> <dfn class="local col8 decl" id="8cc" title='cc' data-type='const int' data-ref="8cc" data-ref-filename="8cc">cc</dfn> = <a class="local col5 ref" href="#5c" title='c' data-ref="5c" data-ref-filename="5c">c</a> + <a class="macro" href="vp9_cost.h.html#30" title="(vp9_prob_cost[(b) ? 256 - (prob) : (prob)])" data-ref="_M/vp9_cost_bit">vp9_cost_bit</a>(<a class="local col6 ref" href="#6prob" title='prob' data-ref="6prob" data-ref-filename="6prob">prob</a>, <a class="local col7 ref" href="#7b" title='b' data-ref="7b" data-ref-filename="7b">b</a>);</td></tr>
<tr><th id="47">47</th><td>    <em>const</em> <a class="typedef" href="../../vpx_dsp/prob.h.html#vpx_tree_index" title='vpx_tree_index' data-type='int8_t' data-ref="vpx_tree_index" data-ref-filename="vpx_tree_index">vpx_tree_index</a> <dfn class="local col9 decl" id="9ii" title='ii' data-type='const vpx_tree_index' data-ref="9ii" data-ref-filename="9ii">ii</dfn> = <a class="local col2 ref" href="#2tree" title='tree' data-ref="2tree" data-ref-filename="2tree">tree</a>[<a class="local col4 ref" href="#4i" title='i' data-ref="4i" data-ref-filename="4i">i</a> + <a class="local col7 ref" href="#7b" title='b' data-ref="7b" data-ref-filename="7b">b</a>];</td></tr>
<tr><th id="48">48</th><td></td></tr>
<tr><th id="49">49</th><td>    <b>if</b> (<a class="local col9 ref" href="#9ii" title='ii' data-ref="9ii" data-ref-filename="9ii">ii</a> &lt;= <var>0</var>)</td></tr>
<tr><th id="50">50</th><td>      <a class="local col1 ref" href="#1costs" title='costs' data-ref="1costs" data-ref-filename="1costs">costs</a>[-<a class="local col9 ref" href="#9ii" title='ii' data-ref="9ii" data-ref-filename="9ii">ii</a>] = <a class="local col8 ref" href="#8cc" title='cc' data-ref="8cc" data-ref-filename="8cc">cc</a>;</td></tr>
<tr><th id="51">51</th><td>    <b>else</b></td></tr>
<tr><th id="52">52</th><td>      <a class="tu ref fn" href="#cost" title='cost' data-use='c' data-ref="cost" data-ref-filename="cost">cost</a>(<a class="local col1 ref" href="#1costs" title='costs' data-ref="1costs" data-ref-filename="1costs">costs</a>, <a class="local col2 ref" href="#2tree" title='tree' data-ref="2tree" data-ref-filename="2tree">tree</a>, <a class="local col3 ref" href="#3probs" title='probs' data-ref="3probs" data-ref-filename="3probs">probs</a>, <a class="local col9 ref" href="#9ii" title='ii' data-ref="9ii" data-ref-filename="9ii">ii</a>, <a class="local col8 ref" href="#8cc" title='cc' data-ref="8cc" data-ref-filename="8cc">cc</a>);</td></tr>
<tr><th id="53">53</th><td>  }</td></tr>
<tr><th id="54">54</th><td>}</td></tr>
<tr><th id="55">55</th><td></td></tr>
<tr><th id="56">56</th><td><em>void</em> <dfn class="decl def fn" id="vp9_cost_tokens" title='vp9_cost_tokens' data-ref="vp9_cost_tokens" data-ref-filename="vp9_cost_tokens">vp9_cost_tokens</dfn>(<em>int</em> *<dfn class="local col0 decl" id="10costs" title='costs' data-type='int *' data-ref="10costs" data-ref-filename="10costs">costs</dfn>, <em>const</em> <a class="typedef" href="../../vpx_dsp/prob.h.html#vpx_prob" title='vpx_prob' data-type='uint8_t' data-ref="vpx_prob" data-ref-filename="vpx_prob">vpx_prob</a> *<dfn class="local col1 decl" id="11probs" title='probs' data-type='const vpx_prob *' data-ref="11probs" data-ref-filename="11probs">probs</dfn>, <a class="typedef" href="../../vpx_dsp/prob.h.html#vpx_tree" title='vpx_tree' data-type='const vpx_tree_index []' data-ref="vpx_tree" data-ref-filename="vpx_tree">vpx_tree</a> <dfn class="local col2 decl" id="12tree" title='tree' data-type='const vpx_tree_index *' data-ref="12tree" data-ref-filename="12tree">tree</dfn>) {</td></tr>
<tr><th id="57">57</th><td>  <a class="tu ref fn" href="#cost" title='cost' data-use='c' data-ref="cost" data-ref-filename="cost">cost</a>(<a class="local col0 ref" href="#10costs" title='costs' data-ref="10costs" data-ref-filename="10costs">costs</a>, <a class="local col2 ref" href="#12tree" title='tree' data-ref="12tree" data-ref-filename="12tree">tree</a>, <a class="local col1 ref" href="#11probs" title='probs' data-ref="11probs" data-ref-filename="11probs">probs</a>, <var>0</var>, <var>0</var>);</td></tr>
<tr><th id="58">58</th><td>}</td></tr>
<tr><th id="59">59</th><td></td></tr>
<tr><th id="60">60</th><td><em>void</em> <dfn class="decl def fn" id="vp9_cost_tokens_skip" title='vp9_cost_tokens_skip' data-ref="vp9_cost_tokens_skip" data-ref-filename="vp9_cost_tokens_skip">vp9_cost_tokens_skip</dfn>(<em>int</em> *<dfn class="local col3 decl" id="13costs" title='costs' data-type='int *' data-ref="13costs" data-ref-filename="13costs">costs</dfn>, <em>const</em> <a class="typedef" href="../../vpx_dsp/prob.h.html#vpx_prob" title='vpx_prob' data-type='uint8_t' data-ref="vpx_prob" data-ref-filename="vpx_prob">vpx_prob</a> *<dfn class="local col4 decl" id="14probs" title='probs' data-type='const vpx_prob *' data-ref="14probs" data-ref-filename="14probs">probs</dfn>, <a class="typedef" href="../../vpx_dsp/prob.h.html#vpx_tree" title='vpx_tree' data-type='const vpx_tree_index []' data-ref="vpx_tree" data-ref-filename="vpx_tree">vpx_tree</a> <dfn class="local col5 decl" id="15tree" title='tree' data-type='const vpx_tree_index *' data-ref="15tree" data-ref-filename="15tree">tree</dfn>) {</td></tr>
<tr><th id="61">61</th><td>  <span class="macro" title="(__builtin_expect(!(tree[0] &lt;= 0 &amp;&amp; tree[1] &gt; 0), 0) ? __assert_rtn(__func__, &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/ThirdParty/libwebrtc/Source/third_party/libvpx/source/libvpx/vp9/encoder/vp9_cost.c&quot;, 61, &quot;tree[0] &lt;= 0 &amp;&amp; tree[1] &gt; 0&quot;) : (void)0)" data-ref="_M/assert">assert</span>(<a class="local col5 ref" href="#15tree" title='tree' data-ref="15tree" data-ref-filename="15tree">tree</a>[<var>0</var>] &lt;= <var>0</var> &amp;&amp; <a class="local col5 ref" href="#15tree" title='tree' data-ref="15tree" data-ref-filename="15tree">tree</a>[<var>1</var>] &gt; <var>0</var>);</td></tr>
<tr><th id="62">62</th><td></td></tr>
<tr><th id="63">63</th><td>  <a class="local col3 ref" href="#13costs" title='costs' data-ref="13costs" data-ref-filename="13costs">costs</a>[-<a class="local col5 ref" href="#15tree" title='tree' data-ref="15tree" data-ref-filename="15tree">tree</a>[<var>0</var>]] = <a class="macro" href="vp9_cost.h.html#30" title="(vp9_prob_cost[(0) ? 256 - (probs[0]) : (probs[0])])" data-ref="_M/vp9_cost_bit">vp9_cost_bit</a>(<a class="local col4 ref" href="#14probs" title='probs' data-ref="14probs" data-ref-filename="14probs">probs</a>[<var>0</var>], <var>0</var>);</td></tr>
<tr><th id="64">64</th><td>  <a class="tu ref fn" href="#cost" title='cost' data-use='c' data-ref="cost" data-ref-filename="cost">cost</a>(<a class="local col3 ref" href="#13costs" title='costs' data-ref="13costs" data-ref-filename="13costs">costs</a>, <a class="local col5 ref" href="#15tree" title='tree' data-ref="15tree" data-ref-filename="15tree">tree</a>, <a class="local col4 ref" href="#14probs" title='probs' data-ref="14probs" data-ref-filename="14probs">probs</a>, <var>2</var>, <var>0</var>);</td></tr>
<tr><th id="65">65</th><td>}</td></tr>
<tr><th id="66">66</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2021-Jul-06</em> from project webkit<br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
