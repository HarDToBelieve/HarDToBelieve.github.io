<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>pitch_filter.c source code [webkit/Source/ThirdParty/libwebrtc/Source/webrtc/modules/audio_coding/codecs/isac/main/source/pitch_filter.c] - Woboq Code Browser</title>
<link rel="stylesheet" href="../../../../../../../../../../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../../../../../../../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../../../../../../../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../../../../../../../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'webkit/Source/ThirdParty/libwebrtc/Source/webrtc/modules/audio_coding/codecs/isac/main/source/pitch_filter.c'; var root_path = '../../../../../../../../../../../..'; var data_path = '../../../../../../../../../../../../../data'; var ecma_script_api_version = 2;</script>
<script src='../../../../../../../../../../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../../../../../../../../..'>webkit</a>/<a href='../../../../../../../../../..'>Source</a>/<a href='../../../../../../../../..'>ThirdParty</a>/<a href='../../../../../../../..'>libwebrtc</a>/<a href='../../../../../../..'>Source</a>/<a href='../../../../../..'>webrtc</a>/<a href='../../../../..'>modules</a>/<a href='../../../..'>audio_coding</a>/<a href='../../..'>codecs</a>/<a href='../..'>isac</a>/<a href='..'>main</a>/<a href='./'>source</a>/<a href='pitch_filter.c.html'>pitch_filter.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> *  Copyright (c) 2012 The WebRTC project authors. All Rights Reserved.</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> *  Use of this source code is governed by a BSD-style license</i></td></tr>
<tr><th id="5">5</th><td><i> *  that can be found in the LICENSE file in the root of the source</i></td></tr>
<tr><th id="6">6</th><td><i> *  tree. An additional intellectual property rights grant can be found</i></td></tr>
<tr><th id="7">7</th><td><i> *  in the file PATENTS.  All contributing project authors may</i></td></tr>
<tr><th id="8">8</th><td><i> *  be found in the AUTHORS file in the root of the source tree.</i></td></tr>
<tr><th id="9">9</th><td><i> */</i></td></tr>
<tr><th id="10">10</th><td></td></tr>
<tr><th id="11">11</th><td><u>#include &lt;math.h&gt;</u></td></tr>
<tr><th id="12">12</th><td><u>#include &lt;memory.h&gt;</u></td></tr>
<tr><th id="13">13</th><td><u>#include &lt;stdlib.h&gt;</u></td></tr>
<tr><th id="14">14</th><td></td></tr>
<tr><th id="15">15</th><td><u>#include <a href="pitch_estimator.h.html">"modules/audio_coding/codecs/isac/main/source/pitch_estimator.h"</a></u></td></tr>
<tr><th id="16">16</th><td><u>#include <a href="os_specific_inline.h.html">"modules/audio_coding/codecs/isac/main/source/os_specific_inline.h"</a></u></td></tr>
<tr><th id="17">17</th><td><u>#include <a href="../../../../../../rtc_base/compile_assert_c.h.html">"rtc_base/compile_assert_c.h"</a></u></td></tr>
<tr><th id="18">18</th><td></td></tr>
<tr><th id="19">19</th><td><i  data-doc="kDampFilter">/*</i></td></tr>
<tr><th id="20">20</th><td><i  data-doc="kDampFilter"> * We are implementing the following filters;</i></td></tr>
<tr><th id="21">21</th><td><i  data-doc="kDampFilter"> *</i></td></tr>
<tr><th id="22">22</th><td><i  data-doc="kDampFilter"> * Pre-filtering:</i></td></tr>
<tr><th id="23">23</th><td><i  data-doc="kDampFilter"> *   y(z) = x(z) + damper(z) * gain * (x(z) + y(z)) * z ^ (-lag);</i></td></tr>
<tr><th id="24">24</th><td><i  data-doc="kDampFilter"> *</i></td></tr>
<tr><th id="25">25</th><td><i  data-doc="kDampFilter"> * Post-filtering:</i></td></tr>
<tr><th id="26">26</th><td><i  data-doc="kDampFilter"> *   y(z) = x(z) - damper(z) * gain * (x(z) + y(z)) * z ^ (-lag);</i></td></tr>
<tr><th id="27">27</th><td><i  data-doc="kDampFilter"> *</i></td></tr>
<tr><th id="28">28</th><td><i  data-doc="kDampFilter"> * Note that |lag| is a floating number so we perform an interpolation to</i></td></tr>
<tr><th id="29">29</th><td><i  data-doc="kDampFilter"> * obtain the correct |lag|.</i></td></tr>
<tr><th id="30">30</th><td><i  data-doc="kDampFilter"> *</i></td></tr>
<tr><th id="31">31</th><td><i  data-doc="kDampFilter"> */</i></td></tr>
<tr><th id="32">32</th><td></td></tr>
<tr><th id="33">33</th><td><em>static</em> <em>const</em> <em>double</em> <dfn class="tu decl def" id="kDampFilter" title='kDampFilter' data-type='const double [5]' data-ref="kDampFilter" data-ref-filename="kDampFilter">kDampFilter</dfn>[<a class="macro" href="settings.h.html#138" title="5" data-ref="_M/PITCH_DAMPORDER">PITCH_DAMPORDER</a>] = {-<var>0.07</var>, <var>0.25</var>, <var>0.64</var>, <var>0.25</var>,</td></tr>
<tr><th id="34">34</th><td>    -<var>0.07</var>};</td></tr>
<tr><th id="35">35</th><td></td></tr>
<tr><th id="36">36</th><td><i  data-doc="kIntrpCoef">/* interpolation coefficients; generated by design_pitch_filter.m */</i></td></tr>
<tr><th id="37">37</th><td><em>static</em> <em>const</em> <em>double</em> <dfn class="tu decl def" id="kIntrpCoef" title='kIntrpCoef' data-type='const double [8][9]' data-ref="kIntrpCoef" data-ref-filename="kIntrpCoef">kIntrpCoef</dfn>[<a class="macro" href="settings.h.html#136" title="8" data-ref="_M/PITCH_FRACS">PITCH_FRACS</a>][<a class="macro" href="settings.h.html#137" title="9" data-ref="_M/PITCH_FRACORDER">PITCH_FRACORDER</a>] = {</td></tr>
<tr><th id="38">38</th><td>    {-<var>0.02239172458614</var>,  <var>0.06653315052934</var>, -<var>0.16515880017569</var>,  <var>0.60701333734125</var>,</td></tr>
<tr><th id="39">39</th><td>     <var>0.64671399919202</var>, -<var>0.20249000396417</var>,  <var>0.09926548334755</var>, -<var>0.04765933793109</var>,</td></tr>
<tr><th id="40">40</th><td>     <var>0.01754159521746</var>},</td></tr>
<tr><th id="41">41</th><td>    {-<var>0.01985640750434</var>,  <var>0.05816126837866</var>, -<var>0.13991265473714</var>,  <var>0.44560418147643</var>,</td></tr>
<tr><th id="42">42</th><td>     <var>0.79117042386876</var>, -<var>0.20266133815188</var>,  <var>0.09585268418555</var>, -<var>0.04533310458084</var>,</td></tr>
<tr><th id="43">43</th><td>     <var>0.01654127246314</var>},</td></tr>
<tr><th id="44">44</th><td>    {-<var>0.01463300534216</var>,  <var>0.04229888475060</var>, -<var>0.09897034715253</var>,  <var>0.28284326017787</var>,</td></tr>
<tr><th id="45">45</th><td>     <var>0.90385267956632</var>, -<var>0.16976950138649</var>,  <var>0.07704272393639</var>, -<var>0.03584218578311</var>,</td></tr>
<tr><th id="46">46</th><td>     <var>0.01295781500709</var>},</td></tr>
<tr><th id="47">47</th><td>    {-<var>0.00764851320885</var>,  <var>0.02184035544377</var>, -<var>0.04985561057281</var>,  <var>0.13083306574393</var>,</td></tr>
<tr><th id="48">48</th><td>     <var>0.97545011664662</var>, -<var>0.10177807997561</var>,  <var>0.04400901776474</var>, -<var>0.02010737175166</var>,</td></tr>
<tr><th id="49">49</th><td>     <var>0.00719783432422</var>},</td></tr>
<tr><th id="50">50</th><td>    {-<var>0.00000000000000</var>,  <var>0.00000000000000</var>, -<var>0.00000000000001</var>,  <var>0.00000000000001</var>,</td></tr>
<tr><th id="51">51</th><td>     <var>0.99999999999999</var>,  <var>0.00000000000001</var>, -<var>0.00000000000001</var>,  <var>0.00000000000000</var>,</td></tr>
<tr><th id="52">52</th><td>     -<var>0.00000000000000</var>},</td></tr>
<tr><th id="53">53</th><td>    {<var>0.00719783432422</var>, -<var>0.02010737175166</var>,  <var>0.04400901776474</var>, -<var>0.10177807997562</var>,</td></tr>
<tr><th id="54">54</th><td>     <var>0.97545011664663</var>,  <var>0.13083306574393</var>, -<var>0.04985561057280</var>,  <var>0.02184035544377</var>,</td></tr>
<tr><th id="55">55</th><td>     -<var>0.00764851320885</var>},</td></tr>
<tr><th id="56">56</th><td>    {<var>0.01295781500710</var>, -<var>0.03584218578312</var>,  <var>0.07704272393640</var>, -<var>0.16976950138650</var>,</td></tr>
<tr><th id="57">57</th><td>     <var>0.90385267956634</var>,  <var>0.28284326017785</var>, -<var>0.09897034715252</var>,  <var>0.04229888475059</var>,</td></tr>
<tr><th id="58">58</th><td>     -<var>0.01463300534216</var>},</td></tr>
<tr><th id="59">59</th><td>    {<var>0.01654127246315</var>, -<var>0.04533310458085</var>,  <var>0.09585268418557</var>, -<var>0.20266133815190</var>,</td></tr>
<tr><th id="60">60</th><td>     <var>0.79117042386878</var>,  <var>0.44560418147640</var>, -<var>0.13991265473712</var>,  <var>0.05816126837865</var>,</td></tr>
<tr><th id="61">61</th><td>     -<var>0.01985640750433</var>}</td></tr>
<tr><th id="62">62</th><td>};</td></tr>
<tr><th id="63">63</th><td></td></tr>
<tr><th id="64">64</th><td><i>/*</i></td></tr>
<tr><th id="65">65</th><td><i> * Enumerating the operation of the filter.</i></td></tr>
<tr><th id="66">66</th><td><i> * iSAC has 4 different pitch-filter which are very similar in their structure.</i></td></tr>
<tr><th id="67">67</th><td><i> *</i></td></tr>
<tr><th id="68">68</th><td><i> * kPitchFilterPre     : In this mode the filter is operating as pitch</i></td></tr>
<tr><th id="69">69</th><td><i> *                       pre-filter. This is used at the encoder.</i></td></tr>
<tr><th id="70">70</th><td><i> * kPitchFilterPost    : In this mode the filter is operating as pitch</i></td></tr>
<tr><th id="71">71</th><td><i> *                       post-filter. This is the inverse of pre-filter and used</i></td></tr>
<tr><th id="72">72</th><td><i> *                       in the decoder.</i></td></tr>
<tr><th id="73">73</th><td><i> * kPitchFilterPreLa   : This is, in structure, similar to pre-filtering but</i></td></tr>
<tr><th id="74">74</th><td><i> *                       utilizing 3 millisecond lookahead. It is used to</i></td></tr>
<tr><th id="75">75</th><td><i> *                       obtain the signal for LPC analysis.</i></td></tr>
<tr><th id="76">76</th><td><i> * kPitchFilterPreGain : This is, in structure, similar to pre-filtering but</i></td></tr>
<tr><th id="77">77</th><td><i> *                       differential changes in gain is considered. This is</i></td></tr>
<tr><th id="78">78</th><td><i> *                       used to find the optimal gain.</i></td></tr>
<tr><th id="79">79</th><td><i> */</i></td></tr>
<tr><th id="80">80</th><td><b>typedef</b> <b>enum</b> {</td></tr>
<tr><th id="81">81</th><td>  <dfn class="enum" id="kPitchFilterPre" title='kPitchFilterPre' data-ref="kPitchFilterPre" data-ref-filename="kPitchFilterPre">kPitchFilterPre</dfn>, <dfn class="enum" id="kPitchFilterPost" title='kPitchFilterPost' data-ref="kPitchFilterPost" data-ref-filename="kPitchFilterPost">kPitchFilterPost</dfn>, <dfn class="enum" id="kPitchFilterPreLa" title='kPitchFilterPreLa' data-ref="kPitchFilterPreLa" data-ref-filename="kPitchFilterPreLa">kPitchFilterPreLa</dfn>, <dfn class="enum" id="kPitchFilterPreGain" title='kPitchFilterPreGain' data-ref="kPitchFilterPreGain" data-ref-filename="kPitchFilterPreGain">kPitchFilterPreGain</dfn></td></tr>
<tr><th id="82">82</th><td>} <dfn class="typedef" id="PitchFilterOperation" title='PitchFilterOperation' data-type='enum PitchFilterOperation' data-ref="PitchFilterOperation" data-ref-filename="PitchFilterOperation">PitchFilterOperation</dfn>;</td></tr>
<tr><th id="83">83</th><td></td></tr>
<tr><th id="84">84</th><td><i>/*</i></td></tr>
<tr><th id="85">85</th><td><i> * Structure with parameters used for pitch-filtering.</i></td></tr>
<tr><th id="86">86</th><td><i> * buffer           : a buffer where the sum of previous inputs and outputs</i></td></tr>
<tr><th id="87">87</th><td><i> *                    are stored.</i></td></tr>
<tr><th id="88">88</th><td><i> * damper_state     : the state of the damping filter. The filter is defined by</i></td></tr>
<tr><th id="89">89</th><td><i> *                    |kDampFilter|.</i></td></tr>
<tr><th id="90">90</th><td><i> * interpol_coeff   : pointer to a set of coefficient which are used to utilize</i></td></tr>
<tr><th id="91">91</th><td><i> *                    fractional pitch by interpolation.</i></td></tr>
<tr><th id="92">92</th><td><i> * gain             : pitch-gain to be applied to the current segment of input.</i></td></tr>
<tr><th id="93">93</th><td><i> * lag              : pitch-lag for the current segment of input.</i></td></tr>
<tr><th id="94">94</th><td><i> * lag_offset       : the offset of lag w.r.t. current sample.</i></td></tr>
<tr><th id="95">95</th><td><i> * sub_frame        : sub-frame index, there are 4 pitch sub-frames in an iSAC</i></td></tr>
<tr><th id="96">96</th><td><i> *                    frame.</i></td></tr>
<tr><th id="97">97</th><td><i> *                    This specifies the usage of the filter. See</i></td></tr>
<tr><th id="98">98</th><td><i> *                    'PitchFilterOperation' for operational modes.</i></td></tr>
<tr><th id="99">99</th><td><i> * num_samples      : number of samples to be processed in each segment.</i></td></tr>
<tr><th id="100">100</th><td><i> * index            : index of the input and output sample.</i></td></tr>
<tr><th id="101">101</th><td><i> * damper_state_dg  : state of damping filter for different trial gains.</i></td></tr>
<tr><th id="102">102</th><td><i> * gain_mult        : differential changes to gain.</i></td></tr>
<tr><th id="103">103</th><td><i> */</i></td></tr>
<tr><th id="104">104</th><td><b>typedef</b> <b>struct</b> {</td></tr>
<tr><th id="105">105</th><td>  <em>double</em> <dfn class="tu decl field" id="(anonymous)::buffer" title='(anonymous struct)::buffer' data-type='double [454]' data-ref="(anonymous)::buffer" data-ref-filename="(anonymous)..buffer">buffer</dfn>[<a class="macro" href="settings.h.html#131" title="((240) + (140 + 50))" data-ref="_M/PITCH_INTBUFFSIZE">PITCH_INTBUFFSIZE</a> + <a class="macro" href="settings.h.html#54" title="24" data-ref="_M/QLOOKAHEAD">QLOOKAHEAD</a>];</td></tr>
<tr><th id="106">106</th><td>  <em>double</em> <dfn class="tu decl field" id="(anonymous)::damper_state" title='(anonymous struct)::damper_state' data-type='double [5]' data-ref="(anonymous)::damper_state" data-ref-filename="(anonymous)..damper_state">damper_state</dfn>[<a class="macro" href="settings.h.html#138" title="5" data-ref="_M/PITCH_DAMPORDER">PITCH_DAMPORDER</a>];</td></tr>
<tr><th id="107">107</th><td>  <em>const</em> <em>double</em> *<dfn class="tu decl field" id="(anonymous)::interpol_coeff" title='(anonymous struct)::interpol_coeff' data-type='const double *' data-ref="(anonymous)::interpol_coeff" data-ref-filename="(anonymous)..interpol_coeff">interpol_coeff</dfn>;</td></tr>
<tr><th id="108">108</th><td>  <em>double</em> <dfn class="tu decl field" id="(anonymous)::gain" title='(anonymous struct)::gain' data-type='double' data-ref="(anonymous)::gain" data-ref-filename="(anonymous)..gain">gain</dfn>;</td></tr>
<tr><th id="109">109</th><td>  <em>double</em> <dfn class="tu decl field" id="(anonymous)::lag" title='(anonymous struct)::lag' data-type='double' data-ref="(anonymous)::lag" data-ref-filename="(anonymous)..lag">lag</dfn>;</td></tr>
<tr><th id="110">110</th><td>  <em>int</em> <dfn class="tu decl field" id="(anonymous)::lag_offset" title='(anonymous struct)::lag_offset' data-type='int' data-ref="(anonymous)::lag_offset" data-ref-filename="(anonymous)..lag_offset">lag_offset</dfn>;</td></tr>
<tr><th id="111">111</th><td></td></tr>
<tr><th id="112">112</th><td>  <em>int</em> <dfn class="tu decl field" id="(anonymous)::sub_frame" title='(anonymous struct)::sub_frame' data-type='int' data-ref="(anonymous)::sub_frame" data-ref-filename="(anonymous)..sub_frame">sub_frame</dfn>;</td></tr>
<tr><th id="113">113</th><td>  <a class="typedef" href="#PitchFilterOperation" title='PitchFilterOperation' data-type='enum PitchFilterOperation' data-ref="PitchFilterOperation" data-ref-filename="PitchFilterOperation">PitchFilterOperation</a> <dfn class="tu decl field" id="(anonymous)::mode" title='(anonymous struct)::mode' data-type='PitchFilterOperation' data-ref="(anonymous)::mode" data-ref-filename="(anonymous)..mode">mode</dfn>;</td></tr>
<tr><th id="114">114</th><td>  <em>int</em> <dfn class="tu decl field" id="(anonymous)::num_samples" title='(anonymous struct)::num_samples' data-type='int' data-ref="(anonymous)::num_samples" data-ref-filename="(anonymous)..num_samples">num_samples</dfn>;</td></tr>
<tr><th id="115">115</th><td>  <em>int</em> <dfn class="tu decl field" id="(anonymous)::index" title='(anonymous struct)::index' data-type='int' data-ref="(anonymous)::index" data-ref-filename="(anonymous)..index">index</dfn>;</td></tr>
<tr><th id="116">116</th><td></td></tr>
<tr><th id="117">117</th><td>  <em>double</em> <dfn class="tu decl field" id="(anonymous)::damper_state_dg" title='(anonymous struct)::damper_state_dg' data-type='double [4][5]' data-ref="(anonymous)::damper_state_dg" data-ref-filename="(anonymous)..damper_state_dg">damper_state_dg</dfn>[<var>4</var>][<a class="macro" href="settings.h.html#138" title="5" data-ref="_M/PITCH_DAMPORDER">PITCH_DAMPORDER</a>];</td></tr>
<tr><th id="118">118</th><td>  <em>double</em> <dfn class="tu decl field" id="(anonymous)::gain_mult" title='(anonymous struct)::gain_mult' data-type='double [4]' data-ref="(anonymous)::gain_mult" data-ref-filename="(anonymous)..gain_mult">gain_mult</dfn>[<var>4</var>];</td></tr>
<tr><th id="119">119</th><td>} <dfn class="typedef" id="PitchFilterParam" title='PitchFilterParam' data-type='struct PitchFilterParam' data-ref="PitchFilterParam" data-ref-filename="PitchFilterParam">PitchFilterParam</dfn>;</td></tr>
<tr><th id="120">120</th><td></td></tr>
<tr><th id="121">121</th><td><i  data-doc="FilterSegment">/**********************************************************************</i></td></tr>
<tr><th id="122">122</th><td><i  data-doc="FilterSegment"> * FilterSegment()</i></td></tr>
<tr><th id="123">123</th><td><i  data-doc="FilterSegment"> * Filter one segment, a quarter of a frame.</i></td></tr>
<tr><th id="124">124</th><td><i  data-doc="FilterSegment"> *</i></td></tr>
<tr><th id="125">125</th><td><i  data-doc="FilterSegment"> * Inputs</i></td></tr>
<tr><th id="126">126</th><td><i  data-doc="FilterSegment"> *   in_data      : pointer to the input signal of 30 ms at 8 kHz sample-rate.</i></td></tr>
<tr><th id="127">127</th><td><i  data-doc="FilterSegment"> *   filter_param : pitch filter parameters.</i></td></tr>
<tr><th id="128">128</th><td><i  data-doc="FilterSegment"> *</i></td></tr>
<tr><th id="129">129</th><td><i  data-doc="FilterSegment"> * Outputs</i></td></tr>
<tr><th id="130">130</th><td><i  data-doc="FilterSegment"> *   out_data     : pointer to a buffer where the filtered signal is written to.</i></td></tr>
<tr><th id="131">131</th><td><i  data-doc="FilterSegment"> *   out_dg       : [only used in kPitchFilterPreGain] pointer to a buffer</i></td></tr>
<tr><th id="132">132</th><td><i  data-doc="FilterSegment"> *                  where the output of different gain values (differential</i></td></tr>
<tr><th id="133">133</th><td><i  data-doc="FilterSegment"> *                  change to gain) is written.</i></td></tr>
<tr><th id="134">134</th><td><i  data-doc="FilterSegment"> */</i></td></tr>
<tr><th id="135">135</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="FilterSegment" title='FilterSegment' data-type='void FilterSegment(const double * in_data, PitchFilterParam * parameters, double * out_data, double (*)[264] out_dg)' data-ref="FilterSegment" data-ref-filename="FilterSegment">FilterSegment</dfn>(<em>const</em> <em>double</em>* <dfn class="local col1 decl" id="1in_data" title='in_data' data-type='const double *' data-ref="1in_data" data-ref-filename="1in_data">in_data</dfn>, <a class="typedef" href="#PitchFilterParam" title='PitchFilterParam' data-type='struct PitchFilterParam' data-ref="PitchFilterParam" data-ref-filename="PitchFilterParam">PitchFilterParam</a>* <dfn class="local col2 decl" id="2parameters" title='parameters' data-type='PitchFilterParam *' data-ref="2parameters" data-ref-filename="2parameters">parameters</dfn>,</td></tr>
<tr><th id="136">136</th><td>                          <em>double</em>* <dfn class="local col3 decl" id="3out_data" title='out_data' data-type='double *' data-ref="3out_data" data-ref-filename="3out_data">out_data</dfn>,</td></tr>
<tr><th id="137">137</th><td>                          <em>double</em> <dfn class="local col4 decl" id="4out_dg" title='out_dg' data-type='double (*)[264]' data-ref="4out_dg" data-ref-filename="4out_dg">out_dg</dfn>[][<a class="macro" href="settings.h.html#106" title="(240)" data-ref="_M/PITCH_FRAME_LEN">PITCH_FRAME_LEN</a> + <a class="macro" href="settings.h.html#54" title="24" data-ref="_M/QLOOKAHEAD">QLOOKAHEAD</a>]) {</td></tr>
<tr><th id="138">138</th><td>  <em>int</em> <dfn class="local col5 decl" id="5n" title='n' data-type='int' data-ref="5n" data-ref-filename="5n">n</dfn>;</td></tr>
<tr><th id="139">139</th><td>  <em>int</em> <dfn class="local col6 decl" id="6m" title='m' data-type='int' data-ref="6m" data-ref-filename="6m">m</dfn>;</td></tr>
<tr><th id="140">140</th><td>  <em>int</em> <dfn class="local col7 decl" id="7j" title='j' data-type='int' data-ref="7j" data-ref-filename="7j">j</dfn>;</td></tr>
<tr><th id="141">141</th><td>  <em>double</em> <dfn class="local col8 decl" id="8sum" title='sum' data-type='double' data-ref="8sum" data-ref-filename="8sum">sum</dfn>;</td></tr>
<tr><th id="142">142</th><td>  <em>double</em> <dfn class="local col9 decl" id="9sum2" title='sum2' data-type='double' data-ref="9sum2" data-ref-filename="9sum2">sum2</dfn>;</td></tr>
<tr><th id="143">143</th><td>  <i>/* Index of |parameters-&gt;buffer| where the output is written to. */</i></td></tr>
<tr><th id="144">144</th><td>  <em>int</em> <dfn class="local col0 decl" id="10pos" title='pos' data-type='int' data-ref="10pos" data-ref-filename="10pos">pos</dfn> = <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::index" title='(anonymous struct)::index' data-use='r' data-ref="(anonymous)::index" data-ref-filename="(anonymous)..index">index</a> + <a class="macro" href="settings.h.html#130" title="(140 + 50)" data-ref="_M/PITCH_BUFFSIZE">PITCH_BUFFSIZE</a>;</td></tr>
<tr><th id="145">145</th><td>  <i>/* Index of |parameters-&gt;buffer| where samples are read for fractional-lag</i></td></tr>
<tr><th id="146">146</th><td><i>   * computation. */</i></td></tr>
<tr><th id="147">147</th><td>  <em>int</em> <dfn class="local col1 decl" id="11pos_lag" title='pos_lag' data-type='int' data-ref="11pos_lag" data-ref-filename="11pos_lag">pos_lag</dfn> = <a class="local col0 ref" href="#10pos" title='pos' data-ref="10pos" data-ref-filename="10pos">pos</a> - <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::lag_offset" title='(anonymous struct)::lag_offset' data-use='r' data-ref="(anonymous)::lag_offset" data-ref-filename="(anonymous)..lag_offset">lag_offset</a>;</td></tr>
<tr><th id="148">148</th><td></td></tr>
<tr><th id="149">149</th><td>  <b>for</b> (<a class="local col5 ref" href="#5n" title='n' data-ref="5n" data-ref-filename="5n">n</a> = <var>0</var>; <a class="local col5 ref" href="#5n" title='n' data-ref="5n" data-ref-filename="5n">n</a> &lt; <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::num_samples" title='(anonymous struct)::num_samples' data-use='r' data-ref="(anonymous)::num_samples" data-ref-filename="(anonymous)..num_samples">num_samples</a>; ++<a class="local col5 ref" href="#5n" title='n' data-ref="5n" data-ref-filename="5n">n</a>) {</td></tr>
<tr><th id="150">150</th><td>    <i>/* Shift low pass filter states. */</i></td></tr>
<tr><th id="151">151</th><td>    <b>for</b> (<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a> = <a class="macro" href="settings.h.html#138" title="5" data-ref="_M/PITCH_DAMPORDER">PITCH_DAMPORDER</a> - <var>1</var>; <a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a> &gt; <var>0</var>; --<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>) {</td></tr>
<tr><th id="152">152</th><td>      <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::damper_state" title='(anonymous struct)::damper_state' data-use='w' data-ref="(anonymous)::damper_state" data-ref-filename="(anonymous)..damper_state">damper_state</a>[<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>] = <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::damper_state" title='(anonymous struct)::damper_state' data-use='r' data-ref="(anonymous)::damper_state" data-ref-filename="(anonymous)..damper_state">damper_state</a>[<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a> - <var>1</var>];</td></tr>
<tr><th id="153">153</th><td>    }</td></tr>
<tr><th id="154">154</th><td>    <i>/* Filter to get fractional pitch. */</i></td></tr>
<tr><th id="155">155</th><td>    <a class="local col8 ref" href="#8sum" title='sum' data-ref="8sum" data-ref-filename="8sum">sum</a> = <var>0.0</var>;</td></tr>
<tr><th id="156">156</th><td>    <b>for</b> (<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a> = <var>0</var>; <a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a> &lt; <a class="macro" href="settings.h.html#137" title="9" data-ref="_M/PITCH_FRACORDER">PITCH_FRACORDER</a>; ++<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>) {</td></tr>
<tr><th id="157">157</th><td>      <a class="local col8 ref" href="#8sum" title='sum' data-ref="8sum" data-ref-filename="8sum">sum</a> += <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::buffer" title='(anonymous struct)::buffer' data-use='r' data-ref="(anonymous)::buffer" data-ref-filename="(anonymous)..buffer">buffer</a>[<a class="local col1 ref" href="#11pos_lag" title='pos_lag' data-ref="11pos_lag" data-ref-filename="11pos_lag">pos_lag</a> + <a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>] * <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::interpol_coeff" title='(anonymous struct)::interpol_coeff' data-use='r' data-ref="(anonymous)::interpol_coeff" data-ref-filename="(anonymous)..interpol_coeff">interpol_coeff</a>[<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>];</td></tr>
<tr><th id="158">158</th><td>    }</td></tr>
<tr><th id="159">159</th><td>    <i>/* Multiply with gain. */</i></td></tr>
<tr><th id="160">160</th><td>    <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::damper_state" title='(anonymous struct)::damper_state' data-use='w' data-ref="(anonymous)::damper_state" data-ref-filename="(anonymous)..damper_state">damper_state</a>[<var>0</var>] = <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::gain" title='(anonymous struct)::gain' data-use='r' data-ref="(anonymous)::gain" data-ref-filename="(anonymous)..gain">gain</a> * <a class="local col8 ref" href="#8sum" title='sum' data-ref="8sum" data-ref-filename="8sum">sum</a>;</td></tr>
<tr><th id="161">161</th><td></td></tr>
<tr><th id="162">162</th><td>    <b>if</b> (<a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::mode" title='(anonymous struct)::mode' data-use='r' data-ref="(anonymous)::mode" data-ref-filename="(anonymous)..mode">mode</a> == <a class="enum" href="#kPitchFilterPreGain" title='kPitchFilterPreGain' data-ref="kPitchFilterPreGain" data-ref-filename="kPitchFilterPreGain">kPitchFilterPreGain</a>) {</td></tr>
<tr><th id="163">163</th><td>      <em>int</em> <dfn class="local col2 decl" id="12lag_index" title='lag_index' data-type='int' data-ref="12lag_index" data-ref-filename="12lag_index">lag_index</dfn> = <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::index" title='(anonymous struct)::index' data-use='r' data-ref="(anonymous)::index" data-ref-filename="(anonymous)..index">index</a> - <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::lag_offset" title='(anonymous struct)::lag_offset' data-use='r' data-ref="(anonymous)::lag_offset" data-ref-filename="(anonymous)..lag_offset">lag_offset</a>;</td></tr>
<tr><th id="164">164</th><td>      <em>int</em> <dfn class="local col3 decl" id="13m_tmp" title='m_tmp' data-type='int' data-ref="13m_tmp" data-ref-filename="13m_tmp">m_tmp</dfn> = (<a class="local col2 ref" href="#12lag_index" title='lag_index' data-ref="12lag_index" data-ref-filename="12lag_index">lag_index</a> &lt; <var>0</var>) ? -<a class="local col2 ref" href="#12lag_index" title='lag_index' data-ref="12lag_index" data-ref-filename="12lag_index">lag_index</a> : <var>0</var>;</td></tr>
<tr><th id="165">165</th><td>      <i>/* Update the damper state for the new sample. */</i></td></tr>
<tr><th id="166">166</th><td>      <b>for</b> (<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a> = <a class="macro" href="settings.h.html#138" title="5" data-ref="_M/PITCH_DAMPORDER">PITCH_DAMPORDER</a> - <var>1</var>; <a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a> &gt; <var>0</var>; --<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>) {</td></tr>
<tr><th id="167">167</th><td>        <b>for</b> (<a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a> = <var>0</var>; <a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a> &lt; <var>4</var>; ++<a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a>) {</td></tr>
<tr><th id="168">168</th><td>          <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::damper_state_dg" title='(anonymous struct)::damper_state_dg' data-use='w' data-ref="(anonymous)::damper_state_dg" data-ref-filename="(anonymous)..damper_state_dg">damper_state_dg</a>[<a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a>][<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>] =</td></tr>
<tr><th id="169">169</th><td>              <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::damper_state_dg" title='(anonymous struct)::damper_state_dg' data-use='r' data-ref="(anonymous)::damper_state_dg" data-ref-filename="(anonymous)..damper_state_dg">damper_state_dg</a>[<a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a>][<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a> - <var>1</var>];</td></tr>
<tr><th id="170">170</th><td>        }</td></tr>
<tr><th id="171">171</th><td>      }</td></tr>
<tr><th id="172">172</th><td></td></tr>
<tr><th id="173">173</th><td>      <b>for</b> (<a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a> = <var>0</var>; <a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a> &lt; <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::sub_frame" title='(anonymous struct)::sub_frame' data-use='r' data-ref="(anonymous)::sub_frame" data-ref-filename="(anonymous)..sub_frame">sub_frame</a> + <var>1</var>; ++<a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a>) {</td></tr>
<tr><th id="174">174</th><td>        <i>/* Filter for fractional pitch. */</i></td></tr>
<tr><th id="175">175</th><td>        <a class="local col9 ref" href="#9sum2" title='sum2' data-ref="9sum2" data-ref-filename="9sum2">sum2</a> = <var>0.0</var>;</td></tr>
<tr><th id="176">176</th><td>        <b>for</b> (<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a> = <a class="macro" href="settings.h.html#137" title="9" data-ref="_M/PITCH_FRACORDER">PITCH_FRACORDER</a>-<var>1</var>; <a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a> &gt;= <a class="local col3 ref" href="#13m_tmp" title='m_tmp' data-ref="13m_tmp" data-ref-filename="13m_tmp">m_tmp</a>; --<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>) {</td></tr>
<tr><th id="177">177</th><td>          <i>/* |lag_index + m| is always larger than or equal to zero, see how</i></td></tr>
<tr><th id="178">178</th><td><i>           * m_tmp is computed. This is equivalent to assume samples outside</i></td></tr>
<tr><th id="179">179</th><td><i>           * |out_dg[j]| are zero. */</i></td></tr>
<tr><th id="180">180</th><td>          <a class="local col9 ref" href="#9sum2" title='sum2' data-ref="9sum2" data-ref-filename="9sum2">sum2</a> += <a class="local col4 ref" href="#4out_dg" title='out_dg' data-ref="4out_dg" data-ref-filename="4out_dg">out_dg</a>[<a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a>][<a class="local col2 ref" href="#12lag_index" title='lag_index' data-ref="12lag_index" data-ref-filename="12lag_index">lag_index</a> + <a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>] * <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::interpol_coeff" title='(anonymous struct)::interpol_coeff' data-use='r' data-ref="(anonymous)::interpol_coeff" data-ref-filename="(anonymous)..interpol_coeff">interpol_coeff</a>[<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>];</td></tr>
<tr><th id="181">181</th><td>        }</td></tr>
<tr><th id="182">182</th><td>        <i>/* Add the contribution of differential gain change. */</i></td></tr>
<tr><th id="183">183</th><td>        <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::damper_state_dg" title='(anonymous struct)::damper_state_dg' data-use='w' data-ref="(anonymous)::damper_state_dg" data-ref-filename="(anonymous)..damper_state_dg">damper_state_dg</a>[<a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a>][<var>0</var>] = <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::gain_mult" title='(anonymous struct)::gain_mult' data-use='r' data-ref="(anonymous)::gain_mult" data-ref-filename="(anonymous)..gain_mult">gain_mult</a>[<a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a>] * <a class="local col8 ref" href="#8sum" title='sum' data-ref="8sum" data-ref-filename="8sum">sum</a> +</td></tr>
<tr><th id="184">184</th><td>            <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::gain" title='(anonymous struct)::gain' data-use='r' data-ref="(anonymous)::gain" data-ref-filename="(anonymous)..gain">gain</a> * <a class="local col9 ref" href="#9sum2" title='sum2' data-ref="9sum2" data-ref-filename="9sum2">sum2</a>;</td></tr>
<tr><th id="185">185</th><td>      }</td></tr>
<tr><th id="186">186</th><td></td></tr>
<tr><th id="187">187</th><td>      <i>/* Filter with damping filter, and store the results. */</i></td></tr>
<tr><th id="188">188</th><td>      <b>for</b> (<a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a> = <var>0</var>; <a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a> &lt; <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::sub_frame" title='(anonymous struct)::sub_frame' data-use='r' data-ref="(anonymous)::sub_frame" data-ref-filename="(anonymous)..sub_frame">sub_frame</a> + <var>1</var>; ++<a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a>) {</td></tr>
<tr><th id="189">189</th><td>        <a class="local col8 ref" href="#8sum" title='sum' data-ref="8sum" data-ref-filename="8sum">sum</a> = <var>0.0</var>;</td></tr>
<tr><th id="190">190</th><td>        <b>for</b> (<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a> = <var>0</var>; <a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a> &lt; <a class="macro" href="settings.h.html#138" title="5" data-ref="_M/PITCH_DAMPORDER">PITCH_DAMPORDER</a>; ++<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>) {</td></tr>
<tr><th id="191">191</th><td>          <a class="local col8 ref" href="#8sum" title='sum' data-ref="8sum" data-ref-filename="8sum">sum</a> -= <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::damper_state_dg" title='(anonymous struct)::damper_state_dg' data-use='r' data-ref="(anonymous)::damper_state_dg" data-ref-filename="(anonymous)..damper_state_dg">damper_state_dg</a>[<a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a>][<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>] * <a class="tu ref" href="#kDampFilter" title='kDampFilter' data-use='r' data-ref="kDampFilter" data-ref-filename="kDampFilter">kDampFilter</a>[<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>];</td></tr>
<tr><th id="192">192</th><td>        }</td></tr>
<tr><th id="193">193</th><td>        <a class="local col4 ref" href="#4out_dg" title='out_dg' data-ref="4out_dg" data-ref-filename="4out_dg">out_dg</a>[<a class="local col7 ref" href="#7j" title='j' data-ref="7j" data-ref-filename="7j">j</a>][<a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::index" title='(anonymous struct)::index' data-use='r' data-ref="(anonymous)::index" data-ref-filename="(anonymous)..index">index</a>] = <a class="local col8 ref" href="#8sum" title='sum' data-ref="8sum" data-ref-filename="8sum">sum</a>;</td></tr>
<tr><th id="194">194</th><td>      }</td></tr>
<tr><th id="195">195</th><td>    }</td></tr>
<tr><th id="196">196</th><td>    <i>/* Filter with damping filter. */</i></td></tr>
<tr><th id="197">197</th><td>    <a class="local col8 ref" href="#8sum" title='sum' data-ref="8sum" data-ref-filename="8sum">sum</a> = <var>0.0</var>;</td></tr>
<tr><th id="198">198</th><td>    <b>for</b> (<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a> = <var>0</var>; <a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a> &lt; <a class="macro" href="settings.h.html#138" title="5" data-ref="_M/PITCH_DAMPORDER">PITCH_DAMPORDER</a>; ++<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>) {</td></tr>
<tr><th id="199">199</th><td>      <a class="local col8 ref" href="#8sum" title='sum' data-ref="8sum" data-ref-filename="8sum">sum</a> += <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::damper_state" title='(anonymous struct)::damper_state' data-use='r' data-ref="(anonymous)::damper_state" data-ref-filename="(anonymous)..damper_state">damper_state</a>[<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>] * <a class="tu ref" href="#kDampFilter" title='kDampFilter' data-use='r' data-ref="kDampFilter" data-ref-filename="kDampFilter">kDampFilter</a>[<a class="local col6 ref" href="#6m" title='m' data-ref="6m" data-ref-filename="6m">m</a>];</td></tr>
<tr><th id="200">200</th><td>    }</td></tr>
<tr><th id="201">201</th><td></td></tr>
<tr><th id="202">202</th><td>    <i>/* Subtract from input and update buffer. */</i></td></tr>
<tr><th id="203">203</th><td>    <a class="local col3 ref" href="#3out_data" title='out_data' data-ref="3out_data" data-ref-filename="3out_data">out_data</a>[<a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::index" title='(anonymous struct)::index' data-use='r' data-ref="(anonymous)::index" data-ref-filename="(anonymous)..index">index</a>] = <a class="local col1 ref" href="#1in_data" title='in_data' data-ref="1in_data" data-ref-filename="1in_data">in_data</a>[<a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::index" title='(anonymous struct)::index' data-use='r' data-ref="(anonymous)::index" data-ref-filename="(anonymous)..index">index</a>] - <a class="local col8 ref" href="#8sum" title='sum' data-ref="8sum" data-ref-filename="8sum">sum</a>;</td></tr>
<tr><th id="204">204</th><td>    <a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::buffer" title='(anonymous struct)::buffer' data-use='w' data-ref="(anonymous)::buffer" data-ref-filename="(anonymous)..buffer">buffer</a>[<a class="local col0 ref" href="#10pos" title='pos' data-ref="10pos" data-ref-filename="10pos">pos</a>] = <a class="local col1 ref" href="#1in_data" title='in_data' data-ref="1in_data" data-ref-filename="1in_data">in_data</a>[<a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::index" title='(anonymous struct)::index' data-use='r' data-ref="(anonymous)::index" data-ref-filename="(anonymous)..index">index</a>] +</td></tr>
<tr><th id="205">205</th><td>        <a class="local col3 ref" href="#3out_data" title='out_data' data-ref="3out_data" data-ref-filename="3out_data">out_data</a>[<a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::index" title='(anonymous struct)::index' data-use='r' data-ref="(anonymous)::index" data-ref-filename="(anonymous)..index">index</a>];</td></tr>
<tr><th id="206">206</th><td></td></tr>
<tr><th id="207">207</th><td>    ++<a class="local col2 ref" href="#2parameters" title='parameters' data-ref="2parameters" data-ref-filename="2parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::index" title='(anonymous struct)::index' data-use='w' data-ref="(anonymous)::index" data-ref-filename="(anonymous)..index">index</a>;</td></tr>
<tr><th id="208">208</th><td>    ++<a class="local col0 ref" href="#10pos" title='pos' data-ref="10pos" data-ref-filename="10pos">pos</a>;</td></tr>
<tr><th id="209">209</th><td>    ++<a class="local col1 ref" href="#11pos_lag" title='pos_lag' data-ref="11pos_lag" data-ref-filename="11pos_lag">pos_lag</a>;</td></tr>
<tr><th id="210">210</th><td>  }</td></tr>
<tr><th id="211">211</th><td>  <b>return</b>;</td></tr>
<tr><th id="212">212</th><td>}</td></tr>
<tr><th id="213">213</th><td></td></tr>
<tr><th id="214">214</th><td><i  data-doc="Update">/* Update filter parameters based on the pitch-gains and pitch-lags. */</i></td></tr>
<tr><th id="215">215</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="Update" title='Update' data-type='void Update(PitchFilterParam * parameters)' data-ref="Update" data-ref-filename="Update">Update</dfn>(<a class="typedef" href="#PitchFilterParam" title='PitchFilterParam' data-type='struct PitchFilterParam' data-ref="PitchFilterParam" data-ref-filename="PitchFilterParam">PitchFilterParam</a>* <dfn class="local col4 decl" id="14parameters" title='parameters' data-type='PitchFilterParam *' data-ref="14parameters" data-ref-filename="14parameters">parameters</dfn>) {</td></tr>
<tr><th id="216">216</th><td>  <em>double</em> <dfn class="local col5 decl" id="15fraction" title='fraction' data-type='double' data-ref="15fraction" data-ref-filename="15fraction">fraction</dfn>;</td></tr>
<tr><th id="217">217</th><td>  <em>int</em> <dfn class="local col6 decl" id="16fraction_index" title='fraction_index' data-type='int' data-ref="16fraction_index" data-ref-filename="16fraction_index">fraction_index</dfn>;</td></tr>
<tr><th id="218">218</th><td>  <i>/* Compute integer lag-offset. */</i></td></tr>
<tr><th id="219">219</th><td>  <a class="local col4 ref" href="#14parameters" title='parameters' data-ref="14parameters" data-ref-filename="14parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::lag_offset" title='(anonymous struct)::lag_offset' data-use='w' data-ref="(anonymous)::lag_offset" data-ref-filename="(anonymous)..lag_offset">lag_offset</a> = <a class="macro" href="os_specific_inline.h.html#19" title="lrint" data-ref="_M/WebRtcIsac_lrint">WebRtcIsac_lrint</a>(<a class="local col4 ref" href="#14parameters" title='parameters' data-ref="14parameters" data-ref-filename="14parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::lag" title='(anonymous struct)::lag' data-use='r' data-ref="(anonymous)::lag" data-ref-filename="(anonymous)..lag">lag</a> + <a class="macro" href="settings.h.html#139" title="1.5f" data-ref="_M/PITCH_FILTDELAY">PITCH_FILTDELAY</a> +</td></tr>
<tr><th id="220">220</th><td>                                            <var>0.5</var>);</td></tr>
<tr><th id="221">221</th><td>  <i>/* Find correct set of coefficients for computing fractional pitch. */</i></td></tr>
<tr><th id="222">222</th><td>  <a class="local col5 ref" href="#15fraction" title='fraction' data-ref="15fraction" data-ref-filename="15fraction">fraction</a> = <a class="local col4 ref" href="#14parameters" title='parameters' data-ref="14parameters" data-ref-filename="14parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::lag_offset" title='(anonymous struct)::lag_offset' data-use='r' data-ref="(anonymous)::lag_offset" data-ref-filename="(anonymous)..lag_offset">lag_offset</a> - (<a class="local col4 ref" href="#14parameters" title='parameters' data-ref="14parameters" data-ref-filename="14parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::lag" title='(anonymous struct)::lag' data-use='r' data-ref="(anonymous)::lag" data-ref-filename="(anonymous)..lag">lag</a> + <a class="macro" href="settings.h.html#139" title="1.5f" data-ref="_M/PITCH_FILTDELAY">PITCH_FILTDELAY</a>);</td></tr>
<tr><th id="223">223</th><td>  <a class="local col6 ref" href="#16fraction_index" title='fraction_index' data-ref="16fraction_index" data-ref-filename="16fraction_index">fraction_index</a> = <a class="macro" href="os_specific_inline.h.html#19" title="lrint" data-ref="_M/WebRtcIsac_lrint">WebRtcIsac_lrint</a>(<a class="macro" href="settings.h.html#136" title="8" data-ref="_M/PITCH_FRACS">PITCH_FRACS</a> * <a class="local col5 ref" href="#15fraction" title='fraction' data-ref="15fraction" data-ref-filename="15fraction">fraction</a> - <var>0.5</var>);</td></tr>
<tr><th id="224">224</th><td>  <a class="local col4 ref" href="#14parameters" title='parameters' data-ref="14parameters" data-ref-filename="14parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::interpol_coeff" title='(anonymous struct)::interpol_coeff' data-use='w' data-ref="(anonymous)::interpol_coeff" data-ref-filename="(anonymous)..interpol_coeff">interpol_coeff</a> = <a class="tu ref" href="#kIntrpCoef" title='kIntrpCoef' data-use='r' data-ref="kIntrpCoef" data-ref-filename="kIntrpCoef">kIntrpCoef</a>[<a class="local col6 ref" href="#16fraction_index" title='fraction_index' data-ref="16fraction_index" data-ref-filename="16fraction_index">fraction_index</a>];</td></tr>
<tr><th id="225">225</th><td></td></tr>
<tr><th id="226">226</th><td>  <b>if</b> (<a class="local col4 ref" href="#14parameters" title='parameters' data-ref="14parameters" data-ref-filename="14parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::mode" title='(anonymous struct)::mode' data-use='r' data-ref="(anonymous)::mode" data-ref-filename="(anonymous)..mode">mode</a> == <a class="enum" href="#kPitchFilterPreGain" title='kPitchFilterPreGain' data-ref="kPitchFilterPreGain" data-ref-filename="kPitchFilterPreGain">kPitchFilterPreGain</a>) {</td></tr>
<tr><th id="227">227</th><td>    <i>/* If in this mode make a differential change to pitch gain. */</i></td></tr>
<tr><th id="228">228</th><td>    <a class="local col4 ref" href="#14parameters" title='parameters' data-ref="14parameters" data-ref-filename="14parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::gain_mult" title='(anonymous struct)::gain_mult' data-use='w' data-ref="(anonymous)::gain_mult" data-ref-filename="(anonymous)..gain_mult">gain_mult</a>[<a class="local col4 ref" href="#14parameters" title='parameters' data-ref="14parameters" data-ref-filename="14parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::sub_frame" title='(anonymous struct)::sub_frame' data-use='r' data-ref="(anonymous)::sub_frame" data-ref-filename="(anonymous)..sub_frame">sub_frame</a>] += <var>0.2</var>;</td></tr>
<tr><th id="229">229</th><td>    <b>if</b> (<a class="local col4 ref" href="#14parameters" title='parameters' data-ref="14parameters" data-ref-filename="14parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::gain_mult" title='(anonymous struct)::gain_mult' data-use='r' data-ref="(anonymous)::gain_mult" data-ref-filename="(anonymous)..gain_mult">gain_mult</a>[<a class="local col4 ref" href="#14parameters" title='parameters' data-ref="14parameters" data-ref-filename="14parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::sub_frame" title='(anonymous struct)::sub_frame' data-use='r' data-ref="(anonymous)::sub_frame" data-ref-filename="(anonymous)..sub_frame">sub_frame</a>] &gt; <var>1.0</var>) {</td></tr>
<tr><th id="230">230</th><td>      <a class="local col4 ref" href="#14parameters" title='parameters' data-ref="14parameters" data-ref-filename="14parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::gain_mult" title='(anonymous struct)::gain_mult' data-use='w' data-ref="(anonymous)::gain_mult" data-ref-filename="(anonymous)..gain_mult">gain_mult</a>[<a class="local col4 ref" href="#14parameters" title='parameters' data-ref="14parameters" data-ref-filename="14parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::sub_frame" title='(anonymous struct)::sub_frame' data-use='r' data-ref="(anonymous)::sub_frame" data-ref-filename="(anonymous)..sub_frame">sub_frame</a>] = <var>1.0</var>;</td></tr>
<tr><th id="231">231</th><td>    }</td></tr>
<tr><th id="232">232</th><td>    <b>if</b> (<a class="local col4 ref" href="#14parameters" title='parameters' data-ref="14parameters" data-ref-filename="14parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::sub_frame" title='(anonymous struct)::sub_frame' data-use='r' data-ref="(anonymous)::sub_frame" data-ref-filename="(anonymous)..sub_frame">sub_frame</a> &gt; <var>0</var>) {</td></tr>
<tr><th id="233">233</th><td>      <a class="local col4 ref" href="#14parameters" title='parameters' data-ref="14parameters" data-ref-filename="14parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::gain_mult" title='(anonymous struct)::gain_mult' data-use='w' data-ref="(anonymous)::gain_mult" data-ref-filename="(anonymous)..gain_mult">gain_mult</a>[<a class="local col4 ref" href="#14parameters" title='parameters' data-ref="14parameters" data-ref-filename="14parameters">parameters</a>-&gt;<a class="tu ref field" href="#(anonymous)::sub_frame" title='(anonymous struct)::sub_frame' data-use='r' data-ref="(anonymous)::sub_frame" data-ref-filename="(anonymous)..sub_frame">sub_frame</a> - <var>1</var>] -= <var>0.2</var>;</td></tr>
<tr><th id="234">234</th><td>    }</td></tr>
<tr><th id="235">235</th><td>  }</td></tr>
<tr><th id="236">236</th><td>}</td></tr>
<tr><th id="237">237</th><td></td></tr>
<tr><th id="238">238</th><td><i  data-doc="FilterFrame">/******************************************************************************</i></td></tr>
<tr><th id="239">239</th><td><i  data-doc="FilterFrame"> * FilterFrame()</i></td></tr>
<tr><th id="240">240</th><td><i  data-doc="FilterFrame"> * Filter a frame of 30 millisecond, given pitch-lags and pitch-gains.</i></td></tr>
<tr><th id="241">241</th><td><i  data-doc="FilterFrame"> *</i></td></tr>
<tr><th id="242">242</th><td><i  data-doc="FilterFrame"> * Inputs</i></td></tr>
<tr><th id="243">243</th><td><i  data-doc="FilterFrame"> *   in_data     : pointer to the input signal of 30 ms at 8 kHz sample-rate.</i></td></tr>
<tr><th id="244">244</th><td><i  data-doc="FilterFrame"> *   lags        : pointer to pitch-lags, 4 lags per frame.</i></td></tr>
<tr><th id="245">245</th><td><i  data-doc="FilterFrame"> *   gains       : pointer to pitch-gians, 4 gains per frame.</i></td></tr>
<tr><th id="246">246</th><td><i  data-doc="FilterFrame"> *   mode        : defining the functionality of the filter. It takes the</i></td></tr>
<tr><th id="247">247</th><td><i  data-doc="FilterFrame"> *                 following values.</i></td></tr>
<tr><th id="248">248</th><td><i  data-doc="FilterFrame"> *                 kPitchFilterPre:     Pitch pre-filter, used at encoder.</i></td></tr>
<tr><th id="249">249</th><td><i  data-doc="FilterFrame"> *                 kPitchFilterPost:    Pitch post-filter, used at decoder.</i></td></tr>
<tr><th id="250">250</th><td><i  data-doc="FilterFrame"> *                 kPitchFilterPreLa:   Pitch pre-filter with lookahead.</i></td></tr>
<tr><th id="251">251</th><td><i  data-doc="FilterFrame"> *                 kPitchFilterPreGain: Pitch pre-filter used to otain optimal</i></td></tr>
<tr><th id="252">252</th><td><i  data-doc="FilterFrame"> *                                      pitch-gains.</i></td></tr>
<tr><th id="253">253</th><td><i  data-doc="FilterFrame"> *</i></td></tr>
<tr><th id="254">254</th><td><i  data-doc="FilterFrame"> * Outputs</i></td></tr>
<tr><th id="255">255</th><td><i  data-doc="FilterFrame"> *   out_data    : pointer to a buffer where the filtered signal is written to.</i></td></tr>
<tr><th id="256">256</th><td><i  data-doc="FilterFrame"> *   out_dg      : [only used in kPitchFilterPreGain] pointer to a buffer</i></td></tr>
<tr><th id="257">257</th><td><i  data-doc="FilterFrame"> *                 where the output of different gain values (differential</i></td></tr>
<tr><th id="258">258</th><td><i  data-doc="FilterFrame"> *                 change to gain) is written.</i></td></tr>
<tr><th id="259">259</th><td><i  data-doc="FilterFrame"> */</i></td></tr>
<tr><th id="260">260</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="FilterFrame" title='FilterFrame' data-type='void FilterFrame(const double * in_data, PitchFiltstr * filter_state, double * lags, double * gains, PitchFilterOperation mode, double * out_data, double (*)[264] out_dg)' data-ref="FilterFrame" data-ref-filename="FilterFrame">FilterFrame</dfn>(<em>const</em> <em>double</em>* <dfn class="local col7 decl" id="17in_data" title='in_data' data-type='const double *' data-ref="17in_data" data-ref-filename="17in_data">in_data</dfn>, <a class="typedef" href="structs.h.html#PitchFiltstr" title='PitchFiltstr' data-type='struct PitchFiltstr' data-ref="PitchFiltstr" data-ref-filename="PitchFiltstr">PitchFiltstr</a>* <dfn class="local col8 decl" id="18filter_state" title='filter_state' data-type='PitchFiltstr *' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</dfn>,</td></tr>
<tr><th id="261">261</th><td>                        <em>double</em>* <dfn class="local col9 decl" id="19lags" title='lags' data-type='double *' data-ref="19lags" data-ref-filename="19lags">lags</dfn>, <em>double</em>* <dfn class="local col0 decl" id="20gains" title='gains' data-type='double *' data-ref="20gains" data-ref-filename="20gains">gains</dfn>, <a class="typedef" href="#PitchFilterOperation" title='PitchFilterOperation' data-type='enum PitchFilterOperation' data-ref="PitchFilterOperation" data-ref-filename="PitchFilterOperation">PitchFilterOperation</a> <dfn class="local col1 decl" id="21mode" title='mode' data-type='PitchFilterOperation' data-ref="21mode" data-ref-filename="21mode">mode</dfn>,</td></tr>
<tr><th id="262">262</th><td>                        <em>double</em>* <dfn class="local col2 decl" id="22out_data" title='out_data' data-type='double *' data-ref="22out_data" data-ref-filename="22out_data">out_data</dfn>,</td></tr>
<tr><th id="263">263</th><td>                        <em>double</em> <dfn class="local col3 decl" id="23out_dg" title='out_dg' data-type='double (*)[264]' data-ref="23out_dg" data-ref-filename="23out_dg">out_dg</dfn>[][<a class="macro" href="settings.h.html#106" title="(240)" data-ref="_M/PITCH_FRAME_LEN">PITCH_FRAME_LEN</a> + <a class="macro" href="settings.h.html#54" title="24" data-ref="_M/QLOOKAHEAD">QLOOKAHEAD</a>]) {</td></tr>
<tr><th id="264">264</th><td>  <a class="typedef" href="#PitchFilterParam" title='PitchFilterParam' data-type='struct PitchFilterParam' data-ref="PitchFilterParam" data-ref-filename="PitchFilterParam">PitchFilterParam</a> <dfn class="local col4 decl" id="24filter_parameters" title='filter_parameters' data-type='PitchFilterParam' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</dfn>;</td></tr>
<tr><th id="265">265</th><td>  <em>double</em> <dfn class="local col5 decl" id="25gain_delta" title='gain_delta' data-type='double' data-ref="25gain_delta" data-ref-filename="25gain_delta">gain_delta</dfn>, <dfn class="local col6 decl" id="26lag_delta" title='lag_delta' data-type='double' data-ref="26lag_delta" data-ref-filename="26lag_delta">lag_delta</dfn>;</td></tr>
<tr><th id="266">266</th><td>  <em>double</em> <dfn class="local col7 decl" id="27old_lag" title='old_lag' data-type='double' data-ref="27old_lag" data-ref-filename="27old_lag">old_lag</dfn>, <dfn class="local col8 decl" id="28old_gain" title='old_gain' data-type='double' data-ref="28old_gain" data-ref-filename="28old_gain">old_gain</dfn>;</td></tr>
<tr><th id="267">267</th><td>  <em>int</em> <dfn class="local col9 decl" id="29n" title='n' data-type='int' data-ref="29n" data-ref-filename="29n">n</dfn>;</td></tr>
<tr><th id="268">268</th><td>  <em>int</em> <dfn class="local col0 decl" id="30m" title='m' data-type='int' data-ref="30m" data-ref-filename="30m">m</dfn>;</td></tr>
<tr><th id="269">269</th><td>  <em>const</em> <em>double</em> <dfn class="local col1 decl" id="31kEnhancer" title='kEnhancer' data-type='const double' data-ref="31kEnhancer" data-ref-filename="31kEnhancer">kEnhancer</dfn> = <var>1.3</var>;</td></tr>
<tr><th id="270">270</th><td></td></tr>
<tr><th id="271">271</th><td>  <i>/* Set up buffer and states. */</i></td></tr>
<tr><th id="272">272</th><td>  <a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::index" title='(anonymous struct)::index' data-use='w' data-ref="(anonymous)::index" data-ref-filename="(anonymous)..index">index</a> = <var>0</var>;</td></tr>
<tr><th id="273">273</th><td>  <a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::lag_offset" title='(anonymous struct)::lag_offset' data-use='w' data-ref="(anonymous)::lag_offset" data-ref-filename="(anonymous)..lag_offset">lag_offset</a> = <var>0</var>;</td></tr>
<tr><th id="274">274</th><td>  <a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::mode" title='(anonymous struct)::mode' data-use='w' data-ref="(anonymous)::mode" data-ref-filename="(anonymous)..mode">mode</a> = <a class="local col1 ref" href="#21mode" title='mode' data-ref="21mode" data-ref-filename="21mode">mode</a>;</td></tr>
<tr><th id="275">275</th><td>  <i>/* Copy states to local variables. */</i></td></tr>
<tr><th id="276">276</th><td>  <span class="macro" title="__builtin___memcpy_chk (filter_parameters.buffer, filter_state-&gt;ubuf, sizeof(filter_state-&gt;ubuf), __builtin_object_size (filter_parameters.buffer, 0))" data-ref="_M/memcpy">memcpy</span>(<a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::buffer" title='(anonymous struct)::buffer' data-use='r' data-ref="(anonymous)::buffer" data-ref-filename="(anonymous)..buffer">buffer</a>, <a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::ubuf" title='(anonymous struct)::ubuf' data-ref="(anonymous)::ubuf" data-ref-filename="(anonymous)..ubuf">ubuf</a>,</td></tr>
<tr><th id="277">277</th><td>         <b>sizeof</b>(<a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::ubuf" title='(anonymous struct)::ubuf' data-ref="(anonymous)::ubuf" data-ref-filename="(anonymous)..ubuf">ubuf</a>));</td></tr>
<tr><th id="278">278</th><td>  <a class="macro" href="../../../../../../rtc_base/compile_assert_c.h.html#19" title="switch (0) { case 0: case sizeof(filter_parameters.buffer) &gt;= sizeof(filter_state-&gt;ubuf):; }" data-ref="_M/RTC_COMPILE_ASSERT">RTC_COMPILE_ASSERT</a>(<b>sizeof</b>(<a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::buffer" title='(anonymous struct)::buffer' data-use='r' data-ref="(anonymous)::buffer" data-ref-filename="(anonymous)..buffer">buffer</a>) &gt;=</td></tr>
<tr><th id="279">279</th><td>                 <b>sizeof</b>(<a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::ubuf" title='(anonymous struct)::ubuf' data-ref="(anonymous)::ubuf" data-ref-filename="(anonymous)..ubuf">ubuf</a>));</td></tr>
<tr><th id="280">280</th><td>  <span class="macro" title="__builtin___memset_chk (filter_parameters.buffer + sizeof(filter_state-&gt;ubuf) / sizeof(filter_state-&gt;ubuf[0]), 0, sizeof(filter_parameters.buffer) - sizeof(filter_state-&gt;ubuf), __builtin_object_size (filter_parameters.buffer + sizeof(filter_state-&gt;ubuf) / sizeof(filter_state-&gt;ubuf[0]), 0))" data-ref="_M/memset">memset</span>(<a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::buffer" title='(anonymous struct)::buffer' data-use='r' data-ref="(anonymous)::buffer" data-ref-filename="(anonymous)..buffer">buffer</a> +</td></tr>
<tr><th id="281">281</th><td>             <b>sizeof</b>(<a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::ubuf" title='(anonymous struct)::ubuf' data-ref="(anonymous)::ubuf" data-ref-filename="(anonymous)..ubuf">ubuf</a>) / <b>sizeof</b>(<a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::ubuf" title='(anonymous struct)::ubuf' data-ref="(anonymous)::ubuf" data-ref-filename="(anonymous)..ubuf">ubuf</a>[<var>0</var>]),</td></tr>
<tr><th id="282">282</th><td>         <var>0</var>, <b>sizeof</b>(<a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::buffer" title='(anonymous struct)::buffer' data-use='r' data-ref="(anonymous)::buffer" data-ref-filename="(anonymous)..buffer">buffer</a>) - <b>sizeof</b>(<a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::ubuf" title='(anonymous struct)::ubuf' data-ref="(anonymous)::ubuf" data-ref-filename="(anonymous)..ubuf">ubuf</a>));</td></tr>
<tr><th id="283">283</th><td>  <span class="macro" title="__builtin___memcpy_chk (filter_parameters.damper_state, filter_state-&gt;ystate, sizeof(filter_state-&gt;ystate), __builtin_object_size (filter_parameters.damper_state, 0))" data-ref="_M/memcpy">memcpy</span>(<a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::damper_state" title='(anonymous struct)::damper_state' data-use='r' data-ref="(anonymous)::damper_state" data-ref-filename="(anonymous)..damper_state">damper_state</a>, <a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::ystate" title='(anonymous struct)::ystate' data-ref="(anonymous)::ystate" data-ref-filename="(anonymous)..ystate">ystate</a>,</td></tr>
<tr><th id="284">284</th><td>         <b>sizeof</b>(<a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::ystate" title='(anonymous struct)::ystate' data-ref="(anonymous)::ystate" data-ref-filename="(anonymous)..ystate">ystate</a>));</td></tr>
<tr><th id="285">285</th><td></td></tr>
<tr><th id="286">286</th><td>  <b>if</b> (<a class="local col1 ref" href="#21mode" title='mode' data-ref="21mode" data-ref-filename="21mode">mode</a> == <a class="enum" href="#kPitchFilterPreGain" title='kPitchFilterPreGain' data-ref="kPitchFilterPreGain" data-ref-filename="kPitchFilterPreGain">kPitchFilterPreGain</a>) {</td></tr>
<tr><th id="287">287</th><td>    <i>/* Clear buffers. */</i></td></tr>
<tr><th id="288">288</th><td>    <span class="macro" title="__builtin___memset_chk (filter_parameters.gain_mult, 0, sizeof(filter_parameters.gain_mult), __builtin_object_size (filter_parameters.gain_mult, 0))" data-ref="_M/memset">memset</span>(<a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::gain_mult" title='(anonymous struct)::gain_mult' data-use='r' data-ref="(anonymous)::gain_mult" data-ref-filename="(anonymous)..gain_mult">gain_mult</a>, <var>0</var>, <b>sizeof</b>(<a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::gain_mult" title='(anonymous struct)::gain_mult' data-use='r' data-ref="(anonymous)::gain_mult" data-ref-filename="(anonymous)..gain_mult">gain_mult</a>));</td></tr>
<tr><th id="289">289</th><td>    <span class="macro" title="__builtin___memset_chk (filter_parameters.damper_state_dg, 0, sizeof(filter_parameters.damper_state_dg), __builtin_object_size (filter_parameters.damper_state_dg, 0))" data-ref="_M/memset">memset</span>(<a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::damper_state_dg" title='(anonymous struct)::damper_state_dg' data-use='r' data-ref="(anonymous)::damper_state_dg" data-ref-filename="(anonymous)..damper_state_dg">damper_state_dg</a>, <var>0</var>,</td></tr>
<tr><th id="290">290</th><td>           <b>sizeof</b>(<a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::damper_state_dg" title='(anonymous struct)::damper_state_dg' data-use='r' data-ref="(anonymous)::damper_state_dg" data-ref-filename="(anonymous)..damper_state_dg">damper_state_dg</a>));</td></tr>
<tr><th id="291">291</th><td>    <b>for</b> (<a class="local col9 ref" href="#29n" title='n' data-ref="29n" data-ref-filename="29n">n</a> = <var>0</var>; <a class="local col9 ref" href="#29n" title='n' data-ref="29n" data-ref-filename="29n">n</a> &lt; <a class="macro" href="settings.h.html#116" title="4" data-ref="_M/PITCH_SUBFRAMES">PITCH_SUBFRAMES</a>; ++<a class="local col9 ref" href="#29n" title='n' data-ref="29n" data-ref-filename="29n">n</a>) {</td></tr>
<tr><th id="292">292</th><td>      <i>//memset(out_dg[n], 0, sizeof(double) * (PITCH_FRAME_LEN + QLOOKAHEAD));</i></td></tr>
<tr><th id="293">293</th><td>      <span class="macro" title="__builtin___memset_chk (out_dg[n], 0, sizeof(out_dg[n]), __builtin_object_size (out_dg[n], 0))" data-ref="_M/memset">memset</span>(<a class="local col3 ref" href="#23out_dg" title='out_dg' data-ref="23out_dg" data-ref-filename="23out_dg">out_dg</a>[<a class="local col9 ref" href="#29n" title='n' data-ref="29n" data-ref-filename="29n">n</a>], <var>0</var>, <b>sizeof</b>(<a class="local col3 ref" href="#23out_dg" title='out_dg' data-ref="23out_dg" data-ref-filename="23out_dg">out_dg</a>[<a class="local col9 ref" href="#29n" title='n' data-ref="29n" data-ref-filename="29n">n</a>]));</td></tr>
<tr><th id="294">294</th><td>    }</td></tr>
<tr><th id="295">295</th><td>  } <b>else</b> <b>if</b> (<a class="local col1 ref" href="#21mode" title='mode' data-ref="21mode" data-ref-filename="21mode">mode</a> == <a class="enum" href="#kPitchFilterPost" title='kPitchFilterPost' data-ref="kPitchFilterPost" data-ref-filename="kPitchFilterPost">kPitchFilterPost</a>) {</td></tr>
<tr><th id="296">296</th><td>    <i>/* Make output more periodic. Negative sign is to change the structure</i></td></tr>
<tr><th id="297">297</th><td><i>     * of the filter. */</i></td></tr>
<tr><th id="298">298</th><td>    <b>for</b> (<a class="local col9 ref" href="#29n" title='n' data-ref="29n" data-ref-filename="29n">n</a> = <var>0</var>; <a class="local col9 ref" href="#29n" title='n' data-ref="29n" data-ref-filename="29n">n</a> &lt; <a class="macro" href="settings.h.html#116" title="4" data-ref="_M/PITCH_SUBFRAMES">PITCH_SUBFRAMES</a>; ++<a class="local col9 ref" href="#29n" title='n' data-ref="29n" data-ref-filename="29n">n</a>) {</td></tr>
<tr><th id="299">299</th><td>      <a class="local col0 ref" href="#20gains" title='gains' data-ref="20gains" data-ref-filename="20gains">gains</a>[<a class="local col9 ref" href="#29n" title='n' data-ref="29n" data-ref-filename="29n">n</a>] *= -<a class="local col1 ref" href="#31kEnhancer" title='kEnhancer' data-ref="31kEnhancer" data-ref-filename="31kEnhancer">kEnhancer</a>;</td></tr>
<tr><th id="300">300</th><td>    }</td></tr>
<tr><th id="301">301</th><td>  }</td></tr>
<tr><th id="302">302</th><td></td></tr>
<tr><th id="303">303</th><td>  <a class="local col7 ref" href="#27old_lag" title='old_lag' data-ref="27old_lag" data-ref-filename="27old_lag">old_lag</a> = *<a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::oldlagp" title='(anonymous struct)::oldlagp' data-ref="(anonymous)::oldlagp" data-ref-filename="(anonymous)..oldlagp">oldlagp</a>;</td></tr>
<tr><th id="304">304</th><td>  <a class="local col8 ref" href="#28old_gain" title='old_gain' data-ref="28old_gain" data-ref-filename="28old_gain">old_gain</a> = *<a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::oldgainp" title='(anonymous struct)::oldgainp' data-ref="(anonymous)::oldgainp" data-ref-filename="(anonymous)..oldgainp">oldgainp</a>;</td></tr>
<tr><th id="305">305</th><td></td></tr>
<tr><th id="306">306</th><td>  <i>/* No interpolation if pitch lag step is big. */</i></td></tr>
<tr><th id="307">307</th><td>  <b>if</b> ((<a class="local col9 ref" href="#19lags" title='lags' data-ref="19lags" data-ref-filename="19lags">lags</a>[<var>0</var>] &gt; (<a class="macro" href="settings.h.html#133" title="1.5" data-ref="_M/PITCH_UPSTEP">PITCH_UPSTEP</a> * <a class="local col7 ref" href="#27old_lag" title='old_lag' data-ref="27old_lag" data-ref-filename="27old_lag">old_lag</a>)) ||</td></tr>
<tr><th id="308">308</th><td>      (<a class="local col9 ref" href="#19lags" title='lags' data-ref="19lags" data-ref-filename="19lags">lags</a>[<var>0</var>] &lt; (<a class="macro" href="settings.h.html#135" title="0.67" data-ref="_M/PITCH_DOWNSTEP">PITCH_DOWNSTEP</a> * <a class="local col7 ref" href="#27old_lag" title='old_lag' data-ref="27old_lag" data-ref-filename="27old_lag">old_lag</a>))) {</td></tr>
<tr><th id="309">309</th><td>    <a class="local col7 ref" href="#27old_lag" title='old_lag' data-ref="27old_lag" data-ref-filename="27old_lag">old_lag</a> = <a class="local col9 ref" href="#19lags" title='lags' data-ref="19lags" data-ref-filename="19lags">lags</a>[<var>0</var>];</td></tr>
<tr><th id="310">310</th><td>    <a class="local col8 ref" href="#28old_gain" title='old_gain' data-ref="28old_gain" data-ref-filename="28old_gain">old_gain</a> = <a class="local col0 ref" href="#20gains" title='gains' data-ref="20gains" data-ref-filename="20gains">gains</a>[<var>0</var>];</td></tr>
<tr><th id="311">311</th><td></td></tr>
<tr><th id="312">312</th><td>    <b>if</b> (<a class="local col1 ref" href="#21mode" title='mode' data-ref="21mode" data-ref-filename="21mode">mode</a> == <a class="enum" href="#kPitchFilterPreGain" title='kPitchFilterPreGain' data-ref="kPitchFilterPreGain" data-ref-filename="kPitchFilterPreGain">kPitchFilterPreGain</a>) {</td></tr>
<tr><th id="313">313</th><td>      <a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::gain_mult" title='(anonymous struct)::gain_mult' data-use='w' data-ref="(anonymous)::gain_mult" data-ref-filename="(anonymous)..gain_mult">gain_mult</a>[<var>0</var>] = <var>1.0</var>;</td></tr>
<tr><th id="314">314</th><td>    }</td></tr>
<tr><th id="315">315</th><td>  }</td></tr>
<tr><th id="316">316</th><td></td></tr>
<tr><th id="317">317</th><td>  <a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::num_samples" title='(anonymous struct)::num_samples' data-use='w' data-ref="(anonymous)::num_samples" data-ref-filename="(anonymous)..num_samples">num_samples</a> = <a class="macro" href="settings.h.html#119" title="(((240) / 4) / 5)" data-ref="_M/PITCH_UPDATE">PITCH_UPDATE</a>;</td></tr>
<tr><th id="318">318</th><td>  <b>for</b> (<a class="local col0 ref" href="#30m" title='m' data-ref="30m" data-ref-filename="30m">m</a> = <var>0</var>; <a class="local col0 ref" href="#30m" title='m' data-ref="30m" data-ref-filename="30m">m</a> &lt; <a class="macro" href="settings.h.html#116" title="4" data-ref="_M/PITCH_SUBFRAMES">PITCH_SUBFRAMES</a>; ++<a class="local col0 ref" href="#30m" title='m' data-ref="30m" data-ref-filename="30m">m</a>) {</td></tr>
<tr><th id="319">319</th><td>    <i>/* Set the sub-frame value. */</i></td></tr>
<tr><th id="320">320</th><td>    <a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::sub_frame" title='(anonymous struct)::sub_frame' data-use='w' data-ref="(anonymous)::sub_frame" data-ref-filename="(anonymous)..sub_frame">sub_frame</a> = <a class="local col0 ref" href="#30m" title='m' data-ref="30m" data-ref-filename="30m">m</a>;</td></tr>
<tr><th id="321">321</th><td>    <i>/* Calculate interpolation steps for pitch-lag and pitch-gain. */</i></td></tr>
<tr><th id="322">322</th><td>    <a class="local col6 ref" href="#26lag_delta" title='lag_delta' data-ref="26lag_delta" data-ref-filename="26lag_delta">lag_delta</a> = (<a class="local col9 ref" href="#19lags" title='lags' data-ref="19lags" data-ref-filename="19lags">lags</a>[<a class="local col0 ref" href="#30m" title='m' data-ref="30m" data-ref-filename="30m">m</a>] - <a class="local col7 ref" href="#27old_lag" title='old_lag' data-ref="27old_lag" data-ref-filename="27old_lag">old_lag</a>) / <a class="macro" href="settings.h.html#117" title="5" data-ref="_M/PITCH_GRAN_PER_SUBFRAME">PITCH_GRAN_PER_SUBFRAME</a>;</td></tr>
<tr><th id="323">323</th><td>    <a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::lag" title='(anonymous struct)::lag' data-use='w' data-ref="(anonymous)::lag" data-ref-filename="(anonymous)..lag">lag</a> = <a class="local col7 ref" href="#27old_lag" title='old_lag' data-ref="27old_lag" data-ref-filename="27old_lag">old_lag</a>;</td></tr>
<tr><th id="324">324</th><td>    <a class="local col5 ref" href="#25gain_delta" title='gain_delta' data-ref="25gain_delta" data-ref-filename="25gain_delta">gain_delta</a> = (<a class="local col0 ref" href="#20gains" title='gains' data-ref="20gains" data-ref-filename="20gains">gains</a>[<a class="local col0 ref" href="#30m" title='m' data-ref="30m" data-ref-filename="30m">m</a>] - <a class="local col8 ref" href="#28old_gain" title='old_gain' data-ref="28old_gain" data-ref-filename="28old_gain">old_gain</a>) / <a class="macro" href="settings.h.html#117" title="5" data-ref="_M/PITCH_GRAN_PER_SUBFRAME">PITCH_GRAN_PER_SUBFRAME</a>;</td></tr>
<tr><th id="325">325</th><td>    <a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::gain" title='(anonymous struct)::gain' data-use='w' data-ref="(anonymous)::gain" data-ref-filename="(anonymous)..gain">gain</a> = <a class="local col8 ref" href="#28old_gain" title='old_gain' data-ref="28old_gain" data-ref-filename="28old_gain">old_gain</a>;</td></tr>
<tr><th id="326">326</th><td>    <i>/* Store for the next sub-frame. */</i></td></tr>
<tr><th id="327">327</th><td>    <a class="local col7 ref" href="#27old_lag" title='old_lag' data-ref="27old_lag" data-ref-filename="27old_lag">old_lag</a> = <a class="local col9 ref" href="#19lags" title='lags' data-ref="19lags" data-ref-filename="19lags">lags</a>[<a class="local col0 ref" href="#30m" title='m' data-ref="30m" data-ref-filename="30m">m</a>];</td></tr>
<tr><th id="328">328</th><td>    <a class="local col8 ref" href="#28old_gain" title='old_gain' data-ref="28old_gain" data-ref-filename="28old_gain">old_gain</a> = <a class="local col0 ref" href="#20gains" title='gains' data-ref="20gains" data-ref-filename="20gains">gains</a>[<a class="local col0 ref" href="#30m" title='m' data-ref="30m" data-ref-filename="30m">m</a>];</td></tr>
<tr><th id="329">329</th><td></td></tr>
<tr><th id="330">330</th><td>    <b>for</b> (<a class="local col9 ref" href="#29n" title='n' data-ref="29n" data-ref-filename="29n">n</a> = <var>0</var>; <a class="local col9 ref" href="#29n" title='n' data-ref="29n" data-ref-filename="29n">n</a> &lt; <a class="macro" href="settings.h.html#117" title="5" data-ref="_M/PITCH_GRAN_PER_SUBFRAME">PITCH_GRAN_PER_SUBFRAME</a>; ++<a class="local col9 ref" href="#29n" title='n' data-ref="29n" data-ref-filename="29n">n</a>) {</td></tr>
<tr><th id="331">331</th><td>      <i>/* Step-wise interpolation of pitch gains and lags. As pitch-lag changes,</i></td></tr>
<tr><th id="332">332</th><td><i>       * some parameters of filter need to be update. */</i></td></tr>
<tr><th id="333">333</th><td>      <a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::gain" title='(anonymous struct)::gain' data-use='w' data-ref="(anonymous)::gain" data-ref-filename="(anonymous)..gain">gain</a> += <a class="local col5 ref" href="#25gain_delta" title='gain_delta' data-ref="25gain_delta" data-ref-filename="25gain_delta">gain_delta</a>;</td></tr>
<tr><th id="334">334</th><td>      <a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::lag" title='(anonymous struct)::lag' data-use='w' data-ref="(anonymous)::lag" data-ref-filename="(anonymous)..lag">lag</a> += <a class="local col6 ref" href="#26lag_delta" title='lag_delta' data-ref="26lag_delta" data-ref-filename="26lag_delta">lag_delta</a>;</td></tr>
<tr><th id="335">335</th><td>      <i>/* Update parameters according to new lag value. */</i></td></tr>
<tr><th id="336">336</th><td>      <a class="tu ref fn" href="#Update" title='Update' data-use='c' data-ref="Update" data-ref-filename="Update">Update</a>(&amp;<a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>);</td></tr>
<tr><th id="337">337</th><td>      <i>/* Filter a segment of input. */</i></td></tr>
<tr><th id="338">338</th><td>      <a class="tu ref fn" href="#FilterSegment" title='FilterSegment' data-use='c' data-ref="FilterSegment" data-ref-filename="FilterSegment">FilterSegment</a>(<a class="local col7 ref" href="#17in_data" title='in_data' data-ref="17in_data" data-ref-filename="17in_data">in_data</a>, &amp;<a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>, <a class="local col2 ref" href="#22out_data" title='out_data' data-ref="22out_data" data-ref-filename="22out_data">out_data</a>, <a class="local col3 ref" href="#23out_dg" title='out_dg' data-ref="23out_dg" data-ref-filename="23out_dg">out_dg</a>);</td></tr>
<tr><th id="339">339</th><td>    }</td></tr>
<tr><th id="340">340</th><td>  }</td></tr>
<tr><th id="341">341</th><td></td></tr>
<tr><th id="342">342</th><td>  <b>if</b> (<a class="local col1 ref" href="#21mode" title='mode' data-ref="21mode" data-ref-filename="21mode">mode</a> != <a class="enum" href="#kPitchFilterPreGain" title='kPitchFilterPreGain' data-ref="kPitchFilterPreGain" data-ref-filename="kPitchFilterPreGain">kPitchFilterPreGain</a>) {</td></tr>
<tr><th id="343">343</th><td>    <i>/* Export buffer and states. */</i></td></tr>
<tr><th id="344">344</th><td>    <span class="macro" title="__builtin___memcpy_chk (filter_state-&gt;ubuf, &amp;filter_parameters.buffer[(240)], sizeof(filter_state-&gt;ubuf), __builtin_object_size (filter_state-&gt;ubuf, 0))" data-ref="_M/memcpy">memcpy</span>(<a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::ubuf" title='(anonymous struct)::ubuf' data-ref="(anonymous)::ubuf" data-ref-filename="(anonymous)..ubuf">ubuf</a>, &amp;<a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::buffer" title='(anonymous struct)::buffer' data-use='a' data-ref="(anonymous)::buffer" data-ref-filename="(anonymous)..buffer">buffer</a>[<a class="macro" href="settings.h.html#106" title="(240)" data-ref="_M/PITCH_FRAME_LEN">PITCH_FRAME_LEN</a>],</td></tr>
<tr><th id="345">345</th><td>           <b>sizeof</b>(<a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::ubuf" title='(anonymous struct)::ubuf' data-ref="(anonymous)::ubuf" data-ref-filename="(anonymous)..ubuf">ubuf</a>));</td></tr>
<tr><th id="346">346</th><td>    <span class="macro" title="__builtin___memcpy_chk (filter_state-&gt;ystate, filter_parameters.damper_state, sizeof(filter_state-&gt;ystate), __builtin_object_size (filter_state-&gt;ystate, 0))" data-ref="_M/memcpy">memcpy</span>(<a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::ystate" title='(anonymous struct)::ystate' data-ref="(anonymous)::ystate" data-ref-filename="(anonymous)..ystate">ystate</a>, <a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::damper_state" title='(anonymous struct)::damper_state' data-use='r' data-ref="(anonymous)::damper_state" data-ref-filename="(anonymous)..damper_state">damper_state</a>,</td></tr>
<tr><th id="347">347</th><td>           <b>sizeof</b>(<a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::ystate" title='(anonymous struct)::ystate' data-ref="(anonymous)::ystate" data-ref-filename="(anonymous)..ystate">ystate</a>));</td></tr>
<tr><th id="348">348</th><td></td></tr>
<tr><th id="349">349</th><td>    <i>/* Store for the next frame. */</i></td></tr>
<tr><th id="350">350</th><td>    *<a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::oldlagp" title='(anonymous struct)::oldlagp' data-ref="(anonymous)::oldlagp" data-ref-filename="(anonymous)..oldlagp">oldlagp</a> = <a class="local col7 ref" href="#27old_lag" title='old_lag' data-ref="27old_lag" data-ref-filename="27old_lag">old_lag</a>;</td></tr>
<tr><th id="351">351</th><td>    *<a class="local col8 ref" href="#18filter_state" title='filter_state' data-ref="18filter_state" data-ref-filename="18filter_state">filter_state</a>-&gt;<a class="ref field" href="structs.h.html#(anonymous)::oldgainp" title='(anonymous struct)::oldgainp' data-ref="(anonymous)::oldgainp" data-ref-filename="(anonymous)..oldgainp">oldgainp</a> = <a class="local col8 ref" href="#28old_gain" title='old_gain' data-ref="28old_gain" data-ref-filename="28old_gain">old_gain</a>;</td></tr>
<tr><th id="352">352</th><td>  }</td></tr>
<tr><th id="353">353</th><td></td></tr>
<tr><th id="354">354</th><td>  <b>if</b> ((<a class="local col1 ref" href="#21mode" title='mode' data-ref="21mode" data-ref-filename="21mode">mode</a> == <a class="enum" href="#kPitchFilterPreGain" title='kPitchFilterPreGain' data-ref="kPitchFilterPreGain" data-ref-filename="kPitchFilterPreGain">kPitchFilterPreGain</a>) || (<a class="local col1 ref" href="#21mode" title='mode' data-ref="21mode" data-ref-filename="21mode">mode</a> == <a class="enum" href="#kPitchFilterPreLa" title='kPitchFilterPreLa' data-ref="kPitchFilterPreLa" data-ref-filename="kPitchFilterPreLa">kPitchFilterPreLa</a>)) {</td></tr>
<tr><th id="355">355</th><td>    <i>/* Filter the lookahead segment, this is treated as the last sub-frame. So</i></td></tr>
<tr><th id="356">356</th><td><i>     * set |pf_param| to last sub-frame. */</i></td></tr>
<tr><th id="357">357</th><td>    <a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::sub_frame" title='(anonymous struct)::sub_frame' data-use='w' data-ref="(anonymous)::sub_frame" data-ref-filename="(anonymous)..sub_frame">sub_frame</a> = <a class="macro" href="settings.h.html#116" title="4" data-ref="_M/PITCH_SUBFRAMES">PITCH_SUBFRAMES</a> - <var>1</var>;</td></tr>
<tr><th id="358">358</th><td>    <a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>.<a class="tu ref field" href="#(anonymous)::num_samples" title='(anonymous struct)::num_samples' data-use='w' data-ref="(anonymous)::num_samples" data-ref-filename="(anonymous)..num_samples">num_samples</a> = <a class="macro" href="settings.h.html#54" title="24" data-ref="_M/QLOOKAHEAD">QLOOKAHEAD</a>;</td></tr>
<tr><th id="359">359</th><td>    <a class="tu ref fn" href="#FilterSegment" title='FilterSegment' data-use='c' data-ref="FilterSegment" data-ref-filename="FilterSegment">FilterSegment</a>(<a class="local col7 ref" href="#17in_data" title='in_data' data-ref="17in_data" data-ref-filename="17in_data">in_data</a>, &amp;<a class="local col4 ref" href="#24filter_parameters" title='filter_parameters' data-ref="24filter_parameters" data-ref-filename="24filter_parameters">filter_parameters</a>, <a class="local col2 ref" href="#22out_data" title='out_data' data-ref="22out_data" data-ref-filename="22out_data">out_data</a>, <a class="local col3 ref" href="#23out_dg" title='out_dg' data-ref="23out_dg" data-ref-filename="23out_dg">out_dg</a>);</td></tr>
<tr><th id="360">360</th><td>  }</td></tr>
<tr><th id="361">361</th><td>}</td></tr>
<tr><th id="362">362</th><td></td></tr>
<tr><th id="363">363</th><td><em>void</em> <dfn class="decl def fn" id="WebRtcIsac_PitchfilterPre" title='WebRtcIsac_PitchfilterPre' data-ref="WebRtcIsac_PitchfilterPre" data-ref-filename="WebRtcIsac_PitchfilterPre">WebRtcIsac_PitchfilterPre</dfn>(<em>double</em>* <dfn class="local col2 decl" id="32in_data" title='in_data' data-type='double *' data-ref="32in_data" data-ref-filename="32in_data">in_data</dfn>, <em>double</em>* <dfn class="local col3 decl" id="33out_data" title='out_data' data-type='double *' data-ref="33out_data" data-ref-filename="33out_data">out_data</dfn>,</td></tr>
<tr><th id="364">364</th><td>                               <a class="typedef" href="structs.h.html#PitchFiltstr" title='PitchFiltstr' data-type='struct PitchFiltstr' data-ref="PitchFiltstr" data-ref-filename="PitchFiltstr">PitchFiltstr</a>* <dfn class="local col4 decl" id="34pf_state" title='pf_state' data-type='PitchFiltstr *' data-ref="34pf_state" data-ref-filename="34pf_state">pf_state</dfn>, <em>double</em>* <dfn class="local col5 decl" id="35lags" title='lags' data-type='double *' data-ref="35lags" data-ref-filename="35lags">lags</dfn>,</td></tr>
<tr><th id="365">365</th><td>                               <em>double</em>* <dfn class="local col6 decl" id="36gains" title='gains' data-type='double *' data-ref="36gains" data-ref-filename="36gains">gains</dfn>) {</td></tr>
<tr><th id="366">366</th><td>  <a class="tu ref fn" href="#FilterFrame" title='FilterFrame' data-use='c' data-ref="FilterFrame" data-ref-filename="FilterFrame">FilterFrame</a>(<a class="local col2 ref" href="#32in_data" title='in_data' data-ref="32in_data" data-ref-filename="32in_data">in_data</a>, <a class="local col4 ref" href="#34pf_state" title='pf_state' data-ref="34pf_state" data-ref-filename="34pf_state">pf_state</a>, <a class="local col5 ref" href="#35lags" title='lags' data-ref="35lags" data-ref-filename="35lags">lags</a>, <a class="local col6 ref" href="#36gains" title='gains' data-ref="36gains" data-ref-filename="36gains">gains</a>, <a class="enum" href="#kPitchFilterPre" title='kPitchFilterPre' data-ref="kPitchFilterPre" data-ref-filename="kPitchFilterPre">kPitchFilterPre</a>, <a class="local col3 ref" href="#33out_data" title='out_data' data-ref="33out_data" data-ref-filename="33out_data">out_data</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="367">367</th><td>}</td></tr>
<tr><th id="368">368</th><td></td></tr>
<tr><th id="369">369</th><td><em>void</em> <dfn class="decl def fn" id="WebRtcIsac_PitchfilterPre_la" title='WebRtcIsac_PitchfilterPre_la' data-ref="WebRtcIsac_PitchfilterPre_la" data-ref-filename="WebRtcIsac_PitchfilterPre_la">WebRtcIsac_PitchfilterPre_la</dfn>(<em>double</em>* <dfn class="local col7 decl" id="37in_data" title='in_data' data-type='double *' data-ref="37in_data" data-ref-filename="37in_data">in_data</dfn>, <em>double</em>* <dfn class="local col8 decl" id="38out_data" title='out_data' data-type='double *' data-ref="38out_data" data-ref-filename="38out_data">out_data</dfn>,</td></tr>
<tr><th id="370">370</th><td>                                  <a class="typedef" href="structs.h.html#PitchFiltstr" title='PitchFiltstr' data-type='struct PitchFiltstr' data-ref="PitchFiltstr" data-ref-filename="PitchFiltstr">PitchFiltstr</a>* <dfn class="local col9 decl" id="39pf_state" title='pf_state' data-type='PitchFiltstr *' data-ref="39pf_state" data-ref-filename="39pf_state">pf_state</dfn>, <em>double</em>* <dfn class="local col0 decl" id="40lags" title='lags' data-type='double *' data-ref="40lags" data-ref-filename="40lags">lags</dfn>,</td></tr>
<tr><th id="371">371</th><td>                                  <em>double</em>* <dfn class="local col1 decl" id="41gains" title='gains' data-type='double *' data-ref="41gains" data-ref-filename="41gains">gains</dfn>) {</td></tr>
<tr><th id="372">372</th><td>  <a class="tu ref fn" href="#FilterFrame" title='FilterFrame' data-use='c' data-ref="FilterFrame" data-ref-filename="FilterFrame">FilterFrame</a>(<a class="local col7 ref" href="#37in_data" title='in_data' data-ref="37in_data" data-ref-filename="37in_data">in_data</a>, <a class="local col9 ref" href="#39pf_state" title='pf_state' data-ref="39pf_state" data-ref-filename="39pf_state">pf_state</a>, <a class="local col0 ref" href="#40lags" title='lags' data-ref="40lags" data-ref-filename="40lags">lags</a>, <a class="local col1 ref" href="#41gains" title='gains' data-ref="41gains" data-ref-filename="41gains">gains</a>, <a class="enum" href="#kPitchFilterPreLa" title='kPitchFilterPreLa' data-ref="kPitchFilterPreLa" data-ref-filename="kPitchFilterPreLa">kPitchFilterPreLa</a>, <a class="local col8 ref" href="#38out_data" title='out_data' data-ref="38out_data" data-ref-filename="38out_data">out_data</a>,</td></tr>
<tr><th id="373">373</th><td>              <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="374">374</th><td>}</td></tr>
<tr><th id="375">375</th><td></td></tr>
<tr><th id="376">376</th><td><em>void</em> <dfn class="decl def fn" id="WebRtcIsac_PitchfilterPre_gains" title='WebRtcIsac_PitchfilterPre_gains' data-ref="WebRtcIsac_PitchfilterPre_gains" data-ref-filename="WebRtcIsac_PitchfilterPre_gains">WebRtcIsac_PitchfilterPre_gains</dfn>(</td></tr>
<tr><th id="377">377</th><td>    <em>double</em>* <dfn class="local col2 decl" id="42in_data" title='in_data' data-type='double *' data-ref="42in_data" data-ref-filename="42in_data">in_data</dfn>, <em>double</em>* <dfn class="local col3 decl" id="43out_data" title='out_data' data-type='double *' data-ref="43out_data" data-ref-filename="43out_data">out_data</dfn>,</td></tr>
<tr><th id="378">378</th><td>    <em>double</em> <dfn class="local col4 decl" id="44out_dg" title='out_dg' data-type='double (*)[264]' data-ref="44out_dg" data-ref-filename="44out_dg">out_dg</dfn>[][<a class="macro" href="settings.h.html#106" title="(240)" data-ref="_M/PITCH_FRAME_LEN">PITCH_FRAME_LEN</a> + <a class="macro" href="settings.h.html#54" title="24" data-ref="_M/QLOOKAHEAD">QLOOKAHEAD</a>], <a class="typedef" href="structs.h.html#PitchFiltstr" title='PitchFiltstr' data-type='struct PitchFiltstr' data-ref="PitchFiltstr" data-ref-filename="PitchFiltstr">PitchFiltstr</a> *<dfn class="local col5 decl" id="45pf_state" title='pf_state' data-type='PitchFiltstr *' data-ref="45pf_state" data-ref-filename="45pf_state">pf_state</dfn>,</td></tr>
<tr><th id="379">379</th><td>    <em>double</em>* <dfn class="local col6 decl" id="46lags" title='lags' data-type='double *' data-ref="46lags" data-ref-filename="46lags">lags</dfn>, <em>double</em>* <dfn class="local col7 decl" id="47gains" title='gains' data-type='double *' data-ref="47gains" data-ref-filename="47gains">gains</dfn>) {</td></tr>
<tr><th id="380">380</th><td>  <a class="tu ref fn" href="#FilterFrame" title='FilterFrame' data-use='c' data-ref="FilterFrame" data-ref-filename="FilterFrame">FilterFrame</a>(<a class="local col2 ref" href="#42in_data" title='in_data' data-ref="42in_data" data-ref-filename="42in_data">in_data</a>, <a class="local col5 ref" href="#45pf_state" title='pf_state' data-ref="45pf_state" data-ref-filename="45pf_state">pf_state</a>, <a class="local col6 ref" href="#46lags" title='lags' data-ref="46lags" data-ref-filename="46lags">lags</a>, <a class="local col7 ref" href="#47gains" title='gains' data-ref="47gains" data-ref-filename="47gains">gains</a>, <a class="enum" href="#kPitchFilterPreGain" title='kPitchFilterPreGain' data-ref="kPitchFilterPreGain" data-ref-filename="kPitchFilterPreGain">kPitchFilterPreGain</a>, <a class="local col3 ref" href="#43out_data" title='out_data' data-ref="43out_data" data-ref-filename="43out_data">out_data</a>,</td></tr>
<tr><th id="381">381</th><td>              <a class="local col4 ref" href="#44out_dg" title='out_dg' data-ref="44out_dg" data-ref-filename="44out_dg">out_dg</a>);</td></tr>
<tr><th id="382">382</th><td>}</td></tr>
<tr><th id="383">383</th><td></td></tr>
<tr><th id="384">384</th><td><em>void</em> <dfn class="decl def fn" id="WebRtcIsac_PitchfilterPost" title='WebRtcIsac_PitchfilterPost' data-ref="WebRtcIsac_PitchfilterPost" data-ref-filename="WebRtcIsac_PitchfilterPost">WebRtcIsac_PitchfilterPost</dfn>(<em>double</em>* <dfn class="local col8 decl" id="48in_data" title='in_data' data-type='double *' data-ref="48in_data" data-ref-filename="48in_data">in_data</dfn>, <em>double</em>* <dfn class="local col9 decl" id="49out_data" title='out_data' data-type='double *' data-ref="49out_data" data-ref-filename="49out_data">out_data</dfn>,</td></tr>
<tr><th id="385">385</th><td>                                <a class="typedef" href="structs.h.html#PitchFiltstr" title='PitchFiltstr' data-type='struct PitchFiltstr' data-ref="PitchFiltstr" data-ref-filename="PitchFiltstr">PitchFiltstr</a>* <dfn class="local col0 decl" id="50pf_state" title='pf_state' data-type='PitchFiltstr *' data-ref="50pf_state" data-ref-filename="50pf_state">pf_state</dfn>, <em>double</em>* <dfn class="local col1 decl" id="51lags" title='lags' data-type='double *' data-ref="51lags" data-ref-filename="51lags">lags</dfn>,</td></tr>
<tr><th id="386">386</th><td>                                <em>double</em>* <dfn class="local col2 decl" id="52gains" title='gains' data-type='double *' data-ref="52gains" data-ref-filename="52gains">gains</dfn>) {</td></tr>
<tr><th id="387">387</th><td>  <a class="tu ref fn" href="#FilterFrame" title='FilterFrame' data-use='c' data-ref="FilterFrame" data-ref-filename="FilterFrame">FilterFrame</a>(<a class="local col8 ref" href="#48in_data" title='in_data' data-ref="48in_data" data-ref-filename="48in_data">in_data</a>, <a class="local col0 ref" href="#50pf_state" title='pf_state' data-ref="50pf_state" data-ref-filename="50pf_state">pf_state</a>, <a class="local col1 ref" href="#51lags" title='lags' data-ref="51lags" data-ref-filename="51lags">lags</a>, <a class="local col2 ref" href="#52gains" title='gains' data-ref="52gains" data-ref-filename="52gains">gains</a>, <a class="enum" href="#kPitchFilterPost" title='kPitchFilterPost' data-ref="kPitchFilterPost" data-ref-filename="kPitchFilterPost">kPitchFilterPost</a>, <a class="local col9 ref" href="#49out_data" title='out_data' data-ref="49out_data" data-ref-filename="49out_data">out_data</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="388">388</th><td>}</td></tr>
<tr><th id="389">389</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2021-Jul-06</em> from project webkit<br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
