<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>DynamicsCompressorKernel.cpp source code [webkit/Source/WebCore/platform/audio/DynamicsCompressorKernel.cpp] - Woboq Code Browser</title>
<link rel="stylesheet" href="../../../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'webkit/Source/WebCore/platform/audio/DynamicsCompressorKernel.cpp'; var root_path = '../../../../..'; var data_path = '../../../../../../data'; var ecma_script_api_version = 2;</script>
<script src='../../../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../..'>webkit</a>/<a href='../../..'>Source</a>/<a href='../..'>WebCore</a>/<a href='..'>platform</a>/<a href='./'>audio</a>/<a href='DynamicsCompressorKernel.cpp.html'>DynamicsCompressorKernel.cpp</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> * Copyright (C) 2011 Google Inc. All rights reserved.</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> * Redistribution and use in source and binary forms, with or without</i></td></tr>
<tr><th id="5">5</th><td><i> * modification, are permitted provided that the following conditions</i></td></tr>
<tr><th id="6">6</th><td><i> * are met:</i></td></tr>
<tr><th id="7">7</th><td><i> *</i></td></tr>
<tr><th id="8">8</th><td><i> * 1.  Redistributions of source code must retain the above copyright</i></td></tr>
<tr><th id="9">9</th><td><i> *     notice, this list of conditions and the following disclaimer.</i></td></tr>
<tr><th id="10">10</th><td><i> * 2.  Redistributions in binary form must reproduce the above copyright</i></td></tr>
<tr><th id="11">11</th><td><i> *     notice, this list of conditions and the following disclaimer in the</i></td></tr>
<tr><th id="12">12</th><td><i> *     documentation and/or other materials provided with the distribution.</i></td></tr>
<tr><th id="13">13</th><td><i> * 3.  Neither the name of Apple Inc. ("Apple") nor the names of</i></td></tr>
<tr><th id="14">14</th><td><i> *     its contributors may be used to endorse or promote products derived</i></td></tr>
<tr><th id="15">15</th><td><i> *     from this software without specific prior written permission.</i></td></tr>
<tr><th id="16">16</th><td><i> *</i></td></tr>
<tr><th id="17">17</th><td><i> * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS "AS IS" AND ANY</i></td></tr>
<tr><th id="18">18</th><td><i> * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</i></td></tr>
<tr><th id="19">19</th><td><i> * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</i></td></tr>
<tr><th id="20">20</th><td><i> * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY</i></td></tr>
<tr><th id="21">21</th><td><i> * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</i></td></tr>
<tr><th id="22">22</th><td><i> * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</i></td></tr>
<tr><th id="23">23</th><td><i> * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND</i></td></tr>
<tr><th id="24">24</th><td><i> * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</i></td></tr>
<tr><th id="25">25</th><td><i> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF</i></td></tr>
<tr><th id="26">26</th><td><i> * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</i></td></tr>
<tr><th id="27">27</th><td><i> */</i></td></tr>
<tr><th id="28">28</th><td></td></tr>
<tr><th id="29">29</th><td><u>#include <a href="../../config.h.html">"config.h"</a></u></td></tr>
<tr><th id="30">30</th><td></td></tr>
<tr><th id="31">31</th><td><u>#<span data-ppcond="31">if</span> <a class="macro" href="../../../../WebKitBuild/Debug/usr/local/include/wtf/PlatformEnable.h.html#36" title="(defined 1 &amp;&amp; 1)" data-ref="_M/ENABLE">ENABLE</a>(WEB_AUDIO)</u></td></tr>
<tr><th id="32">32</th><td></td></tr>
<tr><th id="33">33</th><td><u>#include <a href="DynamicsCompressorKernel.h.html">"DynamicsCompressorKernel.h"</a></u></td></tr>
<tr><th id="34">34</th><td></td></tr>
<tr><th id="35">35</th><td><u>#include <a href="AudioUtilities.h.html">"AudioUtilities.h"</a></u></td></tr>
<tr><th id="36">36</th><td><u>#include <a href="DenormalDisabler.h.html">"DenormalDisabler.h"</a></u></td></tr>
<tr><th id="37">37</th><td><u>#include &lt;algorithm&gt;</u></td></tr>
<tr><th id="38">38</th><td><u>#include <a href="../../../../WebKitBuild/Debug/usr/local/include/wtf/MathExtras.h.html">&lt;wtf/MathExtras.h&gt;</a></u></td></tr>
<tr><th id="39">39</th><td></td></tr>
<tr><th id="40">40</th><td><b>namespace</b> <span class="namespace">WebCore</span> {</td></tr>
<tr><th id="41">41</th><td></td></tr>
<tr><th id="42">42</th><td><b>using</b> <b>namespace</b> <span class="namespace">AudioUtilities</span>;</td></tr>
<tr><th id="43">43</th><td></td></tr>
<tr><th id="44">44</th><td><i>// Metering hits peaks instantly, but releases this fast (in seconds).</i></td></tr>
<tr><th id="45">45</th><td><b>constexpr</b> <em>float</em> <dfn class="decl def" id="WebCore::meteringReleaseTimeConstant" title='WebCore::meteringReleaseTimeConstant' data-ref="WebCore::meteringReleaseTimeConstant" data-ref-filename="WebCore..meteringReleaseTimeConstant">meteringReleaseTimeConstant</dfn> = <var>0.325f</var>;</td></tr>
<tr><th id="46">46</th><td></td></tr>
<tr><th id="47">47</th><td><a class="type" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel" title='WebCore::DynamicsCompressorKernel' data-ref="WebCore::DynamicsCompressorKernel" data-ref-filename="WebCore..DynamicsCompressorKernel">DynamicsCompressorKernel</a>::<dfn class="decl def fn" id="_ZN7WebCore24DynamicsCompressorKernelC1Efj" title='WebCore::DynamicsCompressorKernel::DynamicsCompressorKernel' data-ref="_ZN7WebCore24DynamicsCompressorKernelC1Efj" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernelC1Efj">DynamicsCompressorKernel</dfn>(<em>float</em> <dfn class="local col1 decl" id="401sampleRate" title='sampleRate' data-type='float' data-ref="401sampleRate" data-ref-filename="401sampleRate">sampleRate</dfn>, <em>unsigned</em> <dfn class="local col2 decl" id="402numberOfChannels" title='numberOfChannels' data-type='unsigned int' data-ref="402numberOfChannels" data-ref-filename="402numberOfChannels">numberOfChannels</dfn>)</td></tr>
<tr><th id="48">48</th><td>    : <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_sampleRate" title='WebCore::DynamicsCompressorKernel::m_sampleRate' data-ref="WebCore::DynamicsCompressorKernel::m_sampleRate" data-ref-filename="WebCore..DynamicsCompressorKernel..m_sampleRate">m_sampleRate</a>(<a class="local col1 ref" href="#401sampleRate" title='sampleRate' data-ref="401sampleRate" data-ref-filename="401sampleRate">sampleRate</a>)</td></tr>
<tr><th id="49">49</th><td>{</td></tr>
<tr><th id="50">50</th><td>    <a class="member fn" href="#_ZN7WebCore24DynamicsCompressorKernel19setNumberOfChannelsEj" title='WebCore::DynamicsCompressorKernel::setNumberOfChannels' data-ref="_ZN7WebCore24DynamicsCompressorKernel19setNumberOfChannelsEj" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel19setNumberOfChannelsEj">setNumberOfChannels</a>(<a class="local col2 ref" href="#402numberOfChannels" title='numberOfChannels' data-ref="402numberOfChannels" data-ref-filename="402numberOfChannels">numberOfChannels</a>);</td></tr>
<tr><th id="51">51</th><td></td></tr>
<tr><th id="52">52</th><td>    <i>// Initializes most member variables</i></td></tr>
<tr><th id="53">53</th><td>    <a class="member fn" href="#_ZN7WebCore24DynamicsCompressorKernel5resetEv" title='WebCore::DynamicsCompressorKernel::reset' data-ref="_ZN7WebCore24DynamicsCompressorKernel5resetEv" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel5resetEv">reset</a>();</td></tr>
<tr><th id="54">54</th><td></td></tr>
<tr><th id="55">55</th><td>    <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_meteringReleaseK" title='WebCore::DynamicsCompressorKernel::m_meteringReleaseK' data-ref="WebCore::DynamicsCompressorKernel::m_meteringReleaseK" data-ref-filename="WebCore..DynamicsCompressorKernel..m_meteringReleaseK">m_meteringReleaseK</a> = <b>static_cast</b>&lt;<em>float</em>&gt;(<a class="ref fn" href="AudioUtilities.cpp.html#_ZN7WebCore14AudioUtilities33discreteTimeConstantForSampleRateEdd" title='WebCore::AudioUtilities::discreteTimeConstantForSampleRate' data-ref="_ZN7WebCore14AudioUtilities33discreteTimeConstantForSampleRateEdd" data-ref-filename="_ZN7WebCore14AudioUtilities33discreteTimeConstantForSampleRateEdd">discreteTimeConstantForSampleRate</a>(<a class="ref" href="#WebCore::meteringReleaseTimeConstant" title='WebCore::meteringReleaseTimeConstant' data-ref="WebCore::meteringReleaseTimeConstant" data-ref-filename="WebCore..meteringReleaseTimeConstant">meteringReleaseTimeConstant</a>, <a class="local col1 ref" href="#401sampleRate" title='sampleRate' data-ref="401sampleRate" data-ref-filename="401sampleRate">sampleRate</a>));</td></tr>
<tr><th id="56">56</th><td>}</td></tr>
<tr><th id="57">57</th><td></td></tr>
<tr><th id="58">58</th><td><em>void</em> <a class="type" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel" title='WebCore::DynamicsCompressorKernel' data-ref="WebCore::DynamicsCompressorKernel" data-ref-filename="WebCore..DynamicsCompressorKernel">DynamicsCompressorKernel</a>::<dfn class="decl def fn" id="_ZN7WebCore24DynamicsCompressorKernel19setNumberOfChannelsEj" title='WebCore::DynamicsCompressorKernel::setNumberOfChannels' data-ref="_ZN7WebCore24DynamicsCompressorKernel19setNumberOfChannelsEj" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel19setNumberOfChannelsEj">setNumberOfChannels</dfn>(<em>unsigned</em> <dfn class="local col3 decl" id="403numberOfChannels" title='numberOfChannels' data-type='unsigned int' data-ref="403numberOfChannels" data-ref-filename="403numberOfChannels">numberOfChannels</dfn>)</td></tr>
<tr><th id="59">59</th><td>{</td></tr>
<tr><th id="60">60</th><td>    <b>if</b> (<a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayBuffers" title='WebCore::DynamicsCompressorKernel::m_preDelayBuffers' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayBuffers" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayBuffers">m_preDelayBuffers</a>.<a class="ref fn" href="../../../../WebKitBuild/Debug/usr/local/include/wtf/Vector.h.html#_ZNK3WTF6Vector4sizeEv" title='WTF::Vector::size' data-ref="_ZNK3WTF6Vector4sizeEv" data-ref-filename="_ZNK3WTF6Vector4sizeEv">size</a>() == <a class="local col3 ref" href="#403numberOfChannels" title='numberOfChannels' data-ref="403numberOfChannels" data-ref-filename="403numberOfChannels">numberOfChannels</a>)</td></tr>
<tr><th id="61">61</th><td>        <b>return</b>;</td></tr>
<tr><th id="62">62</th><td></td></tr>
<tr><th id="63">63</th><td>    <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayBuffers" title='WebCore::DynamicsCompressorKernel::m_preDelayBuffers' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayBuffers" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayBuffers">m_preDelayBuffers</a>.<a class="ref fn" href="../../../../WebKitBuild/Debug/usr/local/include/wtf/Vector.h.html#_ZN3WTF6Vector5clearEv" title='WTF::Vector::clear' data-ref="_ZN3WTF6Vector5clearEv" data-ref-filename="_ZN3WTF6Vector5clearEv">clear</a>();</td></tr>
<tr><th id="64">64</th><td>    <b>for</b> (<em>unsigned</em> <dfn class="local col4 decl" id="404i" title='i' data-type='unsigned int' data-ref="404i" data-ref-filename="404i">i</dfn> = <var>0</var>; <a class="local col4 ref" href="#404i" title='i' data-ref="404i" data-ref-filename="404i">i</a> &lt; <a class="local col3 ref" href="#403numberOfChannels" title='numberOfChannels' data-ref="403numberOfChannels" data-ref-filename="403numberOfChannels">numberOfChannels</a>; ++<a class="local col4 ref" href="#404i" title='i' data-ref="404i" data-ref-filename="404i">i</a>)</td></tr>
<tr><th id="65">65</th><td>        <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayBuffers" title='WebCore::DynamicsCompressorKernel::m_preDelayBuffers' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayBuffers" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayBuffers">m_preDelayBuffers</a>.<a class="ref fn" href="../../../../WebKitBuild/Debug/usr/local/include/wtf/Vector.h.html#_ZN3WTF6Vector6appendEOT_" title='WTF::Vector::append' data-ref="_ZN3WTF6Vector6appendEOT_" data-ref-filename="_ZN3WTF6Vector6appendEOT_">append</a>(<a class="ref fn" href="../../../../WebKitBuild/Debug/usr/local/include/wtf/StdLibExtras.h.html#_ZN3WTF10makeUniqueEDpOT0_" title='WTF::makeUnique' data-ref="_ZN3WTF10makeUniqueEDpOT0_" data-ref-filename="_ZN3WTF10makeUniqueEDpOT0_">makeUnique</a>&lt;<a class="typedef" href="AudioArray.h.html#WebCore::AudioFloatArray" title='WebCore::AudioFloatArray' data-type='AudioArray&lt;float&gt;' data-ref="WebCore::AudioFloatArray" data-ref-filename="WebCore..AudioFloatArray">AudioFloatArray</a>&gt;(<a class="enum" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::MaxPreDelayFrames" title='WebCore::DynamicsCompressorKernel::MaxPreDelayFrames' data-ref="WebCore::DynamicsCompressorKernel::MaxPreDelayFrames" data-ref-filename="WebCore..DynamicsCompressorKernel..MaxPreDelayFrames">MaxPreDelayFrames</a>));</td></tr>
<tr><th id="66">66</th><td>}</td></tr>
<tr><th id="67">67</th><td></td></tr>
<tr><th id="68">68</th><td><em>void</em> <a class="type" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel" title='WebCore::DynamicsCompressorKernel' data-ref="WebCore::DynamicsCompressorKernel" data-ref-filename="WebCore..DynamicsCompressorKernel">DynamicsCompressorKernel</a>::<dfn class="decl def fn" id="_ZN7WebCore24DynamicsCompressorKernel15setPreDelayTimeEf" title='WebCore::DynamicsCompressorKernel::setPreDelayTime' data-ref="_ZN7WebCore24DynamicsCompressorKernel15setPreDelayTimeEf" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel15setPreDelayTimeEf">setPreDelayTime</dfn>(<em>float</em> <dfn class="local col5 decl" id="405preDelayTime" title='preDelayTime' data-type='float' data-ref="405preDelayTime" data-ref-filename="405preDelayTime">preDelayTime</dfn>)</td></tr>
<tr><th id="69">69</th><td>{</td></tr>
<tr><th id="70">70</th><td>    <i>// Re-configure look-ahead section pre-delay if delay time has changed.</i></td></tr>
<tr><th id="71">71</th><td>    <em>unsigned</em> <dfn class="local col6 decl" id="406preDelayFrames" title='preDelayFrames' data-type='unsigned int' data-ref="406preDelayFrames" data-ref-filename="406preDelayFrames">preDelayFrames</dfn> = <a class="local col5 ref" href="#405preDelayTime" title='preDelayTime' data-ref="405preDelayTime" data-ref-filename="405preDelayTime">preDelayTime</a> * <a class="member fn" href="DynamicsCompressorKernel.h.html#_ZNK7WebCore24DynamicsCompressorKernel10sampleRateEv" title='WebCore::DynamicsCompressorKernel::sampleRate' data-ref="_ZNK7WebCore24DynamicsCompressorKernel10sampleRateEv" data-ref-filename="_ZNK7WebCore24DynamicsCompressorKernel10sampleRateEv">sampleRate</a>();</td></tr>
<tr><th id="72">72</th><td>    <b>if</b> (<a class="local col6 ref" href="#406preDelayFrames" title='preDelayFrames' data-ref="406preDelayFrames" data-ref-filename="406preDelayFrames">preDelayFrames</a> &gt; <a class="enum" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::MaxPreDelayFrames" title='WebCore::DynamicsCompressorKernel::MaxPreDelayFrames' data-ref="WebCore::DynamicsCompressorKernel::MaxPreDelayFrames" data-ref-filename="WebCore..DynamicsCompressorKernel..MaxPreDelayFrames">MaxPreDelayFrames</a> - <var>1</var>)</td></tr>
<tr><th id="73">73</th><td>        <a class="local col6 ref" href="#406preDelayFrames" title='preDelayFrames' data-ref="406preDelayFrames" data-ref-filename="406preDelayFrames">preDelayFrames</a> = <a class="enum" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::MaxPreDelayFrames" title='WebCore::DynamicsCompressorKernel::MaxPreDelayFrames' data-ref="WebCore::DynamicsCompressorKernel::MaxPreDelayFrames" data-ref-filename="WebCore..DynamicsCompressorKernel..MaxPreDelayFrames">MaxPreDelayFrames</a> - <var>1</var>;</td></tr>
<tr><th id="74">74</th><td></td></tr>
<tr><th id="75">75</th><td>    <b>if</b> (<a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_lastPreDelayFrames" title='WebCore::DynamicsCompressorKernel::m_lastPreDelayFrames' data-ref="WebCore::DynamicsCompressorKernel::m_lastPreDelayFrames" data-ref-filename="WebCore..DynamicsCompressorKernel..m_lastPreDelayFrames">m_lastPreDelayFrames</a> != <a class="local col6 ref" href="#406preDelayFrames" title='preDelayFrames' data-ref="406preDelayFrames" data-ref-filename="406preDelayFrames">preDelayFrames</a>) {</td></tr>
<tr><th id="76">76</th><td>        <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_lastPreDelayFrames" title='WebCore::DynamicsCompressorKernel::m_lastPreDelayFrames' data-ref="WebCore::DynamicsCompressorKernel::m_lastPreDelayFrames" data-ref-filename="WebCore..DynamicsCompressorKernel..m_lastPreDelayFrames">m_lastPreDelayFrames</a> = <a class="local col6 ref" href="#406preDelayFrames" title='preDelayFrames' data-ref="406preDelayFrames" data-ref-filename="406preDelayFrames">preDelayFrames</a>;</td></tr>
<tr><th id="77">77</th><td>        <b>for</b> (<em>unsigned</em> <dfn class="local col7 decl" id="407i" title='i' data-type='unsigned int' data-ref="407i" data-ref-filename="407i">i</dfn> = <var>0</var>; <a class="local col7 ref" href="#407i" title='i' data-ref="407i" data-ref-filename="407i">i</a> &lt; <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayBuffers" title='WebCore::DynamicsCompressorKernel::m_preDelayBuffers' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayBuffers" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayBuffers">m_preDelayBuffers</a>.<a class="ref fn" href="../../../../WebKitBuild/Debug/usr/local/include/wtf/Vector.h.html#_ZNK3WTF6Vector4sizeEv" title='WTF::Vector::size' data-ref="_ZNK3WTF6Vector4sizeEv" data-ref-filename="_ZNK3WTF6Vector4sizeEv">size</a>(); ++<a class="local col7 ref" href="#407i" title='i' data-ref="407i" data-ref-filename="407i">i</a>)</td></tr>
<tr><th id="78">78</th><td>            <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayBuffers" title='WebCore::DynamicsCompressorKernel::m_preDelayBuffers' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayBuffers" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayBuffers">m_preDelayBuffers</a><a class="ref fn" href="../../../../WebKitBuild/Debug/usr/local/include/wtf/Vector.h.html#_ZN3WTF6VectorixEm" title='WTF::Vector::operator[]' data-ref="_ZN3WTF6VectorixEm" data-ref-filename="_ZN3WTF6VectorixEm">[<a class="local col7 ref" href="#407i" title='i' data-ref="407i" data-ref-filename="407i">i</a>]</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref fn" href="AudioArray.h.html#_ZN7WebCore10AudioArray4zeroEv" title='WebCore::AudioArray::zero' data-ref="_ZN7WebCore10AudioArray4zeroEv" data-ref-filename="_ZN7WebCore10AudioArray4zeroEv">zero</a>();</td></tr>
<tr><th id="79">79</th><td></td></tr>
<tr><th id="80">80</th><td>        <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayReadIndex" title='WebCore::DynamicsCompressorKernel::m_preDelayReadIndex' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayReadIndex" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayReadIndex">m_preDelayReadIndex</a> = <var>0</var>;</td></tr>
<tr><th id="81">81</th><td>        <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayWriteIndex" title='WebCore::DynamicsCompressorKernel::m_preDelayWriteIndex' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayWriteIndex" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayWriteIndex">m_preDelayWriteIndex</a> = <a class="local col6 ref" href="#406preDelayFrames" title='preDelayFrames' data-ref="406preDelayFrames" data-ref-filename="406preDelayFrames">preDelayFrames</a>;</td></tr>
<tr><th id="82">82</th><td>    }</td></tr>
<tr><th id="83">83</th><td>}</td></tr>
<tr><th id="84">84</th><td></td></tr>
<tr><th id="85">85</th><td><i>// Exponential curve for the knee.</i></td></tr>
<tr><th id="86">86</th><td><i>// It is 1st derivative matched at m_linearThreshold and asymptotically approaches the value m_linearThreshold + 1 / k.</i></td></tr>
<tr><th id="87">87</th><td><em>float</em> <a class="type" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel" title='WebCore::DynamicsCompressorKernel' data-ref="WebCore::DynamicsCompressorKernel" data-ref-filename="WebCore..DynamicsCompressorKernel">DynamicsCompressorKernel</a>::<dfn class="decl def fn" id="_ZN7WebCore24DynamicsCompressorKernel9kneeCurveEff" title='WebCore::DynamicsCompressorKernel::kneeCurve' data-ref="_ZN7WebCore24DynamicsCompressorKernel9kneeCurveEff" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel9kneeCurveEff">kneeCurve</dfn>(<em>float</em> <dfn class="local col8 decl" id="408x" title='x' data-type='float' data-ref="408x" data-ref-filename="408x">x</dfn>, <em>float</em> <dfn class="local col9 decl" id="409k" title='k' data-type='float' data-ref="409k" data-ref-filename="409k">k</dfn>)</td></tr>
<tr><th id="88">88</th><td>{</td></tr>
<tr><th id="89">89</th><td>    <i>// Linear up to threshold.</i></td></tr>
<tr><th id="90">90</th><td>    <b>if</b> (<a class="local col8 ref" href="#408x" title='x' data-ref="408x" data-ref-filename="408x">x</a> &lt; <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_linearThreshold" title='WebCore::DynamicsCompressorKernel::m_linearThreshold' data-ref="WebCore::DynamicsCompressorKernel::m_linearThreshold" data-ref-filename="WebCore..DynamicsCompressorKernel..m_linearThreshold">m_linearThreshold</a>)</td></tr>
<tr><th id="91">91</th><td>        <b>return</b> <a class="local col8 ref" href="#408x" title='x' data-ref="408x" data-ref-filename="408x">x</a>;</td></tr>
<tr><th id="92">92</th><td></td></tr>
<tr><th id="93">93</th><td>    <b>return</b> <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_linearThreshold" title='WebCore::DynamicsCompressorKernel::m_linearThreshold' data-ref="WebCore::DynamicsCompressorKernel::m_linearThreshold" data-ref-filename="WebCore..DynamicsCompressorKernel..m_linearThreshold">m_linearThreshold</a> + (<var>1</var> - <span class='ref fn' title='expf' data-ref="expf" data-ref-filename="expf">expf</span>(-<a class="local col9 ref" href="#409k" title='k' data-ref="409k" data-ref-filename="409k">k</a> * (<a class="local col8 ref" href="#408x" title='x' data-ref="408x" data-ref-filename="408x">x</a> - <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_linearThreshold" title='WebCore::DynamicsCompressorKernel::m_linearThreshold' data-ref="WebCore::DynamicsCompressorKernel::m_linearThreshold" data-ref-filename="WebCore..DynamicsCompressorKernel..m_linearThreshold">m_linearThreshold</a>))) / <a class="local col9 ref" href="#409k" title='k' data-ref="409k" data-ref-filename="409k">k</a>;</td></tr>
<tr><th id="94">94</th><td>}</td></tr>
<tr><th id="95">95</th><td></td></tr>
<tr><th id="96">96</th><td><i>// Full compression curve with constant ratio after knee.</i></td></tr>
<tr><th id="97">97</th><td><em>float</em> <a class="type" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel" title='WebCore::DynamicsCompressorKernel' data-ref="WebCore::DynamicsCompressorKernel" data-ref-filename="WebCore..DynamicsCompressorKernel">DynamicsCompressorKernel</a>::<dfn class="decl def fn" id="_ZN7WebCore24DynamicsCompressorKernel8saturateEff" title='WebCore::DynamicsCompressorKernel::saturate' data-ref="_ZN7WebCore24DynamicsCompressorKernel8saturateEff" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel8saturateEff">saturate</dfn>(<em>float</em> <dfn class="local col0 decl" id="410x" title='x' data-type='float' data-ref="410x" data-ref-filename="410x">x</dfn>, <em>float</em> <dfn class="local col1 decl" id="411k" title='k' data-type='float' data-ref="411k" data-ref-filename="411k">k</dfn>)</td></tr>
<tr><th id="98">98</th><td>{</td></tr>
<tr><th id="99">99</th><td>    <em>float</em> <dfn class="local col2 decl" id="412y" title='y' data-type='float' data-ref="412y" data-ref-filename="412y">y</dfn>;</td></tr>
<tr><th id="100">100</th><td></td></tr>
<tr><th id="101">101</th><td>    <b>if</b> (<a class="local col0 ref" href="#410x" title='x' data-ref="410x" data-ref-filename="410x">x</a> &lt; <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_kneeThreshold" title='WebCore::DynamicsCompressorKernel::m_kneeThreshold' data-ref="WebCore::DynamicsCompressorKernel::m_kneeThreshold" data-ref-filename="WebCore..DynamicsCompressorKernel..m_kneeThreshold">m_kneeThreshold</a>)</td></tr>
<tr><th id="102">102</th><td>        <a class="local col2 ref" href="#412y" title='y' data-ref="412y" data-ref-filename="412y">y</a> = <a class="member fn" href="#_ZN7WebCore24DynamicsCompressorKernel9kneeCurveEff" title='WebCore::DynamicsCompressorKernel::kneeCurve' data-ref="_ZN7WebCore24DynamicsCompressorKernel9kneeCurveEff" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel9kneeCurveEff">kneeCurve</a>(<a class="local col0 ref" href="#410x" title='x' data-ref="410x" data-ref-filename="410x">x</a>, <a class="local col1 ref" href="#411k" title='k' data-ref="411k" data-ref-filename="411k">k</a>);</td></tr>
<tr><th id="103">103</th><td>    <b>else</b> {</td></tr>
<tr><th id="104">104</th><td>        <i>// Constant ratio after knee.</i></td></tr>
<tr><th id="105">105</th><td>        <em>float</em> <dfn class="local col3 decl" id="413xDb" title='xDb' data-type='float' data-ref="413xDb" data-ref-filename="413xDb">xDb</dfn> = <a class="ref fn" href="AudioUtilities.h.html#_ZN7WebCore14AudioUtilities16linearToDecibelsEf" title='WebCore::AudioUtilities::linearToDecibels' data-ref="_ZN7WebCore14AudioUtilities16linearToDecibelsEf" data-ref-filename="_ZN7WebCore14AudioUtilities16linearToDecibelsEf">linearToDecibels</a>(<a class="local col0 ref" href="#410x" title='x' data-ref="410x" data-ref-filename="410x">x</a>);</td></tr>
<tr><th id="106">106</th><td>        <em>float</em> <dfn class="local col4 decl" id="414yDb" title='yDb' data-type='float' data-ref="414yDb" data-ref-filename="414yDb">yDb</dfn> = <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_ykneeThresholdDb" title='WebCore::DynamicsCompressorKernel::m_ykneeThresholdDb' data-ref="WebCore::DynamicsCompressorKernel::m_ykneeThresholdDb" data-ref-filename="WebCore..DynamicsCompressorKernel..m_ykneeThresholdDb">m_ykneeThresholdDb</a> + <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_slope" title='WebCore::DynamicsCompressorKernel::m_slope' data-ref="WebCore::DynamicsCompressorKernel::m_slope" data-ref-filename="WebCore..DynamicsCompressorKernel..m_slope">m_slope</a> * (<a class="local col3 ref" href="#413xDb" title='xDb' data-ref="413xDb" data-ref-filename="413xDb">xDb</a> - <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_kneeThresholdDb" title='WebCore::DynamicsCompressorKernel::m_kneeThresholdDb' data-ref="WebCore::DynamicsCompressorKernel::m_kneeThresholdDb" data-ref-filename="WebCore..DynamicsCompressorKernel..m_kneeThresholdDb">m_kneeThresholdDb</a>);</td></tr>
<tr><th id="107">107</th><td></td></tr>
<tr><th id="108">108</th><td>        <a class="local col2 ref" href="#412y" title='y' data-ref="412y" data-ref-filename="412y">y</a> = <a class="ref fn" href="AudioUtilities.h.html#_ZN7WebCore14AudioUtilities16decibelsToLinearEf" title='WebCore::AudioUtilities::decibelsToLinear' data-ref="_ZN7WebCore14AudioUtilities16decibelsToLinearEf" data-ref-filename="_ZN7WebCore14AudioUtilities16decibelsToLinearEf">decibelsToLinear</a>(<a class="local col4 ref" href="#414yDb" title='yDb' data-ref="414yDb" data-ref-filename="414yDb">yDb</a>);</td></tr>
<tr><th id="109">109</th><td>    }</td></tr>
<tr><th id="110">110</th><td></td></tr>
<tr><th id="111">111</th><td>    <b>return</b> <a class="local col2 ref" href="#412y" title='y' data-ref="412y" data-ref-filename="412y">y</a>;</td></tr>
<tr><th id="112">112</th><td>}</td></tr>
<tr><th id="113">113</th><td></td></tr>
<tr><th id="114">114</th><td><i>// Approximate 1st derivative with input and output expressed in dB.</i></td></tr>
<tr><th id="115">115</th><td><i>// This slope is equal to the inverse of the compression "ratio".</i></td></tr>
<tr><th id="116">116</th><td><i>// In other words, a compression ratio of 20 would be a slope of 1/20.</i></td></tr>
<tr><th id="117">117</th><td><em>float</em> <a class="type" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel" title='WebCore::DynamicsCompressorKernel' data-ref="WebCore::DynamicsCompressorKernel" data-ref-filename="WebCore..DynamicsCompressorKernel">DynamicsCompressorKernel</a>::<dfn class="decl def fn" id="_ZN7WebCore24DynamicsCompressorKernel7slopeAtEff" title='WebCore::DynamicsCompressorKernel::slopeAt' data-ref="_ZN7WebCore24DynamicsCompressorKernel7slopeAtEff" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel7slopeAtEff">slopeAt</dfn>(<em>float</em> <dfn class="local col5 decl" id="415x" title='x' data-type='float' data-ref="415x" data-ref-filename="415x">x</dfn>, <em>float</em> <dfn class="local col6 decl" id="416k" title='k' data-type='float' data-ref="416k" data-ref-filename="416k">k</dfn>)</td></tr>
<tr><th id="118">118</th><td>{</td></tr>
<tr><th id="119">119</th><td>    <b>if</b> (<a class="local col5 ref" href="#415x" title='x' data-ref="415x" data-ref-filename="415x">x</a> &lt; <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_linearThreshold" title='WebCore::DynamicsCompressorKernel::m_linearThreshold' data-ref="WebCore::DynamicsCompressorKernel::m_linearThreshold" data-ref-filename="WebCore..DynamicsCompressorKernel..m_linearThreshold">m_linearThreshold</a>)</td></tr>
<tr><th id="120">120</th><td>        <b>return</b> <var>1</var>;</td></tr>
<tr><th id="121">121</th><td></td></tr>
<tr><th id="122">122</th><td>    <em>float</em> <dfn class="local col7 decl" id="417x2" title='x2' data-type='float' data-ref="417x2" data-ref-filename="417x2">x2</dfn> = <a class="local col5 ref" href="#415x" title='x' data-ref="415x" data-ref-filename="415x">x</a> * <var>1.001</var>;</td></tr>
<tr><th id="123">123</th><td></td></tr>
<tr><th id="124">124</th><td>    <em>float</em> <dfn class="local col8 decl" id="418xDb" title='xDb' data-type='float' data-ref="418xDb" data-ref-filename="418xDb">xDb</dfn> = <a class="ref fn" href="AudioUtilities.h.html#_ZN7WebCore14AudioUtilities16linearToDecibelsEf" title='WebCore::AudioUtilities::linearToDecibels' data-ref="_ZN7WebCore14AudioUtilities16linearToDecibelsEf" data-ref-filename="_ZN7WebCore14AudioUtilities16linearToDecibelsEf">linearToDecibels</a>(<a class="local col5 ref" href="#415x" title='x' data-ref="415x" data-ref-filename="415x">x</a>);</td></tr>
<tr><th id="125">125</th><td>    <em>float</em> <dfn class="local col9 decl" id="419x2Db" title='x2Db' data-type='float' data-ref="419x2Db" data-ref-filename="419x2Db">x2Db</dfn> = <a class="ref fn" href="AudioUtilities.h.html#_ZN7WebCore14AudioUtilities16linearToDecibelsEf" title='WebCore::AudioUtilities::linearToDecibels' data-ref="_ZN7WebCore14AudioUtilities16linearToDecibelsEf" data-ref-filename="_ZN7WebCore14AudioUtilities16linearToDecibelsEf">linearToDecibels</a>(<a class="local col7 ref" href="#417x2" title='x2' data-ref="417x2" data-ref-filename="417x2">x2</a>);</td></tr>
<tr><th id="126">126</th><td></td></tr>
<tr><th id="127">127</th><td>    <em>float</em> <dfn class="local col0 decl" id="420yDb" title='yDb' data-type='float' data-ref="420yDb" data-ref-filename="420yDb">yDb</dfn> = <a class="ref fn" href="AudioUtilities.h.html#_ZN7WebCore14AudioUtilities16linearToDecibelsEf" title='WebCore::AudioUtilities::linearToDecibels' data-ref="_ZN7WebCore14AudioUtilities16linearToDecibelsEf" data-ref-filename="_ZN7WebCore14AudioUtilities16linearToDecibelsEf">linearToDecibels</a>(<a class="member fn" href="#_ZN7WebCore24DynamicsCompressorKernel9kneeCurveEff" title='WebCore::DynamicsCompressorKernel::kneeCurve' data-ref="_ZN7WebCore24DynamicsCompressorKernel9kneeCurveEff" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel9kneeCurveEff">kneeCurve</a>(<a class="local col5 ref" href="#415x" title='x' data-ref="415x" data-ref-filename="415x">x</a>, <a class="local col6 ref" href="#416k" title='k' data-ref="416k" data-ref-filename="416k">k</a>));</td></tr>
<tr><th id="128">128</th><td>    <em>float</em> <dfn class="local col1 decl" id="421y2Db" title='y2Db' data-type='float' data-ref="421y2Db" data-ref-filename="421y2Db">y2Db</dfn> = <a class="ref fn" href="AudioUtilities.h.html#_ZN7WebCore14AudioUtilities16linearToDecibelsEf" title='WebCore::AudioUtilities::linearToDecibels' data-ref="_ZN7WebCore14AudioUtilities16linearToDecibelsEf" data-ref-filename="_ZN7WebCore14AudioUtilities16linearToDecibelsEf">linearToDecibels</a>(<a class="member fn" href="#_ZN7WebCore24DynamicsCompressorKernel9kneeCurveEff" title='WebCore::DynamicsCompressorKernel::kneeCurve' data-ref="_ZN7WebCore24DynamicsCompressorKernel9kneeCurveEff" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel9kneeCurveEff">kneeCurve</a>(<a class="local col7 ref" href="#417x2" title='x2' data-ref="417x2" data-ref-filename="417x2">x2</a>, <a class="local col6 ref" href="#416k" title='k' data-ref="416k" data-ref-filename="416k">k</a>));</td></tr>
<tr><th id="129">129</th><td></td></tr>
<tr><th id="130">130</th><td>    <em>float</em> <dfn class="local col2 decl" id="422m" title='m' data-type='float' data-ref="422m" data-ref-filename="422m">m</dfn> = (<a class="local col1 ref" href="#421y2Db" title='y2Db' data-ref="421y2Db" data-ref-filename="421y2Db">y2Db</a> - <a class="local col0 ref" href="#420yDb" title='yDb' data-ref="420yDb" data-ref-filename="420yDb">yDb</a>) / (<a class="local col9 ref" href="#419x2Db" title='x2Db' data-ref="419x2Db" data-ref-filename="419x2Db">x2Db</a> - <a class="local col8 ref" href="#418xDb" title='xDb' data-ref="418xDb" data-ref-filename="418xDb">xDb</a>);</td></tr>
<tr><th id="131">131</th><td></td></tr>
<tr><th id="132">132</th><td>    <b>return</b> <a class="local col2 ref" href="#422m" title='m' data-ref="422m" data-ref-filename="422m">m</a>;</td></tr>
<tr><th id="133">133</th><td>}</td></tr>
<tr><th id="134">134</th><td></td></tr>
<tr><th id="135">135</th><td><em>float</em> <a class="type" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel" title='WebCore::DynamicsCompressorKernel' data-ref="WebCore::DynamicsCompressorKernel" data-ref-filename="WebCore..DynamicsCompressorKernel">DynamicsCompressorKernel</a>::<dfn class="decl def fn" id="_ZN7WebCore24DynamicsCompressorKernel8kAtSlopeEf" title='WebCore::DynamicsCompressorKernel::kAtSlope' data-ref="_ZN7WebCore24DynamicsCompressorKernel8kAtSlopeEf" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel8kAtSlopeEf">kAtSlope</dfn>(<em>float</em> <dfn class="local col3 decl" id="423desiredSlope" title='desiredSlope' data-type='float' data-ref="423desiredSlope" data-ref-filename="423desiredSlope">desiredSlope</dfn>)</td></tr>
<tr><th id="136">136</th><td>{</td></tr>
<tr><th id="137">137</th><td>    <em>float</em> <dfn class="local col4 decl" id="424xDb" title='xDb' data-type='float' data-ref="424xDb" data-ref-filename="424xDb">xDb</dfn> = <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_dbThreshold" title='WebCore::DynamicsCompressorKernel::m_dbThreshold' data-ref="WebCore::DynamicsCompressorKernel::m_dbThreshold" data-ref-filename="WebCore..DynamicsCompressorKernel..m_dbThreshold">m_dbThreshold</a> + <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_dbKnee" title='WebCore::DynamicsCompressorKernel::m_dbKnee' data-ref="WebCore::DynamicsCompressorKernel::m_dbKnee" data-ref-filename="WebCore..DynamicsCompressorKernel..m_dbKnee">m_dbKnee</a>;</td></tr>
<tr><th id="138">138</th><td>    <em>float</em> <dfn class="local col5 decl" id="425x" title='x' data-type='float' data-ref="425x" data-ref-filename="425x">x</dfn> = <a class="ref fn" href="AudioUtilities.h.html#_ZN7WebCore14AudioUtilities16decibelsToLinearEf" title='WebCore::AudioUtilities::decibelsToLinear' data-ref="_ZN7WebCore14AudioUtilities16decibelsToLinearEf" data-ref-filename="_ZN7WebCore14AudioUtilities16decibelsToLinearEf">decibelsToLinear</a>(<a class="local col4 ref" href="#424xDb" title='xDb' data-ref="424xDb" data-ref-filename="424xDb">xDb</a>);</td></tr>
<tr><th id="139">139</th><td></td></tr>
<tr><th id="140">140</th><td>    <i>// Approximate k given initial values.</i></td></tr>
<tr><th id="141">141</th><td>    <em>float</em> <dfn class="local col6 decl" id="426minK" title='minK' data-type='float' data-ref="426minK" data-ref-filename="426minK">minK</dfn> = <var>0.1</var>;</td></tr>
<tr><th id="142">142</th><td>    <em>float</em> <dfn class="local col7 decl" id="427maxK" title='maxK' data-type='float' data-ref="427maxK" data-ref-filename="427maxK">maxK</dfn> = <var>10000</var>;</td></tr>
<tr><th id="143">143</th><td>    <em>float</em> <dfn class="local col8 decl" id="428k" title='k' data-type='float' data-ref="428k" data-ref-filename="428k">k</dfn> = <var>5</var>;</td></tr>
<tr><th id="144">144</th><td></td></tr>
<tr><th id="145">145</th><td>    <b>for</b> (<em>int</em> <dfn class="local col9 decl" id="429i" title='i' data-type='int' data-ref="429i" data-ref-filename="429i">i</dfn> = <var>0</var>; <a class="local col9 ref" href="#429i" title='i' data-ref="429i" data-ref-filename="429i">i</a> &lt; <var>15</var>; ++<a class="local col9 ref" href="#429i" title='i' data-ref="429i" data-ref-filename="429i">i</a>) {</td></tr>
<tr><th id="146">146</th><td>        <i>// A high value for k will more quickly asymptotically approach a slope of 0.</i></td></tr>
<tr><th id="147">147</th><td>        <em>float</em> <dfn class="local col0 decl" id="430slope" title='slope' data-type='float' data-ref="430slope" data-ref-filename="430slope">slope</dfn> = <a class="member fn" href="#_ZN7WebCore24DynamicsCompressorKernel7slopeAtEff" title='WebCore::DynamicsCompressorKernel::slopeAt' data-ref="_ZN7WebCore24DynamicsCompressorKernel7slopeAtEff" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel7slopeAtEff">slopeAt</a>(<a class="local col5 ref" href="#425x" title='x' data-ref="425x" data-ref-filename="425x">x</a>, <a class="local col8 ref" href="#428k" title='k' data-ref="428k" data-ref-filename="428k">k</a>);</td></tr>
<tr><th id="148">148</th><td></td></tr>
<tr><th id="149">149</th><td>        <b>if</b> (<a class="local col0 ref" href="#430slope" title='slope' data-ref="430slope" data-ref-filename="430slope">slope</a> &lt; <a class="local col3 ref" href="#423desiredSlope" title='desiredSlope' data-ref="423desiredSlope" data-ref-filename="423desiredSlope">desiredSlope</a>) {</td></tr>
<tr><th id="150">150</th><td>            <i>// k is too high.</i></td></tr>
<tr><th id="151">151</th><td>            <a class="local col7 ref" href="#427maxK" title='maxK' data-ref="427maxK" data-ref-filename="427maxK">maxK</a> = <a class="local col8 ref" href="#428k" title='k' data-ref="428k" data-ref-filename="428k">k</a>;</td></tr>
<tr><th id="152">152</th><td>        } <b>else</b> {</td></tr>
<tr><th id="153">153</th><td>            <i>// k is too low.</i></td></tr>
<tr><th id="154">154</th><td>            <a class="local col6 ref" href="#426minK" title='minK' data-ref="426minK" data-ref-filename="426minK">minK</a> = <a class="local col8 ref" href="#428k" title='k' data-ref="428k" data-ref-filename="428k">k</a>;</td></tr>
<tr><th id="155">155</th><td>        }</td></tr>
<tr><th id="156">156</th><td></td></tr>
<tr><th id="157">157</th><td>        <i>// Re-calculate based on geometric mean.</i></td></tr>
<tr><th id="158">158</th><td>        <a class="local col8 ref" href="#428k" title='k' data-ref="428k" data-ref-filename="428k">k</a> = <span class='ref fn' title='sqrtf' data-ref="sqrtf" data-ref-filename="sqrtf">sqrtf</span>(<a class="local col6 ref" href="#426minK" title='minK' data-ref="426minK" data-ref-filename="426minK">minK</a> * <a class="local col7 ref" href="#427maxK" title='maxK' data-ref="427maxK" data-ref-filename="427maxK">maxK</a>);</td></tr>
<tr><th id="159">159</th><td>    }</td></tr>
<tr><th id="160">160</th><td></td></tr>
<tr><th id="161">161</th><td>    <b>return</b> <a class="local col8 ref" href="#428k" title='k' data-ref="428k" data-ref-filename="428k">k</a>;</td></tr>
<tr><th id="162">162</th><td>}</td></tr>
<tr><th id="163">163</th><td></td></tr>
<tr><th id="164">164</th><td><em>float</em> <a class="type" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel" title='WebCore::DynamicsCompressorKernel' data-ref="WebCore::DynamicsCompressorKernel" data-ref-filename="WebCore..DynamicsCompressorKernel">DynamicsCompressorKernel</a>::<dfn class="decl def fn" id="_ZN7WebCore24DynamicsCompressorKernel27updateStaticCurveParametersEfff" title='WebCore::DynamicsCompressorKernel::updateStaticCurveParameters' data-ref="_ZN7WebCore24DynamicsCompressorKernel27updateStaticCurveParametersEfff" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel27updateStaticCurveParametersEfff">updateStaticCurveParameters</dfn>(<em>float</em> <dfn class="local col1 decl" id="431dbThreshold" title='dbThreshold' data-type='float' data-ref="431dbThreshold" data-ref-filename="431dbThreshold">dbThreshold</dfn>, <em>float</em> <dfn class="local col2 decl" id="432dbKnee" title='dbKnee' data-type='float' data-ref="432dbKnee" data-ref-filename="432dbKnee">dbKnee</dfn>, <em>float</em> <dfn class="local col3 decl" id="433ratio" title='ratio' data-type='float' data-ref="433ratio" data-ref-filename="433ratio">ratio</dfn>)</td></tr>
<tr><th id="165">165</th><td>{</td></tr>
<tr><th id="166">166</th><td>    <b>if</b> (<a class="local col1 ref" href="#431dbThreshold" title='dbThreshold' data-ref="431dbThreshold" data-ref-filename="431dbThreshold">dbThreshold</a> != <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_dbThreshold" title='WebCore::DynamicsCompressorKernel::m_dbThreshold' data-ref="WebCore::DynamicsCompressorKernel::m_dbThreshold" data-ref-filename="WebCore..DynamicsCompressorKernel..m_dbThreshold">m_dbThreshold</a> || <a class="local col2 ref" href="#432dbKnee" title='dbKnee' data-ref="432dbKnee" data-ref-filename="432dbKnee">dbKnee</a> != <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_dbKnee" title='WebCore::DynamicsCompressorKernel::m_dbKnee' data-ref="WebCore::DynamicsCompressorKernel::m_dbKnee" data-ref-filename="WebCore..DynamicsCompressorKernel..m_dbKnee">m_dbKnee</a> || <a class="local col3 ref" href="#433ratio" title='ratio' data-ref="433ratio" data-ref-filename="433ratio">ratio</a> != <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_ratio" title='WebCore::DynamicsCompressorKernel::m_ratio' data-ref="WebCore::DynamicsCompressorKernel::m_ratio" data-ref-filename="WebCore..DynamicsCompressorKernel..m_ratio">m_ratio</a>) {</td></tr>
<tr><th id="167">167</th><td>        <i>// Threshold and knee.</i></td></tr>
<tr><th id="168">168</th><td>        <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_dbThreshold" title='WebCore::DynamicsCompressorKernel::m_dbThreshold' data-ref="WebCore::DynamicsCompressorKernel::m_dbThreshold" data-ref-filename="WebCore..DynamicsCompressorKernel..m_dbThreshold">m_dbThreshold</a> = <a class="local col1 ref" href="#431dbThreshold" title='dbThreshold' data-ref="431dbThreshold" data-ref-filename="431dbThreshold">dbThreshold</a>;</td></tr>
<tr><th id="169">169</th><td>        <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_linearThreshold" title='WebCore::DynamicsCompressorKernel::m_linearThreshold' data-ref="WebCore::DynamicsCompressorKernel::m_linearThreshold" data-ref-filename="WebCore..DynamicsCompressorKernel..m_linearThreshold">m_linearThreshold</a> = <a class="ref fn" href="AudioUtilities.h.html#_ZN7WebCore14AudioUtilities16decibelsToLinearEf" title='WebCore::AudioUtilities::decibelsToLinear' data-ref="_ZN7WebCore14AudioUtilities16decibelsToLinearEf" data-ref-filename="_ZN7WebCore14AudioUtilities16decibelsToLinearEf">decibelsToLinear</a>(<a class="local col1 ref" href="#431dbThreshold" title='dbThreshold' data-ref="431dbThreshold" data-ref-filename="431dbThreshold">dbThreshold</a>);</td></tr>
<tr><th id="170">170</th><td>        <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_dbKnee" title='WebCore::DynamicsCompressorKernel::m_dbKnee' data-ref="WebCore::DynamicsCompressorKernel::m_dbKnee" data-ref-filename="WebCore..DynamicsCompressorKernel..m_dbKnee">m_dbKnee</a> = <a class="local col2 ref" href="#432dbKnee" title='dbKnee' data-ref="432dbKnee" data-ref-filename="432dbKnee">dbKnee</a>;</td></tr>
<tr><th id="171">171</th><td></td></tr>
<tr><th id="172">172</th><td>        <i>// Compute knee parameters.</i></td></tr>
<tr><th id="173">173</th><td>        <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_ratio" title='WebCore::DynamicsCompressorKernel::m_ratio' data-ref="WebCore::DynamicsCompressorKernel::m_ratio" data-ref-filename="WebCore..DynamicsCompressorKernel..m_ratio">m_ratio</a> = <a class="local col3 ref" href="#433ratio" title='ratio' data-ref="433ratio" data-ref-filename="433ratio">ratio</a>;</td></tr>
<tr><th id="174">174</th><td>        <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_slope" title='WebCore::DynamicsCompressorKernel::m_slope' data-ref="WebCore::DynamicsCompressorKernel::m_slope" data-ref-filename="WebCore..DynamicsCompressorKernel..m_slope">m_slope</a> = <var>1</var> / <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_ratio" title='WebCore::DynamicsCompressorKernel::m_ratio' data-ref="WebCore::DynamicsCompressorKernel::m_ratio" data-ref-filename="WebCore..DynamicsCompressorKernel..m_ratio">m_ratio</a>;</td></tr>
<tr><th id="175">175</th><td></td></tr>
<tr><th id="176">176</th><td>        <em>float</em> <dfn class="local col4 decl" id="434k" title='k' data-type='float' data-ref="434k" data-ref-filename="434k">k</dfn> = <a class="member fn" href="#_ZN7WebCore24DynamicsCompressorKernel8kAtSlopeEf" title='WebCore::DynamicsCompressorKernel::kAtSlope' data-ref="_ZN7WebCore24DynamicsCompressorKernel8kAtSlopeEf" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel8kAtSlopeEf">kAtSlope</a>(<var>1</var> / <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_ratio" title='WebCore::DynamicsCompressorKernel::m_ratio' data-ref="WebCore::DynamicsCompressorKernel::m_ratio" data-ref-filename="WebCore..DynamicsCompressorKernel..m_ratio">m_ratio</a>);</td></tr>
<tr><th id="177">177</th><td></td></tr>
<tr><th id="178">178</th><td>        <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_kneeThresholdDb" title='WebCore::DynamicsCompressorKernel::m_kneeThresholdDb' data-ref="WebCore::DynamicsCompressorKernel::m_kneeThresholdDb" data-ref-filename="WebCore..DynamicsCompressorKernel..m_kneeThresholdDb">m_kneeThresholdDb</a> = <a class="local col1 ref" href="#431dbThreshold" title='dbThreshold' data-ref="431dbThreshold" data-ref-filename="431dbThreshold">dbThreshold</a> + <a class="local col2 ref" href="#432dbKnee" title='dbKnee' data-ref="432dbKnee" data-ref-filename="432dbKnee">dbKnee</a>;</td></tr>
<tr><th id="179">179</th><td>        <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_kneeThreshold" title='WebCore::DynamicsCompressorKernel::m_kneeThreshold' data-ref="WebCore::DynamicsCompressorKernel::m_kneeThreshold" data-ref-filename="WebCore..DynamicsCompressorKernel..m_kneeThreshold">m_kneeThreshold</a> = <a class="ref fn" href="AudioUtilities.h.html#_ZN7WebCore14AudioUtilities16decibelsToLinearEf" title='WebCore::AudioUtilities::decibelsToLinear' data-ref="_ZN7WebCore14AudioUtilities16decibelsToLinearEf" data-ref-filename="_ZN7WebCore14AudioUtilities16decibelsToLinearEf">decibelsToLinear</a>(<a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_kneeThresholdDb" title='WebCore::DynamicsCompressorKernel::m_kneeThresholdDb' data-ref="WebCore::DynamicsCompressorKernel::m_kneeThresholdDb" data-ref-filename="WebCore..DynamicsCompressorKernel..m_kneeThresholdDb">m_kneeThresholdDb</a>);</td></tr>
<tr><th id="180">180</th><td></td></tr>
<tr><th id="181">181</th><td>        <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_ykneeThresholdDb" title='WebCore::DynamicsCompressorKernel::m_ykneeThresholdDb' data-ref="WebCore::DynamicsCompressorKernel::m_ykneeThresholdDb" data-ref-filename="WebCore..DynamicsCompressorKernel..m_ykneeThresholdDb">m_ykneeThresholdDb</a> = <a class="ref fn" href="AudioUtilities.h.html#_ZN7WebCore14AudioUtilities16linearToDecibelsEf" title='WebCore::AudioUtilities::linearToDecibels' data-ref="_ZN7WebCore14AudioUtilities16linearToDecibelsEf" data-ref-filename="_ZN7WebCore14AudioUtilities16linearToDecibelsEf">linearToDecibels</a>(<a class="member fn" href="#_ZN7WebCore24DynamicsCompressorKernel9kneeCurveEff" title='WebCore::DynamicsCompressorKernel::kneeCurve' data-ref="_ZN7WebCore24DynamicsCompressorKernel9kneeCurveEff" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel9kneeCurveEff">kneeCurve</a>(<a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_kneeThreshold" title='WebCore::DynamicsCompressorKernel::m_kneeThreshold' data-ref="WebCore::DynamicsCompressorKernel::m_kneeThreshold" data-ref-filename="WebCore..DynamicsCompressorKernel..m_kneeThreshold">m_kneeThreshold</a>, <a class="local col4 ref" href="#434k" title='k' data-ref="434k" data-ref-filename="434k">k</a>));</td></tr>
<tr><th id="182">182</th><td></td></tr>
<tr><th id="183">183</th><td>        <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_K" title='WebCore::DynamicsCompressorKernel::m_K' data-ref="WebCore::DynamicsCompressorKernel::m_K" data-ref-filename="WebCore..DynamicsCompressorKernel..m_K">m_K</a> = <a class="local col4 ref" href="#434k" title='k' data-ref="434k" data-ref-filename="434k">k</a>;</td></tr>
<tr><th id="184">184</th><td>    }</td></tr>
<tr><th id="185">185</th><td>    <b>return</b> <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_K" title='WebCore::DynamicsCompressorKernel::m_K' data-ref="WebCore::DynamicsCompressorKernel::m_K" data-ref-filename="WebCore..DynamicsCompressorKernel..m_K">m_K</a>;</td></tr>
<tr><th id="186">186</th><td>}</td></tr>
<tr><th id="187">187</th><td></td></tr>
<tr><th id="188">188</th><td><em>void</em> <a class="type" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel" title='WebCore::DynamicsCompressorKernel' data-ref="WebCore::DynamicsCompressorKernel" data-ref-filename="WebCore..DynamicsCompressorKernel">DynamicsCompressorKernel</a>::<dfn class="decl def fn" id="_ZN7WebCore24DynamicsCompressorKernel7processEPPKfPPfjjffffffffffff" title='WebCore::DynamicsCompressorKernel::process' data-ref="_ZN7WebCore24DynamicsCompressorKernel7processEPPKfPPfjjffffffffffff" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel7processEPPKfPPfjjffffffffffff">process</dfn>(<em>const</em> <em>float</em>* <dfn class="local col5 decl" id="435sourceChannels" title='sourceChannels' data-type='const float **' data-ref="435sourceChannels" data-ref-filename="435sourceChannels">sourceChannels</dfn>[],</td></tr>
<tr><th id="189">189</th><td>                                       <em>float</em>* <dfn class="local col6 decl" id="436destinationChannels" title='destinationChannels' data-type='float **' data-ref="436destinationChannels" data-ref-filename="436destinationChannels">destinationChannels</dfn>[],</td></tr>
<tr><th id="190">190</th><td>                                       <em>unsigned</em> <dfn class="local col7 decl" id="437numberOfChannels" title='numberOfChannels' data-type='unsigned int' data-ref="437numberOfChannels" data-ref-filename="437numberOfChannels">numberOfChannels</dfn>,</td></tr>
<tr><th id="191">191</th><td>                                       <em>unsigned</em> <dfn class="local col8 decl" id="438framesToProcess" title='framesToProcess' data-type='unsigned int' data-ref="438framesToProcess" data-ref-filename="438framesToProcess">framesToProcess</dfn>,</td></tr>
<tr><th id="192">192</th><td></td></tr>
<tr><th id="193">193</th><td>                                       <em>float</em> <dfn class="local col9 decl" id="439dbThreshold" title='dbThreshold' data-type='float' data-ref="439dbThreshold" data-ref-filename="439dbThreshold">dbThreshold</dfn>,</td></tr>
<tr><th id="194">194</th><td>                                       <em>float</em> <dfn class="local col0 decl" id="440dbKnee" title='dbKnee' data-type='float' data-ref="440dbKnee" data-ref-filename="440dbKnee">dbKnee</dfn>,</td></tr>
<tr><th id="195">195</th><td>                                       <em>float</em> <dfn class="local col1 decl" id="441ratio" title='ratio' data-type='float' data-ref="441ratio" data-ref-filename="441ratio">ratio</dfn>,</td></tr>
<tr><th id="196">196</th><td>                                       <em>float</em> <dfn class="local col2 decl" id="442attackTime" title='attackTime' data-type='float' data-ref="442attackTime" data-ref-filename="442attackTime">attackTime</dfn>,</td></tr>
<tr><th id="197">197</th><td>                                       <em>float</em> <dfn class="local col3 decl" id="443releaseTime" title='releaseTime' data-type='float' data-ref="443releaseTime" data-ref-filename="443releaseTime">releaseTime</dfn>,</td></tr>
<tr><th id="198">198</th><td>                                       <em>float</em> <dfn class="local col4 decl" id="444preDelayTime" title='preDelayTime' data-type='float' data-ref="444preDelayTime" data-ref-filename="444preDelayTime">preDelayTime</dfn>,</td></tr>
<tr><th id="199">199</th><td>                                       <em>float</em> <dfn class="local col5 decl" id="445dbPostGain" title='dbPostGain' data-type='float' data-ref="445dbPostGain" data-ref-filename="445dbPostGain">dbPostGain</dfn>,</td></tr>
<tr><th id="200">200</th><td>                                       <em>float</em> <dfn class="local col6 decl" id="446effectBlend" title='effectBlend' data-type='float' data-ref="446effectBlend" data-ref-filename="446effectBlend">effectBlend</dfn>, <i>/* equal power crossfade */</i></td></tr>
<tr><th id="201">201</th><td></td></tr>
<tr><th id="202">202</th><td>                                       <em>float</em> <dfn class="local col7 decl" id="447releaseZone1" title='releaseZone1' data-type='float' data-ref="447releaseZone1" data-ref-filename="447releaseZone1">releaseZone1</dfn>,</td></tr>
<tr><th id="203">203</th><td>                                       <em>float</em> <dfn class="local col8 decl" id="448releaseZone2" title='releaseZone2' data-type='float' data-ref="448releaseZone2" data-ref-filename="448releaseZone2">releaseZone2</dfn>,</td></tr>
<tr><th id="204">204</th><td>                                       <em>float</em> <dfn class="local col9 decl" id="449releaseZone3" title='releaseZone3' data-type='float' data-ref="449releaseZone3" data-ref-filename="449releaseZone3">releaseZone3</dfn>,</td></tr>
<tr><th id="205">205</th><td>                                       <em>float</em> <dfn class="local col0 decl" id="450releaseZone4" title='releaseZone4' data-type='float' data-ref="450releaseZone4" data-ref-filename="450releaseZone4">releaseZone4</dfn></td></tr>
<tr><th id="206">206</th><td>                                       )</td></tr>
<tr><th id="207">207</th><td>{</td></tr>
<tr><th id="208">208</th><td>    <a class="macro" href="../../../../WebKitBuild/Debug/usr/local/include/wtf/Assertions.h.html#347" title="do { if (!(m_preDelayBuffers.size() == numberOfChannels)) { WTFReportAssertionFailure(&quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/WebCore/platform/audio/DynamicsCompressorKernel.cpp&quot;, 208, __PRETTY_FUNCTION__, &quot;m_preDelayBuffers.size() == numberOfChannels&quot;); do { WTF::isIntegralOrPointerType(); compilerFenceForCrash(); WTFCrashWithInfo(208, &quot;/Volumes/ExternalSSD/Projects/webkit/WebKit/Source/WebCore/platform/audio/DynamicsCompressorKernel.cpp&quot;, __PRETTY_FUNCTION__, 741); } while (false); } } while (0)" data-ref="_M/ASSERT">ASSERT</a>(<a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayBuffers" title='WebCore::DynamicsCompressorKernel::m_preDelayBuffers' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayBuffers" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayBuffers">m_preDelayBuffers</a>.<a class="ref fn" href="../../../../WebKitBuild/Debug/usr/local/include/wtf/Vector.h.html#_ZNK3WTF6Vector4sizeEv" title='WTF::Vector::size' data-ref="_ZNK3WTF6Vector4sizeEv" data-ref-filename="_ZNK3WTF6Vector4sizeEv">size</a>() == <a class="local col7 ref" href="#437numberOfChannels" title='numberOfChannels' data-ref="437numberOfChannels" data-ref-filename="437numberOfChannels">numberOfChannels</a>);</td></tr>
<tr><th id="209">209</th><td></td></tr>
<tr><th id="210">210</th><td>    <em>float</em> <dfn class="local col1 decl" id="451sampleRate" title='sampleRate' data-type='float' data-ref="451sampleRate" data-ref-filename="451sampleRate">sampleRate</dfn> = <b>this</b>-&gt;<a class="member fn" href="DynamicsCompressorKernel.h.html#_ZNK7WebCore24DynamicsCompressorKernel10sampleRateEv" title='WebCore::DynamicsCompressorKernel::sampleRate' data-ref="_ZNK7WebCore24DynamicsCompressorKernel10sampleRateEv" data-ref-filename="_ZNK7WebCore24DynamicsCompressorKernel10sampleRateEv">sampleRate</a>();</td></tr>
<tr><th id="211">211</th><td></td></tr>
<tr><th id="212">212</th><td>    <em>float</em> <dfn class="local col2 decl" id="452dryMix" title='dryMix' data-type='float' data-ref="452dryMix" data-ref-filename="452dryMix">dryMix</dfn> = <var>1</var> - <a class="local col6 ref" href="#446effectBlend" title='effectBlend' data-ref="446effectBlend" data-ref-filename="446effectBlend">effectBlend</a>;</td></tr>
<tr><th id="213">213</th><td>    <em>float</em> <dfn class="local col3 decl" id="453wetMix" title='wetMix' data-type='float' data-ref="453wetMix" data-ref-filename="453wetMix">wetMix</dfn> = <a class="local col6 ref" href="#446effectBlend" title='effectBlend' data-ref="446effectBlend" data-ref-filename="446effectBlend">effectBlend</a>;</td></tr>
<tr><th id="214">214</th><td></td></tr>
<tr><th id="215">215</th><td>    <em>float</em> <dfn class="local col4 decl" id="454k" title='k' data-type='float' data-ref="454k" data-ref-filename="454k">k</dfn> = <a class="member fn" href="#_ZN7WebCore24DynamicsCompressorKernel27updateStaticCurveParametersEfff" title='WebCore::DynamicsCompressorKernel::updateStaticCurveParameters' data-ref="_ZN7WebCore24DynamicsCompressorKernel27updateStaticCurveParametersEfff" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel27updateStaticCurveParametersEfff">updateStaticCurveParameters</a>(<a class="local col9 ref" href="#439dbThreshold" title='dbThreshold' data-ref="439dbThreshold" data-ref-filename="439dbThreshold">dbThreshold</a>, <a class="local col0 ref" href="#440dbKnee" title='dbKnee' data-ref="440dbKnee" data-ref-filename="440dbKnee">dbKnee</a>, <a class="local col1 ref" href="#441ratio" title='ratio' data-ref="441ratio" data-ref-filename="441ratio">ratio</a>);</td></tr>
<tr><th id="216">216</th><td></td></tr>
<tr><th id="217">217</th><td>    <i>// Makeup gain.</i></td></tr>
<tr><th id="218">218</th><td>    <em>float</em> <dfn class="local col5 decl" id="455fullRangeGain" title='fullRangeGain' data-type='float' data-ref="455fullRangeGain" data-ref-filename="455fullRangeGain">fullRangeGain</dfn> = <a class="member fn" href="#_ZN7WebCore24DynamicsCompressorKernel8saturateEff" title='WebCore::DynamicsCompressorKernel::saturate' data-ref="_ZN7WebCore24DynamicsCompressorKernel8saturateEff" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel8saturateEff">saturate</a>(<var>1</var>, <a class="local col4 ref" href="#454k" title='k' data-ref="454k" data-ref-filename="454k">k</a>);</td></tr>
<tr><th id="219">219</th><td>    <em>float</em> <dfn class="local col6 decl" id="456fullRangeMakeupGain" title='fullRangeMakeupGain' data-type='float' data-ref="456fullRangeMakeupGain" data-ref-filename="456fullRangeMakeupGain">fullRangeMakeupGain</dfn> = <var>1</var> / <a class="local col5 ref" href="#455fullRangeGain" title='fullRangeGain' data-ref="455fullRangeGain" data-ref-filename="455fullRangeGain">fullRangeGain</a>;</td></tr>
<tr><th id="220">220</th><td></td></tr>
<tr><th id="221">221</th><td>    <i>// Empirical/perceptual tuning.</i></td></tr>
<tr><th id="222">222</th><td>    <a class="local col6 ref" href="#456fullRangeMakeupGain" title='fullRangeMakeupGain' data-ref="456fullRangeMakeupGain" data-ref-filename="456fullRangeMakeupGain">fullRangeMakeupGain</a> = <span class='ref fn' title='powf' data-ref="powf" data-ref-filename="powf">powf</span>(<a class="local col6 ref" href="#456fullRangeMakeupGain" title='fullRangeMakeupGain' data-ref="456fullRangeMakeupGain" data-ref-filename="456fullRangeMakeupGain">fullRangeMakeupGain</a>, <var>0.6f</var>);</td></tr>
<tr><th id="223">223</th><td></td></tr>
<tr><th id="224">224</th><td>    <em>float</em> <dfn class="local col7 decl" id="457masterLinearGain" title='masterLinearGain' data-type='float' data-ref="457masterLinearGain" data-ref-filename="457masterLinearGain">masterLinearGain</dfn> = <a class="ref fn" href="AudioUtilities.h.html#_ZN7WebCore14AudioUtilities16decibelsToLinearEf" title='WebCore::AudioUtilities::decibelsToLinear' data-ref="_ZN7WebCore14AudioUtilities16decibelsToLinearEf" data-ref-filename="_ZN7WebCore14AudioUtilities16decibelsToLinearEf">decibelsToLinear</a>(<a class="local col5 ref" href="#445dbPostGain" title='dbPostGain' data-ref="445dbPostGain" data-ref-filename="445dbPostGain">dbPostGain</a>) * <a class="local col6 ref" href="#456fullRangeMakeupGain" title='fullRangeMakeupGain' data-ref="456fullRangeMakeupGain" data-ref-filename="456fullRangeMakeupGain">fullRangeMakeupGain</a>;</td></tr>
<tr><th id="225">225</th><td></td></tr>
<tr><th id="226">226</th><td>    <i>// Attack parameters.</i></td></tr>
<tr><th id="227">227</th><td>    <a class="local col2 ref" href="#442attackTime" title='attackTime' data-ref="442attackTime" data-ref-filename="442attackTime">attackTime</a> = <span class="namespace">std::</span><span class='ref fn' title='std::__1::max' data-ref="_ZNSt3__1L3maxERKT_S2_" data-ref-filename="_ZNSt3__1L3maxERKT_S2_">max</span>(<var>0.001f</var>, <a class="local col2 ref" href="#442attackTime" title='attackTime' data-ref="442attackTime" data-ref-filename="442attackTime">attackTime</a>);</td></tr>
<tr><th id="228">228</th><td>    <em>float</em> <dfn class="local col8 decl" id="458attackFrames" title='attackFrames' data-type='float' data-ref="458attackFrames" data-ref-filename="458attackFrames">attackFrames</dfn> = <a class="local col2 ref" href="#442attackTime" title='attackTime' data-ref="442attackTime" data-ref-filename="442attackTime">attackTime</a> * <a class="local col1 ref" href="#451sampleRate" title='sampleRate' data-ref="451sampleRate" data-ref-filename="451sampleRate">sampleRate</a>;</td></tr>
<tr><th id="229">229</th><td></td></tr>
<tr><th id="230">230</th><td>    <i>// Release parameters.</i></td></tr>
<tr><th id="231">231</th><td>    <em>float</em> <dfn class="local col9 decl" id="459releaseFrames" title='releaseFrames' data-type='float' data-ref="459releaseFrames" data-ref-filename="459releaseFrames">releaseFrames</dfn> = <a class="local col1 ref" href="#451sampleRate" title='sampleRate' data-ref="451sampleRate" data-ref-filename="451sampleRate">sampleRate</a> * <a class="local col3 ref" href="#443releaseTime" title='releaseTime' data-ref="443releaseTime" data-ref-filename="443releaseTime">releaseTime</a>;</td></tr>
<tr><th id="232">232</th><td></td></tr>
<tr><th id="233">233</th><td>    <i>// Detector release time.</i></td></tr>
<tr><th id="234">234</th><td>    <em>float</em> <dfn class="local col0 decl" id="460satReleaseTime" title='satReleaseTime' data-type='float' data-ref="460satReleaseTime" data-ref-filename="460satReleaseTime">satReleaseTime</dfn> = <var>0.0025f</var>;</td></tr>
<tr><th id="235">235</th><td>    <em>float</em> <dfn class="local col1 decl" id="461satReleaseFrames" title='satReleaseFrames' data-type='float' data-ref="461satReleaseFrames" data-ref-filename="461satReleaseFrames">satReleaseFrames</dfn> = <a class="local col0 ref" href="#460satReleaseTime" title='satReleaseTime' data-ref="460satReleaseTime" data-ref-filename="460satReleaseTime">satReleaseTime</a> * <a class="local col1 ref" href="#451sampleRate" title='sampleRate' data-ref="451sampleRate" data-ref-filename="451sampleRate">sampleRate</a>;</td></tr>
<tr><th id="236">236</th><td></td></tr>
<tr><th id="237">237</th><td>    <i>// Create a smooth function which passes through four points.</i></td></tr>
<tr><th id="238">238</th><td><i></i></td></tr>
<tr><th id="239">239</th><td><i>    // Polynomial of the form</i></td></tr>
<tr><th id="240">240</th><td><i>    // y = a + b*x + c*x^2 + d*x^3 + e*x^4;</i></td></tr>
<tr><th id="241">241</th><td></td></tr>
<tr><th id="242">242</th><td>    <em>float</em> <dfn class="local col2 decl" id="462y1" title='y1' data-type='float' data-ref="462y1" data-ref-filename="462y1">y1</dfn> = <a class="local col9 ref" href="#459releaseFrames" title='releaseFrames' data-ref="459releaseFrames" data-ref-filename="459releaseFrames">releaseFrames</a> * <a class="local col7 ref" href="#447releaseZone1" title='releaseZone1' data-ref="447releaseZone1" data-ref-filename="447releaseZone1">releaseZone1</a>;</td></tr>
<tr><th id="243">243</th><td>    <em>float</em> <dfn class="local col3 decl" id="463y2" title='y2' data-type='float' data-ref="463y2" data-ref-filename="463y2">y2</dfn> = <a class="local col9 ref" href="#459releaseFrames" title='releaseFrames' data-ref="459releaseFrames" data-ref-filename="459releaseFrames">releaseFrames</a> * <a class="local col8 ref" href="#448releaseZone2" title='releaseZone2' data-ref="448releaseZone2" data-ref-filename="448releaseZone2">releaseZone2</a>;</td></tr>
<tr><th id="244">244</th><td>    <em>float</em> <dfn class="local col4 decl" id="464y3" title='y3' data-type='float' data-ref="464y3" data-ref-filename="464y3">y3</dfn> = <a class="local col9 ref" href="#459releaseFrames" title='releaseFrames' data-ref="459releaseFrames" data-ref-filename="459releaseFrames">releaseFrames</a> * <a class="local col9 ref" href="#449releaseZone3" title='releaseZone3' data-ref="449releaseZone3" data-ref-filename="449releaseZone3">releaseZone3</a>;</td></tr>
<tr><th id="245">245</th><td>    <em>float</em> <dfn class="local col5 decl" id="465y4" title='y4' data-type='float' data-ref="465y4" data-ref-filename="465y4">y4</dfn> = <a class="local col9 ref" href="#459releaseFrames" title='releaseFrames' data-ref="459releaseFrames" data-ref-filename="459releaseFrames">releaseFrames</a> * <a class="local col0 ref" href="#450releaseZone4" title='releaseZone4' data-ref="450releaseZone4" data-ref-filename="450releaseZone4">releaseZone4</a>;</td></tr>
<tr><th id="246">246</th><td></td></tr>
<tr><th id="247">247</th><td>    <i>// All of these coefficients were derived for 4th order polynomial curve fitting where the y values</i></td></tr>
<tr><th id="248">248</th><td><i>    // match the evenly spaced x values as follows: (y1 : x == 0, y2 : x == 1, y3 : x == 2, y4 : x == 3)</i></td></tr>
<tr><th id="249">249</th><td>    <em>float</em> <dfn class="local col6 decl" id="466kA" title='kA' data-type='float' data-ref="466kA" data-ref-filename="466kA">kA</dfn> = <var>0.9999999999999998f</var>*<a class="local col2 ref" href="#462y1" title='y1' data-ref="462y1" data-ref-filename="462y1">y1</a> + <var>1.8432219684323923e-16f</var>*<a class="local col3 ref" href="#463y2" title='y2' data-ref="463y2" data-ref-filename="463y2">y2</a> - <var>1.9373394351676423e-16f</var>*<a class="local col4 ref" href="#464y3" title='y3' data-ref="464y3" data-ref-filename="464y3">y3</a> + <var>8.824516011816245e-18f</var>*<a class="local col5 ref" href="#465y4" title='y4' data-ref="465y4" data-ref-filename="465y4">y4</a>;</td></tr>
<tr><th id="250">250</th><td>    <em>float</em> <dfn class="local col7 decl" id="467kB" title='kB' data-type='float' data-ref="467kB" data-ref-filename="467kB">kB</dfn> = -<var>1.5788320352845888f</var>*<a class="local col2 ref" href="#462y1" title='y1' data-ref="462y1" data-ref-filename="462y1">y1</a> + <var>2.3305837032074286f</var>*<a class="local col3 ref" href="#463y2" title='y2' data-ref="463y2" data-ref-filename="463y2">y2</a> - <var>0.9141194204840429f</var>*<a class="local col4 ref" href="#464y3" title='y3' data-ref="464y3" data-ref-filename="464y3">y3</a> + <var>0.1623677525612032f</var>*<a class="local col5 ref" href="#465y4" title='y4' data-ref="465y4" data-ref-filename="465y4">y4</a>;</td></tr>
<tr><th id="251">251</th><td>    <em>float</em> <dfn class="local col8 decl" id="468kC" title='kC' data-type='float' data-ref="468kC" data-ref-filename="468kC">kC</dfn> = <var>0.5334142869106424f</var>*<a class="local col2 ref" href="#462y1" title='y1' data-ref="462y1" data-ref-filename="462y1">y1</a> - <var>1.272736789213631f</var>*<a class="local col3 ref" href="#463y2" title='y2' data-ref="463y2" data-ref-filename="463y2">y2</a> + <var>0.9258856042207512f</var>*<a class="local col4 ref" href="#464y3" title='y3' data-ref="464y3" data-ref-filename="464y3">y3</a> - <var>0.18656310191776226f</var>*<a class="local col5 ref" href="#465y4" title='y4' data-ref="465y4" data-ref-filename="465y4">y4</a>;</td></tr>
<tr><th id="252">252</th><td>    <em>float</em> <dfn class="local col9 decl" id="469kD" title='kD' data-type='float' data-ref="469kD" data-ref-filename="469kD">kD</dfn> = <var>0.08783463138207234f</var>*<a class="local col2 ref" href="#462y1" title='y1' data-ref="462y1" data-ref-filename="462y1">y1</a> - <var>0.1694162967925622f</var>*<a class="local col3 ref" href="#463y2" title='y2' data-ref="463y2" data-ref-filename="463y2">y2</a> + <var>0.08588057951595272f</var>*<a class="local col4 ref" href="#464y3" title='y3' data-ref="464y3" data-ref-filename="464y3">y3</a> - <var>0.00429891410546283f</var>*<a class="local col5 ref" href="#465y4" title='y4' data-ref="465y4" data-ref-filename="465y4">y4</a>;</td></tr>
<tr><th id="253">253</th><td>    <em>float</em> <dfn class="local col0 decl" id="470kE" title='kE' data-type='float' data-ref="470kE" data-ref-filename="470kE">kE</dfn> = -<var>0.042416883008123074f</var>*<a class="local col2 ref" href="#462y1" title='y1' data-ref="462y1" data-ref-filename="462y1">y1</a> + <var>0.1115693827987602f</var>*<a class="local col3 ref" href="#463y2" title='y2' data-ref="463y2" data-ref-filename="463y2">y2</a> - <var>0.09764676325265872f</var>*<a class="local col4 ref" href="#464y3" title='y3' data-ref="464y3" data-ref-filename="464y3">y3</a> + <var>0.028494263462021576f</var>*<a class="local col5 ref" href="#465y4" title='y4' data-ref="465y4" data-ref-filename="465y4">y4</a>;</td></tr>
<tr><th id="254">254</th><td></td></tr>
<tr><th id="255">255</th><td>    <i>// x ranges from 0 -&gt; 3       0    1    2   3</i></td></tr>
<tr><th id="256">256</th><td><i>    //                           -15  -10  -5   0db</i></td></tr>
<tr><th id="257">257</th><td><i></i></td></tr>
<tr><th id="258">258</th><td><i>    // y calculates adaptive release frames depending on the amount of compression.</i></td></tr>
<tr><th id="259">259</th><td></td></tr>
<tr><th id="260">260</th><td>    <a class="member fn" href="#_ZN7WebCore24DynamicsCompressorKernel15setPreDelayTimeEf" title='WebCore::DynamicsCompressorKernel::setPreDelayTime' data-ref="_ZN7WebCore24DynamicsCompressorKernel15setPreDelayTimeEf" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel15setPreDelayTimeEf">setPreDelayTime</a>(<a class="local col4 ref" href="#444preDelayTime" title='preDelayTime' data-ref="444preDelayTime" data-ref-filename="444preDelayTime">preDelayTime</a>);</td></tr>
<tr><th id="261">261</th><td></td></tr>
<tr><th id="262">262</th><td>    <em>const</em> <em>int</em> <dfn class="local col1 decl" id="471nDivisionFrames" title='nDivisionFrames' data-type='const int' data-ref="471nDivisionFrames" data-ref-filename="471nDivisionFrames">nDivisionFrames</dfn> = <var>32</var>;</td></tr>
<tr><th id="263">263</th><td></td></tr>
<tr><th id="264">264</th><td>    <em>const</em> <em>int</em> <dfn class="local col2 decl" id="472nDivisions" title='nDivisions' data-type='const int' data-ref="472nDivisions" data-ref-filename="472nDivisions">nDivisions</dfn> = <a class="local col8 ref" href="#438framesToProcess" title='framesToProcess' data-ref="438framesToProcess" data-ref-filename="438framesToProcess">framesToProcess</a> / <a class="local col1 ref" href="#471nDivisionFrames" title='nDivisionFrames' data-ref="471nDivisionFrames" data-ref-filename="471nDivisionFrames">nDivisionFrames</a>;</td></tr>
<tr><th id="265">265</th><td></td></tr>
<tr><th id="266">266</th><td>    <em>unsigned</em> <dfn class="local col3 decl" id="473frameIndex" title='frameIndex' data-type='unsigned int' data-ref="473frameIndex" data-ref-filename="473frameIndex">frameIndex</dfn> = <var>0</var>;</td></tr>
<tr><th id="267">267</th><td>    <b>for</b> (<em>int</em> <dfn class="local col4 decl" id="474i" title='i' data-type='int' data-ref="474i" data-ref-filename="474i">i</dfn> = <var>0</var>; <a class="local col4 ref" href="#474i" title='i' data-ref="474i" data-ref-filename="474i">i</a> &lt; <a class="local col2 ref" href="#472nDivisions" title='nDivisions' data-ref="472nDivisions" data-ref-filename="472nDivisions">nDivisions</a>; ++<a class="local col4 ref" href="#474i" title='i' data-ref="474i" data-ref-filename="474i">i</a>) {</td></tr>
<tr><th id="268">268</th><td>        <i>// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</i></td></tr>
<tr><th id="269">269</th><td><i>        // Calculate desired gain</i></td></tr>
<tr><th id="270">270</th><td><i>        // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</i></td></tr>
<tr><th id="271">271</th><td><i></i></td></tr>
<tr><th id="272">272</th><td><i>        // Fix gremlins.</i></td></tr>
<tr><th id="273">273</th><td>        <b>if</b> (<span class="namespace">std::</span><span class='ref fn' title='isnan' data-ref="_ZL5isnanf" data-ref-filename="_ZL5isnanf">isnan</span>(<a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_detectorAverage" title='WebCore::DynamicsCompressorKernel::m_detectorAverage' data-ref="WebCore::DynamicsCompressorKernel::m_detectorAverage" data-ref-filename="WebCore..DynamicsCompressorKernel..m_detectorAverage">m_detectorAverage</a>))</td></tr>
<tr><th id="274">274</th><td>            <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_detectorAverage" title='WebCore::DynamicsCompressorKernel::m_detectorAverage' data-ref="WebCore::DynamicsCompressorKernel::m_detectorAverage" data-ref-filename="WebCore..DynamicsCompressorKernel..m_detectorAverage">m_detectorAverage</a> = <var>1</var>;</td></tr>
<tr><th id="275">275</th><td>        <b>if</b> (<span class="namespace">std::</span><span class='ref fn' title='isinf' data-ref="_ZL5isinff" data-ref-filename="_ZL5isinff">isinf</span>(<a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_detectorAverage" title='WebCore::DynamicsCompressorKernel::m_detectorAverage' data-ref="WebCore::DynamicsCompressorKernel::m_detectorAverage" data-ref-filename="WebCore..DynamicsCompressorKernel..m_detectorAverage">m_detectorAverage</a>))</td></tr>
<tr><th id="276">276</th><td>            <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_detectorAverage" title='WebCore::DynamicsCompressorKernel::m_detectorAverage' data-ref="WebCore::DynamicsCompressorKernel::m_detectorAverage" data-ref-filename="WebCore..DynamicsCompressorKernel..m_detectorAverage">m_detectorAverage</a> = <var>1</var>;</td></tr>
<tr><th id="277">277</th><td></td></tr>
<tr><th id="278">278</th><td>        <em>float</em> <dfn class="local col5 decl" id="475desiredGain" title='desiredGain' data-type='float' data-ref="475desiredGain" data-ref-filename="475desiredGain">desiredGain</dfn> = <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_detectorAverage" title='WebCore::DynamicsCompressorKernel::m_detectorAverage' data-ref="WebCore::DynamicsCompressorKernel::m_detectorAverage" data-ref-filename="WebCore..DynamicsCompressorKernel..m_detectorAverage">m_detectorAverage</a>;</td></tr>
<tr><th id="279">279</th><td></td></tr>
<tr><th id="280">280</th><td>        <i>// Pre-warp so we get desiredGain after sin() warp below.</i></td></tr>
<tr><th id="281">281</th><td>        <em>float</em> <dfn class="local col6 decl" id="476scaledDesiredGain" title='scaledDesiredGain' data-type='float' data-ref="476scaledDesiredGain" data-ref-filename="476scaledDesiredGain">scaledDesiredGain</dfn> = <span class='ref fn' title='asinf' data-ref="asinf" data-ref-filename="asinf">asinf</span>(<a class="local col5 ref" href="#475desiredGain" title='desiredGain' data-ref="475desiredGain" data-ref-filename="475desiredGain">desiredGain</a>) / (<var>0.5f</var> * <a class="ref" href="../../../../WebKitBuild/Debug/usr/local/include/wtf/MathExtras.h.html#piFloat" title='piFloat' data-ref="piFloat" data-ref-filename="piFloat">piFloat</a>);</td></tr>
<tr><th id="282">282</th><td></td></tr>
<tr><th id="283">283</th><td>        <i>// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</i></td></tr>
<tr><th id="284">284</th><td><i>        // Deal with envelopes</i></td></tr>
<tr><th id="285">285</th><td><i>        // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</i></td></tr>
<tr><th id="286">286</th><td><i></i></td></tr>
<tr><th id="287">287</th><td><i>        // envelopeRate is the rate we slew from current compressor level to the desired level.</i></td></tr>
<tr><th id="288">288</th><td><i>        // The exact rate depends on if we're attacking or releasing and by how much.</i></td></tr>
<tr><th id="289">289</th><td>        <em>float</em> <dfn class="local col7 decl" id="477envelopeRate" title='envelopeRate' data-type='float' data-ref="477envelopeRate" data-ref-filename="477envelopeRate">envelopeRate</dfn>;</td></tr>
<tr><th id="290">290</th><td></td></tr>
<tr><th id="291">291</th><td>        <em>bool</em> <dfn class="local col8 decl" id="478isReleasing" title='isReleasing' data-type='bool' data-ref="478isReleasing" data-ref-filename="478isReleasing">isReleasing</dfn> = <a class="local col6 ref" href="#476scaledDesiredGain" title='scaledDesiredGain' data-ref="476scaledDesiredGain" data-ref-filename="476scaledDesiredGain">scaledDesiredGain</a> &gt; <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_compressorGain" title='WebCore::DynamicsCompressorKernel::m_compressorGain' data-ref="WebCore::DynamicsCompressorKernel::m_compressorGain" data-ref-filename="WebCore..DynamicsCompressorKernel..m_compressorGain">m_compressorGain</a>;</td></tr>
<tr><th id="292">292</th><td></td></tr>
<tr><th id="293">293</th><td>        <i>// compressionDiffDb is the difference between current compression level and the desired level.</i></td></tr>
<tr><th id="294">294</th><td>        <em>float</em> <dfn class="local col9 decl" id="479compressionDiffDb" title='compressionDiffDb' data-type='float' data-ref="479compressionDiffDb" data-ref-filename="479compressionDiffDb">compressionDiffDb</dfn> = <a class="ref fn" href="AudioUtilities.h.html#_ZN7WebCore14AudioUtilities16linearToDecibelsEf" title='WebCore::AudioUtilities::linearToDecibels' data-ref="_ZN7WebCore14AudioUtilities16linearToDecibelsEf" data-ref-filename="_ZN7WebCore14AudioUtilities16linearToDecibelsEf">linearToDecibels</a>(<a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_compressorGain" title='WebCore::DynamicsCompressorKernel::m_compressorGain' data-ref="WebCore::DynamicsCompressorKernel::m_compressorGain" data-ref-filename="WebCore..DynamicsCompressorKernel..m_compressorGain">m_compressorGain</a> / <a class="local col6 ref" href="#476scaledDesiredGain" title='scaledDesiredGain' data-ref="476scaledDesiredGain" data-ref-filename="476scaledDesiredGain">scaledDesiredGain</a>);</td></tr>
<tr><th id="295">295</th><td></td></tr>
<tr><th id="296">296</th><td>        <b>if</b> (<a class="local col8 ref" href="#478isReleasing" title='isReleasing' data-ref="478isReleasing" data-ref-filename="478isReleasing">isReleasing</a>) {</td></tr>
<tr><th id="297">297</th><td>            <i>// Release mode - compressionDiffDb should be negative dB</i></td></tr>
<tr><th id="298">298</th><td>            <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb" title='WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb' data-ref="WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb" data-ref-filename="WebCore..DynamicsCompressorKernel..m_maxAttackCompressionDiffDb">m_maxAttackCompressionDiffDb</a> = -<var>1</var>;</td></tr>
<tr><th id="299">299</th><td></td></tr>
<tr><th id="300">300</th><td>            <i>// Fix gremlins.</i></td></tr>
<tr><th id="301">301</th><td>            <b>if</b> (<span class="namespace">std::</span><span class='ref fn' title='isnan' data-ref="_ZL5isnanf" data-ref-filename="_ZL5isnanf">isnan</span>(<a class="local col9 ref" href="#479compressionDiffDb" title='compressionDiffDb' data-ref="479compressionDiffDb" data-ref-filename="479compressionDiffDb">compressionDiffDb</a>))</td></tr>
<tr><th id="302">302</th><td>                <a class="local col9 ref" href="#479compressionDiffDb" title='compressionDiffDb' data-ref="479compressionDiffDb" data-ref-filename="479compressionDiffDb">compressionDiffDb</a> = -<var>1</var>;</td></tr>
<tr><th id="303">303</th><td>            <b>if</b> (<span class="namespace">std::</span><span class='ref fn' title='isinf' data-ref="_ZL5isinff" data-ref-filename="_ZL5isinff">isinf</span>(<a class="local col9 ref" href="#479compressionDiffDb" title='compressionDiffDb' data-ref="479compressionDiffDb" data-ref-filename="479compressionDiffDb">compressionDiffDb</a>))</td></tr>
<tr><th id="304">304</th><td>                <a class="local col9 ref" href="#479compressionDiffDb" title='compressionDiffDb' data-ref="479compressionDiffDb" data-ref-filename="479compressionDiffDb">compressionDiffDb</a> = -<var>1</var>;</td></tr>
<tr><th id="305">305</th><td></td></tr>
<tr><th id="306">306</th><td>            <i>// Adaptive release - higher compression (lower compressionDiffDb)  releases faster.</i></td></tr>
<tr><th id="307">307</th><td><i></i></td></tr>
<tr><th id="308">308</th><td><i>            // Contain within range: -12 -&gt; 0 then scale to go from 0 -&gt; 3</i></td></tr>
<tr><th id="309">309</th><td>            <em>float</em> <dfn class="local col0 decl" id="480x" title='x' data-type='float' data-ref="480x" data-ref-filename="480x">x</dfn> = <a class="local col9 ref" href="#479compressionDiffDb" title='compressionDiffDb' data-ref="479compressionDiffDb" data-ref-filename="479compressionDiffDb">compressionDiffDb</a>;</td></tr>
<tr><th id="310">310</th><td>            <a class="local col0 ref" href="#480x" title='x' data-ref="480x" data-ref-filename="480x">x</a> = <span class="namespace">std::</span><span class='ref fn' title='std::__1::max' data-ref="_ZNSt3__1L3maxERKT_S2_" data-ref-filename="_ZNSt3__1L3maxERKT_S2_">max</span>(-<var>12.0f</var>, <a class="local col0 ref" href="#480x" title='x' data-ref="480x" data-ref-filename="480x">x</a>);</td></tr>
<tr><th id="311">311</th><td>            <a class="local col0 ref" href="#480x" title='x' data-ref="480x" data-ref-filename="480x">x</a> = <span class="namespace">std::</span><span class='ref fn' title='std::__1::min' data-ref="_ZNSt3__1L3minERKT_S2_" data-ref-filename="_ZNSt3__1L3minERKT_S2_">min</span>(<var>0.0f</var>, <a class="local col0 ref" href="#480x" title='x' data-ref="480x" data-ref-filename="480x">x</a>);</td></tr>
<tr><th id="312">312</th><td>            <a class="local col0 ref" href="#480x" title='x' data-ref="480x" data-ref-filename="480x">x</a> = <var>0.25f</var> * (<a class="local col0 ref" href="#480x" title='x' data-ref="480x" data-ref-filename="480x">x</a> + <var>12</var>);</td></tr>
<tr><th id="313">313</th><td></td></tr>
<tr><th id="314">314</th><td>            <i>// Compute adaptive release curve using 4th order polynomial.</i></td></tr>
<tr><th id="315">315</th><td><i>            // Normal values for the polynomial coefficients would create a monotonically increasing function.</i></td></tr>
<tr><th id="316">316</th><td>            <em>float</em> <dfn class="local col1 decl" id="481x2" title='x2' data-type='float' data-ref="481x2" data-ref-filename="481x2">x2</dfn> = <a class="local col0 ref" href="#480x" title='x' data-ref="480x" data-ref-filename="480x">x</a> * <a class="local col0 ref" href="#480x" title='x' data-ref="480x" data-ref-filename="480x">x</a>;</td></tr>
<tr><th id="317">317</th><td>            <em>float</em> <dfn class="local col2 decl" id="482x3" title='x3' data-type='float' data-ref="482x3" data-ref-filename="482x3">x3</dfn> = <a class="local col1 ref" href="#481x2" title='x2' data-ref="481x2" data-ref-filename="481x2">x2</a> * <a class="local col0 ref" href="#480x" title='x' data-ref="480x" data-ref-filename="480x">x</a>;</td></tr>
<tr><th id="318">318</th><td>            <em>float</em> <dfn class="local col3 decl" id="483x4" title='x4' data-type='float' data-ref="483x4" data-ref-filename="483x4">x4</dfn> = <a class="local col1 ref" href="#481x2" title='x2' data-ref="481x2" data-ref-filename="481x2">x2</a> * <a class="local col1 ref" href="#481x2" title='x2' data-ref="481x2" data-ref-filename="481x2">x2</a>;</td></tr>
<tr><th id="319">319</th><td>            <em>float</em> <dfn class="local col4 decl" id="484releaseFrames" title='releaseFrames' data-type='float' data-ref="484releaseFrames" data-ref-filename="484releaseFrames">releaseFrames</dfn> = <a class="local col6 ref" href="#466kA" title='kA' data-ref="466kA" data-ref-filename="466kA">kA</a> + <a class="local col7 ref" href="#467kB" title='kB' data-ref="467kB" data-ref-filename="467kB">kB</a> * <a class="local col0 ref" href="#480x" title='x' data-ref="480x" data-ref-filename="480x">x</a> + <a class="local col8 ref" href="#468kC" title='kC' data-ref="468kC" data-ref-filename="468kC">kC</a> * <a class="local col1 ref" href="#481x2" title='x2' data-ref="481x2" data-ref-filename="481x2">x2</a> + <a class="local col9 ref" href="#469kD" title='kD' data-ref="469kD" data-ref-filename="469kD">kD</a> * <a class="local col2 ref" href="#482x3" title='x3' data-ref="482x3" data-ref-filename="482x3">x3</a> + <a class="local col0 ref" href="#470kE" title='kE' data-ref="470kE" data-ref-filename="470kE">kE</a> * <a class="local col3 ref" href="#483x4" title='x4' data-ref="483x4" data-ref-filename="483x4">x4</a>;</td></tr>
<tr><th id="320">320</th><td></td></tr>
<tr><th id="321">321</th><td><u>#define <dfn class="macro" id="_M/kSpacingDb" data-ref="_M/kSpacingDb">kSpacingDb</dfn> 5</u></td></tr>
<tr><th id="322">322</th><td>            <em>float</em> <dfn class="local col5 decl" id="485dbPerFrame" title='dbPerFrame' data-type='float' data-ref="485dbPerFrame" data-ref-filename="485dbPerFrame">dbPerFrame</dfn> = <a class="macro" href="#321" title="5" data-ref="_M/kSpacingDb">kSpacingDb</a> / <a class="local col4 ref" href="#484releaseFrames" title='releaseFrames' data-ref="484releaseFrames" data-ref-filename="484releaseFrames">releaseFrames</a>;</td></tr>
<tr><th id="323">323</th><td></td></tr>
<tr><th id="324">324</th><td>            <a class="local col7 ref" href="#477envelopeRate" title='envelopeRate' data-ref="477envelopeRate" data-ref-filename="477envelopeRate">envelopeRate</a> = <a class="ref fn" href="AudioUtilities.h.html#_ZN7WebCore14AudioUtilities16decibelsToLinearEf" title='WebCore::AudioUtilities::decibelsToLinear' data-ref="_ZN7WebCore14AudioUtilities16decibelsToLinearEf" data-ref-filename="_ZN7WebCore14AudioUtilities16decibelsToLinearEf">decibelsToLinear</a>(<a class="local col5 ref" href="#485dbPerFrame" title='dbPerFrame' data-ref="485dbPerFrame" data-ref-filename="485dbPerFrame">dbPerFrame</a>);</td></tr>
<tr><th id="325">325</th><td>        } <b>else</b> {</td></tr>
<tr><th id="326">326</th><td>            <i>// Attack mode - compressionDiffDb should be positive dB</i></td></tr>
<tr><th id="327">327</th><td><i></i></td></tr>
<tr><th id="328">328</th><td><i>            // Fix gremlins.</i></td></tr>
<tr><th id="329">329</th><td>            <b>if</b> (<span class="namespace">std::</span><span class='ref fn' title='isnan' data-ref="_ZL5isnanf" data-ref-filename="_ZL5isnanf">isnan</span>(<a class="local col9 ref" href="#479compressionDiffDb" title='compressionDiffDb' data-ref="479compressionDiffDb" data-ref-filename="479compressionDiffDb">compressionDiffDb</a>))</td></tr>
<tr><th id="330">330</th><td>                <a class="local col9 ref" href="#479compressionDiffDb" title='compressionDiffDb' data-ref="479compressionDiffDb" data-ref-filename="479compressionDiffDb">compressionDiffDb</a> = <var>1</var>;</td></tr>
<tr><th id="331">331</th><td>            <b>if</b> (<span class="namespace">std::</span><span class='ref fn' title='isinf' data-ref="_ZL5isinff" data-ref-filename="_ZL5isinff">isinf</span>(<a class="local col9 ref" href="#479compressionDiffDb" title='compressionDiffDb' data-ref="479compressionDiffDb" data-ref-filename="479compressionDiffDb">compressionDiffDb</a>))</td></tr>
<tr><th id="332">332</th><td>                <a class="local col9 ref" href="#479compressionDiffDb" title='compressionDiffDb' data-ref="479compressionDiffDb" data-ref-filename="479compressionDiffDb">compressionDiffDb</a> = <var>1</var>;</td></tr>
<tr><th id="333">333</th><td></td></tr>
<tr><th id="334">334</th><td>            <i>// As long as we're still in attack mode, use a rate based off</i></td></tr>
<tr><th id="335">335</th><td><i>            // the largest compressionDiffDb we've encountered so far.</i></td></tr>
<tr><th id="336">336</th><td>            <b>if</b> (<a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb" title='WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb' data-ref="WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb" data-ref-filename="WebCore..DynamicsCompressorKernel..m_maxAttackCompressionDiffDb">m_maxAttackCompressionDiffDb</a> == -<var>1</var> || <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb" title='WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb' data-ref="WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb" data-ref-filename="WebCore..DynamicsCompressorKernel..m_maxAttackCompressionDiffDb">m_maxAttackCompressionDiffDb</a> &lt; <a class="local col9 ref" href="#479compressionDiffDb" title='compressionDiffDb' data-ref="479compressionDiffDb" data-ref-filename="479compressionDiffDb">compressionDiffDb</a>)</td></tr>
<tr><th id="337">337</th><td>                <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb" title='WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb' data-ref="WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb" data-ref-filename="WebCore..DynamicsCompressorKernel..m_maxAttackCompressionDiffDb">m_maxAttackCompressionDiffDb</a> = <a class="local col9 ref" href="#479compressionDiffDb" title='compressionDiffDb' data-ref="479compressionDiffDb" data-ref-filename="479compressionDiffDb">compressionDiffDb</a>;</td></tr>
<tr><th id="338">338</th><td></td></tr>
<tr><th id="339">339</th><td>            <em>float</em> <dfn class="local col6 decl" id="486effAttenDiffDb" title='effAttenDiffDb' data-type='float' data-ref="486effAttenDiffDb" data-ref-filename="486effAttenDiffDb">effAttenDiffDb</dfn> = <span class="namespace">std::</span><span class='ref fn' title='std::__1::max' data-ref="_ZNSt3__1L3maxERKT_S2_" data-ref-filename="_ZNSt3__1L3maxERKT_S2_">max</span>(<var>0.5f</var>, <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb" title='WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb' data-ref="WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb" data-ref-filename="WebCore..DynamicsCompressorKernel..m_maxAttackCompressionDiffDb">m_maxAttackCompressionDiffDb</a>);</td></tr>
<tr><th id="340">340</th><td></td></tr>
<tr><th id="341">341</th><td>            <em>float</em> <dfn class="local col7 decl" id="487x" title='x' data-type='float' data-ref="487x" data-ref-filename="487x">x</dfn> = <var>0.25f</var> / <a class="local col6 ref" href="#486effAttenDiffDb" title='effAttenDiffDb' data-ref="486effAttenDiffDb" data-ref-filename="486effAttenDiffDb">effAttenDiffDb</a>;</td></tr>
<tr><th id="342">342</th><td>            <a class="local col7 ref" href="#477envelopeRate" title='envelopeRate' data-ref="477envelopeRate" data-ref-filename="477envelopeRate">envelopeRate</a> = <var>1</var> - <span class='ref fn' title='powf' data-ref="powf" data-ref-filename="powf">powf</span>(<a class="local col7 ref" href="#487x" title='x' data-ref="487x" data-ref-filename="487x">x</a>, <var>1</var> / <a class="local col8 ref" href="#458attackFrames" title='attackFrames' data-ref="458attackFrames" data-ref-filename="458attackFrames">attackFrames</a>);</td></tr>
<tr><th id="343">343</th><td>        }</td></tr>
<tr><th id="344">344</th><td></td></tr>
<tr><th id="345">345</th><td>        <i>// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</i></td></tr>
<tr><th id="346">346</th><td><i>        // Inner loop - calculate shaped power average - apply compression.</i></td></tr>
<tr><th id="347">347</th><td><i>        // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</i></td></tr>
<tr><th id="348">348</th><td></td></tr>
<tr><th id="349">349</th><td>        {</td></tr>
<tr><th id="350">350</th><td>            <em>int</em> <dfn class="local col8 decl" id="488preDelayReadIndex" title='preDelayReadIndex' data-type='int' data-ref="488preDelayReadIndex" data-ref-filename="488preDelayReadIndex">preDelayReadIndex</dfn> = <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayReadIndex" title='WebCore::DynamicsCompressorKernel::m_preDelayReadIndex' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayReadIndex" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayReadIndex">m_preDelayReadIndex</a>;</td></tr>
<tr><th id="351">351</th><td>            <em>int</em> <dfn class="local col9 decl" id="489preDelayWriteIndex" title='preDelayWriteIndex' data-type='int' data-ref="489preDelayWriteIndex" data-ref-filename="489preDelayWriteIndex">preDelayWriteIndex</dfn> = <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayWriteIndex" title='WebCore::DynamicsCompressorKernel::m_preDelayWriteIndex' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayWriteIndex" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayWriteIndex">m_preDelayWriteIndex</a>;</td></tr>
<tr><th id="352">352</th><td>            <em>float</em> <dfn class="local col0 decl" id="490detectorAverage" title='detectorAverage' data-type='float' data-ref="490detectorAverage" data-ref-filename="490detectorAverage">detectorAverage</dfn> = <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_detectorAverage" title='WebCore::DynamicsCompressorKernel::m_detectorAverage' data-ref="WebCore::DynamicsCompressorKernel::m_detectorAverage" data-ref-filename="WebCore..DynamicsCompressorKernel..m_detectorAverage">m_detectorAverage</a>;</td></tr>
<tr><th id="353">353</th><td>            <em>float</em> <dfn class="local col1 decl" id="491compressorGain" title='compressorGain' data-type='float' data-ref="491compressorGain" data-ref-filename="491compressorGain">compressorGain</dfn> = <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_compressorGain" title='WebCore::DynamicsCompressorKernel::m_compressorGain' data-ref="WebCore::DynamicsCompressorKernel::m_compressorGain" data-ref-filename="WebCore..DynamicsCompressorKernel..m_compressorGain">m_compressorGain</a>;</td></tr>
<tr><th id="354">354</th><td></td></tr>
<tr><th id="355">355</th><td>            <em>int</em> <dfn class="local col2 decl" id="492loopFrames" title='loopFrames' data-type='int' data-ref="492loopFrames" data-ref-filename="492loopFrames">loopFrames</dfn> = <a class="local col1 ref" href="#471nDivisionFrames" title='nDivisionFrames' data-ref="471nDivisionFrames" data-ref-filename="471nDivisionFrames">nDivisionFrames</a>;</td></tr>
<tr><th id="356">356</th><td>            <b>while</b> (<a class="local col2 ref" href="#492loopFrames" title='loopFrames' data-ref="492loopFrames" data-ref-filename="492loopFrames">loopFrames</a>--) {</td></tr>
<tr><th id="357">357</th><td>                <em>float</em> <dfn class="local col3 decl" id="493compressorInput" title='compressorInput' data-type='float' data-ref="493compressorInput" data-ref-filename="493compressorInput">compressorInput</dfn> = <var>0</var>;</td></tr>
<tr><th id="358">358</th><td></td></tr>
<tr><th id="359">359</th><td>                <i>// Predelay signal, computing compression amount from un-delayed version.</i></td></tr>
<tr><th id="360">360</th><td>                <b>for</b> (<em>unsigned</em> <dfn class="local col4 decl" id="494i" title='i' data-type='unsigned int' data-ref="494i" data-ref-filename="494i">i</dfn> = <var>0</var>; <a class="local col4 ref" href="#494i" title='i' data-ref="494i" data-ref-filename="494i">i</a> &lt; <a class="local col7 ref" href="#437numberOfChannels" title='numberOfChannels' data-ref="437numberOfChannels" data-ref-filename="437numberOfChannels">numberOfChannels</a>; ++<a class="local col4 ref" href="#494i" title='i' data-ref="494i" data-ref-filename="494i">i</a>) {</td></tr>
<tr><th id="361">361</th><td>                    <em>float</em>* <dfn class="local col5 decl" id="495delayBuffer" title='delayBuffer' data-type='float *' data-ref="495delayBuffer" data-ref-filename="495delayBuffer">delayBuffer</dfn> = <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayBuffers" title='WebCore::DynamicsCompressorKernel::m_preDelayBuffers' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayBuffers" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayBuffers">m_preDelayBuffers</a><a class="ref fn" href="../../../../WebKitBuild/Debug/usr/local/include/wtf/Vector.h.html#_ZN3WTF6VectorixEm" title='WTF::Vector::operator[]' data-ref="_ZN3WTF6VectorixEm" data-ref-filename="_ZN3WTF6VectorixEm">[<a class="local col4 ref" href="#494i" title='i' data-ref="494i" data-ref-filename="494i">i</a>]</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref fn" href="AudioArray.h.html#_ZN7WebCore10AudioArray4dataEv" title='WebCore::AudioArray::data' data-ref="_ZN7WebCore10AudioArray4dataEv" data-ref-filename="_ZN7WebCore10AudioArray4dataEv">data</a>();</td></tr>
<tr><th id="362">362</th><td>                    <em>float</em> <dfn class="local col6 decl" id="496undelayedSource" title='undelayedSource' data-type='float' data-ref="496undelayedSource" data-ref-filename="496undelayedSource">undelayedSource</dfn> = <a class="local col5 ref" href="#435sourceChannels" title='sourceChannels' data-ref="435sourceChannels" data-ref-filename="435sourceChannels">sourceChannels</a>[<a class="local col4 ref" href="#494i" title='i' data-ref="494i" data-ref-filename="494i">i</a>][<a class="local col3 ref" href="#473frameIndex" title='frameIndex' data-ref="473frameIndex" data-ref-filename="473frameIndex">frameIndex</a>];</td></tr>
<tr><th id="363">363</th><td>                    <a class="local col5 ref" href="#495delayBuffer" title='delayBuffer' data-ref="495delayBuffer" data-ref-filename="495delayBuffer">delayBuffer</a>[<a class="local col9 ref" href="#489preDelayWriteIndex" title='preDelayWriteIndex' data-ref="489preDelayWriteIndex" data-ref-filename="489preDelayWriteIndex">preDelayWriteIndex</a>] = <a class="local col6 ref" href="#496undelayedSource" title='undelayedSource' data-ref="496undelayedSource" data-ref-filename="496undelayedSource">undelayedSource</a>;</td></tr>
<tr><th id="364">364</th><td></td></tr>
<tr><th id="365">365</th><td>                    <em>float</em> <dfn class="local col7 decl" id="497absUndelayedSource" title='absUndelayedSource' data-type='float' data-ref="497absUndelayedSource" data-ref-filename="497absUndelayedSource">absUndelayedSource</dfn> = <a class="local col6 ref" href="#496undelayedSource" title='undelayedSource' data-ref="496undelayedSource" data-ref-filename="496undelayedSource">undelayedSource</a> &gt; <var>0</var> ? <a class="local col6 ref" href="#496undelayedSource" title='undelayedSource' data-ref="496undelayedSource" data-ref-filename="496undelayedSource">undelayedSource</a> : -<a class="local col6 ref" href="#496undelayedSource" title='undelayedSource' data-ref="496undelayedSource" data-ref-filename="496undelayedSource">undelayedSource</a>;</td></tr>
<tr><th id="366">366</th><td>                    <b>if</b> (<a class="local col3 ref" href="#493compressorInput" title='compressorInput' data-ref="493compressorInput" data-ref-filename="493compressorInput">compressorInput</a> &lt; <a class="local col7 ref" href="#497absUndelayedSource" title='absUndelayedSource' data-ref="497absUndelayedSource" data-ref-filename="497absUndelayedSource">absUndelayedSource</a>)</td></tr>
<tr><th id="367">367</th><td>                        <a class="local col3 ref" href="#493compressorInput" title='compressorInput' data-ref="493compressorInput" data-ref-filename="493compressorInput">compressorInput</a> = <a class="local col7 ref" href="#497absUndelayedSource" title='absUndelayedSource' data-ref="497absUndelayedSource" data-ref-filename="497absUndelayedSource">absUndelayedSource</a>;</td></tr>
<tr><th id="368">368</th><td>                }</td></tr>
<tr><th id="369">369</th><td></td></tr>
<tr><th id="370">370</th><td>                <i>// Calculate shaped power on undelayed input.</i></td></tr>
<tr><th id="371">371</th><td></td></tr>
<tr><th id="372">372</th><td>                <em>float</em> <dfn class="local col8 decl" id="498scaledInput" title='scaledInput' data-type='float' data-ref="498scaledInput" data-ref-filename="498scaledInput">scaledInput</dfn> = <a class="local col3 ref" href="#493compressorInput" title='compressorInput' data-ref="493compressorInput" data-ref-filename="493compressorInput">compressorInput</a>;</td></tr>
<tr><th id="373">373</th><td>                <em>float</em> <dfn class="local col9 decl" id="499absInput" title='absInput' data-type='float' data-ref="499absInput" data-ref-filename="499absInput">absInput</dfn> = <a class="local col8 ref" href="#498scaledInput" title='scaledInput' data-ref="498scaledInput" data-ref-filename="498scaledInput">scaledInput</a> &gt; <var>0</var> ? <a class="local col8 ref" href="#498scaledInput" title='scaledInput' data-ref="498scaledInput" data-ref-filename="498scaledInput">scaledInput</a> : -<a class="local col8 ref" href="#498scaledInput" title='scaledInput' data-ref="498scaledInput" data-ref-filename="498scaledInput">scaledInput</a>;</td></tr>
<tr><th id="374">374</th><td></td></tr>
<tr><th id="375">375</th><td>                <i>// Put through shaping curve.</i></td></tr>
<tr><th id="376">376</th><td><i>                // This is linear up to the threshold, then enters a "knee" portion followed by the "ratio" portion.</i></td></tr>
<tr><th id="377">377</th><td><i>                // The transition from the threshold to the knee is smooth (1st derivative matched).</i></td></tr>
<tr><th id="378">378</th><td><i>                // The transition from the knee to the ratio portion is smooth (1st derivative matched).</i></td></tr>
<tr><th id="379">379</th><td>                <em>float</em> <dfn class="local col0 decl" id="500shapedInput" title='shapedInput' data-type='float' data-ref="500shapedInput" data-ref-filename="500shapedInput">shapedInput</dfn> = <a class="member fn" href="#_ZN7WebCore24DynamicsCompressorKernel8saturateEff" title='WebCore::DynamicsCompressorKernel::saturate' data-ref="_ZN7WebCore24DynamicsCompressorKernel8saturateEff" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel8saturateEff">saturate</a>(<a class="local col9 ref" href="#499absInput" title='absInput' data-ref="499absInput" data-ref-filename="499absInput">absInput</a>, <a class="local col4 ref" href="#454k" title='k' data-ref="454k" data-ref-filename="454k">k</a>);</td></tr>
<tr><th id="380">380</th><td></td></tr>
<tr><th id="381">381</th><td>                <em>float</em> <dfn class="local col1 decl" id="501attenuation" title='attenuation' data-type='float' data-ref="501attenuation" data-ref-filename="501attenuation">attenuation</dfn> = <a class="local col9 ref" href="#499absInput" title='absInput' data-ref="499absInput" data-ref-filename="499absInput">absInput</a> &lt;= <var>0.0001f</var> ? <var>1</var> : <a class="local col0 ref" href="#500shapedInput" title='shapedInput' data-ref="500shapedInput" data-ref-filename="500shapedInput">shapedInput</a> / <a class="local col9 ref" href="#499absInput" title='absInput' data-ref="499absInput" data-ref-filename="499absInput">absInput</a>;</td></tr>
<tr><th id="382">382</th><td></td></tr>
<tr><th id="383">383</th><td>                <em>float</em> <dfn class="local col2 decl" id="502attenuationDb" title='attenuationDb' data-type='float' data-ref="502attenuationDb" data-ref-filename="502attenuationDb">attenuationDb</dfn> = -<a class="ref fn" href="AudioUtilities.h.html#_ZN7WebCore14AudioUtilities16linearToDecibelsEf" title='WebCore::AudioUtilities::linearToDecibels' data-ref="_ZN7WebCore14AudioUtilities16linearToDecibelsEf" data-ref-filename="_ZN7WebCore14AudioUtilities16linearToDecibelsEf">linearToDecibels</a>(<a class="local col1 ref" href="#501attenuation" title='attenuation' data-ref="501attenuation" data-ref-filename="501attenuation">attenuation</a>);</td></tr>
<tr><th id="384">384</th><td>                <a class="local col2 ref" href="#502attenuationDb" title='attenuationDb' data-ref="502attenuationDb" data-ref-filename="502attenuationDb">attenuationDb</a> = <span class="namespace">std::</span><span class='ref fn' title='std::__1::max' data-ref="_ZNSt3__1L3maxERKT_S2_" data-ref-filename="_ZNSt3__1L3maxERKT_S2_">max</span>(<var>2.0f</var>, <a class="local col2 ref" href="#502attenuationDb" title='attenuationDb' data-ref="502attenuationDb" data-ref-filename="502attenuationDb">attenuationDb</a>);</td></tr>
<tr><th id="385">385</th><td></td></tr>
<tr><th id="386">386</th><td>                <em>float</em> <dfn class="local col3 decl" id="503dbPerFrame" title='dbPerFrame' data-type='float' data-ref="503dbPerFrame" data-ref-filename="503dbPerFrame">dbPerFrame</dfn> = <a class="local col2 ref" href="#502attenuationDb" title='attenuationDb' data-ref="502attenuationDb" data-ref-filename="502attenuationDb">attenuationDb</a> / <a class="local col1 ref" href="#461satReleaseFrames" title='satReleaseFrames' data-ref="461satReleaseFrames" data-ref-filename="461satReleaseFrames">satReleaseFrames</a>;</td></tr>
<tr><th id="387">387</th><td></td></tr>
<tr><th id="388">388</th><td>                <em>float</em> <dfn class="local col4 decl" id="504satReleaseRate" title='satReleaseRate' data-type='float' data-ref="504satReleaseRate" data-ref-filename="504satReleaseRate">satReleaseRate</dfn> = <a class="ref fn" href="AudioUtilities.h.html#_ZN7WebCore14AudioUtilities16decibelsToLinearEf" title='WebCore::AudioUtilities::decibelsToLinear' data-ref="_ZN7WebCore14AudioUtilities16decibelsToLinearEf" data-ref-filename="_ZN7WebCore14AudioUtilities16decibelsToLinearEf">decibelsToLinear</a>(<a class="local col3 ref" href="#503dbPerFrame" title='dbPerFrame' data-ref="503dbPerFrame" data-ref-filename="503dbPerFrame">dbPerFrame</a>) - <var>1</var>;</td></tr>
<tr><th id="389">389</th><td></td></tr>
<tr><th id="390">390</th><td>                <em>bool</em> <dfn class="local col5 decl" id="505isRelease" title='isRelease' data-type='bool' data-ref="505isRelease" data-ref-filename="505isRelease">isRelease</dfn> = (<a class="local col1 ref" href="#501attenuation" title='attenuation' data-ref="501attenuation" data-ref-filename="501attenuation">attenuation</a> &gt; <a class="local col0 ref" href="#490detectorAverage" title='detectorAverage' data-ref="490detectorAverage" data-ref-filename="490detectorAverage">detectorAverage</a>);</td></tr>
<tr><th id="391">391</th><td>                <em>float</em> <dfn class="local col6 decl" id="506rate" title='rate' data-type='float' data-ref="506rate" data-ref-filename="506rate">rate</dfn> = <a class="local col5 ref" href="#505isRelease" title='isRelease' data-ref="505isRelease" data-ref-filename="505isRelease">isRelease</a> ? <a class="local col4 ref" href="#504satReleaseRate" title='satReleaseRate' data-ref="504satReleaseRate" data-ref-filename="504satReleaseRate">satReleaseRate</a> : <var>1</var>;</td></tr>
<tr><th id="392">392</th><td></td></tr>
<tr><th id="393">393</th><td>                <a class="local col0 ref" href="#490detectorAverage" title='detectorAverage' data-ref="490detectorAverage" data-ref-filename="490detectorAverage">detectorAverage</a> += (<a class="local col1 ref" href="#501attenuation" title='attenuation' data-ref="501attenuation" data-ref-filename="501attenuation">attenuation</a> - <a class="local col0 ref" href="#490detectorAverage" title='detectorAverage' data-ref="490detectorAverage" data-ref-filename="490detectorAverage">detectorAverage</a>) * <a class="local col6 ref" href="#506rate" title='rate' data-ref="506rate" data-ref-filename="506rate">rate</a>;</td></tr>
<tr><th id="394">394</th><td>                <a class="local col0 ref" href="#490detectorAverage" title='detectorAverage' data-ref="490detectorAverage" data-ref-filename="490detectorAverage">detectorAverage</a> = <span class="namespace">std::</span><span class='ref fn' title='std::__1::min' data-ref="_ZNSt3__1L3minERKT_S2_" data-ref-filename="_ZNSt3__1L3minERKT_S2_">min</span>(<var>1.0f</var>, <a class="local col0 ref" href="#490detectorAverage" title='detectorAverage' data-ref="490detectorAverage" data-ref-filename="490detectorAverage">detectorAverage</a>);</td></tr>
<tr><th id="395">395</th><td></td></tr>
<tr><th id="396">396</th><td>                <i>// Fix gremlins.</i></td></tr>
<tr><th id="397">397</th><td>                <b>if</b> (<span class="namespace">std::</span><span class='ref fn' title='isnan' data-ref="_ZL5isnanf" data-ref-filename="_ZL5isnanf">isnan</span>(<a class="local col0 ref" href="#490detectorAverage" title='detectorAverage' data-ref="490detectorAverage" data-ref-filename="490detectorAverage">detectorAverage</a>))</td></tr>
<tr><th id="398">398</th><td>                    <a class="local col0 ref" href="#490detectorAverage" title='detectorAverage' data-ref="490detectorAverage" data-ref-filename="490detectorAverage">detectorAverage</a> = <var>1</var>;</td></tr>
<tr><th id="399">399</th><td>                <b>if</b> (<span class="namespace">std::</span><span class='ref fn' title='isinf' data-ref="_ZL5isinff" data-ref-filename="_ZL5isinff">isinf</span>(<a class="local col0 ref" href="#490detectorAverage" title='detectorAverage' data-ref="490detectorAverage" data-ref-filename="490detectorAverage">detectorAverage</a>))</td></tr>
<tr><th id="400">400</th><td>                    <a class="local col0 ref" href="#490detectorAverage" title='detectorAverage' data-ref="490detectorAverage" data-ref-filename="490detectorAverage">detectorAverage</a> = <var>1</var>;</td></tr>
<tr><th id="401">401</th><td></td></tr>
<tr><th id="402">402</th><td>                <i>// Exponential approach to desired gain.</i></td></tr>
<tr><th id="403">403</th><td>                <b>if</b> (<a class="local col7 ref" href="#477envelopeRate" title='envelopeRate' data-ref="477envelopeRate" data-ref-filename="477envelopeRate">envelopeRate</a> &lt; <var>1</var>) {</td></tr>
<tr><th id="404">404</th><td>                    <i>// Attack - reduce gain to desired.</i></td></tr>
<tr><th id="405">405</th><td>                    <a class="local col1 ref" href="#491compressorGain" title='compressorGain' data-ref="491compressorGain" data-ref-filename="491compressorGain">compressorGain</a> += (<a class="local col6 ref" href="#476scaledDesiredGain" title='scaledDesiredGain' data-ref="476scaledDesiredGain" data-ref-filename="476scaledDesiredGain">scaledDesiredGain</a> - <a class="local col1 ref" href="#491compressorGain" title='compressorGain' data-ref="491compressorGain" data-ref-filename="491compressorGain">compressorGain</a>) * <a class="local col7 ref" href="#477envelopeRate" title='envelopeRate' data-ref="477envelopeRate" data-ref-filename="477envelopeRate">envelopeRate</a>;</td></tr>
<tr><th id="406">406</th><td>                } <b>else</b> {</td></tr>
<tr><th id="407">407</th><td>                    <i>// Release - exponentially increase gain to 1.0</i></td></tr>
<tr><th id="408">408</th><td>                    <a class="local col1 ref" href="#491compressorGain" title='compressorGain' data-ref="491compressorGain" data-ref-filename="491compressorGain">compressorGain</a> *= <a class="local col7 ref" href="#477envelopeRate" title='envelopeRate' data-ref="477envelopeRate" data-ref-filename="477envelopeRate">envelopeRate</a>;</td></tr>
<tr><th id="409">409</th><td>                    <a class="local col1 ref" href="#491compressorGain" title='compressorGain' data-ref="491compressorGain" data-ref-filename="491compressorGain">compressorGain</a> = <span class="namespace">std::</span><span class='ref fn' title='std::__1::min' data-ref="_ZNSt3__1L3minERKT_S2_" data-ref-filename="_ZNSt3__1L3minERKT_S2_">min</span>(<var>1.0f</var>, <a class="local col1 ref" href="#491compressorGain" title='compressorGain' data-ref="491compressorGain" data-ref-filename="491compressorGain">compressorGain</a>);</td></tr>
<tr><th id="410">410</th><td>                }</td></tr>
<tr><th id="411">411</th><td></td></tr>
<tr><th id="412">412</th><td>                <i>// Warp pre-compression gain to smooth out sharp exponential transition points.</i></td></tr>
<tr><th id="413">413</th><td>                <em>float</em> <dfn class="local col7 decl" id="507postWarpCompressorGain" title='postWarpCompressorGain' data-type='float' data-ref="507postWarpCompressorGain" data-ref-filename="507postWarpCompressorGain">postWarpCompressorGain</dfn> = <span class='ref fn' title='sinf' data-ref="sinf" data-ref-filename="sinf">sinf</span>(<var>0.5f</var> * <a class="ref" href="../../../../WebKitBuild/Debug/usr/local/include/wtf/MathExtras.h.html#piFloat" title='piFloat' data-ref="piFloat" data-ref-filename="piFloat">piFloat</a> * <a class="local col1 ref" href="#491compressorGain" title='compressorGain' data-ref="491compressorGain" data-ref-filename="491compressorGain">compressorGain</a>);</td></tr>
<tr><th id="414">414</th><td></td></tr>
<tr><th id="415">415</th><td>                <i>// Calculate total gain using master gain and effect blend.</i></td></tr>
<tr><th id="416">416</th><td>                <em>float</em> <dfn class="local col8 decl" id="508totalGain" title='totalGain' data-type='float' data-ref="508totalGain" data-ref-filename="508totalGain">totalGain</dfn> = <a class="local col2 ref" href="#452dryMix" title='dryMix' data-ref="452dryMix" data-ref-filename="452dryMix">dryMix</a> + <a class="local col3 ref" href="#453wetMix" title='wetMix' data-ref="453wetMix" data-ref-filename="453wetMix">wetMix</a> * <a class="local col7 ref" href="#457masterLinearGain" title='masterLinearGain' data-ref="457masterLinearGain" data-ref-filename="457masterLinearGain">masterLinearGain</a> * <a class="local col7 ref" href="#507postWarpCompressorGain" title='postWarpCompressorGain' data-ref="507postWarpCompressorGain" data-ref-filename="507postWarpCompressorGain">postWarpCompressorGain</a>;</td></tr>
<tr><th id="417">417</th><td></td></tr>
<tr><th id="418">418</th><td>                <i>// Calculate metering.</i></td></tr>
<tr><th id="419">419</th><td>                <em>float</em> <dfn class="local col9 decl" id="509dbRealGain" title='dbRealGain' data-type='float' data-ref="509dbRealGain" data-ref-filename="509dbRealGain">dbRealGain</dfn> = <var>20</var> * <span class='ref fn' title='log10' data-ref="_ZL5log10f" data-ref-filename="_ZL5log10f">log10</span>(<a class="local col7 ref" href="#507postWarpCompressorGain" title='postWarpCompressorGain' data-ref="507postWarpCompressorGain" data-ref-filename="507postWarpCompressorGain">postWarpCompressorGain</a>);</td></tr>
<tr><th id="420">420</th><td>                <b>if</b> (<a class="local col9 ref" href="#509dbRealGain" title='dbRealGain' data-ref="509dbRealGain" data-ref-filename="509dbRealGain">dbRealGain</a> &lt; <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_meteringGain" title='WebCore::DynamicsCompressorKernel::m_meteringGain' data-ref="WebCore::DynamicsCompressorKernel::m_meteringGain" data-ref-filename="WebCore..DynamicsCompressorKernel..m_meteringGain">m_meteringGain</a>)</td></tr>
<tr><th id="421">421</th><td>                    <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_meteringGain" title='WebCore::DynamicsCompressorKernel::m_meteringGain' data-ref="WebCore::DynamicsCompressorKernel::m_meteringGain" data-ref-filename="WebCore..DynamicsCompressorKernel..m_meteringGain">m_meteringGain</a> = <a class="local col9 ref" href="#509dbRealGain" title='dbRealGain' data-ref="509dbRealGain" data-ref-filename="509dbRealGain">dbRealGain</a>;</td></tr>
<tr><th id="422">422</th><td>                <b>else</b></td></tr>
<tr><th id="423">423</th><td>                    <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_meteringGain" title='WebCore::DynamicsCompressorKernel::m_meteringGain' data-ref="WebCore::DynamicsCompressorKernel::m_meteringGain" data-ref-filename="WebCore..DynamicsCompressorKernel..m_meteringGain">m_meteringGain</a> += (<a class="local col9 ref" href="#509dbRealGain" title='dbRealGain' data-ref="509dbRealGain" data-ref-filename="509dbRealGain">dbRealGain</a> - <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_meteringGain" title='WebCore::DynamicsCompressorKernel::m_meteringGain' data-ref="WebCore::DynamicsCompressorKernel::m_meteringGain" data-ref-filename="WebCore..DynamicsCompressorKernel..m_meteringGain">m_meteringGain</a>) * <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_meteringReleaseK" title='WebCore::DynamicsCompressorKernel::m_meteringReleaseK' data-ref="WebCore::DynamicsCompressorKernel::m_meteringReleaseK" data-ref-filename="WebCore..DynamicsCompressorKernel..m_meteringReleaseK">m_meteringReleaseK</a>;</td></tr>
<tr><th id="424">424</th><td></td></tr>
<tr><th id="425">425</th><td>                <i>// Apply final gain.</i></td></tr>
<tr><th id="426">426</th><td>                <b>for</b> (<em>unsigned</em> <dfn class="local col0 decl" id="510i" title='i' data-type='unsigned int' data-ref="510i" data-ref-filename="510i">i</dfn> = <var>0</var>; <a class="local col0 ref" href="#510i" title='i' data-ref="510i" data-ref-filename="510i">i</a> &lt; <a class="local col7 ref" href="#437numberOfChannels" title='numberOfChannels' data-ref="437numberOfChannels" data-ref-filename="437numberOfChannels">numberOfChannels</a>; ++<a class="local col0 ref" href="#510i" title='i' data-ref="510i" data-ref-filename="510i">i</a>) {</td></tr>
<tr><th id="427">427</th><td>                    <em>float</em>* <dfn class="local col1 decl" id="511delayBuffer" title='delayBuffer' data-type='float *' data-ref="511delayBuffer" data-ref-filename="511delayBuffer">delayBuffer</dfn> = <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayBuffers" title='WebCore::DynamicsCompressorKernel::m_preDelayBuffers' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayBuffers" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayBuffers">m_preDelayBuffers</a><a class="ref fn" href="../../../../WebKitBuild/Debug/usr/local/include/wtf/Vector.h.html#_ZN3WTF6VectorixEm" title='WTF::Vector::operator[]' data-ref="_ZN3WTF6VectorixEm" data-ref-filename="_ZN3WTF6VectorixEm">[<a class="local col0 ref" href="#510i" title='i' data-ref="510i" data-ref-filename="510i">i</a>]</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref fn" href="AudioArray.h.html#_ZN7WebCore10AudioArray4dataEv" title='WebCore::AudioArray::data' data-ref="_ZN7WebCore10AudioArray4dataEv" data-ref-filename="_ZN7WebCore10AudioArray4dataEv">data</a>();</td></tr>
<tr><th id="428">428</th><td>                    <a class="local col6 ref" href="#436destinationChannels" title='destinationChannels' data-ref="436destinationChannels" data-ref-filename="436destinationChannels">destinationChannels</a>[<a class="local col0 ref" href="#510i" title='i' data-ref="510i" data-ref-filename="510i">i</a>][<a class="local col3 ref" href="#473frameIndex" title='frameIndex' data-ref="473frameIndex" data-ref-filename="473frameIndex">frameIndex</a>] = <a class="local col1 ref" href="#511delayBuffer" title='delayBuffer' data-ref="511delayBuffer" data-ref-filename="511delayBuffer">delayBuffer</a>[<a class="local col8 ref" href="#488preDelayReadIndex" title='preDelayReadIndex' data-ref="488preDelayReadIndex" data-ref-filename="488preDelayReadIndex">preDelayReadIndex</a>] * <a class="local col8 ref" href="#508totalGain" title='totalGain' data-ref="508totalGain" data-ref-filename="508totalGain">totalGain</a>;</td></tr>
<tr><th id="429">429</th><td>                }</td></tr>
<tr><th id="430">430</th><td></td></tr>
<tr><th id="431">431</th><td>                <a class="local col3 ref" href="#473frameIndex" title='frameIndex' data-ref="473frameIndex" data-ref-filename="473frameIndex">frameIndex</a>++;</td></tr>
<tr><th id="432">432</th><td>                <a class="local col8 ref" href="#488preDelayReadIndex" title='preDelayReadIndex' data-ref="488preDelayReadIndex" data-ref-filename="488preDelayReadIndex">preDelayReadIndex</a> = (<a class="local col8 ref" href="#488preDelayReadIndex" title='preDelayReadIndex' data-ref="488preDelayReadIndex" data-ref-filename="488preDelayReadIndex">preDelayReadIndex</a> + <var>1</var>) &amp; <a class="enum" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::MaxPreDelayFramesMask" title='WebCore::DynamicsCompressorKernel::MaxPreDelayFramesMask' data-ref="WebCore::DynamicsCompressorKernel::MaxPreDelayFramesMask" data-ref-filename="WebCore..DynamicsCompressorKernel..MaxPreDelayFramesMask">MaxPreDelayFramesMask</a>;</td></tr>
<tr><th id="433">433</th><td>                <a class="local col9 ref" href="#489preDelayWriteIndex" title='preDelayWriteIndex' data-ref="489preDelayWriteIndex" data-ref-filename="489preDelayWriteIndex">preDelayWriteIndex</a> = (<a class="local col9 ref" href="#489preDelayWriteIndex" title='preDelayWriteIndex' data-ref="489preDelayWriteIndex" data-ref-filename="489preDelayWriteIndex">preDelayWriteIndex</a> + <var>1</var>) &amp; <a class="enum" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::MaxPreDelayFramesMask" title='WebCore::DynamicsCompressorKernel::MaxPreDelayFramesMask' data-ref="WebCore::DynamicsCompressorKernel::MaxPreDelayFramesMask" data-ref-filename="WebCore..DynamicsCompressorKernel..MaxPreDelayFramesMask">MaxPreDelayFramesMask</a>;</td></tr>
<tr><th id="434">434</th><td>            }</td></tr>
<tr><th id="435">435</th><td></td></tr>
<tr><th id="436">436</th><td>            <i>// Locals back to member variables.</i></td></tr>
<tr><th id="437">437</th><td>            <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayReadIndex" title='WebCore::DynamicsCompressorKernel::m_preDelayReadIndex' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayReadIndex" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayReadIndex">m_preDelayReadIndex</a> = <a class="local col8 ref" href="#488preDelayReadIndex" title='preDelayReadIndex' data-ref="488preDelayReadIndex" data-ref-filename="488preDelayReadIndex">preDelayReadIndex</a>;</td></tr>
<tr><th id="438">438</th><td>            <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayWriteIndex" title='WebCore::DynamicsCompressorKernel::m_preDelayWriteIndex' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayWriteIndex" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayWriteIndex">m_preDelayWriteIndex</a> = <a class="local col9 ref" href="#489preDelayWriteIndex" title='preDelayWriteIndex' data-ref="489preDelayWriteIndex" data-ref-filename="489preDelayWriteIndex">preDelayWriteIndex</a>;</td></tr>
<tr><th id="439">439</th><td>            <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_detectorAverage" title='WebCore::DynamicsCompressorKernel::m_detectorAverage' data-ref="WebCore::DynamicsCompressorKernel::m_detectorAverage" data-ref-filename="WebCore..DynamicsCompressorKernel..m_detectorAverage">m_detectorAverage</a> = <a class="type" href="DenormalDisabler.h.html#WebCore::DenormalDisabler" title='WebCore::DenormalDisabler' data-ref="WebCore::DenormalDisabler" data-ref-filename="WebCore..DenormalDisabler">DenormalDisabler</a>::<a class="ref fn" href="DenormalDisabler.h.html#_ZN7WebCore16DenormalDisabler24flushDenormalFloatToZeroEf" title='WebCore::DenormalDisabler::flushDenormalFloatToZero' data-ref="_ZN7WebCore16DenormalDisabler24flushDenormalFloatToZeroEf" data-ref-filename="_ZN7WebCore16DenormalDisabler24flushDenormalFloatToZeroEf">flushDenormalFloatToZero</a>(<a class="local col0 ref" href="#490detectorAverage" title='detectorAverage' data-ref="490detectorAverage" data-ref-filename="490detectorAverage">detectorAverage</a>);</td></tr>
<tr><th id="440">440</th><td>            <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_compressorGain" title='WebCore::DynamicsCompressorKernel::m_compressorGain' data-ref="WebCore::DynamicsCompressorKernel::m_compressorGain" data-ref-filename="WebCore..DynamicsCompressorKernel..m_compressorGain">m_compressorGain</a> = <a class="type" href="DenormalDisabler.h.html#WebCore::DenormalDisabler" title='WebCore::DenormalDisabler' data-ref="WebCore::DenormalDisabler" data-ref-filename="WebCore..DenormalDisabler">DenormalDisabler</a>::<a class="ref fn" href="DenormalDisabler.h.html#_ZN7WebCore16DenormalDisabler24flushDenormalFloatToZeroEf" title='WebCore::DenormalDisabler::flushDenormalFloatToZero' data-ref="_ZN7WebCore16DenormalDisabler24flushDenormalFloatToZeroEf" data-ref-filename="_ZN7WebCore16DenormalDisabler24flushDenormalFloatToZeroEf">flushDenormalFloatToZero</a>(<a class="local col1 ref" href="#491compressorGain" title='compressorGain' data-ref="491compressorGain" data-ref-filename="491compressorGain">compressorGain</a>);</td></tr>
<tr><th id="441">441</th><td>        }</td></tr>
<tr><th id="442">442</th><td>    }</td></tr>
<tr><th id="443">443</th><td>}</td></tr>
<tr><th id="444">444</th><td></td></tr>
<tr><th id="445">445</th><td><em>void</em> <a class="type" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel" title='WebCore::DynamicsCompressorKernel' data-ref="WebCore::DynamicsCompressorKernel" data-ref-filename="WebCore..DynamicsCompressorKernel">DynamicsCompressorKernel</a>::<dfn class="decl def fn" id="_ZN7WebCore24DynamicsCompressorKernel5resetEv" title='WebCore::DynamicsCompressorKernel::reset' data-ref="_ZN7WebCore24DynamicsCompressorKernel5resetEv" data-ref-filename="_ZN7WebCore24DynamicsCompressorKernel5resetEv">reset</dfn>()</td></tr>
<tr><th id="446">446</th><td>{</td></tr>
<tr><th id="447">447</th><td>    <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_detectorAverage" title='WebCore::DynamicsCompressorKernel::m_detectorAverage' data-ref="WebCore::DynamicsCompressorKernel::m_detectorAverage" data-ref-filename="WebCore..DynamicsCompressorKernel..m_detectorAverage">m_detectorAverage</a> = <var>0</var>;</td></tr>
<tr><th id="448">448</th><td>    <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_compressorGain" title='WebCore::DynamicsCompressorKernel::m_compressorGain' data-ref="WebCore::DynamicsCompressorKernel::m_compressorGain" data-ref-filename="WebCore..DynamicsCompressorKernel..m_compressorGain">m_compressorGain</a> = <var>1</var>;</td></tr>
<tr><th id="449">449</th><td>    <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_meteringGain" title='WebCore::DynamicsCompressorKernel::m_meteringGain' data-ref="WebCore::DynamicsCompressorKernel::m_meteringGain" data-ref-filename="WebCore..DynamicsCompressorKernel..m_meteringGain">m_meteringGain</a> = <var>1</var>;</td></tr>
<tr><th id="450">450</th><td></td></tr>
<tr><th id="451">451</th><td>    <i>// Predelay section.</i></td></tr>
<tr><th id="452">452</th><td>    <b>for</b> (<em>unsigned</em> <dfn class="local col2 decl" id="512i" title='i' data-type='unsigned int' data-ref="512i" data-ref-filename="512i">i</dfn> = <var>0</var>; <a class="local col2 ref" href="#512i" title='i' data-ref="512i" data-ref-filename="512i">i</a> &lt; <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayBuffers" title='WebCore::DynamicsCompressorKernel::m_preDelayBuffers' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayBuffers" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayBuffers">m_preDelayBuffers</a>.<a class="ref fn" href="../../../../WebKitBuild/Debug/usr/local/include/wtf/Vector.h.html#_ZNK3WTF6Vector4sizeEv" title='WTF::Vector::size' data-ref="_ZNK3WTF6Vector4sizeEv" data-ref-filename="_ZNK3WTF6Vector4sizeEv">size</a>(); ++<a class="local col2 ref" href="#512i" title='i' data-ref="512i" data-ref-filename="512i">i</a>)</td></tr>
<tr><th id="453">453</th><td>        <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayBuffers" title='WebCore::DynamicsCompressorKernel::m_preDelayBuffers' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayBuffers" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayBuffers">m_preDelayBuffers</a><a class="ref fn" href="../../../../WebKitBuild/Debug/usr/local/include/wtf/Vector.h.html#_ZN3WTF6VectorixEm" title='WTF::Vector::operator[]' data-ref="_ZN3WTF6VectorixEm" data-ref-filename="_ZN3WTF6VectorixEm">[<a class="local col2 ref" href="#512i" title='i' data-ref="512i" data-ref-filename="512i">i</a>]</a><span class='ref fn' title='std::__1::unique_ptr::operator-&gt;' data-ref="_ZNKSt3__110unique_ptrptEv" data-ref-filename="_ZNKSt3__110unique_ptrptEv">-&gt;</span><a class="ref fn" href="AudioArray.h.html#_ZN7WebCore10AudioArray4zeroEv" title='WebCore::AudioArray::zero' data-ref="_ZN7WebCore10AudioArray4zeroEv" data-ref-filename="_ZN7WebCore10AudioArray4zeroEv">zero</a>();</td></tr>
<tr><th id="454">454</th><td></td></tr>
<tr><th id="455">455</th><td>    <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayReadIndex" title='WebCore::DynamicsCompressorKernel::m_preDelayReadIndex' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayReadIndex" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayReadIndex">m_preDelayReadIndex</a> = <var>0</var>;</td></tr>
<tr><th id="456">456</th><td>    <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_preDelayWriteIndex" title='WebCore::DynamicsCompressorKernel::m_preDelayWriteIndex' data-ref="WebCore::DynamicsCompressorKernel::m_preDelayWriteIndex" data-ref-filename="WebCore..DynamicsCompressorKernel..m_preDelayWriteIndex">m_preDelayWriteIndex</a> = <a class="enum" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::DefaultPreDelayFrames" title='WebCore::DynamicsCompressorKernel::DefaultPreDelayFrames' data-ref="WebCore::DynamicsCompressorKernel::DefaultPreDelayFrames" data-ref-filename="WebCore..DynamicsCompressorKernel..DefaultPreDelayFrames">DefaultPreDelayFrames</a>;</td></tr>
<tr><th id="457">457</th><td></td></tr>
<tr><th id="458">458</th><td>    <a class="member field" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb" title='WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb' data-ref="WebCore::DynamicsCompressorKernel::m_maxAttackCompressionDiffDb" data-ref-filename="WebCore..DynamicsCompressorKernel..m_maxAttackCompressionDiffDb">m_maxAttackCompressionDiffDb</a> = -<var>1</var>; <i>// uninitialized state</i></td></tr>
<tr><th id="459">459</th><td>}</td></tr>
<tr><th id="460">460</th><td></td></tr>
<tr><th id="461">461</th><td><em>double</em> <a class="type" href="DynamicsCompressorKernel.h.html#WebCore::DynamicsCompressorKernel" title='WebCore::DynamicsCompressorKernel' data-ref="WebCore::DynamicsCompressorKernel" data-ref-filename="WebCore..DynamicsCompressorKernel">DynamicsCompressorKernel</a>::<dfn class="decl def fn" id="_ZNK7WebCore24DynamicsCompressorKernel8tailTimeEv" title='WebCore::DynamicsCompressorKernel::tailTime' data-ref="_ZNK7WebCore24DynamicsCompressorKernel8tailTimeEv" data-ref-filename="_ZNK7WebCore24DynamicsCompressorKernel8tailTimeEv">tailTime</dfn>() <em>const</em></td></tr>
<tr><th id="462">462</th><td>{</td></tr>
<tr><th id="463">463</th><td>    <i>// The reduction value of the compressor is computed from the gain using an exponential filter</i></td></tr>
<tr><th id="464">464</th><td><i>    // with a time constant of |meteringReleaseTimeConstant|. We need to keep he compressor running</i></td></tr>
<tr><th id="465">465</th><td><i>    // for some time after the inputs go away so that the reduction value approaches 0. This is a</i></td></tr>
<tr><th id="466">466</th><td><i>    // tradeoff between how long we keep the node alive and how close we approach the final value.</i></td></tr>
<tr><th id="467">467</th><td><i>    // A value of 5 to 10 times the time constant is a reasonable trade-off.</i></td></tr>
<tr><th id="468">468</th><td>    <b>return</b> <var>5</var> * <a class="ref" href="#WebCore::meteringReleaseTimeConstant" title='WebCore::meteringReleaseTimeConstant' data-ref="WebCore::meteringReleaseTimeConstant" data-ref-filename="WebCore..meteringReleaseTimeConstant">meteringReleaseTimeConstant</a>;</td></tr>
<tr><th id="469">469</th><td>}</td></tr>
<tr><th id="470">470</th><td></td></tr>
<tr><th id="471">471</th><td>} <i>// namespace WebCore</i></td></tr>
<tr><th id="472">472</th><td></td></tr>
<tr><th id="473">473</th><td><u>#<span data-ppcond="31">endif</span> // ENABLE(WEB_AUDIO)</u></td></tr>
<tr><th id="474">474</th><td></td></tr>
</table><hr/><p id='footer'>
Generated while processing <a href='../../../../WebKitBuild/Debug/DerivedSources/WebCore/unified-sources/UnifiedSource255.cpp.html'>webkit/WebKitBuild/Debug/DerivedSources/WebCore/unified-sources/UnifiedSource255.cpp</a><br/>Generated on <em>2021-Jul-06</em> from project webkit<br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
